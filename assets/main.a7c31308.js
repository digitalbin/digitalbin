var J1=Object.defineProperty;var K1=(l,e,t)=>e in l?J1(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var Ce=(l,e,t)=>(K1(l,typeof e!="symbol"?e+"":e,t),t),yd=(l,e,t)=>{if(!e.has(l))throw TypeError("Cannot "+t)};var xi=(l,e,t)=>(yd(l,e,"read from private field"),t?t.call(l):e.get(l)),qo=(l,e,t)=>{if(e.has(l))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(l):e.set(l,t)},sh=(l,e,t,i)=>(yd(l,e,"write to private field"),i?i.call(l,t):e.set(l,t),t);const Q1=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}};Q1();const $1=`
<label>
Your email:
<input required type="email" name="email">
</label>
<label>
Your message:
<textarea required name="message"></textarea>
</label>
<button type="submit">Send</button>
`;class e2 extends HTMLElement{constructor(){super();Ce(this,"form");Ce(this,"status");this.form=document.createElement("form"),this.form.innerHTML=$1,this.form.onsubmit=this.onSubmit.bind(this),this.status=document.createElement("p"),this.status.classList.add("status"),this.form.appendChild(this.status),this.appendChild(this.form)}onSubmit(t){t.preventDefault();const i=t.target,n=new FormData(i);fetch("https://formspree.io/f/xoqbavoq",{method:"POST",body:n,headers:{Accept:"application/json"}}).then(r=>this.setStatus(r.ok)).catch(()=>this.setStatus(!1))}setStatus(t){t?(this.status.innerHTML="> Thanks for reaching out",this.form.reset()):this.status.innerHTML="> Something went wrong, please try again"}}const t2=`
<div>
    <svg id="loading" viewBox="0 0 1611 303" xmlns="http://www.w3.org/2000/svg">
        <path class="letter" d="M53.7511 63.272L4.59914 84.008L0.119141 70.184L36.0871 56.232L0.119141 42.28L4.59914 28.456L53.7511 49.064V63.272Z" />
        <path class="letter" d="M142.583 58.536C142.583 63.912 143.564 68.3066 145.527 71.72C147.575 75.1333 150.818 76.84 155.255 76.84C156.535 76.84 157.73 76.7973 158.839 76.712C159.948 76.6266 161.1 76.4986 162.295 76.328V43.56C161.1 42.8773 159.735 42.3226 158.199 41.896C156.663 41.384 155.042 41.128 153.335 41.128C149.58 41.128 146.85 42.6213 145.143 45.608C143.436 48.5946 142.583 52.904 142.583 58.536ZM178.039 87.208C175.138 88.1466 171.596 88.9146 167.415 89.512C163.234 90.1093 159.138 90.408 155.127 90.408C145.74 90.408 138.615 87.6346 133.751 82.088C128.972 76.5413 126.583 68.9466 126.583 59.304C126.583 49.4906 128.588 41.768 132.599 36.136C136.695 30.4186 142.711 27.56 150.647 27.56C152.78 27.56 154.871 27.816 156.919 28.328C158.967 28.7546 160.759 29.3946 162.295 30.248V2.85596L178.039 0.167969V87.208Z" />
        <path class="letter" d="M223.351 11.56C223.351 14.632 222.37 17.064 220.407 18.856C218.444 20.648 216.098 21.544 213.367 21.544C210.636 21.544 208.29 20.648 206.327 18.856C204.45 17.064 203.511 14.632 203.511 11.56C203.511 8.40263 204.45 5.92797 206.327 4.13596C208.29 2.34397 210.636 1.44797 213.367 1.44797C216.098 1.44797 218.444 2.34397 220.407 4.13596C222.37 5.92797 223.351 8.40263 223.351 11.56ZM246.775 86.44C243.532 87.976 240.46 89 237.559 89.512C234.743 90.1093 232.14 90.408 229.751 90.408C225.655 90.408 222.199 89.8106 219.383 88.616C216.652 87.4213 214.434 85.7146 212.727 83.496C211.106 81.192 209.954 78.4186 209.271 75.176C208.588 71.9333 208.247 68.2213 208.247 64.04V41.896H191.607V28.84H223.991V66.088C223.991 69.672 224.631 72.36 225.911 74.152C227.276 75.8586 229.495 76.712 232.567 76.712C234.018 76.712 235.767 76.5413 237.815 76.2C239.863 75.7733 242.167 74.9626 244.727 73.768L246.775 86.44Z" />
        <path class="letter" d="M271.223 57C271.223 61.9493 272.119 65.7466 273.911 68.392C275.703 70.952 278.519 72.232 282.359 72.232C284.066 72.232 285.644 72.0186 287.095 71.592C288.631 71.1653 289.996 70.6106 291.191 69.928V41C289.996 40.744 288.93 40.5733 287.991 40.488C287.052 40.4026 286.071 40.36 285.047 40.36C275.831 40.36 271.223 45.9066 271.223 57ZM307.063 81.704C307.063 91.5173 304.674 98.7706 299.895 103.464C295.202 108.157 287.607 110.504 277.111 110.504C273.356 110.504 269.73 110.12 266.231 109.352C262.818 108.584 259.532 107.688 256.375 106.664L259.319 93.352C261.794 94.2906 264.396 95.144 267.127 95.912C269.858 96.7653 273.271 97.192 277.367 97.192C280.098 97.192 282.359 96.8506 284.151 96.168C285.943 95.5706 287.351 94.7173 288.375 93.608C289.399 92.4986 290.124 91.176 290.551 89.64C290.978 88.1893 291.191 86.6106 291.191 84.904V82.472C288.972 83.3253 286.924 83.9653 285.047 84.392C283.255 84.8186 281.292 85.032 279.159 85.032C271.308 85.032 265.335 82.5573 261.239 77.608C257.228 72.6586 255.223 65.7893 255.223 57C255.223 47.1013 257.954 39.72 263.415 34.856C268.876 29.992 276.3 27.56 285.687 27.56C292.258 27.56 299.383 28.6266 307.063 30.76V81.704Z" />
        <path class="letter" d="M351.351 11.56C351.351 14.632 350.37 17.064 348.407 18.856C346.444 20.648 344.098 21.544 341.367 21.544C338.636 21.544 336.29 20.648 334.327 18.856C332.45 17.064 331.511 14.632 331.511 11.56C331.511 8.40263 332.45 5.92797 334.327 4.13596C336.29 2.34397 338.636 1.44797 341.367 1.44797C344.098 1.44797 346.444 2.34397 348.407 4.13596C350.37 5.92797 351.351 8.40263 351.351 11.56ZM374.775 86.44C371.532 87.976 368.46 89 365.559 89.512C362.743 90.1093 360.14 90.408 357.751 90.408C353.655 90.408 350.199 89.8106 347.383 88.616C344.652 87.4213 342.434 85.7146 340.727 83.496C339.106 81.192 337.954 78.4186 337.271 75.176C336.588 71.9333 336.247 68.2213 336.247 64.04V41.896H319.607V28.84H351.991V66.088C351.991 69.672 352.631 72.36 353.911 74.152C355.276 75.8586 357.495 76.712 360.567 76.712C362.018 76.712 363.767 76.5413 365.815 76.2C367.863 75.7733 370.167 74.9626 372.727 73.768L374.775 86.44Z" />
        <path class="letter" d="M397.303 41.896H383.607V28.84H397.303V13.736L413.047 11.176V28.84H438.263V41.896H413.047V66.216C413.047 68.4346 413.26 70.2266 413.687 71.592C414.114 72.9573 414.711 74.024 415.479 74.792C416.247 75.56 417.186 76.072 418.295 76.328C419.404 76.584 420.642 76.712 422.007 76.712C423.458 76.712 424.78 76.6693 425.975 76.584C427.255 76.4986 428.45 76.3706 429.559 76.2C430.754 75.944 431.948 75.6026 433.143 75.176C434.423 74.7493 435.788 74.1946 437.239 73.512L439.415 87.08C436.514 88.2746 433.356 89.128 429.943 89.64C426.615 90.152 423.372 90.408 420.215 90.408C416.546 90.408 413.303 90.1093 410.487 89.512C407.671 88.9146 405.282 87.7626 403.319 86.056C401.356 84.3493 399.863 81.96 398.839 78.888C397.815 75.7306 397.303 71.6346 397.303 66.6V41.896Z" />
        <path class="letter" d="M475.127 77.736C476.834 77.736 478.498 77.736 480.119 77.736C481.74 77.6506 483.148 77.5226 484.343 77.352V63.528C483.319 63.3573 482.082 63.2293 480.631 63.144C479.18 62.9733 477.858 62.888 476.663 62.888C475.042 62.888 473.463 63.016 471.927 63.272C470.391 63.4426 469.026 63.784 467.831 64.296C466.722 64.808 465.826 65.5333 465.143 66.472C464.46 67.4106 464.119 68.648 464.119 70.184C464.119 72.9146 465.143 74.8773 467.191 76.072C469.239 77.1813 471.884 77.736 475.127 77.736ZM473.719 27.304C478.668 27.304 482.764 27.9013 486.007 29.096C489.335 30.2053 491.98 31.8266 493.943 33.96C495.906 36.008 497.314 38.568 498.167 41.64C499.02 44.6266 499.447 47.9973 499.447 51.752V87.592C497.143 88.104 493.73 88.7013 489.207 89.384C484.684 90.0666 479.607 90.408 473.975 90.408C470.135 90.408 466.636 90.0666 463.479 89.384C460.407 88.7013 457.762 87.592 455.543 86.056C453.324 84.4346 451.618 82.3866 450.423 79.912C449.228 77.352 448.631 74.2373 448.631 70.568C448.631 67.0693 449.314 64.1253 450.679 61.736C452.044 59.3466 453.879 57.4266 456.183 55.976C458.487 54.5253 461.132 53.5013 464.119 52.904C467.106 52.2213 470.22 51.88 473.463 51.88C477.559 51.88 481.186 52.2213 484.343 52.904V50.984C484.343 47.9973 483.404 45.5226 481.527 43.56C479.65 41.512 476.407 40.488 471.799 40.488C468.812 40.488 465.911 40.7013 463.095 41.128C460.364 41.5546 458.146 42.0666 456.439 42.664L454.263 29.992C456.226 29.3093 458.999 28.712 462.583 28.2C466.167 27.6026 469.879 27.304 473.719 27.304Z" />
        <path class="letter" d="M566.775 86.44C566.519 86.6106 565.922 86.9093 564.983 87.336C564.13 87.7626 562.978 88.232 561.527 88.744C560.076 89.1706 558.284 89.5546 556.151 89.896C554.103 90.2373 551.756 90.408 549.111 90.408C541.858 90.408 536.567 88.2746 533.239 84.008C529.911 79.656 528.247 73.3413 528.247 65.064V13.992H511.607V0.935966H543.991V66.216C543.991 70.312 544.802 73.0853 546.423 74.536C548.044 75.9866 550.092 76.712 552.567 76.712C555.724 76.712 558.37 76.2853 560.503 75.432C562.636 74.5786 564.045 74.024 564.727 73.768L566.775 86.44Z" />
        <path class="letter" d="M615.159 58.536C615.159 52.904 614.22 48.5946 612.343 45.608C610.551 42.6213 607.778 41.128 604.023 41.128C602.316 41.128 600.61 41.384 598.903 41.896C597.282 42.3226 595.874 42.8773 594.679 43.56V76.2C595.874 76.456 597.111 76.6266 598.391 76.712C599.756 76.7973 600.909 76.84 601.847 76.84C605.943 76.84 609.186 75.4746 611.575 72.744C613.964 69.928 615.159 65.192 615.159 58.536ZM631.159 58.92C631.159 63.6986 630.519 68.0506 629.239 71.976C627.959 75.816 626.082 79.1013 623.607 81.832C621.132 84.5626 618.103 86.696 614.519 88.232C610.935 89.6826 606.839 90.408 602.231 90.408C598.135 90.408 593.954 90.1093 589.687 89.512C585.42 88.9146 581.836 88.1466 578.935 87.208V2.85596L594.679 0.167969V30.248C596.898 29.224 599.031 28.5413 601.079 28.2C603.127 27.7733 605.175 27.56 607.223 27.56C611.148 27.56 614.604 28.328 617.591 29.864C620.578 31.3146 623.052 33.448 625.015 36.264C627.063 38.9946 628.599 42.28 629.623 46.12C630.647 49.96 631.159 54.2266 631.159 58.92Z" />
        <path class="letter" d="M671.351 11.56C671.351 14.632 670.37 17.064 668.407 18.856C666.444 20.648 664.098 21.544 661.367 21.544C658.636 21.544 656.29 20.648 654.327 18.856C652.45 17.064 651.511 14.632 651.511 11.56C651.511 8.40263 652.45 5.92797 654.327 4.13596C656.29 2.34397 658.636 1.44797 661.367 1.44797C664.098 1.44797 666.444 2.34397 668.407 4.13596C670.37 5.92797 671.351 8.40263 671.351 11.56ZM694.775 86.44C691.532 87.976 688.46 89 685.559 89.512C682.743 90.1093 680.14 90.408 677.751 90.408C673.655 90.408 670.199 89.8106 667.383 88.616C664.652 87.4213 662.434 85.7146 660.727 83.496C659.106 81.192 657.954 78.4186 657.271 75.176C656.588 71.9333 656.247 68.2213 656.247 64.04V41.896H639.607V28.84H671.991V66.088C671.991 69.672 672.631 72.36 673.911 74.152C675.276 75.8586 677.495 76.712 680.567 76.712C682.018 76.712 683.767 76.5413 685.815 76.2C687.863 75.7733 690.167 74.9626 692.727 73.768L694.775 86.44Z" />
        <path class="letter" d="M707.063 30.76C709.879 29.992 713.335 29.2666 717.431 28.584C721.612 27.9013 726.135 27.56 730.999 27.56C735.778 27.56 739.746 28.2426 742.903 29.608C746.06 30.888 748.535 32.7653 750.327 35.24C752.204 37.6293 753.527 40.5306 754.295 43.944C755.063 47.272 755.447 50.984 755.447 55.08V89H739.703V57.128C739.703 51.496 739.063 47.4426 737.783 44.968C736.503 42.4933 733.9 41.256 729.975 41.256C728.78 41.256 727.586 41.2986 726.391 41.384C725.282 41.4693 724.087 41.5973 722.807 41.768V89H707.063V30.76Z" />
        <path class="letter" d="M806.519 78.888C806.519 82.6426 805.367 85.5013 803.063 87.464C800.759 89.4266 798.114 90.408 795.127 90.408C793.591 90.408 792.14 90.152 790.775 89.64C789.41 89.128 788.173 88.4026 787.063 87.464C786.039 86.44 785.186 85.2453 784.503 83.88C783.906 82.4293 783.607 80.7653 783.607 78.888C783.607 77.096 783.906 75.5173 784.503 74.152C785.186 72.7013 786.039 71.5066 787.063 70.568C788.173 69.6293 789.41 68.904 790.775 68.392C792.14 67.88 793.591 67.624 795.127 67.624C798.114 67.624 800.759 68.6053 803.063 70.568C805.367 72.5306 806.519 75.304 806.519 78.888ZM806.519 40.104C806.519 43.8586 805.367 46.7173 803.063 48.68C800.759 50.6426 798.114 51.624 795.127 51.624C793.591 51.624 792.14 51.368 790.775 50.856C789.41 50.344 788.173 49.6186 787.063 48.68C786.039 47.656 785.186 46.4613 784.503 45.096C783.906 43.6453 783.607 41.9813 783.607 40.104C783.607 38.312 783.906 36.7333 784.503 35.368C785.186 33.9173 786.039 32.7226 787.063 31.784C788.173 30.8453 789.41 30.12 790.775 29.608C792.14 29.096 793.591 28.84 795.127 28.84C798.114 28.84 800.759 29.8213 803.063 31.784C805.367 33.7466 806.519 36.52 806.519 40.104Z" />
        <path class="letter" d="M53.7511 255.272L4.59914 276.008L0.119141 262.184L36.0871 248.232L0.119141 234.28L4.59914 220.456L53.7511 241.064V255.272Z" />
        <path class="letter" d="M141.303 233.896H127.607V220.84H141.303V205.736L157.047 203.176V220.84H182.263V233.896H157.047V258.216C157.047 260.435 157.26 262.227 157.687 263.592C158.114 264.957 158.711 266.024 159.479 266.792C160.247 267.56 161.186 268.072 162.295 268.328C163.404 268.584 164.642 268.712 166.007 268.712C167.458 268.712 168.78 268.669 169.975 268.584C171.255 268.499 172.45 268.371 173.559 268.2C174.754 267.944 175.948 267.603 177.143 267.176C178.423 266.749 179.788 266.195 181.239 265.512L183.415 279.08C180.514 280.275 177.356 281.128 173.943 281.64C170.615 282.152 167.372 282.408 164.215 282.408C160.546 282.408 157.303 282.109 154.487 281.512C151.671 280.915 149.282 279.763 147.319 278.056C145.356 276.349 143.863 273.96 142.839 270.888C141.815 267.731 141.303 263.635 141.303 258.6V233.896Z" />
        <path class="letter" d="M195.063 281V194.856L210.807 192.168V221.352C212.087 220.925 213.623 220.541 215.415 220.2C217.207 219.773 218.786 219.56 220.151 219.56C224.588 219.56 228.3 220.243 231.287 221.608C234.274 222.888 236.663 224.765 238.455 227.24C240.247 229.629 241.527 232.531 242.295 235.944C243.063 239.272 243.447 242.984 243.447 247.08V281H227.703V249.128C227.703 243.496 227.063 239.443 225.783 236.968C224.503 234.493 222.071 233.256 218.487 233.256C217.036 233.256 215.586 233.427 214.135 233.768C212.77 234.109 211.66 234.408 210.807 234.664V281H195.063Z" />
        <path class="letter" d="M254.967 251.432C254.967 246.141 255.778 241.491 257.399 237.48C259.02 233.469 261.154 230.141 263.799 227.496C266.444 224.765 269.474 222.717 272.887 221.352C276.3 219.987 279.799 219.304 283.383 219.304C292.258 219.304 298.999 221.949 303.607 227.24C308.215 232.445 310.519 240.083 310.519 250.152C310.519 251.176 310.476 252.243 310.391 253.352C310.391 254.461 310.348 255.357 310.263 256.04H271.223C271.223 259.965 272.844 263.08 276.087 265.384C279.33 267.603 283.511 268.712 288.631 268.712C291.788 268.712 294.775 268.371 297.591 267.688C300.492 267.005 302.924 266.323 304.887 265.64L307.063 279.08C304.332 280.019 301.431 280.787 298.359 281.384C295.287 282.067 291.831 282.408 287.991 282.408C282.871 282.408 278.263 281.768 274.167 280.488C270.156 279.123 266.7 277.16 263.799 274.6C260.983 271.955 258.807 268.712 257.271 264.872C255.735 261.032 254.967 256.552 254.967 251.432ZM295.287 245.16C295.287 243.539 295.074 242.003 294.647 240.552C294.22 239.016 293.538 237.651 292.599 236.456C291.66 235.261 290.466 234.323 289.015 233.64C287.564 232.872 285.772 232.488 283.639 232.488C281.591 232.488 279.799 232.829 278.263 233.512C276.812 234.195 275.575 235.133 274.551 236.328C273.612 237.523 272.844 238.888 272.247 240.424C271.735 241.96 271.394 243.539 271.223 245.16H295.287Z" />
        <path class="letter" d="M411.127 269.736C412.834 269.736 414.498 269.736 416.119 269.736C417.74 269.651 419.148 269.523 420.343 269.352V255.528C419.319 255.357 418.082 255.229 416.631 255.144C415.18 254.973 413.858 254.888 412.663 254.888C411.042 254.888 409.463 255.016 407.927 255.272C406.391 255.443 405.026 255.784 403.831 256.296C402.722 256.808 401.826 257.533 401.143 258.472C400.46 259.411 400.119 260.648 400.119 262.184C400.119 264.915 401.143 266.877 403.191 268.072C405.239 269.181 407.884 269.736 411.127 269.736ZM409.719 219.304C414.668 219.304 418.764 219.901 422.007 221.096C425.335 222.205 427.98 223.827 429.943 225.96C431.906 228.008 433.314 230.568 434.167 233.64C435.02 236.627 435.447 239.997 435.447 243.752V279.592C433.143 280.104 429.73 280.701 425.207 281.384C420.684 282.067 415.607 282.408 409.975 282.408C406.135 282.408 402.636 282.067 399.479 281.384C396.407 280.701 393.762 279.592 391.543 278.056C389.324 276.435 387.618 274.387 386.423 271.912C385.228 269.352 384.631 266.237 384.631 262.568C384.631 259.069 385.314 256.125 386.679 253.736C388.044 251.347 389.879 249.427 392.183 247.976C394.487 246.525 397.132 245.501 400.119 244.904C403.106 244.221 406.22 243.88 409.463 243.88C413.559 243.88 417.186 244.221 420.343 244.904V242.984C420.343 239.997 419.404 237.523 417.527 235.56C415.65 233.512 412.407 232.488 407.799 232.488C404.812 232.488 401.911 232.701 399.095 233.128C396.364 233.555 394.146 234.067 392.439 234.664L390.263 221.992C392.226 221.309 394.999 220.712 398.583 220.2C402.167 219.603 405.879 219.304 409.719 219.304Z" />
        <path class="letter" d="M451.063 222.76C453.879 221.992 457.335 221.267 461.431 220.584C465.612 219.901 470.135 219.56 474.999 219.56C479.778 219.56 483.746 220.243 486.903 221.608C490.06 222.888 492.535 224.765 494.327 227.24C496.204 229.629 497.527 232.531 498.295 235.944C499.063 239.272 499.447 242.984 499.447 247.08V281H483.703V249.128C483.703 243.496 483.063 239.443 481.783 236.968C480.503 234.493 477.9 233.256 473.975 233.256C472.78 233.256 471.586 233.299 470.391 233.384C469.282 233.469 468.087 233.597 466.807 233.768V281H451.063V222.76Z" />
        <path class="letter" d="M539.127 269.736C540.834 269.736 542.498 269.736 544.119 269.736C545.74 269.651 547.148 269.523 548.343 269.352V255.528C547.319 255.357 546.082 255.229 544.631 255.144C543.18 254.973 541.858 254.888 540.663 254.888C539.042 254.888 537.463 255.016 535.927 255.272C534.391 255.443 533.026 255.784 531.831 256.296C530.722 256.808 529.826 257.533 529.143 258.472C528.46 259.411 528.119 260.648 528.119 262.184C528.119 264.915 529.143 266.877 531.191 268.072C533.239 269.181 535.884 269.736 539.127 269.736ZM537.719 219.304C542.668 219.304 546.764 219.901 550.007 221.096C553.335 222.205 555.98 223.827 557.943 225.96C559.906 228.008 561.314 230.568 562.167 233.64C563.02 236.627 563.447 239.997 563.447 243.752V279.592C561.143 280.104 557.73 280.701 553.207 281.384C548.684 282.067 543.607 282.408 537.975 282.408C534.135 282.408 530.636 282.067 527.479 281.384C524.407 280.701 521.762 279.592 519.543 278.056C517.324 276.435 515.618 274.387 514.423 271.912C513.228 269.352 512.631 266.237 512.631 262.568C512.631 259.069 513.314 256.125 514.679 253.736C516.044 251.347 517.879 249.427 520.183 247.976C522.487 246.525 525.132 245.501 528.119 244.904C531.106 244.221 534.22 243.88 537.463 243.88C541.559 243.88 545.186 244.221 548.343 244.904V242.984C548.343 239.997 547.404 237.523 545.527 235.56C543.65 233.512 540.407 232.488 535.799 232.488C532.812 232.488 529.911 232.701 527.095 233.128C524.364 233.555 522.146 234.067 520.439 234.664L518.263 221.992C520.226 221.309 522.999 220.712 526.583 220.2C530.167 219.603 533.879 219.304 537.719 219.304Z" />
        <path class="letter" d="M630.775 278.44C630.519 278.611 629.922 278.909 628.983 279.336C628.13 279.763 626.978 280.232 625.527 280.744C624.076 281.171 622.284 281.555 620.151 281.896C618.103 282.237 615.756 282.408 613.111 282.408C605.858 282.408 600.567 280.275 597.239 276.008C593.911 271.656 592.247 265.341 592.247 257.064V205.992H575.607V192.936H607.991V258.216C607.991 262.312 608.802 265.085 610.423 266.536C612.044 267.987 614.092 268.712 616.567 268.712C619.724 268.712 622.37 268.285 624.503 267.432C626.636 266.579 628.045 266.024 628.727 265.768L630.775 278.44Z" />
        <path class="letter" d="M695.415 250.792C695.415 255.571 694.732 259.923 693.367 263.848C692.002 267.688 690.082 271.016 687.607 273.832C685.132 276.648 682.146 278.824 678.647 280.36C675.234 281.896 671.394 282.664 667.127 282.664C662.86 282.664 658.978 281.896 655.479 280.36C652.066 278.824 649.079 276.648 646.519 273.832C644.044 271.016 642.124 267.688 640.759 263.848C639.394 259.923 638.711 255.571 638.711 250.792C638.711 246.099 639.394 241.832 640.759 237.992C642.21 234.067 644.172 230.739 646.647 228.008C649.207 225.192 652.237 223.059 655.735 221.608C659.234 220.072 663.031 219.304 667.127 219.304C671.308 219.304 675.106 220.072 678.519 221.608C682.018 223.059 685.004 225.192 687.479 228.008C690.039 230.739 692.002 234.067 693.367 237.992C694.732 241.832 695.415 246.099 695.415 250.792ZM654.711 250.92C654.711 256.296 655.65 260.648 657.527 263.976C659.49 267.304 662.604 268.968 666.871 268.968C670.967 268.968 674.039 267.304 676.087 263.976C678.22 260.648 679.287 256.296 679.287 250.92C679.287 245.544 678.306 241.235 676.343 237.992C674.466 234.664 671.394 233 667.127 233C663.031 233 659.916 234.664 657.783 237.992C655.735 241.235 654.711 245.544 654.711 250.92Z" />
        <path class="letter" d="M719.223 249C719.223 253.949 720.119 257.747 721.911 260.392C723.703 262.952 726.519 264.232 730.359 264.232C732.066 264.232 733.644 264.019 735.095 263.592C736.631 263.165 737.996 262.611 739.191 261.928V233C737.996 232.744 736.93 232.573 735.991 232.488C735.052 232.403 734.071 232.36 733.047 232.36C723.831 232.36 719.223 237.907 719.223 249ZM755.063 273.704C755.063 283.517 752.674 290.771 747.895 295.464C743.202 300.157 735.607 302.504 725.111 302.504C721.356 302.504 717.73 302.12 714.231 301.352C710.818 300.584 707.532 299.688 704.375 298.664L707.319 285.352C709.794 286.291 712.396 287.144 715.127 287.912C717.858 288.765 721.271 289.192 725.367 289.192C728.098 289.192 730.359 288.851 732.151 288.168C733.943 287.571 735.351 286.717 736.375 285.608C737.399 284.499 738.124 283.176 738.551 281.64C738.978 280.189 739.191 278.611 739.191 276.904V274.472C736.972 275.325 734.924 275.965 733.047 276.392C731.255 276.819 729.292 277.032 727.159 277.032C719.308 277.032 713.335 274.557 709.239 269.608C705.228 264.659 703.223 257.789 703.223 249C703.223 239.101 705.954 231.72 711.415 226.856C716.876 221.992 724.3 219.56 733.687 219.56C740.258 219.56 747.383 220.627 755.063 222.76V273.704Z" />
        <path class="letter" d="M819.063 278.952C816.162 279.72 812.62 280.488 808.439 281.256C804.343 282.024 799.863 282.408 794.999 282.408C790.05 282.408 785.996 281.725 782.839 280.36C779.682 278.995 777.165 277.075 775.287 274.6C773.495 272.04 772.258 269.053 771.575 265.64C770.892 262.227 770.551 258.472 770.551 254.376V220.84H786.295V252.328C786.295 257.875 786.935 262.013 788.215 264.744C789.58 267.389 792.183 268.712 796.023 268.712C798.412 268.712 800.802 268.499 803.191 268.072V220.84H819.063V278.952Z" />
        <path class="letter" d="M830.967 251.432C830.967 246.141 831.778 241.491 833.399 237.48C835.021 233.469 837.154 230.141 839.799 227.496C842.444 224.765 845.474 222.717 848.887 221.352C852.3 219.987 855.799 219.304 859.383 219.304C868.258 219.304 874.999 221.949 879.607 227.24C884.215 232.445 886.519 240.083 886.519 250.152C886.519 251.176 886.476 252.243 886.391 253.352C886.391 254.461 886.348 255.357 886.263 256.04H847.223C847.223 259.965 848.844 263.08 852.087 265.384C855.33 267.603 859.511 268.712 864.631 268.712C867.789 268.712 870.775 268.371 873.591 267.688C876.492 267.005 878.924 266.323 880.887 265.64L883.063 279.08C880.333 280.019 877.431 280.787 874.359 281.384C871.287 282.067 867.831 282.408 863.991 282.408C858.871 282.408 854.263 281.768 850.167 280.488C846.156 279.123 842.7 277.16 839.799 274.6C836.983 271.955 834.807 268.712 833.271 264.872C831.735 261.032 830.967 256.552 830.967 251.432ZM871.287 245.16C871.287 243.539 871.074 242.003 870.647 240.552C870.22 239.016 869.538 237.651 868.599 236.456C867.66 235.261 866.466 234.323 865.015 233.64C863.564 232.872 861.772 232.488 859.639 232.488C857.591 232.488 855.799 232.829 854.263 233.512C852.812 234.195 851.575 235.133 850.551 236.328C849.612 237.523 848.844 238.888 848.247 240.424C847.735 241.96 847.394 243.539 847.223 245.16H871.287Z" />
        <path class="letter" d="M960.631 250.92C960.631 246.568 961.314 242.472 962.679 238.632C964.044 234.792 966.135 231.464 968.951 228.648C971.767 225.747 975.308 223.485 979.575 221.864C983.927 220.157 989.09 219.304 995.063 219.304C998.647 219.304 1001.89 219.56 1004.79 220.072C1007.69 220.584 1010.64 221.437 1013.62 222.632L1010.17 235.304C1008.46 234.707 1006.54 234.195 1004.41 233.768C1002.36 233.256 999.714 233 996.471 233C992.716 233 989.559 233.469 986.999 234.408C984.524 235.261 982.519 236.499 980.983 238.12C979.447 239.656 978.338 241.533 977.655 243.752C976.972 245.971 976.631 248.36 976.631 250.92C976.631 256.467 978.167 260.819 981.239 263.976C984.396 267.133 989.73 268.712 997.239 268.712C999.714 268.712 1002.27 268.541 1004.92 268.2C1007.65 267.859 1010.12 267.304 1012.34 266.536L1014.65 279.464C1012.43 280.317 1009.74 281 1006.58 281.512C1003.43 282.109 999.714 282.408 995.447 282.408C989.303 282.408 984.012 281.597 979.575 279.976C975.223 278.355 971.639 276.136 968.823 273.32C966.007 270.504 963.916 267.176 962.551 263.336C961.271 259.496 960.631 255.357 960.631 250.92Z" />
        <path class="letter" d="M1051.13 269.736C1052.83 269.736 1054.5 269.736 1056.12 269.736C1057.74 269.651 1059.15 269.523 1060.34 269.352V255.528C1059.32 255.357 1058.08 255.229 1056.63 255.144C1055.18 254.973 1053.86 254.888 1052.66 254.888C1051.04 254.888 1049.46 255.016 1047.93 255.272C1046.39 255.443 1045.03 255.784 1043.83 256.296C1042.72 256.808 1041.83 257.533 1041.14 258.472C1040.46 259.411 1040.12 260.648 1040.12 262.184C1040.12 264.915 1041.14 266.877 1043.19 268.072C1045.24 269.181 1047.88 269.736 1051.13 269.736ZM1049.72 219.304C1054.67 219.304 1058.76 219.901 1062.01 221.096C1065.34 222.205 1067.98 223.827 1069.94 225.96C1071.91 228.008 1073.31 230.568 1074.17 233.64C1075.02 236.627 1075.45 239.997 1075.45 243.752V279.592C1073.14 280.104 1069.73 280.701 1065.21 281.384C1060.68 282.067 1055.61 282.408 1049.98 282.408C1046.14 282.408 1042.64 282.067 1039.48 281.384C1036.41 280.701 1033.76 279.592 1031.54 278.056C1029.32 276.435 1027.62 274.387 1026.42 271.912C1025.23 269.352 1024.63 266.237 1024.63 262.568C1024.63 259.069 1025.31 256.125 1026.68 253.736C1028.04 251.347 1029.88 249.427 1032.18 247.976C1034.49 246.525 1037.13 245.501 1040.12 244.904C1043.11 244.221 1046.22 243.88 1049.46 243.88C1053.56 243.88 1057.19 244.221 1060.34 244.904V242.984C1060.34 239.997 1059.4 237.523 1057.53 235.56C1055.65 233.512 1052.41 232.488 1047.8 232.488C1044.81 232.488 1041.91 232.701 1039.1 233.128C1036.36 233.555 1034.15 234.067 1032.44 234.664L1030.26 221.992C1032.23 221.309 1035 220.712 1038.58 220.2C1042.17 219.603 1045.88 219.304 1049.72 219.304Z" />
        <path class="letter" d="M1101.3 233.896H1087.61V220.84H1101.3V205.736L1117.05 203.176V220.84H1142.26V233.896H1117.05V258.216C1117.05 260.435 1117.26 262.227 1117.69 263.592C1118.11 264.957 1118.71 266.024 1119.48 266.792C1120.25 267.56 1121.19 268.072 1122.3 268.328C1123.4 268.584 1124.64 268.712 1126.01 268.712C1127.46 268.712 1128.78 268.669 1129.98 268.584C1131.26 268.499 1132.45 268.371 1133.56 268.2C1134.75 267.944 1135.95 267.603 1137.14 267.176C1138.42 266.749 1139.79 266.195 1141.24 265.512L1143.42 279.08C1140.51 280.275 1137.36 281.128 1133.94 281.64C1130.62 282.152 1127.37 282.408 1124.22 282.408C1120.55 282.408 1117.3 282.109 1114.49 281.512C1111.67 280.915 1109.28 279.763 1107.32 278.056C1105.36 276.349 1103.86 273.96 1102.84 270.888C1101.82 267.731 1101.3 263.635 1101.3 258.6V233.896Z" />
        <path class="letter" d="M1179.13 269.736C1180.83 269.736 1182.5 269.736 1184.12 269.736C1185.74 269.651 1187.15 269.523 1188.34 269.352V255.528C1187.32 255.357 1186.08 255.229 1184.63 255.144C1183.18 254.973 1181.86 254.888 1180.66 254.888C1179.04 254.888 1177.46 255.016 1175.93 255.272C1174.39 255.443 1173.03 255.784 1171.83 256.296C1170.72 256.808 1169.83 257.533 1169.14 258.472C1168.46 259.411 1168.12 260.648 1168.12 262.184C1168.12 264.915 1169.14 266.877 1171.19 268.072C1173.24 269.181 1175.88 269.736 1179.13 269.736ZM1177.72 219.304C1182.67 219.304 1186.76 219.901 1190.01 221.096C1193.34 222.205 1195.98 223.827 1197.94 225.96C1199.91 228.008 1201.31 230.568 1202.17 233.64C1203.02 236.627 1203.45 239.997 1203.45 243.752V279.592C1201.14 280.104 1197.73 280.701 1193.21 281.384C1188.68 282.067 1183.61 282.408 1177.98 282.408C1174.14 282.408 1170.64 282.067 1167.48 281.384C1164.41 280.701 1161.76 279.592 1159.54 278.056C1157.32 276.435 1155.62 274.387 1154.42 271.912C1153.23 269.352 1152.63 266.237 1152.63 262.568C1152.63 259.069 1153.31 256.125 1154.68 253.736C1156.04 251.347 1157.88 249.427 1160.18 247.976C1162.49 246.525 1165.13 245.501 1168.12 244.904C1171.11 244.221 1174.22 243.88 1177.46 243.88C1181.56 243.88 1185.19 244.221 1188.34 244.904V242.984C1188.34 239.997 1187.4 237.523 1185.53 235.56C1183.65 233.512 1180.41 232.488 1175.8 232.488C1172.81 232.488 1169.91 232.701 1167.1 233.128C1164.36 233.555 1162.15 234.067 1160.44 234.664L1158.26 221.992C1160.23 221.309 1163 220.712 1166.58 220.2C1170.17 219.603 1173.88 219.304 1177.72 219.304Z" />
        <path class="letter" d="M1270.78 278.44C1270.52 278.611 1269.92 278.909 1268.98 279.336C1268.13 279.763 1266.98 280.232 1265.53 280.744C1264.08 281.171 1262.28 281.555 1260.15 281.896C1258.1 282.237 1255.76 282.408 1253.11 282.408C1245.86 282.408 1240.57 280.275 1237.24 276.008C1233.91 271.656 1232.25 265.341 1232.25 257.064V205.992H1215.61V192.936H1247.99V258.216C1247.99 262.312 1248.8 265.085 1250.42 266.536C1252.04 267.987 1254.09 268.712 1256.57 268.712C1259.72 268.712 1262.37 268.285 1264.5 267.432C1266.64 266.579 1268.04 266.024 1268.73 265.768L1270.78 278.44Z" />
        <path class="letter" d="M1335.42 250.792C1335.42 255.571 1334.73 259.923 1333.37 263.848C1332 267.688 1330.08 271.016 1327.61 273.832C1325.13 276.648 1322.15 278.824 1318.65 280.36C1315.23 281.896 1311.39 282.664 1307.13 282.664C1302.86 282.664 1298.98 281.896 1295.48 280.36C1292.07 278.824 1289.08 276.648 1286.52 273.832C1284.04 271.016 1282.12 267.688 1280.76 263.848C1279.39 259.923 1278.71 255.571 1278.71 250.792C1278.71 246.099 1279.39 241.832 1280.76 237.992C1282.21 234.067 1284.17 230.739 1286.65 228.008C1289.21 225.192 1292.24 223.059 1295.74 221.608C1299.23 220.072 1303.03 219.304 1307.13 219.304C1311.31 219.304 1315.11 220.072 1318.52 221.608C1322.02 223.059 1325 225.192 1327.48 228.008C1330.04 230.739 1332 234.067 1333.37 237.992C1334.73 241.832 1335.42 246.099 1335.42 250.792ZM1294.71 250.92C1294.71 256.296 1295.65 260.648 1297.53 263.976C1299.49 267.304 1302.6 268.968 1306.87 268.968C1310.97 268.968 1314.04 267.304 1316.09 263.976C1318.22 260.648 1319.29 256.296 1319.29 250.92C1319.29 245.544 1318.31 241.235 1316.34 237.992C1314.47 234.664 1311.39 233 1307.13 233C1303.03 233 1299.92 234.664 1297.78 237.992C1295.74 241.235 1294.71 245.544 1294.71 250.92Z" />
        <path class="letter" d="M1359.22 249C1359.22 253.949 1360.12 257.747 1361.91 260.392C1363.7 262.952 1366.52 264.232 1370.36 264.232C1372.07 264.232 1373.64 264.019 1375.1 263.592C1376.63 263.165 1378 262.611 1379.19 261.928V233C1378 232.744 1376.93 232.573 1375.99 232.488C1375.05 232.403 1374.07 232.36 1373.05 232.36C1363.83 232.36 1359.22 237.907 1359.22 249ZM1395.06 273.704C1395.06 283.517 1392.67 290.771 1387.9 295.464C1383.2 300.157 1375.61 302.504 1365.11 302.504C1361.36 302.504 1357.73 302.12 1354.23 301.352C1350.82 300.584 1347.53 299.688 1344.38 298.664L1347.32 285.352C1349.79 286.291 1352.4 287.144 1355.13 287.912C1357.86 288.765 1361.27 289.192 1365.37 289.192C1368.1 289.192 1370.36 288.851 1372.15 288.168C1373.94 287.571 1375.35 286.717 1376.38 285.608C1377.4 284.499 1378.12 283.176 1378.55 281.64C1378.98 280.189 1379.19 278.611 1379.19 276.904V274.472C1376.97 275.325 1374.92 275.965 1373.05 276.392C1371.26 276.819 1369.29 277.032 1367.16 277.032C1359.31 277.032 1353.34 274.557 1349.24 269.608C1345.23 264.659 1343.22 257.789 1343.22 249C1343.22 239.101 1345.95 231.72 1351.42 226.856C1356.88 221.992 1364.3 219.56 1373.69 219.56C1380.26 219.56 1387.38 220.627 1395.06 222.76V273.704Z" />
        <path class="letter" d="M1459.06 278.952C1456.16 279.72 1452.62 280.488 1448.44 281.256C1444.34 282.024 1439.86 282.408 1435 282.408C1430.05 282.408 1426 281.725 1422.84 280.36C1419.68 278.995 1417.16 277.075 1415.29 274.6C1413.5 272.04 1412.26 269.053 1411.58 265.64C1410.89 262.227 1410.55 258.472 1410.55 254.376V220.84H1426.3V252.328C1426.3 257.875 1426.94 262.013 1428.22 264.744C1429.58 267.389 1432.18 268.712 1436.02 268.712C1438.41 268.712 1440.8 268.499 1443.19 268.072V220.84H1459.06V278.952Z" />
        <path class="letter" d="M1470.97 251.432C1470.97 246.141 1471.78 241.491 1473.4 237.48C1475.02 233.469 1477.15 230.141 1479.8 227.496C1482.44 224.765 1485.47 222.717 1488.89 221.352C1492.3 219.987 1495.8 219.304 1499.38 219.304C1508.26 219.304 1515 221.949 1519.61 227.24C1524.22 232.445 1526.52 240.083 1526.52 250.152C1526.52 251.176 1526.48 252.243 1526.39 253.352C1526.39 254.461 1526.35 255.357 1526.26 256.04H1487.22C1487.22 259.965 1488.84 263.08 1492.09 265.384C1495.33 267.603 1499.51 268.712 1504.63 268.712C1507.79 268.712 1510.78 268.371 1513.59 267.688C1516.49 267.005 1518.92 266.323 1520.89 265.64L1523.06 279.08C1520.33 280.019 1517.43 280.787 1514.36 281.384C1511.29 282.067 1507.83 282.408 1503.99 282.408C1498.87 282.408 1494.26 281.768 1490.17 280.488C1486.16 279.123 1482.7 277.16 1479.8 274.6C1476.98 271.955 1474.81 268.712 1473.27 264.872C1471.74 261.032 1470.97 256.552 1470.97 251.432ZM1511.29 245.16C1511.29 243.539 1511.07 242.003 1510.65 240.552C1510.22 239.016 1509.54 237.651 1508.6 236.456C1507.66 235.261 1506.47 234.323 1505.02 233.64C1503.56 232.872 1501.77 232.488 1499.64 232.488C1497.59 232.488 1495.8 232.829 1494.26 233.512C1492.81 234.195 1491.58 235.133 1490.55 236.328C1489.61 237.523 1488.84 238.888 1488.25 240.424C1487.74 241.96 1487.39 243.539 1487.22 245.16H1511.29Z" />
        <path class="cursor" d="M1559 192H1611V283H1559V192Z" />
    </svg>
    <button disabled>loading...</button>
</div>
`;class n2 extends HTMLElement{constructor(){super();Ce(this,"btn");Ce(this,"handleOnStart",()=>{const t=new Event("onstart");this.dispatchEvent(t),this.destroy()});this.innerHTML=t2,this.btn=this.querySelector("button"),this.btn.addEventListener("click",this.handleOnStart)}connectedCallback(){}disconnectedCallback(){this.btn.removeEventListener("click",this.handleOnStart)}attributeChangedCallback(t){t==="ready"&&(this.btn.removeAttribute("disabled"),this.btn.innerHTML="&#60;start&#62;")}static get observedAttributes(){return["ready"]}destroy(){document.body.removeChild(this)}}const i2=`
    <div>
        <a href="/minimal.html">&#62;</a>
    </div>
`;class r2 extends HTMLElement{constructor(){super(),this.innerHTML=i2,window.addEventListener("onroutechange",()=>{const e=window.location.pathname;this.style.display=e==="/"?"block":"none"})}}customElements.define("contact-form",e2);customElements.define("loading-screen",n2);customElements.define("boring-button",r2);/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const wc="141",s2={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},o2={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Fm=0,su=1,Om=2,a2=3,l2=0,rf=1,Um=2,Ws=3,Pi=0,tn=1,ui=2,km=1,c2=2,Ei=0,Kr=1,ou=2,au=3,lu=4,Nm=5,Hr=100,Bm=101,zm=102,cu=103,hu=104,Gm=200,Vm=201,Hm=202,Wm=203,sf=204,of=205,Xm=206,qm=207,Ym=208,Zm=209,jm=210,Jm=0,Km=1,Qm=2,hc=3,$m=4,e0=5,t0=6,n0=7,Va=0,i0=1,r0=2,li=0,s0=1,o0=2,a0=3,l0=4,c0=5,Mc=300,hr=301,ur=302,ya=303,ba=304,Lo=306,fr=1e3,Yt=1001,ro=1002,Tt=1003,wa=1004,h2=1004,Ma=1005,u2=1005,dt=1006,Sc=1007,f2=1007,Ui=1008,d2=1008,dr=1009,h0=1010,u0=1011,af=1012,f0=1013,tr=1014,Ai=1015,so=1016,d0=1017,p0=1018,Qr=1020,m0=1021,g0=1022,vn=1023,_0=1024,x0=1025,ar=1026,as=1027,v0=1028,y0=1029,b0=1030,w0=1031,M0=1033,ec=33776,tc=33777,nc=33778,ic=33779,uu=35840,fu=35841,du=35842,pu=35843,S0=36196,mu=37492,gu=37496,_u=37808,xu=37809,vu=37810,yu=37811,bu=37812,wu=37813,Mu=37814,Su=37815,Tu=37816,Cu=37817,Au=37818,Eu=37819,Lu=37820,Ru=37821,Pu=36492,T0=2200,C0=2201,A0=2202,oo=2300,ls=2301,rc=2302,qr=2400,Yr=2401,Sa=2402,Tc=2500,lf=2501,p2=0,E0=1,cf=2,pr=3e3,nt=3001,L0=3200,hf=3201,wr=0,R0=1,m2="",oi="srgb",nr="srgb-linear",g2=0,sc=7680,_2=7681,x2=7682,v2=7683,y2=34055,b2=34056,w2=5386,M2=512,S2=513,T2=514,C2=515,A2=516,E2=517,L2=518,P0=519,uc=35044,R2=35048,P2=35040,D2=35045,I2=35049,F2=35041,O2=35046,U2=35050,k2=35042,N2="100",Du="300 es",fc=1035;class Mr{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const n=this._listeners[e];if(n!==void 0){const r=n.indexOf(t);r!==-1&&n.splice(r,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const n=i.slice(0);for(let r=0,s=n.length;r<s;r++)n[r].call(this,e);e.target=null}}}const zt=[];for(let l=0;l<256;l++)zt[l]=(l<16?"0":"")+l.toString(16);let bd=1234567;const $r=Math.PI/180,Ta=180/Math.PI;function wn(){const l=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(zt[l&255]+zt[l>>8&255]+zt[l>>16&255]+zt[l>>24&255]+"-"+zt[e&255]+zt[e>>8&255]+"-"+zt[e>>16&15|64]+zt[e>>24&255]+"-"+zt[t&63|128]+zt[t>>8&255]+"-"+zt[t>>16&255]+zt[t>>24&255]+zt[i&255]+zt[i>>8&255]+zt[i>>16&255]+zt[i>>24&255]).toLowerCase()}function Ct(l,e,t){return Math.max(e,Math.min(t,l))}function uf(l,e){return(l%e+e)%e}function B2(l,e,t,i,n){return i+(l-e)*(n-i)/(t-e)}function z2(l,e,t){return l!==e?(t-l)/(e-l):0}function ha(l,e,t){return(1-t)*l+t*e}function G2(l,e,t,i){return ha(l,e,1-Math.exp(-t*i))}function V2(l,e=1){return e-Math.abs(uf(l,e*2)-e)}function H2(l,e,t){return l<=e?0:l>=t?1:(l=(l-e)/(t-e),l*l*(3-2*l))}function W2(l,e,t){return l<=e?0:l>=t?1:(l=(l-e)/(t-e),l*l*l*(l*(l*6-15)+10))}function X2(l,e){return l+Math.floor(Math.random()*(e-l+1))}function q2(l,e){return l+Math.random()*(e-l)}function Y2(l){return l*(.5-Math.random())}function Z2(l){l!==void 0&&(bd=l);let e=bd+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function j2(l){return l*$r}function J2(l){return l*Ta}function Iu(l){return(l&l-1)===0&&l!==0}function D0(l){return Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))}function dc(l){return Math.pow(2,Math.floor(Math.log(l)/Math.LN2))}function K2(l,e,t,i,n){const r=Math.cos,s=Math.sin,o=r(t/2),a=s(t/2),c=r((e+i)/2),h=s((e+i)/2),u=r((e-i)/2),f=s((e-i)/2),d=r((i-e)/2),g=s((i-e)/2);switch(n){case"XYX":l.set(o*h,a*u,a*f,o*c);break;case"YZY":l.set(a*f,o*h,a*u,o*c);break;case"ZXZ":l.set(a*u,a*f,o*h,o*c);break;case"XZX":l.set(o*h,a*g,a*d,o*c);break;case"YXY":l.set(a*d,o*h,a*g,o*c);break;case"ZYZ":l.set(a*g,a*d,o*h,o*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function Q2(l,e){switch(e.constructor){case Float32Array:return l;case Uint16Array:return l/65535;case Uint8Array:return l/255;case Int16Array:return Math.max(l/32767,-1);case Int8Array:return Math.max(l/127,-1);default:throw new Error("Invalid component type.")}}function $2(l,e){switch(e.constructor){case Float32Array:return l;case Uint16Array:return Math.round(l*65535);case Uint8Array:return Math.round(l*255);case Int16Array:return Math.round(l*32767);case Int8Array:return Math.round(l*127);default:throw new Error("Invalid component type.")}}var ua=Object.freeze({__proto__:null,DEG2RAD:$r,RAD2DEG:Ta,generateUUID:wn,clamp:Ct,euclideanModulo:uf,mapLinear:B2,inverseLerp:z2,lerp:ha,damp:G2,pingpong:V2,smoothstep:H2,smootherstep:W2,randInt:X2,randFloat:q2,randFloatSpread:Y2,seededRandom:Z2,degToRad:j2,radToDeg:J2,isPowerOfTwo:Iu,ceilPowerOfTwo:D0,floorPowerOfTwo:dc,setQuaternionFromProperEuler:K2,normalize:$2,denormalize:Q2});class pe{constructor(e=0,t=0){this.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,n=e.elements;return this.x=n[0]*t+n[3]*i+n[6],this.y=n[1]*t+n[4]*i+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,i){return i!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),n=Math.sin(t),r=this.x-e.x,s=this.y-e.y;return this.x=r*i-s*n+e.x,this.y=r*n+s*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class yn{constructor(){this.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,i,n,r,s,o,a,c){const h=this.elements;return h[0]=e,h[1]=n,h[2]=o,h[3]=t,h[4]=r,h[5]=a,h[6]=i,h[7]=s,h[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,n=t.elements,r=this.elements,s=i[0],o=i[3],a=i[6],c=i[1],h=i[4],u=i[7],f=i[2],d=i[5],g=i[8],p=n[0],m=n[3],_=n[6],x=n[1],b=n[4],y=n[7],v=n[2],M=n[5],S=n[8];return r[0]=s*p+o*x+a*v,r[3]=s*m+o*b+a*M,r[6]=s*_+o*y+a*S,r[1]=c*p+h*x+u*v,r[4]=c*m+h*b+u*M,r[7]=c*_+h*y+u*S,r[2]=f*p+d*x+g*v,r[5]=f*m+d*b+g*M,r[8]=f*_+d*y+g*S,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],s=e[4],o=e[5],a=e[6],c=e[7],h=e[8];return t*s*h-t*o*c-i*r*h+i*o*a+n*r*c-n*s*a}invert(){const e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],s=e[4],o=e[5],a=e[6],c=e[7],h=e[8],u=h*s-o*c,f=o*a-h*r,d=c*r-s*a,g=t*u+i*f+n*d;if(g===0)return this.set(0,0,0,0,0,0,0,0,0);const p=1/g;return e[0]=u*p,e[1]=(n*c-h*i)*p,e[2]=(o*i-n*s)*p,e[3]=f*p,e[4]=(h*t-n*a)*p,e[5]=(n*r-o*t)*p,e[6]=d*p,e[7]=(i*a-c*t)*p,e[8]=(s*t-i*r)*p,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,n,r,s,o){const a=Math.cos(r),c=Math.sin(r);return this.set(i*a,i*c,-i*(a*s+c*o)+s+e,-n*c,n*a,-n*(-c*s+a*o)+o+t,0,0,1),this}scale(e,t){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=t,i[4]*=t,i[7]*=t,this}rotate(e){const t=Math.cos(e),i=Math.sin(e),n=this.elements,r=n[0],s=n[3],o=n[6],a=n[1],c=n[4],h=n[7];return n[0]=t*r+i*a,n[3]=t*s+i*c,n[6]=t*o+i*h,n[1]=-i*r+t*a,n[4]=-i*s+t*c,n[7]=-i*o+t*h,this}translate(e,t){const i=this.elements;return i[0]+=e*i[2],i[3]+=e*i[5],i[6]+=e*i[8],i[1]+=t*i[2],i[4]+=t*i[5],i[7]+=t*i[8],this}equals(e){const t=this.elements,i=e.elements;for(let n=0;n<9;n++)if(t[n]!==i[n])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}function I0(l){for(let e=l.length-1;e>=0;--e)if(l[e]>65535)return!0;return!1}const e_={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Xs(l,e){return new e_[l](e)}function Ca(l){return document.createElementNS("http://www.w3.org/1999/xhtml",l)}function es(l){return l<.04045?l*.0773993808:Math.pow(l*.9478672986+.0521327014,2.4)}function oc(l){return l<.0031308?l*12.92:1.055*Math.pow(l,.41666)-.055}const oh={[oi]:{[nr]:es},[nr]:{[oi]:oc}},Ln={legacyMode:!0,get workingColorSpace(){return nr},set workingColorSpace(l){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(l,e,t){if(this.legacyMode||e===t||!e||!t)return l;if(oh[e]&&oh[e][t]!==void 0){const i=oh[e][t];return l.r=i(l.r),l.g=i(l.g),l.b=i(l.b),l}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(l,e){return this.convert(l,this.workingColorSpace,e)},toWorkingColorSpace:function(l,e){return this.convert(l,e,this.workingColorSpace)}},F0={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Pt={r:0,g:0,b:0},zn={h:0,s:0,l:0},al={h:0,s:0,l:0};function ah(l,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?l+(e-l)*6*t:t<1/2?e:t<2/3?l+(e-l)*6*(2/3-t):l}function ll(l,e){return e.r=l.r,e.g=l.g,e.b=l.b,e}class Ae{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&i===void 0?this.set(e):this.setRGB(e,t,i)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=oi){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ln.toWorkingColorSpace(this,t),this}setRGB(e,t,i,n=nr){return this.r=e,this.g=t,this.b=i,Ln.toWorkingColorSpace(this,n),this}setHSL(e,t,i,n=nr){if(e=uf(e,1),t=Ct(t,0,1),i=Ct(i,0,1),t===0)this.r=this.g=this.b=i;else{const r=i<=.5?i*(1+t):i+t-i*t,s=2*i-r;this.r=ah(s,r,e+1/3),this.g=ah(s,r,e),this.b=ah(s,r,e-1/3)}return Ln.toWorkingColorSpace(this,n),this}setStyle(e,t=oi){function i(r){r!==void 0&&parseFloat(r)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let r;const s=n[1],o=n[2];switch(s){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,Ln.toWorkingColorSpace(this,t),i(r[4]),this;if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,Ln.toWorkingColorSpace(this,t),i(r[4]),this;break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){const a=parseFloat(r[1])/360,c=parseInt(r[2],10)/100,h=parseInt(r[3],10)/100;return i(r[4]),this.setHSL(a,c,h,t)}break}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){const r=n[1],s=r.length;if(s===3)return this.r=parseInt(r.charAt(0)+r.charAt(0),16)/255,this.g=parseInt(r.charAt(1)+r.charAt(1),16)/255,this.b=parseInt(r.charAt(2)+r.charAt(2),16)/255,Ln.toWorkingColorSpace(this,t),this;if(s===6)return this.r=parseInt(r.charAt(0)+r.charAt(1),16)/255,this.g=parseInt(r.charAt(2)+r.charAt(3),16)/255,this.b=parseInt(r.charAt(4)+r.charAt(5),16)/255,Ln.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=oi){const i=F0[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=es(e.r),this.g=es(e.g),this.b=es(e.b),this}copyLinearToSRGB(e){return this.r=oc(e.r),this.g=oc(e.g),this.b=oc(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=oi){return Ln.fromWorkingColorSpace(ll(this,Pt),e),Ct(Pt.r*255,0,255)<<16^Ct(Pt.g*255,0,255)<<8^Ct(Pt.b*255,0,255)<<0}getHexString(e=oi){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=nr){Ln.fromWorkingColorSpace(ll(this,Pt),t);const i=Pt.r,n=Pt.g,r=Pt.b,s=Math.max(i,n,r),o=Math.min(i,n,r);let a,c;const h=(o+s)/2;if(o===s)a=0,c=0;else{const u=s-o;switch(c=h<=.5?u/(s+o):u/(2-s-o),s){case i:a=(n-r)/u+(n<r?6:0);break;case n:a=(r-i)/u+2;break;case r:a=(i-n)/u+4;break}a/=6}return e.h=a,e.s=c,e.l=h,e}getRGB(e,t=nr){return Ln.fromWorkingColorSpace(ll(this,Pt),t),e.r=Pt.r,e.g=Pt.g,e.b=Pt.b,e}getStyle(e=oi){return Ln.fromWorkingColorSpace(ll(this,Pt),e),e!==oi?`color(${e} ${Pt.r} ${Pt.g} ${Pt.b})`:`rgb(${Pt.r*255|0},${Pt.g*255|0},${Pt.b*255|0})`}offsetHSL(e,t,i){return this.getHSL(zn),zn.h+=e,zn.s+=t,zn.l+=i,this.setHSL(zn.h,zn.s,zn.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(zn),e.getHSL(al);const i=ha(zn.h,al.h,t),n=ha(zn.s,al.s,t),r=ha(zn.l,al.l,t);return this.setHSL(i,n,r),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),e.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}Ae.NAMES=F0;let ws;class ff{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement=="undefined")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{ws===void 0&&(ws=Ca("canvas")),ws.width=e.width,ws.height=e.height;const i=ws.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=ws}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement!="undefined"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&e instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap){const t=Ca("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const n=i.getImageData(0,0,e.width,e.height),r=n.data;for(let s=0;s<r.length;s++)r[s]=es(r[s]/255)*255;return i.putImageData(n,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(es(t[i]/255)*255):t[i]=es(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Zr{constructor(e=null){this.isSource=!0,this.uuid=wn(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},n=this.data;if(n!==null){let r;if(Array.isArray(n)){r=[];for(let s=0,o=n.length;s<o;s++)n[s].isDataTexture?r.push(lh(n[s].image)):r.push(lh(n[s]))}else r=lh(n);i.url=r}return t||(e.images[this.uuid]=i),i}}function lh(l){return typeof HTMLImageElement!="undefined"&&l instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&l instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&l instanceof ImageBitmap?ff.getDataURL(l):l.data?{data:Array.prototype.slice.call(l.data),width:l.width,height:l.height,type:l.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let t_=0;class wt extends Mr{constructor(e=wt.DEFAULT_IMAGE,t=wt.DEFAULT_MAPPING,i=Yt,n=Yt,r=dt,s=Ui,o=vn,a=dr,c=1,h=pr){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:t_++}),this.uuid=wn(),this.name="",this.source=new Zr(e),this.mipmaps=[],this.mapping=t,this.wrapS=i,this.wrapT=n,this.magFilter=r,this.minFilter=s,this.anisotropy=c,this.format=o,this.internalFormat=null,this.type=a,this.offset=new pe(0,0),this.repeat=new pe(1,1),this.center=new pe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new yn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=h,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Mc)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case fr:e.x=e.x-Math.floor(e.x);break;case Yt:e.x=e.x<0?0:1;break;case ro:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case fr:e.y=e.y-Math.floor(e.y);break;case Yt:e.y=e.y<0?0:1;break;case ro:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}wt.DEFAULT_IMAGE=null;wt.DEFAULT_MAPPING=Mc;class it{constructor(e=0,t=0,i=0,n=1){this.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,n=this.z,r=this.w,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*n+s[12]*r,this.y=s[1]*t+s[5]*i+s[9]*n+s[13]*r,this.z=s[2]*t+s[6]*i+s[10]*n+s[14]*r,this.w=s[3]*t+s[7]*i+s[11]*n+s[15]*r,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,n,r;const a=e.elements,c=a[0],h=a[4],u=a[8],f=a[1],d=a[5],g=a[9],p=a[2],m=a[6],_=a[10];if(Math.abs(h-f)<.01&&Math.abs(u-p)<.01&&Math.abs(g-m)<.01){if(Math.abs(h+f)<.1&&Math.abs(u+p)<.1&&Math.abs(g+m)<.1&&Math.abs(c+d+_-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const b=(c+1)/2,y=(d+1)/2,v=(_+1)/2,M=(h+f)/4,S=(u+p)/4,w=(g+m)/4;return b>y&&b>v?b<.01?(i=0,n=.707106781,r=.707106781):(i=Math.sqrt(b),n=M/i,r=S/i):y>v?y<.01?(i=.707106781,n=0,r=.707106781):(n=Math.sqrt(y),i=M/n,r=w/n):v<.01?(i=.707106781,n=.707106781,r=0):(r=Math.sqrt(v),i=S/r,n=w/r),this.set(i,n,r,t),this}let x=Math.sqrt((m-g)*(m-g)+(u-p)*(u-p)+(f-h)*(f-h));return Math.abs(x)<.001&&(x=1),this.x=(m-g)/x,this.y=(u-p)/x,this.z=(f-h)/x,this.w=Math.acos((c+d+_-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,i){return i!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Mn extends Mr{constructor(e,t,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new it(0,0,e,t),this.scissorTest=!1,this.viewport=new it(0,0,e,t);const n={width:e,height:t,depth:1};this.texture=new wt(n,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.internalFormat=i.internalFormat!==void 0?i.internalFormat:null,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:dt,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!1,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null,this.samples=i.samples!==void 0?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Zr(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Ha extends wt{constructor(e=null,t=1,i=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:n},this.magFilter=Tt,this.minFilter=Tt,this.wrapR=Yt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class n_ extends Mn{constructor(e,t,i){super(e,t),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new Ha(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class Cc extends wt{constructor(e=null,t=1,i=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:n},this.magFilter=Tt,this.minFilter=Tt,this.wrapR=Yt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class i_ extends Mn{constructor(e,t,i){super(e,t),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new Cc(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class r_ extends Mn{constructor(e,t,i,n={}){super(e,t,n),this.isWebGLMultipleRenderTargets=!0;const r=this.texture;this.texture=[];for(let s=0;s<i;s++)this.texture[s]=r.clone(),this.texture[s].isRenderTargetTexture=!0}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let n=0,r=this.texture.length;n<r;n++)this.texture[n].image.width=e,this.texture[n].image.height=t,this.texture[n].image.depth=i;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,i=e.texture.length;t<i;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class jt{constructor(e=0,t=0,i=0,n=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=n}static slerp(e,t,i,n){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),i.slerpQuaternions(e,t,n)}static slerpFlat(e,t,i,n,r,s,o){let a=i[n+0],c=i[n+1],h=i[n+2],u=i[n+3];const f=r[s+0],d=r[s+1],g=r[s+2],p=r[s+3];if(o===0){e[t+0]=a,e[t+1]=c,e[t+2]=h,e[t+3]=u;return}if(o===1){e[t+0]=f,e[t+1]=d,e[t+2]=g,e[t+3]=p;return}if(u!==p||a!==f||c!==d||h!==g){let m=1-o;const _=a*f+c*d+h*g+u*p,x=_>=0?1:-1,b=1-_*_;if(b>Number.EPSILON){const v=Math.sqrt(b),M=Math.atan2(v,_*x);m=Math.sin(m*M)/v,o=Math.sin(o*M)/v}const y=o*x;if(a=a*m+f*y,c=c*m+d*y,h=h*m+g*y,u=u*m+p*y,m===1-o){const v=1/Math.sqrt(a*a+c*c+h*h+u*u);a*=v,c*=v,h*=v,u*=v}}e[t]=a,e[t+1]=c,e[t+2]=h,e[t+3]=u}static multiplyQuaternionsFlat(e,t,i,n,r,s){const o=i[n],a=i[n+1],c=i[n+2],h=i[n+3],u=r[s],f=r[s+1],d=r[s+2],g=r[s+3];return e[t]=o*g+h*u+a*d-c*f,e[t+1]=a*g+h*f+c*u-o*d,e[t+2]=c*g+h*d+o*f-a*u,e[t+3]=h*g-o*u-a*f-c*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!(e&&e.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const i=e._x,n=e._y,r=e._z,s=e._order,o=Math.cos,a=Math.sin,c=o(i/2),h=o(n/2),u=o(r/2),f=a(i/2),d=a(n/2),g=a(r/2);switch(s){case"XYZ":this._x=f*h*u+c*d*g,this._y=c*d*u-f*h*g,this._z=c*h*g+f*d*u,this._w=c*h*u-f*d*g;break;case"YXZ":this._x=f*h*u+c*d*g,this._y=c*d*u-f*h*g,this._z=c*h*g-f*d*u,this._w=c*h*u+f*d*g;break;case"ZXY":this._x=f*h*u-c*d*g,this._y=c*d*u+f*h*g,this._z=c*h*g+f*d*u,this._w=c*h*u-f*d*g;break;case"ZYX":this._x=f*h*u-c*d*g,this._y=c*d*u+f*h*g,this._z=c*h*g-f*d*u,this._w=c*h*u+f*d*g;break;case"YZX":this._x=f*h*u+c*d*g,this._y=c*d*u+f*h*g,this._z=c*h*g-f*d*u,this._w=c*h*u-f*d*g;break;case"XZY":this._x=f*h*u-c*d*g,this._y=c*d*u-f*h*g,this._z=c*h*g+f*d*u,this._w=c*h*u+f*d*g;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,n=Math.sin(i);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],n=t[4],r=t[8],s=t[1],o=t[5],a=t[9],c=t[2],h=t[6],u=t[10],f=i+o+u;if(f>0){const d=.5/Math.sqrt(f+1);this._w=.25/d,this._x=(h-a)*d,this._y=(r-c)*d,this._z=(s-n)*d}else if(i>o&&i>u){const d=2*Math.sqrt(1+i-o-u);this._w=(h-a)/d,this._x=.25*d,this._y=(n+s)/d,this._z=(r+c)/d}else if(o>u){const d=2*Math.sqrt(1+o-i-u);this._w=(r-c)/d,this._x=(n+s)/d,this._y=.25*d,this._z=(a+h)/d}else{const d=2*Math.sqrt(1+u-i-o);this._w=(s-n)/d,this._x=(r+c)/d,this._y=(a+h)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ct(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const n=Math.min(1,t/i);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return t!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,n=e._y,r=e._z,s=e._w,o=t._x,a=t._y,c=t._z,h=t._w;return this._x=i*h+s*o+n*c-r*a,this._y=n*h+s*a+r*o-i*c,this._z=r*h+s*c+i*a-n*o,this._w=s*h-i*o-n*a-r*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,n=this._y,r=this._z,s=this._w;let o=s*e._w+i*e._x+n*e._y+r*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=s,this._x=i,this._y=n,this._z=r,this;const a=1-o*o;if(a<=Number.EPSILON){const d=1-t;return this._w=d*s+t*this._w,this._x=d*i+t*this._x,this._y=d*n+t*this._y,this._z=d*r+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(a),h=Math.atan2(c,o),u=Math.sin((1-t)*h)/c,f=Math.sin(t*h)/c;return this._w=s*u+this._w*f,this._x=i*u+this._x*f,this._y=n*u+this._y*f,this._z=r*u+this._z*f,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),n=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(t*Math.cos(n),i*Math.sin(r),i*Math.cos(r),t*Math.sin(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class L{constructor(e=0,t=0,i=0){this.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(wd.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(wd.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6]*n,this.y=r[1]*t+r[4]*i+r[7]*n,this.z=r[2]*t+r[5]*i+r[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,n=this.z,r=e.elements,s=1/(r[3]*t+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*t+r[4]*i+r[8]*n+r[12])*s,this.y=(r[1]*t+r[5]*i+r[9]*n+r[13])*s,this.z=(r[2]*t+r[6]*i+r[10]*n+r[14])*s,this}applyQuaternion(e){const t=this.x,i=this.y,n=this.z,r=e.x,s=e.y,o=e.z,a=e.w,c=a*t+s*n-o*i,h=a*i+o*t-r*n,u=a*n+r*i-s*t,f=-r*t-s*i-o*n;return this.x=c*a+f*-r+h*-o-u*-s,this.y=h*a+f*-s+u*-r-c*-o,this.z=u*a+f*-o+c*-s-h*-r,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[4]*i+r[8]*n,this.y=r[1]*t+r[5]*i+r[9]*n,this.z=r[2]*t+r[6]*i+r[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e,t){return t!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,n=e.y,r=e.z,s=t.x,o=t.y,a=t.z;return this.x=n*a-r*o,this.y=r*s-i*a,this.z=i*o-n*s,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return ch.copy(this).projectOnVector(e),this.sub(ch)}reflect(e){return this.sub(ch.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Ct(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,n=this.z-e.z;return t*t+i*i+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const n=Math.sin(t)*e;return this.x=n*Math.sin(i),this.y=Math.cos(t)*e,this.z=n*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,i){return i!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const ch=new L,wd=new jt;class gi{constructor(e=new L(1/0,1/0,1/0),t=new L(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,n=1/0,r=-1/0,s=-1/0,o=-1/0;for(let a=0,c=e.length;a<c;a+=3){const h=e[a],u=e[a+1],f=e[a+2];h<t&&(t=h),u<i&&(i=u),f<n&&(n=f),h>r&&(r=h),u>s&&(s=u),f>o&&(o=f)}return this.min.set(t,i,n),this.max.set(r,s,o),this}setFromBufferAttribute(e){let t=1/0,i=1/0,n=1/0,r=-1/0,s=-1/0,o=-1/0;for(let a=0,c=e.count;a<c;a++){const h=e.getX(a),u=e.getY(a),f=e.getZ(a);h<t&&(t=h),u<i&&(i=u),f<n&&(n=f),h>r&&(r=h),u>s&&(s=u),f>o&&(o=f)}return this.min.set(t,i,n),this.max.set(r,s,o),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Cr.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0)if(t&&i.attributes!=null&&i.attributes.position!==void 0){const r=i.attributes.position;for(let s=0,o=r.count;s<o;s++)Cr.fromBufferAttribute(r,s).applyMatrix4(e.matrixWorld),this.expandByPoint(Cr)}else i.boundingBox===null&&i.computeBoundingBox(),hh.copy(i.boundingBox),hh.applyMatrix4(e.matrixWorld),this.union(hh);const n=e.children;for(let r=0,s=n.length;r<s;r++)this.expandByObject(n[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Cr),Cr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Yo),cl.subVectors(this.max,Yo),Ms.subVectors(e.a,Yo),Ss.subVectors(e.b,Yo),Ts.subVectors(e.c,Yo),Wi.subVectors(Ss,Ms),Xi.subVectors(Ts,Ss),Ar.subVectors(Ms,Ts);let t=[0,-Wi.z,Wi.y,0,-Xi.z,Xi.y,0,-Ar.z,Ar.y,Wi.z,0,-Wi.x,Xi.z,0,-Xi.x,Ar.z,0,-Ar.x,-Wi.y,Wi.x,0,-Xi.y,Xi.x,0,-Ar.y,Ar.x,0];return!uh(t,Ms,Ss,Ts,cl)||(t=[1,0,0,0,1,0,0,0,1],!uh(t,Ms,Ss,Ts,cl))?!1:(hl.crossVectors(Wi,Xi),t=[hl.x,hl.y,hl.z],uh(t,Ms,Ss,Ts,cl))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Cr.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(Cr).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(vi[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),vi[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),vi[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),vi[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),vi[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),vi[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),vi[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),vi[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(vi),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const vi=[new L,new L,new L,new L,new L,new L,new L,new L],Cr=new L,hh=new gi,Ms=new L,Ss=new L,Ts=new L,Wi=new L,Xi=new L,Ar=new L,Yo=new L,cl=new L,hl=new L,Er=new L;function uh(l,e,t,i,n){for(let r=0,s=l.length-3;r<=s;r+=3){Er.fromArray(l,r);const o=n.x*Math.abs(Er.x)+n.y*Math.abs(Er.y)+n.z*Math.abs(Er.z),a=e.dot(Er),c=t.dot(Er),h=i.dot(Er);if(Math.max(-Math.max(a,c,h),Math.min(a,c,h))>o)return!1}return!0}const s_=new gi,Md=new L,ul=new L,fh=new L;class ki{constructor(e=new L,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):s_.setFromPoints(e).getCenter(i);let n=0;for(let r=0,s=e.length;r<s;r++)n=Math.max(n,i.distanceToSquared(e[r]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){fh.subVectors(e,this.center);const t=fh.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),n=(i-this.radius)*.5;this.center.add(fh.multiplyScalar(n/i)),this.radius+=n}return this}union(e){return this.center.equals(e.center)===!0?ul.set(0,0,1).multiplyScalar(e.radius):ul.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(Md.copy(e.center).add(ul)),this.expandByPoint(Md.copy(e.center).sub(ul)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const yi=new L,dh=new L,fl=new L,qi=new L,ph=new L,dl=new L,mh=new L;class Wa{constructor(e=new L,t=new L(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,yi)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=yi.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(yi.copy(this.direction).multiplyScalar(t).add(this.origin),yi.distanceToSquared(e))}distanceSqToSegment(e,t,i,n){dh.copy(e).add(t).multiplyScalar(.5),fl.copy(t).sub(e).normalize(),qi.copy(this.origin).sub(dh);const r=e.distanceTo(t)*.5,s=-this.direction.dot(fl),o=qi.dot(this.direction),a=-qi.dot(fl),c=qi.lengthSq(),h=Math.abs(1-s*s);let u,f,d,g;if(h>0)if(u=s*a-o,f=s*o-a,g=r*h,u>=0)if(f>=-g)if(f<=g){const p=1/h;u*=p,f*=p,d=u*(u+s*f+2*o)+f*(s*u+f+2*a)+c}else f=r,u=Math.max(0,-(s*f+o)),d=-u*u+f*(f+2*a)+c;else f=-r,u=Math.max(0,-(s*f+o)),d=-u*u+f*(f+2*a)+c;else f<=-g?(u=Math.max(0,-(-s*r+o)),f=u>0?-r:Math.min(Math.max(-r,-a),r),d=-u*u+f*(f+2*a)+c):f<=g?(u=0,f=Math.min(Math.max(-r,-a),r),d=f*(f+2*a)+c):(u=Math.max(0,-(s*r+o)),f=u>0?r:Math.min(Math.max(-r,-a),r),d=-u*u+f*(f+2*a)+c);else f=s>0?-r:r,u=Math.max(0,-(s*f+o)),d=-u*u+f*(f+2*a)+c;return i&&i.copy(this.direction).multiplyScalar(u).add(this.origin),n&&n.copy(fl).multiplyScalar(f).add(dh),d}intersectSphere(e,t){yi.subVectors(e.center,this.origin);const i=yi.dot(this.direction),n=yi.dot(yi)-i*i,r=e.radius*e.radius;if(n>r)return null;const s=Math.sqrt(r-n),o=i-s,a=i+s;return o<0&&a<0?null:o<0?this.at(a,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,n,r,s,o,a;const c=1/this.direction.x,h=1/this.direction.y,u=1/this.direction.z,f=this.origin;return c>=0?(i=(e.min.x-f.x)*c,n=(e.max.x-f.x)*c):(i=(e.max.x-f.x)*c,n=(e.min.x-f.x)*c),h>=0?(r=(e.min.y-f.y)*h,s=(e.max.y-f.y)*h):(r=(e.max.y-f.y)*h,s=(e.min.y-f.y)*h),i>s||r>n||((r>i||i!==i)&&(i=r),(s<n||n!==n)&&(n=s),u>=0?(o=(e.min.z-f.z)*u,a=(e.max.z-f.z)*u):(o=(e.max.z-f.z)*u,a=(e.min.z-f.z)*u),i>a||o>n)||((o>i||i!==i)&&(i=o),(a<n||n!==n)&&(n=a),n<0)?null:this.at(i>=0?i:n,t)}intersectsBox(e){return this.intersectBox(e,yi)!==null}intersectTriangle(e,t,i,n,r){ph.subVectors(t,e),dl.subVectors(i,e),mh.crossVectors(ph,dl);let s=this.direction.dot(mh),o;if(s>0){if(n)return null;o=1}else if(s<0)o=-1,s=-s;else return null;qi.subVectors(this.origin,e);const a=o*this.direction.dot(dl.crossVectors(qi,dl));if(a<0)return null;const c=o*this.direction.dot(ph.cross(qi));if(c<0||a+c>s)return null;const h=-o*qi.dot(mh);return h<0?null:this.at(h/s,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Ne{constructor(){this.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,i,n,r,s,o,a,c,h,u,f,d,g,p,m){const _=this.elements;return _[0]=e,_[4]=t,_[8]=i,_[12]=n,_[1]=r,_[5]=s,_[9]=o,_[13]=a,_[2]=c,_[6]=h,_[10]=u,_[14]=f,_[3]=d,_[7]=g,_[11]=p,_[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ne().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,n=1/Cs.setFromMatrixColumn(e,0).length(),r=1/Cs.setFromMatrixColumn(e,1).length(),s=1/Cs.setFromMatrixColumn(e,2).length();return t[0]=i[0]*n,t[1]=i[1]*n,t[2]=i[2]*n,t[3]=0,t[4]=i[4]*r,t[5]=i[5]*r,t[6]=i[6]*r,t[7]=0,t[8]=i[8]*s,t[9]=i[9]*s,t[10]=i[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,i=e.x,n=e.y,r=e.z,s=Math.cos(i),o=Math.sin(i),a=Math.cos(n),c=Math.sin(n),h=Math.cos(r),u=Math.sin(r);if(e.order==="XYZ"){const f=s*h,d=s*u,g=o*h,p=o*u;t[0]=a*h,t[4]=-a*u,t[8]=c,t[1]=d+g*c,t[5]=f-p*c,t[9]=-o*a,t[2]=p-f*c,t[6]=g+d*c,t[10]=s*a}else if(e.order==="YXZ"){const f=a*h,d=a*u,g=c*h,p=c*u;t[0]=f+p*o,t[4]=g*o-d,t[8]=s*c,t[1]=s*u,t[5]=s*h,t[9]=-o,t[2]=d*o-g,t[6]=p+f*o,t[10]=s*a}else if(e.order==="ZXY"){const f=a*h,d=a*u,g=c*h,p=c*u;t[0]=f-p*o,t[4]=-s*u,t[8]=g+d*o,t[1]=d+g*o,t[5]=s*h,t[9]=p-f*o,t[2]=-s*c,t[6]=o,t[10]=s*a}else if(e.order==="ZYX"){const f=s*h,d=s*u,g=o*h,p=o*u;t[0]=a*h,t[4]=g*c-d,t[8]=f*c+p,t[1]=a*u,t[5]=p*c+f,t[9]=d*c-g,t[2]=-c,t[6]=o*a,t[10]=s*a}else if(e.order==="YZX"){const f=s*a,d=s*c,g=o*a,p=o*c;t[0]=a*h,t[4]=p-f*u,t[8]=g*u+d,t[1]=u,t[5]=s*h,t[9]=-o*h,t[2]=-c*h,t[6]=d*u+g,t[10]=f-p*u}else if(e.order==="XZY"){const f=s*a,d=s*c,g=o*a,p=o*c;t[0]=a*h,t[4]=-u,t[8]=c*h,t[1]=f*u+p,t[5]=s*h,t[9]=d*u-g,t[2]=g*u-d,t[6]=o*h,t[10]=p*u+f}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(o_,e,a_)}lookAt(e,t,i){const n=this.elements;return mn.subVectors(e,t),mn.lengthSq()===0&&(mn.z=1),mn.normalize(),Yi.crossVectors(i,mn),Yi.lengthSq()===0&&(Math.abs(i.z)===1?mn.x+=1e-4:mn.z+=1e-4,mn.normalize(),Yi.crossVectors(i,mn)),Yi.normalize(),pl.crossVectors(mn,Yi),n[0]=Yi.x,n[4]=pl.x,n[8]=mn.x,n[1]=Yi.y,n[5]=pl.y,n[9]=mn.y,n[2]=Yi.z,n[6]=pl.z,n[10]=mn.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,n=t.elements,r=this.elements,s=i[0],o=i[4],a=i[8],c=i[12],h=i[1],u=i[5],f=i[9],d=i[13],g=i[2],p=i[6],m=i[10],_=i[14],x=i[3],b=i[7],y=i[11],v=i[15],M=n[0],S=n[4],w=n[8],T=n[12],R=n[1],D=n[5],I=n[9],U=n[13],A=n[2],B=n[6],O=n[10],q=n[14],Z=n[3],k=n[7],V=n[11],F=n[15];return r[0]=s*M+o*R+a*A+c*Z,r[4]=s*S+o*D+a*B+c*k,r[8]=s*w+o*I+a*O+c*V,r[12]=s*T+o*U+a*q+c*F,r[1]=h*M+u*R+f*A+d*Z,r[5]=h*S+u*D+f*B+d*k,r[9]=h*w+u*I+f*O+d*V,r[13]=h*T+u*U+f*q+d*F,r[2]=g*M+p*R+m*A+_*Z,r[6]=g*S+p*D+m*B+_*k,r[10]=g*w+p*I+m*O+_*V,r[14]=g*T+p*U+m*q+_*F,r[3]=x*M+b*R+y*A+v*Z,r[7]=x*S+b*D+y*B+v*k,r[11]=x*w+b*I+y*O+v*V,r[15]=x*T+b*U+y*q+v*F,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],n=e[8],r=e[12],s=e[1],o=e[5],a=e[9],c=e[13],h=e[2],u=e[6],f=e[10],d=e[14],g=e[3],p=e[7],m=e[11],_=e[15];return g*(+r*a*u-n*c*u-r*o*f+i*c*f+n*o*d-i*a*d)+p*(+t*a*d-t*c*f+r*s*f-n*s*d+n*c*h-r*a*h)+m*(+t*c*u-t*o*d-r*s*u+i*s*d+r*o*h-i*c*h)+_*(-n*o*h-t*a*u+t*o*f+n*s*u-i*s*f+i*a*h)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],s=e[4],o=e[5],a=e[6],c=e[7],h=e[8],u=e[9],f=e[10],d=e[11],g=e[12],p=e[13],m=e[14],_=e[15],x=u*m*c-p*f*c+p*a*d-o*m*d-u*a*_+o*f*_,b=g*f*c-h*m*c-g*a*d+s*m*d+h*a*_-s*f*_,y=h*p*c-g*u*c+g*o*d-s*p*d-h*o*_+s*u*_,v=g*u*a-h*p*a-g*o*f+s*p*f+h*o*m-s*u*m,M=t*x+i*b+n*y+r*v;if(M===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const S=1/M;return e[0]=x*S,e[1]=(p*f*r-u*m*r-p*n*d+i*m*d+u*n*_-i*f*_)*S,e[2]=(o*m*r-p*a*r+p*n*c-i*m*c-o*n*_+i*a*_)*S,e[3]=(u*a*r-o*f*r-u*n*c+i*f*c+o*n*d-i*a*d)*S,e[4]=b*S,e[5]=(h*m*r-g*f*r+g*n*d-t*m*d-h*n*_+t*f*_)*S,e[6]=(g*a*r-s*m*r-g*n*c+t*m*c+s*n*_-t*a*_)*S,e[7]=(s*f*r-h*a*r+h*n*c-t*f*c-s*n*d+t*a*d)*S,e[8]=y*S,e[9]=(g*u*r-h*p*r-g*i*d+t*p*d+h*i*_-t*u*_)*S,e[10]=(s*p*r-g*o*r+g*i*c-t*p*c-s*i*_+t*o*_)*S,e[11]=(h*o*r-s*u*r-h*i*c+t*u*c+s*i*d-t*o*d)*S,e[12]=v*S,e[13]=(h*p*n-g*u*n+g*i*f-t*p*f-h*i*m+t*u*m)*S,e[14]=(g*o*n-s*p*n-g*i*a+t*p*a+s*i*m-t*o*m)*S,e[15]=(s*u*n-h*o*n+h*i*a-t*u*a-s*i*f+t*o*f)*S,this}scale(e){const t=this.elements,i=e.x,n=e.y,r=e.z;return t[0]*=i,t[4]*=n,t[8]*=r,t[1]*=i,t[5]*=n,t[9]*=r,t[2]*=i,t[6]*=n,t[10]*=r,t[3]*=i,t[7]*=n,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,n))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),n=Math.sin(t),r=1-i,s=e.x,o=e.y,a=e.z,c=r*s,h=r*o;return this.set(c*s+i,c*o-n*a,c*a+n*o,0,c*o+n*a,h*o+i,h*a-n*s,0,c*a-n*o,h*a+n*s,r*a*a+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,n,r,s){return this.set(1,i,r,0,e,1,s,0,t,n,1,0,0,0,0,1),this}compose(e,t,i){const n=this.elements,r=t._x,s=t._y,o=t._z,a=t._w,c=r+r,h=s+s,u=o+o,f=r*c,d=r*h,g=r*u,p=s*h,m=s*u,_=o*u,x=a*c,b=a*h,y=a*u,v=i.x,M=i.y,S=i.z;return n[0]=(1-(p+_))*v,n[1]=(d+y)*v,n[2]=(g-b)*v,n[3]=0,n[4]=(d-y)*M,n[5]=(1-(f+_))*M,n[6]=(m+x)*M,n[7]=0,n[8]=(g+b)*S,n[9]=(m-x)*S,n[10]=(1-(f+p))*S,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,i){const n=this.elements;let r=Cs.set(n[0],n[1],n[2]).length();const s=Cs.set(n[4],n[5],n[6]).length(),o=Cs.set(n[8],n[9],n[10]).length();this.determinant()<0&&(r=-r),e.x=n[12],e.y=n[13],e.z=n[14],Gn.copy(this);const c=1/r,h=1/s,u=1/o;return Gn.elements[0]*=c,Gn.elements[1]*=c,Gn.elements[2]*=c,Gn.elements[4]*=h,Gn.elements[5]*=h,Gn.elements[6]*=h,Gn.elements[8]*=u,Gn.elements[9]*=u,Gn.elements[10]*=u,t.setFromRotationMatrix(Gn),i.x=r,i.y=s,i.z=o,this}makePerspective(e,t,i,n,r,s){s===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const o=this.elements,a=2*r/(t-e),c=2*r/(i-n),h=(t+e)/(t-e),u=(i+n)/(i-n),f=-(s+r)/(s-r),d=-2*s*r/(s-r);return o[0]=a,o[4]=0,o[8]=h,o[12]=0,o[1]=0,o[5]=c,o[9]=u,o[13]=0,o[2]=0,o[6]=0,o[10]=f,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,t,i,n,r,s){const o=this.elements,a=1/(t-e),c=1/(i-n),h=1/(s-r),u=(t+e)*a,f=(i+n)*c,d=(s+r)*h;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*c,o[9]=0,o[13]=-f,o[2]=0,o[6]=0,o[10]=-2*h,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let n=0;n<16;n++)if(t[n]!==i[n])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Cs=new L,Gn=new Ne,o_=new L(0,0,0),a_=new L(1,1,1),Yi=new L,pl=new L,mn=new L,Sd=new Ne,Td=new jt;class Ro{constructor(e=0,t=0,i=0,n=Ro.DefaultOrder){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,n=this._order){return this._x=e,this._y=t,this._z=i,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const n=e.elements,r=n[0],s=n[4],o=n[8],a=n[1],c=n[5],h=n[9],u=n[2],f=n[6],d=n[10];switch(t){case"XYZ":this._y=Math.asin(Ct(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-h,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(f,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Ct(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,c)):(this._y=Math.atan2(-u,r),this._z=0);break;case"ZXY":this._x=Math.asin(Ct(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,c)):(this._y=0,this._z=Math.atan2(a,r));break;case"ZYX":this._y=Math.asin(-Ct(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(f,d),this._z=Math.atan2(a,r)):(this._x=0,this._z=Math.atan2(-s,c));break;case"YZX":this._z=Math.asin(Ct(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-h,c),this._y=Math.atan2(-u,r)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-Ct(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(f,c),this._y=Math.atan2(o,r)):(this._x=Math.atan2(-h,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return Sd.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Sd,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Td.setFromEuler(this),this.setFromQuaternion(Td,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}Ro.DefaultOrder="XYZ";Ro.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Ac{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let l_=0;const Cd=new L,As=new jt,bi=new Ne,ml=new L,Zo=new L,c_=new L,h_=new jt,Ad=new L(1,0,0),Ed=new L(0,1,0),Ld=new L(0,0,1),u_={type:"added"},Rd={type:"removed"};class $e extends Mr{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:l_++}),this.uuid=wn(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=$e.DefaultUp.clone();const e=new L,t=new Ro,i=new jt,n=new L(1,1,1);function r(){i.setFromEuler(t,!1)}function s(){t.setFromQuaternion(i,void 0,!1)}t._onChange(r),i._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new Ne},normalMatrix:{value:new yn}}),this.matrix=new Ne,this.matrixWorld=new Ne,this.matrixAutoUpdate=$e.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Ac,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return As.setFromAxisAngle(e,t),this.quaternion.multiply(As),this}rotateOnWorldAxis(e,t){return As.setFromAxisAngle(e,t),this.quaternion.premultiply(As),this}rotateX(e){return this.rotateOnAxis(Ad,e)}rotateY(e){return this.rotateOnAxis(Ed,e)}rotateZ(e){return this.rotateOnAxis(Ld,e)}translateOnAxis(e,t){return Cd.copy(e).applyQuaternion(this.quaternion),this.position.add(Cd.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Ad,e)}translateY(e){return this.translateOnAxis(Ed,e)}translateZ(e){return this.translateOnAxis(Ld,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(bi.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?ml.copy(e):ml.set(e,t,i);const n=this.parent;this.updateWorldMatrix(!0,!1),Zo.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?bi.lookAt(Zo,ml,this.up):bi.lookAt(ml,Zo,this.up),this.quaternion.setFromRotationMatrix(bi),n&&(bi.extractRotation(n.matrixWorld),As.setFromRotationMatrix(bi),this.quaternion.premultiply(As.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(u_)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Rd)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(Rd)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),bi.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),bi.multiply(e.parent.matrixWorld)),e.applyMatrix4(bi),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,n=this.children.length;i<n;i++){const s=this.children[i].getObjectByProperty(e,t);if(s!==void 0)return s}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Zo,e,c_),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Zo,h_,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,n=t.length;i<n;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,n=t.length;i<n;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,n=t.length;i<n;i++)t[i].updateMatrixWorld(e)}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON()));function r(o,a){return o[a.uuid]===void 0&&(o[a.uuid]=a.toJSON(e)),a.uuid}if(this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=r(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const a=o.shapes;if(Array.isArray(a))for(let c=0,h=a.length;c<h;c++){const u=a[c];r(e.shapes,u)}else r(e.shapes,a)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let a=0,c=this.material.length;a<c;a++)o.push(r(e.materials,this.material[a]));n.material=o}else n.material=r(e.materials,this.material);if(this.children.length>0){n.children=[];for(let o=0;o<this.children.length;o++)n.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let o=0;o<this.animations.length;o++){const a=this.animations[o];n.animations.push(r(e.animations,a))}}if(t){const o=s(e.geometries),a=s(e.materials),c=s(e.textures),h=s(e.images),u=s(e.shapes),f=s(e.skeletons),d=s(e.animations),g=s(e.nodes);o.length>0&&(i.geometries=o),a.length>0&&(i.materials=a),c.length>0&&(i.textures=c),h.length>0&&(i.images=h),u.length>0&&(i.shapes=u),f.length>0&&(i.skeletons=f),d.length>0&&(i.animations=d),g.length>0&&(i.nodes=g)}return i.object=n,i;function s(o){const a=[];for(const c in o){const h=o[c];delete h.metadata,a.push(h)}return a}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const n=e.children[i];this.add(n.clone())}return this}}$e.DefaultUp=new L(0,1,0);$e.DefaultMatrixAutoUpdate=!0;const Vn=new L,wi=new L,gh=new L,Mi=new L,Es=new L,Ls=new L,Pd=new L,_h=new L,xh=new L,vh=new L;class Pn{constructor(e=new L,t=new L,i=new L){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,n){n.subVectors(i,t),Vn.subVectors(e,t),n.cross(Vn);const r=n.lengthSq();return r>0?n.multiplyScalar(1/Math.sqrt(r)):n.set(0,0,0)}static getBarycoord(e,t,i,n,r){Vn.subVectors(n,t),wi.subVectors(i,t),gh.subVectors(e,t);const s=Vn.dot(Vn),o=Vn.dot(wi),a=Vn.dot(gh),c=wi.dot(wi),h=wi.dot(gh),u=s*c-o*o;if(u===0)return r.set(-2,-1,-1);const f=1/u,d=(c*a-o*h)*f,g=(s*h-o*a)*f;return r.set(1-d-g,g,d)}static containsPoint(e,t,i,n){return this.getBarycoord(e,t,i,n,Mi),Mi.x>=0&&Mi.y>=0&&Mi.x+Mi.y<=1}static getUV(e,t,i,n,r,s,o,a){return this.getBarycoord(e,t,i,n,Mi),a.set(0,0),a.addScaledVector(r,Mi.x),a.addScaledVector(s,Mi.y),a.addScaledVector(o,Mi.z),a}static isFrontFacing(e,t,i,n){return Vn.subVectors(i,t),wi.subVectors(e,t),Vn.cross(wi).dot(n)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,n){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,t,i,n){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Vn.subVectors(this.c,this.b),wi.subVectors(this.a,this.b),Vn.cross(wi).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Pn.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Pn.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,n,r){return Pn.getUV(e,this.a,this.b,this.c,t,i,n,r)}containsPoint(e){return Pn.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Pn.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,n=this.b,r=this.c;let s,o;Es.subVectors(n,i),Ls.subVectors(r,i),_h.subVectors(e,i);const a=Es.dot(_h),c=Ls.dot(_h);if(a<=0&&c<=0)return t.copy(i);xh.subVectors(e,n);const h=Es.dot(xh),u=Ls.dot(xh);if(h>=0&&u<=h)return t.copy(n);const f=a*u-h*c;if(f<=0&&a>=0&&h<=0)return s=a/(a-h),t.copy(i).addScaledVector(Es,s);vh.subVectors(e,r);const d=Es.dot(vh),g=Ls.dot(vh);if(g>=0&&d<=g)return t.copy(r);const p=d*c-a*g;if(p<=0&&c>=0&&g<=0)return o=c/(c-g),t.copy(i).addScaledVector(Ls,o);const m=h*g-d*u;if(m<=0&&u-h>=0&&d-g>=0)return Pd.subVectors(r,n),o=(u-h)/(u-h+(d-g)),t.copy(n).addScaledVector(Pd,o);const _=1/(m+p+f);return s=p*_,o=f*_,t.copy(i).addScaledVector(Es,s).addScaledVector(Ls,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let f_=0;class bt extends Mr{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:f_++}),this.uuid=wn(),this.name="",this.type="Material",this.blending=Kr,this.side=Pi,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=sf,this.blendDst=of,this.blendEquation=Hr,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=hc,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=P0,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=sc,this.stencilZFail=sc,this.stencilZPass=sc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if(t==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=i===km;continue}const n=this[t];if(n===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Kr&&(i.blending=this.blending),this.side!==Pi&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(i.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=this.flatShading),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData);function n(r){const s=[];for(const o in r){const a=r[o];delete a.metadata,s.push(a)}return s}if(t){const r=n(e.textures),s=n(e.images);r.length>0&&(i.textures=r),s.length>0&&(i.images=s)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const n=t.length;i=new Array(n);for(let r=0;r!==n;++r)i[r]=t[r].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}get vertexTangents(){return console.warn("THREE."+this.type+": .vertexTangents has been removed."),!1}set vertexTangents(e){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}bt.fromType=function(){return null};class kt extends bt{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ae(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Va,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Lt=new L,gl=new pe;class st{constructor(e,t,i){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i===!0,this.usage=uc,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let n=0,r=this.itemSize;n<r;n++)this.array[e+n]=t.array[i+n];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let i=0;for(let n=0,r=e.length;n<r;n++){let s=e[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),s=new Ae),t[i++]=s.r,t[i++]=s.g,t[i++]=s.b}return this}copyVector2sArray(e){const t=this.array;let i=0;for(let n=0,r=e.length;n<r;n++){let s=e[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),s=new pe),t[i++]=s.x,t[i++]=s.y}return this}copyVector3sArray(e){const t=this.array;let i=0;for(let n=0,r=e.length;n<r;n++){let s=e[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),s=new L),t[i++]=s.x,t[i++]=s.y,t[i++]=s.z}return this}copyVector4sArray(e){const t=this.array;let i=0;for(let n=0,r=e.length;n<r;n++){let s=e[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),s=new it),t[i++]=s.x,t[i++]=s.y,t[i++]=s.z,t[i++]=s.w}return this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)gl.fromBufferAttribute(this,t),gl.applyMatrix3(e),this.setXY(t,gl.x,gl.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)Lt.fromBufferAttribute(this,t),Lt.applyMatrix3(e),this.setXYZ(t,Lt.x,Lt.y,Lt.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Lt.fromBufferAttribute(this,t),Lt.applyMatrix4(e),this.setXYZ(t,Lt.x,Lt.y,Lt.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Lt.fromBufferAttribute(this,t),Lt.applyNormalMatrix(e),this.setXYZ(t,Lt.x,Lt.y,Lt.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Lt.fromBufferAttribute(this,t),Lt.transformDirection(e),this.setXYZ(t,Lt.x,Lt.y,Lt.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this}setXYZW(e,t,i,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==uc&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}}class d_ extends st{constructor(e,t,i){super(new Int8Array(e),t,i)}}class p_ extends st{constructor(e,t,i){super(new Uint8Array(e),t,i)}}class m_ extends st{constructor(e,t,i){super(new Uint8ClampedArray(e),t,i)}}class g_ extends st{constructor(e,t,i){super(new Int16Array(e),t,i)}}class df extends st{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class __ extends st{constructor(e,t,i){super(new Int32Array(e),t,i)}}class pf extends st{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class x_ extends st{constructor(e,t,i){super(new Uint16Array(e),t,i),this.isFloat16BufferAttribute=!0}}class Fe extends st{constructor(e,t,i){super(new Float32Array(e),t,i)}}class v_ extends st{constructor(e,t,i){super(new Float64Array(e),t,i)}}let y_=0;const En=new Ne,yh=new $e,Rs=new L,gn=new gi,jo=new gi,Ft=new L;class ze extends Mr{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:y_++}),this.uuid=wn(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(I0(e)?pf:df)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const r=new yn().getNormalMatrix(e);i.applyNormalMatrix(r),i.needsUpdate=!0}const n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(e),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return En.makeRotationFromQuaternion(e),this.applyMatrix4(En),this}rotateX(e){return En.makeRotationX(e),this.applyMatrix4(En),this}rotateY(e){return En.makeRotationY(e),this.applyMatrix4(En),this}rotateZ(e){return En.makeRotationZ(e),this.applyMatrix4(En),this}translate(e,t,i){return En.makeTranslation(e,t,i),this.applyMatrix4(En),this}scale(e,t,i){return En.makeScale(e,t,i),this.applyMatrix4(En),this}lookAt(e){return yh.lookAt(e),yh.updateMatrix(),this.applyMatrix4(yh.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Rs).negate(),this.translate(Rs.x,Rs.y,Rs.z),this}setFromPoints(e){const t=[];for(let i=0,n=e.length;i<n;i++){const r=e[i];t.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new Fe(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new gi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new L(-1/0,-1/0,-1/0),new L(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,n=t.length;i<n;i++){const r=t[i];gn.setFromBufferAttribute(r),this.morphTargetsRelative?(Ft.addVectors(this.boundingBox.min,gn.min),this.boundingBox.expandByPoint(Ft),Ft.addVectors(this.boundingBox.max,gn.max),this.boundingBox.expandByPoint(Ft)):(this.boundingBox.expandByPoint(gn.min),this.boundingBox.expandByPoint(gn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ki);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new L,1/0);return}if(e){const i=this.boundingSphere.center;if(gn.setFromBufferAttribute(e),t)for(let r=0,s=t.length;r<s;r++){const o=t[r];jo.setFromBufferAttribute(o),this.morphTargetsRelative?(Ft.addVectors(gn.min,jo.min),gn.expandByPoint(Ft),Ft.addVectors(gn.max,jo.max),gn.expandByPoint(Ft)):(gn.expandByPoint(jo.min),gn.expandByPoint(jo.max))}gn.getCenter(i);let n=0;for(let r=0,s=e.count;r<s;r++)Ft.fromBufferAttribute(e,r),n=Math.max(n,i.distanceToSquared(Ft));if(t)for(let r=0,s=t.length;r<s;r++){const o=t[r],a=this.morphTargetsRelative;for(let c=0,h=o.count;c<h;c++)Ft.fromBufferAttribute(o,c),a&&(Rs.fromBufferAttribute(e,c),Ft.add(Rs)),n=Math.max(n,i.distanceToSquared(Ft))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,n=t.position.array,r=t.normal.array,s=t.uv.array,o=n.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new st(new Float32Array(4*o),4));const a=this.getAttribute("tangent").array,c=[],h=[];for(let R=0;R<o;R++)c[R]=new L,h[R]=new L;const u=new L,f=new L,d=new L,g=new pe,p=new pe,m=new pe,_=new L,x=new L;function b(R,D,I){u.fromArray(n,R*3),f.fromArray(n,D*3),d.fromArray(n,I*3),g.fromArray(s,R*2),p.fromArray(s,D*2),m.fromArray(s,I*2),f.sub(u),d.sub(u),p.sub(g),m.sub(g);const U=1/(p.x*m.y-m.x*p.y);!isFinite(U)||(_.copy(f).multiplyScalar(m.y).addScaledVector(d,-p.y).multiplyScalar(U),x.copy(d).multiplyScalar(p.x).addScaledVector(f,-m.x).multiplyScalar(U),c[R].add(_),c[D].add(_),c[I].add(_),h[R].add(x),h[D].add(x),h[I].add(x))}let y=this.groups;y.length===0&&(y=[{start:0,count:i.length}]);for(let R=0,D=y.length;R<D;++R){const I=y[R],U=I.start,A=I.count;for(let B=U,O=U+A;B<O;B+=3)b(i[B+0],i[B+1],i[B+2])}const v=new L,M=new L,S=new L,w=new L;function T(R){S.fromArray(r,R*3),w.copy(S);const D=c[R];v.copy(D),v.sub(S.multiplyScalar(S.dot(D))).normalize(),M.crossVectors(w,D);const U=M.dot(h[R])<0?-1:1;a[R*4]=v.x,a[R*4+1]=v.y,a[R*4+2]=v.z,a[R*4+3]=U}for(let R=0,D=y.length;R<D;++R){const I=y[R],U=I.start,A=I.count;for(let B=U,O=U+A;B<O;B+=3)T(i[B+0]),T(i[B+1]),T(i[B+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new st(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let f=0,d=i.count;f<d;f++)i.setXYZ(f,0,0,0);const n=new L,r=new L,s=new L,o=new L,a=new L,c=new L,h=new L,u=new L;if(e)for(let f=0,d=e.count;f<d;f+=3){const g=e.getX(f+0),p=e.getX(f+1),m=e.getX(f+2);n.fromBufferAttribute(t,g),r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,m),h.subVectors(s,r),u.subVectors(n,r),h.cross(u),o.fromBufferAttribute(i,g),a.fromBufferAttribute(i,p),c.fromBufferAttribute(i,m),o.add(h),a.add(h),c.add(h),i.setXYZ(g,o.x,o.y,o.z),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(m,c.x,c.y,c.z)}else for(let f=0,d=t.count;f<d;f+=3)n.fromBufferAttribute(t,f+0),r.fromBufferAttribute(t,f+1),s.fromBufferAttribute(t,f+2),h.subVectors(s,r),u.subVectors(n,r),h.cross(u),i.setXYZ(f+0,h.x,h.y,h.z),i.setXYZ(f+1,h.x,h.y,h.z),i.setXYZ(f+2,h.x,h.y,h.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(e,t){if(!(e&&e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);return}t===void 0&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const i=this.attributes;for(const n in i){if(e.attributes[n]===void 0)continue;const s=i[n].array,o=e.attributes[n],a=o.array,c=o.itemSize*t,h=Math.min(a.length,s.length-c);for(let u=0,f=c;u<h;u++,f++)s[f]=a[u]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Ft.fromBufferAttribute(e,t),Ft.normalize(),e.setXYZ(t,Ft.x,Ft.y,Ft.z)}toNonIndexed(){function e(o,a){const c=o.array,h=o.itemSize,u=o.normalized,f=new c.constructor(a.length*h);let d=0,g=0;for(let p=0,m=a.length;p<m;p++){o.isInterleavedBufferAttribute?d=a[p]*o.data.stride+o.offset:d=a[p]*h;for(let _=0;_<h;_++)f[g++]=c[d++]}return new st(f,h,u)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new ze,i=this.index.array,n=this.attributes;for(const o in n){const a=n[o],c=e(a,i);t.setAttribute(o,c)}const r=this.morphAttributes;for(const o in r){const a=[],c=r[o];for(let h=0,u=c.length;h<u;h++){const f=c[h],d=e(f,i);a.push(d)}t.morphAttributes[o]=a}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let o=0,a=s.length;o<a;o++){const c=s[o];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const a=this.parameters;for(const c in a)a[c]!==void 0&&(e[c]=a[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const a in i){const c=i[a];e.data.attributes[a]=c.toJSON(e.data)}const n={};let r=!1;for(const a in this.morphAttributes){const c=this.morphAttributes[a],h=[];for(let u=0,f=c.length;u<f;u++){const d=c[u];h.push(d.toJSON(e.data))}h.length>0&&(n[a]=h,r=!0)}r&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(t));const n=e.attributes;for(const c in n){const h=n[c];this.setAttribute(c,h.clone(t))}const r=e.morphAttributes;for(const c in r){const h=[],u=r[c];for(let f=0,d=u.length;f<d;f++)h.push(u[f].clone(t));this.morphAttributes[c]=h}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let c=0,h=s.length;c<h;c++){const u=s[c];this.addGroup(u.start,u.count,u.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const a=e.boundingSphere;return a!==null&&(this.boundingSphere=a.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const Dd=new Ne,Ps=new Wa,bh=new ki,Zi=new L,ji=new L,Ji=new L,wh=new L,Mh=new L,Sh=new L,_l=new L,xl=new L,vl=new L,yl=new pe,bl=new pe,wl=new pe,Th=new L,Ml=new L;class ht extends $e{constructor(e=new ze,t=new kt){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const n=t[i[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,s=n.length;r<s;r++){const o=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=r}}}}raycast(e,t){const i=this.geometry,n=this.material,r=this.matrixWorld;if(n===void 0||(i.boundingSphere===null&&i.computeBoundingSphere(),bh.copy(i.boundingSphere),bh.applyMatrix4(r),e.ray.intersectsSphere(bh)===!1)||(Dd.copy(r).invert(),Ps.copy(e.ray).applyMatrix4(Dd),i.boundingBox!==null&&Ps.intersectsBox(i.boundingBox)===!1))return;let s;const o=i.index,a=i.attributes.position,c=i.morphAttributes.position,h=i.morphTargetsRelative,u=i.attributes.uv,f=i.attributes.uv2,d=i.groups,g=i.drawRange;if(o!==null)if(Array.isArray(n))for(let p=0,m=d.length;p<m;p++){const _=d[p],x=n[_.materialIndex],b=Math.max(_.start,g.start),y=Math.min(o.count,Math.min(_.start+_.count,g.start+g.count));for(let v=b,M=y;v<M;v+=3){const S=o.getX(v),w=o.getX(v+1),T=o.getX(v+2);s=Sl(this,x,e,Ps,a,c,h,u,f,S,w,T),s&&(s.faceIndex=Math.floor(v/3),s.face.materialIndex=_.materialIndex,t.push(s))}}else{const p=Math.max(0,g.start),m=Math.min(o.count,g.start+g.count);for(let _=p,x=m;_<x;_+=3){const b=o.getX(_),y=o.getX(_+1),v=o.getX(_+2);s=Sl(this,n,e,Ps,a,c,h,u,f,b,y,v),s&&(s.faceIndex=Math.floor(_/3),t.push(s))}}else if(a!==void 0)if(Array.isArray(n))for(let p=0,m=d.length;p<m;p++){const _=d[p],x=n[_.materialIndex],b=Math.max(_.start,g.start),y=Math.min(a.count,Math.min(_.start+_.count,g.start+g.count));for(let v=b,M=y;v<M;v+=3){const S=v,w=v+1,T=v+2;s=Sl(this,x,e,Ps,a,c,h,u,f,S,w,T),s&&(s.faceIndex=Math.floor(v/3),s.face.materialIndex=_.materialIndex,t.push(s))}}else{const p=Math.max(0,g.start),m=Math.min(a.count,g.start+g.count);for(let _=p,x=m;_<x;_+=3){const b=_,y=_+1,v=_+2;s=Sl(this,n,e,Ps,a,c,h,u,f,b,y,v),s&&(s.faceIndex=Math.floor(_/3),t.push(s))}}}}function b_(l,e,t,i,n,r,s,o){let a;if(e.side===tn?a=i.intersectTriangle(s,r,n,!0,o):a=i.intersectTriangle(n,r,s,e.side!==ui,o),a===null)return null;Ml.copy(o),Ml.applyMatrix4(l.matrixWorld);const c=t.ray.origin.distanceTo(Ml);return c<t.near||c>t.far?null:{distance:c,point:Ml.clone(),object:l}}function Sl(l,e,t,i,n,r,s,o,a,c,h,u){Zi.fromBufferAttribute(n,c),ji.fromBufferAttribute(n,h),Ji.fromBufferAttribute(n,u);const f=l.morphTargetInfluences;if(r&&f){_l.set(0,0,0),xl.set(0,0,0),vl.set(0,0,0);for(let g=0,p=r.length;g<p;g++){const m=f[g],_=r[g];m!==0&&(wh.fromBufferAttribute(_,c),Mh.fromBufferAttribute(_,h),Sh.fromBufferAttribute(_,u),s?(_l.addScaledVector(wh,m),xl.addScaledVector(Mh,m),vl.addScaledVector(Sh,m)):(_l.addScaledVector(wh.sub(Zi),m),xl.addScaledVector(Mh.sub(ji),m),vl.addScaledVector(Sh.sub(Ji),m)))}Zi.add(_l),ji.add(xl),Ji.add(vl)}l.isSkinnedMesh&&(l.boneTransform(c,Zi),l.boneTransform(h,ji),l.boneTransform(u,Ji));const d=b_(l,e,t,i,Zi,ji,Ji,Th);if(d){o&&(yl.fromBufferAttribute(o,c),bl.fromBufferAttribute(o,h),wl.fromBufferAttribute(o,u),d.uv=Pn.getUV(Th,Zi,ji,Ji,yl,bl,wl,new pe)),a&&(yl.fromBufferAttribute(a,c),bl.fromBufferAttribute(a,h),wl.fromBufferAttribute(a,u),d.uv2=Pn.getUV(Th,Zi,ji,Ji,yl,bl,wl,new pe));const g={a:c,b:h,c:u,normal:new L,materialIndex:0};Pn.getNormal(Zi,ji,Ji,g.normal),d.face=g}return d}class fi extends ze{constructor(e=1,t=1,i=1,n=1,r=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:n,heightSegments:r,depthSegments:s};const o=this;n=Math.floor(n),r=Math.floor(r),s=Math.floor(s);const a=[],c=[],h=[],u=[];let f=0,d=0;g("z","y","x",-1,-1,i,t,e,s,r,0),g("z","y","x",1,-1,i,t,-e,s,r,1),g("x","z","y",1,1,e,i,t,n,s,2),g("x","z","y",1,-1,e,i,-t,n,s,3),g("x","y","z",1,-1,e,t,i,n,r,4),g("x","y","z",-1,-1,e,t,-i,n,r,5),this.setIndex(a),this.setAttribute("position",new Fe(c,3)),this.setAttribute("normal",new Fe(h,3)),this.setAttribute("uv",new Fe(u,2));function g(p,m,_,x,b,y,v,M,S,w,T){const R=y/S,D=v/w,I=y/2,U=v/2,A=M/2,B=S+1,O=w+1;let q=0,Z=0;const k=new L;for(let V=0;V<O;V++){const F=V*D-U;for(let z=0;z<B;z++){const X=z*R-I;k[p]=X*x,k[m]=F*b,k[_]=A,c.push(k.x,k.y,k.z),k[p]=0,k[m]=0,k[_]=M>0?1:-1,h.push(k.x,k.y,k.z),u.push(z/S),u.push(1-V/w),q+=1}}for(let V=0;V<w;V++)for(let F=0;F<S;F++){const z=f+F+B*V,X=f+F+B*(V+1),j=f+(F+1)+B*(V+1),K=f+(F+1)+B*V;a.push(z,X,K),a.push(X,j,K),Z+=6}o.addGroup(d,Z,T),d+=Z,f+=q}}static fromJSON(e){return new fi(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function ao(l){const e={};for(const t in l){e[t]={};for(const i in l[t]){const n=l[t][i];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?e[t][i]=n.clone():Array.isArray(n)?e[t][i]=n.slice():e[t][i]=n}}return e}function Xt(l){const e={};for(let t=0;t<l.length;t++){const i=ao(l[t]);for(const n in i)e[n]=i[n]}return e}const mf={clone:ao,merge:Xt};var w_=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,M_=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class di extends bt{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=w_,this.fragmentShader=M_,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ao(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const n in this.uniforms){const s=this.uniforms[n].value;s&&s.isTexture?t.uniforms[n]={type:"t",value:s.toJSON(e).uuid}:s&&s.isColor?t.uniforms[n]={type:"c",value:s.getHex()}:s&&s.isVector2?t.uniforms[n]={type:"v2",value:s.toArray()}:s&&s.isVector3?t.uniforms[n]={type:"v3",value:s.toArray()}:s&&s.isVector4?t.uniforms[n]={type:"v4",value:s.toArray()}:s&&s.isMatrix3?t.uniforms[n]={type:"m3",value:s.toArray()}:s&&s.isMatrix4?t.uniforms[n]={type:"m4",value:s.toArray()}:t.uniforms[n]={value:s}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const i={};for(const n in this.extensions)this.extensions[n]===!0&&(i[n]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class Ec extends $e{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ne,this.projectionMatrix=new Ne,this.projectionMatrixInverse=new Ne}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Dt extends Ec{constructor(e=50,t=1,i=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Ta*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan($r*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Ta*2*Math.atan(Math.tan($r*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,n,r,s){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan($r*.5*this.fov)/this.zoom,i=2*t,n=this.aspect*i,r=-.5*n;const s=this.view;if(this.view!==null&&this.view.enabled){const a=s.fullWidth,c=s.fullHeight;r+=s.offsetX*n/a,t-=s.offsetY*i/c,n*=s.width/a,i*=s.height/c}const o=this.filmOffset;o!==0&&(r+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+n,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Ds=90,Is=1;class O0 extends $e{constructor(e,t,i){if(super(),this.type="CubeCamera",i.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=i;const n=new Dt(Ds,Is,e,t);n.layers=this.layers,n.up.set(0,-1,0),n.lookAt(new L(1,0,0)),this.add(n);const r=new Dt(Ds,Is,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new L(-1,0,0)),this.add(r);const s=new Dt(Ds,Is,e,t);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(new L(0,1,0)),this.add(s);const o=new Dt(Ds,Is,e,t);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(new L(0,-1,0)),this.add(o);const a=new Dt(Ds,Is,e,t);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new L(0,0,1)),this.add(a);const c=new Dt(Ds,Is,e,t);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new L(0,0,-1)),this.add(c)}update(e,t){this.parent===null&&this.updateMatrixWorld();const i=this.renderTarget,[n,r,s,o,a,c]=this.children,h=e.getRenderTarget(),u=e.toneMapping,f=e.xr.enabled;e.toneMapping=li,e.xr.enabled=!1;const d=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,n),e.setRenderTarget(i,1),e.render(t,r),e.setRenderTarget(i,2),e.render(t,s),e.setRenderTarget(i,3),e.render(t,o),e.setRenderTarget(i,4),e.render(t,a),i.texture.generateMipmaps=d,e.setRenderTarget(i,5),e.render(t,c),e.setRenderTarget(h),e.toneMapping=u,e.xr.enabled=f,i.texture.needsPMREMUpdate=!0}}class Xa extends wt{constructor(e,t,i,n,r,s,o,a,c,h){e=e!==void 0?e:[],t=t!==void 0?t:hr,super(e,t,i,n,r,s,o,a,c,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class U0 extends Mn{constructor(e,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},n=[i,i,i,i,i,i];this.texture=new Xa(n,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:dt}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},n=new fi(5,5,5),r=new di({name:"CubemapFromEquirect",uniforms:ao(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:tn,blending:Ei});r.uniforms.tEquirect.value=t;const s=new ht(n,r),o=t.minFilter;return t.minFilter===Ui&&(t.minFilter=dt),new O0(1,10,this).update(e,s),t.minFilter=o,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,i,n){const r=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,i,n);e.setRenderTarget(r)}}const Ch=new L,S_=new L,T_=new yn;class er{constructor(e=new L(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,n){return this.normal.set(e,t,i),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const n=Ch.subVectors(i,t).cross(S_.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const i=e.delta(Ch),n=this.normal.dot(i);if(n===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/n;return r<0||r>1?null:t.copy(i).multiplyScalar(r).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||T_.getNormalMatrix(e),n=this.coplanarPoint(Ch).applyMatrix4(e),r=this.normal.applyMatrix3(i).normalize();return this.constant=-n.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Fs=new ki,Tl=new L;class Lc{constructor(e=new er,t=new er,i=new er,n=new er,r=new er,s=new er){this.planes=[e,t,i,n,r,s]}set(e,t,i,n,r,s){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(i),o[3].copy(n),o[4].copy(r),o[5].copy(s),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const t=this.planes,i=e.elements,n=i[0],r=i[1],s=i[2],o=i[3],a=i[4],c=i[5],h=i[6],u=i[7],f=i[8],d=i[9],g=i[10],p=i[11],m=i[12],_=i[13],x=i[14],b=i[15];return t[0].setComponents(o-n,u-a,p-f,b-m).normalize(),t[1].setComponents(o+n,u+a,p+f,b+m).normalize(),t[2].setComponents(o+r,u+c,p+d,b+_).normalize(),t[3].setComponents(o-r,u-c,p-d,b-_).normalize(),t[4].setComponents(o-s,u-h,p-g,b-x).normalize(),t[5].setComponents(o+s,u+h,p+g,b+x).normalize(),this}intersectsObject(e){const t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Fs.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Fs)}intersectsSprite(e){return Fs.center.set(0,0,0),Fs.radius=.7071067811865476,Fs.applyMatrix4(e.matrixWorld),this.intersectsSphere(Fs)}intersectsSphere(e){const t=this.planes,i=e.center,n=-e.radius;for(let r=0;r<6;r++)if(t[r].distanceToPoint(i)<n)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const n=t[i];if(Tl.x=n.normal.x>0?e.max.x:e.min.x,Tl.y=n.normal.y>0?e.max.y:e.min.y,Tl.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(Tl)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function k0(){let l=null,e=!1,t=null,i=null;function n(r,s){t(r,s),i=l.requestAnimationFrame(n)}return{start:function(){e!==!0&&t!==null&&(i=l.requestAnimationFrame(n),e=!0)},stop:function(){l.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(r){t=r},setContext:function(r){l=r}}}function C_(l,e){const t=e.isWebGL2,i=new WeakMap;function n(c,h){const u=c.array,f=c.usage,d=l.createBuffer();l.bindBuffer(h,d),l.bufferData(h,u,f),c.onUploadCallback();let g;if(u instanceof Float32Array)g=5126;else if(u instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(t)g=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else g=5123;else if(u instanceof Int16Array)g=5122;else if(u instanceof Uint32Array)g=5125;else if(u instanceof Int32Array)g=5124;else if(u instanceof Int8Array)g=5120;else if(u instanceof Uint8Array)g=5121;else if(u instanceof Uint8ClampedArray)g=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:d,type:g,bytesPerElement:u.BYTES_PER_ELEMENT,version:c.version}}function r(c,h,u){const f=h.array,d=h.updateRange;l.bindBuffer(u,c),d.count===-1?l.bufferSubData(u,0,f):(t?l.bufferSubData(u,d.offset*f.BYTES_PER_ELEMENT,f,d.offset,d.count):l.bufferSubData(u,d.offset*f.BYTES_PER_ELEMENT,f.subarray(d.offset,d.offset+d.count)),d.count=-1)}function s(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)}function o(c){c.isInterleavedBufferAttribute&&(c=c.data);const h=i.get(c);h&&(l.deleteBuffer(h.buffer),i.delete(c))}function a(c,h){if(c.isGLBufferAttribute){const f=i.get(c);(!f||f.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);const u=i.get(c);u===void 0?i.set(c,n(c,h)):u.version<c.version&&(r(u.buffer,c,h),u.version=c.version)}return{get:s,remove:o,update:a}}class Zn extends ze{constructor(e=1,t=1,i=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:n};const r=e/2,s=t/2,o=Math.floor(i),a=Math.floor(n),c=o+1,h=a+1,u=e/o,f=t/a,d=[],g=[],p=[],m=[];for(let _=0;_<h;_++){const x=_*f-s;for(let b=0;b<c;b++){const y=b*u-r;g.push(y,-x,0),p.push(0,0,1),m.push(b/o),m.push(1-_/a)}}for(let _=0;_<a;_++)for(let x=0;x<o;x++){const b=x+c*_,y=x+c*(_+1),v=x+1+c*(_+1),M=x+1+c*_;d.push(b,y,M),d.push(y,v,M)}this.setIndex(d),this.setAttribute("position",new Fe(g,3)),this.setAttribute("normal",new Fe(p,3)),this.setAttribute("uv",new Fe(m,2))}static fromJSON(e){return new Zn(e.width,e.height,e.widthSegments,e.heightSegments)}}var A_=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,E_=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,L_=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,R_=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,P_=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,D_=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,I_="vec3 transformed = vec3( position );",F_=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,O_=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = mix(F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence);
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,U_=`#ifdef USE_IRIDESCENCE
const mat3 XYZ_TO_REC709 = mat3(
    3.2404542, -0.9692660,  0.0556434,
   -1.5371385,  1.8760108, -0.2040259,
   -0.4985314,  0.0415560,  1.0572252
);
vec3 Fresnel0ToIor( vec3 fresnel0 ) {
   vec3 sqrtF0 = sqrt( fresnel0 );
   return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
}
vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
   return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
}
float IorToFresnel0( float transmittedIor, float incidentIor ) {
   return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
}
vec3 evalSensitivity( float OPD, vec3 shift ) {
   float phase = 2.0 * PI * OPD * 1.0e-9;
   vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
   vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
   vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
   vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( -pow2( phase ) * var );
   xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[0] ) * exp( -4.5282e+09 * pow2( phase ) );
   xyz /= 1.0685e-7;
   vec3 srgb = XYZ_TO_REC709 * xyz;
   return srgb;
}
vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
   vec3 I;
   float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
   float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
   float cosTheta2Sq = 1.0 - sinTheta2Sq;
   if ( cosTheta2Sq < 0.0 ) {
       return vec3( 1.0 );
   }
   float cosTheta2 = sqrt( cosTheta2Sq );
   float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
   float R12 = F_Schlick( R0, 1.0, cosTheta1 );
   float R21 = R12;
   float T121 = 1.0 - R12;
   float phi12 = 0.0;
   if ( iridescenceIOR < outsideIOR ) phi12 = PI;
   float phi21 = PI - phi12;
   vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );   vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
   vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
   vec3 phi23 = vec3( 0.0 );
   if ( baseIOR[0] < iridescenceIOR ) phi23[0] = PI;
   if ( baseIOR[1] < iridescenceIOR ) phi23[1] = PI;
   if ( baseIOR[2] < iridescenceIOR ) phi23[2] = PI;
   float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
   vec3 phi = vec3( phi21 ) + phi23;
   vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
   vec3 r123 = sqrt( R123 );
   vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
   vec3 C0 = R12 + Rs;
   I = C0;
   vec3 Cm = Rs - T121;
   for ( int m = 1; m <= 2; ++m ) {
       Cm *= r123;
       vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
       I += Cm * Sm;
   }
   return max( I, vec3( 0.0 ) );
}
#endif`,k_=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,N_=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,B_=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,z_=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,G_=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,V_=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,H_=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,W_=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,X_=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,q_=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,Y_=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Z_=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,j_=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,J_=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,K_=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Q_=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,$_="gl_FragColor = linearToOutputTexel( gl_FragColor );",ex=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,tx=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,nx=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,ix=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,rx=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,sx=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,ox=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,ax=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,lx=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,cx=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,hx=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,ux=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,fx=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,dx=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointLightInfo( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotLightInfo( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
		#endif
	}
	#pragma unroll_loop_end
#endif`,px=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,mx=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,gx=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,_x=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,xx=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,vx=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,yx=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,bx=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,wx=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
float dotNVi = saturate( dot( normal, geometry.viewDir ) );
if ( material.iridescenceThickness == 0.0 ) {
	material.iridescence = 0.0;
} else {
	material.iridescence = saturate( material.iridescence );
}
if ( material.iridescence > 0.0 ) {
	material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
	material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Mx=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Sx=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,Tx=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Cx=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Ax=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Ex=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,Lx=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Rx=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Px=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Dx=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Ix=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Fx=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Ox=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Ux=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,kx=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Nx=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Bx=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,zx=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Gx=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Vx=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Hx=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Wx=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,Xx=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,qx=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,Yx=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,Zx=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,jx=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Jx=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,Kx=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Qx=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,$x=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,ev=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,tv=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,nv=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,iv=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,rv=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,sv=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,ov=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,av=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,lv=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,cv=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,hv=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,uv=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,fv=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,dv=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,pv=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,mv=`#ifdef USE_TRANSMISSION
	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );
#endif`,gv=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,_v=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,xv=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,vv=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,yv=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,bv=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,wv=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,Mv=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Sv=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Tv=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	gl_FragColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		gl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );
	#endif
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Cv=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Av=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Ev=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Lv=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Rv=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Pv=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Dv=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Iv=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Fv=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Ov=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Uv=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,kv=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Nv=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Bv=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,zv=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Gv=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Vv=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Hv=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Wv=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Xv=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,qv=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Yv=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Zv=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,jv=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Jv=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Kv=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Qv=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,$v=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,ey=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,ty=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,He={alphamap_fragment:A_,alphamap_pars_fragment:E_,alphatest_fragment:L_,alphatest_pars_fragment:R_,aomap_fragment:P_,aomap_pars_fragment:D_,begin_vertex:I_,beginnormal_vertex:F_,bsdfs:O_,iridescence_fragment:U_,bumpmap_pars_fragment:k_,clipping_planes_fragment:N_,clipping_planes_pars_fragment:B_,clipping_planes_pars_vertex:z_,clipping_planes_vertex:G_,color_fragment:V_,color_pars_fragment:H_,color_pars_vertex:W_,color_vertex:X_,common:q_,cube_uv_reflection_fragment:Y_,defaultnormal_vertex:Z_,displacementmap_pars_vertex:j_,displacementmap_vertex:J_,emissivemap_fragment:K_,emissivemap_pars_fragment:Q_,encodings_fragment:$_,encodings_pars_fragment:ex,envmap_fragment:tx,envmap_common_pars_fragment:nx,envmap_pars_fragment:ix,envmap_pars_vertex:rx,envmap_physical_pars_fragment:mx,envmap_vertex:sx,fog_vertex:ox,fog_pars_vertex:ax,fog_fragment:lx,fog_pars_fragment:cx,gradientmap_pars_fragment:hx,lightmap_fragment:ux,lightmap_pars_fragment:fx,lights_lambert_vertex:dx,lights_pars_begin:px,lights_toon_fragment:gx,lights_toon_pars_fragment:_x,lights_phong_fragment:xx,lights_phong_pars_fragment:vx,lights_physical_fragment:yx,lights_physical_pars_fragment:bx,lights_fragment_begin:wx,lights_fragment_maps:Mx,lights_fragment_end:Sx,logdepthbuf_fragment:Tx,logdepthbuf_pars_fragment:Cx,logdepthbuf_pars_vertex:Ax,logdepthbuf_vertex:Ex,map_fragment:Lx,map_pars_fragment:Rx,map_particle_fragment:Px,map_particle_pars_fragment:Dx,metalnessmap_fragment:Ix,metalnessmap_pars_fragment:Fx,morphcolor_vertex:Ox,morphnormal_vertex:Ux,morphtarget_pars_vertex:kx,morphtarget_vertex:Nx,normal_fragment_begin:Bx,normal_fragment_maps:zx,normal_pars_fragment:Gx,normal_pars_vertex:Vx,normal_vertex:Hx,normalmap_pars_fragment:Wx,clearcoat_normal_fragment_begin:Xx,clearcoat_normal_fragment_maps:qx,clearcoat_pars_fragment:Yx,iridescence_pars_fragment:Zx,output_fragment:jx,packing:Jx,premultiplied_alpha_fragment:Kx,project_vertex:Qx,dithering_fragment:$x,dithering_pars_fragment:ev,roughnessmap_fragment:tv,roughnessmap_pars_fragment:nv,shadowmap_pars_fragment:iv,shadowmap_pars_vertex:rv,shadowmap_vertex:sv,shadowmask_pars_fragment:ov,skinbase_vertex:av,skinning_pars_vertex:lv,skinning_vertex:cv,skinnormal_vertex:hv,specularmap_fragment:uv,specularmap_pars_fragment:fv,tonemapping_fragment:dv,tonemapping_pars_fragment:pv,transmission_fragment:mv,transmission_pars_fragment:gv,uv_pars_fragment:_v,uv_pars_vertex:xv,uv_vertex:vv,uv2_pars_fragment:yv,uv2_pars_vertex:bv,uv2_vertex:wv,worldpos_vertex:Mv,background_vert:Sv,background_frag:Tv,cube_vert:Cv,cube_frag:Av,depth_vert:Ev,depth_frag:Lv,distanceRGBA_vert:Rv,distanceRGBA_frag:Pv,equirect_vert:Dv,equirect_frag:Iv,linedashed_vert:Fv,linedashed_frag:Ov,meshbasic_vert:Uv,meshbasic_frag:kv,meshlambert_vert:Nv,meshlambert_frag:Bv,meshmatcap_vert:zv,meshmatcap_frag:Gv,meshnormal_vert:Vv,meshnormal_frag:Hv,meshphong_vert:Wv,meshphong_frag:Xv,meshphysical_vert:qv,meshphysical_frag:Yv,meshtoon_vert:Zv,meshtoon_frag:jv,points_vert:Jv,points_frag:Kv,shadow_vert:Qv,shadow_frag:$v,sprite_vert:ey,sprite_frag:ty},Re={common:{diffuse:{value:new Ae(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new yn},uv2Transform:{value:new yn},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new pe(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ae(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ae(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new yn}},sprite:{diffuse:{value:new Ae(16777215)},opacity:{value:1},center:{value:new pe(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new yn}}},Yn={basic:{uniforms:Xt([Re.common,Re.specularmap,Re.envmap,Re.aomap,Re.lightmap,Re.fog]),vertexShader:He.meshbasic_vert,fragmentShader:He.meshbasic_frag},lambert:{uniforms:Xt([Re.common,Re.specularmap,Re.envmap,Re.aomap,Re.lightmap,Re.emissivemap,Re.fog,Re.lights,{emissive:{value:new Ae(0)}}]),vertexShader:He.meshlambert_vert,fragmentShader:He.meshlambert_frag},phong:{uniforms:Xt([Re.common,Re.specularmap,Re.envmap,Re.aomap,Re.lightmap,Re.emissivemap,Re.bumpmap,Re.normalmap,Re.displacementmap,Re.fog,Re.lights,{emissive:{value:new Ae(0)},specular:{value:new Ae(1118481)},shininess:{value:30}}]),vertexShader:He.meshphong_vert,fragmentShader:He.meshphong_frag},standard:{uniforms:Xt([Re.common,Re.envmap,Re.aomap,Re.lightmap,Re.emissivemap,Re.bumpmap,Re.normalmap,Re.displacementmap,Re.roughnessmap,Re.metalnessmap,Re.fog,Re.lights,{emissive:{value:new Ae(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:He.meshphysical_vert,fragmentShader:He.meshphysical_frag},toon:{uniforms:Xt([Re.common,Re.aomap,Re.lightmap,Re.emissivemap,Re.bumpmap,Re.normalmap,Re.displacementmap,Re.gradientmap,Re.fog,Re.lights,{emissive:{value:new Ae(0)}}]),vertexShader:He.meshtoon_vert,fragmentShader:He.meshtoon_frag},matcap:{uniforms:Xt([Re.common,Re.bumpmap,Re.normalmap,Re.displacementmap,Re.fog,{matcap:{value:null}}]),vertexShader:He.meshmatcap_vert,fragmentShader:He.meshmatcap_frag},points:{uniforms:Xt([Re.points,Re.fog]),vertexShader:He.points_vert,fragmentShader:He.points_frag},dashed:{uniforms:Xt([Re.common,Re.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:He.linedashed_vert,fragmentShader:He.linedashed_frag},depth:{uniforms:Xt([Re.common,Re.displacementmap]),vertexShader:He.depth_vert,fragmentShader:He.depth_frag},normal:{uniforms:Xt([Re.common,Re.bumpmap,Re.normalmap,Re.displacementmap,{opacity:{value:1}}]),vertexShader:He.meshnormal_vert,fragmentShader:He.meshnormal_frag},sprite:{uniforms:Xt([Re.sprite,Re.fog]),vertexShader:He.sprite_vert,fragmentShader:He.sprite_frag},background:{uniforms:{uvTransform:{value:new yn},t2D:{value:null}},vertexShader:He.background_vert,fragmentShader:He.background_frag},cube:{uniforms:Xt([Re.envmap,{opacity:{value:1}}]),vertexShader:He.cube_vert,fragmentShader:He.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:He.equirect_vert,fragmentShader:He.equirect_frag},distanceRGBA:{uniforms:Xt([Re.common,Re.displacementmap,{referencePosition:{value:new L},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:He.distanceRGBA_vert,fragmentShader:He.distanceRGBA_frag},shadow:{uniforms:Xt([Re.lights,Re.fog,{color:{value:new Ae(0)},opacity:{value:1}}]),vertexShader:He.shadow_vert,fragmentShader:He.shadow_frag}};Yn.physical={uniforms:Xt([Yn.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new pe(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Ae(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new pe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Ae(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Ae(1,1,1)},specularColorMap:{value:null}}]),vertexShader:He.meshphysical_vert,fragmentShader:He.meshphysical_frag};function ny(l,e,t,i,n,r){const s=new Ae(0);let o=n===!0?0:1,a,c,h=null,u=0,f=null;function d(p,m){let _=!1,x=m.isScene===!0?m.background:null;x&&x.isTexture&&(x=e.get(x));const b=l.xr,y=b.getSession&&b.getSession();y&&y.environmentBlendMode==="additive"&&(x=null),x===null?g(s,o):x&&x.isColor&&(g(x,1),_=!0),(l.autoClear||_)&&l.clear(l.autoClearColor,l.autoClearDepth,l.autoClearStencil),x&&(x.isCubeTexture||x.mapping===Lo)?(c===void 0&&(c=new ht(new fi(1,1,1),new di({name:"BackgroundCubeMaterial",uniforms:ao(Yn.cube.uniforms),vertexShader:Yn.cube.vertexShader,fragmentShader:Yn.cube.fragmentShader,side:tn,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(v,M,S){this.matrixWorld.copyPosition(S.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),c.material.uniforms.envMap.value=x,c.material.uniforms.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,(h!==x||u!==x.version||f!==l.toneMapping)&&(c.material.needsUpdate=!0,h=x,u=x.version,f=l.toneMapping),c.layers.enableAll(),p.unshift(c,c.geometry,c.material,0,0,null)):x&&x.isTexture&&(a===void 0&&(a=new ht(new Zn(2,2),new di({name:"BackgroundMaterial",uniforms:ao(Yn.background.uniforms),vertexShader:Yn.background.vertexShader,fragmentShader:Yn.background.fragmentShader,side:Pi,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(a)),a.material.uniforms.t2D.value=x,x.matrixAutoUpdate===!0&&x.updateMatrix(),a.material.uniforms.uvTransform.value.copy(x.matrix),(h!==x||u!==x.version||f!==l.toneMapping)&&(a.material.needsUpdate=!0,h=x,u=x.version,f=l.toneMapping),a.layers.enableAll(),p.unshift(a,a.geometry,a.material,0,0,null))}function g(p,m){t.buffers.color.setClear(p.r,p.g,p.b,m,r)}return{getClearColor:function(){return s},setClearColor:function(p,m=1){s.set(p),o=m,g(s,o)},getClearAlpha:function(){return o},setClearAlpha:function(p){o=p,g(s,o)},render:d}}function iy(l,e,t,i){const n=l.getParameter(34921),r=i.isWebGL2?null:e.get("OES_vertex_array_object"),s=i.isWebGL2||r!==null,o={},a=m(null);let c=a,h=!1;function u(A,B,O,q,Z){let k=!1;if(s){const V=p(q,O,B);c!==V&&(c=V,d(c.object)),k=_(A,q,O,Z),k&&x(A,q,O,Z)}else{const V=B.wireframe===!0;(c.geometry!==q.id||c.program!==O.id||c.wireframe!==V)&&(c.geometry=q.id,c.program=O.id,c.wireframe=V,k=!0)}Z!==null&&t.update(Z,34963),(k||h)&&(h=!1,w(A,B,O,q),Z!==null&&l.bindBuffer(34963,t.get(Z).buffer))}function f(){return i.isWebGL2?l.createVertexArray():r.createVertexArrayOES()}function d(A){return i.isWebGL2?l.bindVertexArray(A):r.bindVertexArrayOES(A)}function g(A){return i.isWebGL2?l.deleteVertexArray(A):r.deleteVertexArrayOES(A)}function p(A,B,O){const q=O.wireframe===!0;let Z=o[A.id];Z===void 0&&(Z={},o[A.id]=Z);let k=Z[B.id];k===void 0&&(k={},Z[B.id]=k);let V=k[q];return V===void 0&&(V=m(f()),k[q]=V),V}function m(A){const B=[],O=[],q=[];for(let Z=0;Z<n;Z++)B[Z]=0,O[Z]=0,q[Z]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:B,enabledAttributes:O,attributeDivisors:q,object:A,attributes:{},index:null}}function _(A,B,O,q){const Z=c.attributes,k=B.attributes;let V=0;const F=O.getAttributes();for(const z in F)if(F[z].location>=0){const j=Z[z];let K=k[z];if(K===void 0&&(z==="instanceMatrix"&&A.instanceMatrix&&(K=A.instanceMatrix),z==="instanceColor"&&A.instanceColor&&(K=A.instanceColor)),j===void 0||j.attribute!==K||K&&j.data!==K.data)return!0;V++}return c.attributesNum!==V||c.index!==q}function x(A,B,O,q){const Z={},k=B.attributes;let V=0;const F=O.getAttributes();for(const z in F)if(F[z].location>=0){let j=k[z];j===void 0&&(z==="instanceMatrix"&&A.instanceMatrix&&(j=A.instanceMatrix),z==="instanceColor"&&A.instanceColor&&(j=A.instanceColor));const K={};K.attribute=j,j&&j.data&&(K.data=j.data),Z[z]=K,V++}c.attributes=Z,c.attributesNum=V,c.index=q}function b(){const A=c.newAttributes;for(let B=0,O=A.length;B<O;B++)A[B]=0}function y(A){v(A,0)}function v(A,B){const O=c.newAttributes,q=c.enabledAttributes,Z=c.attributeDivisors;O[A]=1,q[A]===0&&(l.enableVertexAttribArray(A),q[A]=1),Z[A]!==B&&((i.isWebGL2?l:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](A,B),Z[A]=B)}function M(){const A=c.newAttributes,B=c.enabledAttributes;for(let O=0,q=B.length;O<q;O++)B[O]!==A[O]&&(l.disableVertexAttribArray(O),B[O]=0)}function S(A,B,O,q,Z,k){i.isWebGL2===!0&&(O===5124||O===5125)?l.vertexAttribIPointer(A,B,O,Z,k):l.vertexAttribPointer(A,B,O,q,Z,k)}function w(A,B,O,q){if(i.isWebGL2===!1&&(A.isInstancedMesh||q.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;b();const Z=q.attributes,k=O.getAttributes(),V=B.defaultAttributeValues;for(const F in k){const z=k[F];if(z.location>=0){let X=Z[F];if(X===void 0&&(F==="instanceMatrix"&&A.instanceMatrix&&(X=A.instanceMatrix),F==="instanceColor"&&A.instanceColor&&(X=A.instanceColor)),X!==void 0){const j=X.normalized,K=X.itemSize,G=t.get(X);if(G===void 0)continue;const ee=G.buffer,ne=G.type,de=G.bytesPerElement;if(X.isInterleavedBufferAttribute){const le=X.data,ge=le.stride,W=X.offset;if(le.isInstancedInterleavedBuffer){for(let se=0;se<z.locationSize;se++)v(z.location+se,le.meshPerAttribute);A.isInstancedMesh!==!0&&q._maxInstanceCount===void 0&&(q._maxInstanceCount=le.meshPerAttribute*le.count)}else for(let se=0;se<z.locationSize;se++)y(z.location+se);l.bindBuffer(34962,ee);for(let se=0;se<z.locationSize;se++)S(z.location+se,K/z.locationSize,ne,j,ge*de,(W+K/z.locationSize*se)*de)}else{if(X.isInstancedBufferAttribute){for(let le=0;le<z.locationSize;le++)v(z.location+le,X.meshPerAttribute);A.isInstancedMesh!==!0&&q._maxInstanceCount===void 0&&(q._maxInstanceCount=X.meshPerAttribute*X.count)}else for(let le=0;le<z.locationSize;le++)y(z.location+le);l.bindBuffer(34962,ee);for(let le=0;le<z.locationSize;le++)S(z.location+le,K/z.locationSize,ne,j,K*de,K/z.locationSize*le*de)}}else if(V!==void 0){const j=V[F];if(j!==void 0)switch(j.length){case 2:l.vertexAttrib2fv(z.location,j);break;case 3:l.vertexAttrib3fv(z.location,j);break;case 4:l.vertexAttrib4fv(z.location,j);break;default:l.vertexAttrib1fv(z.location,j)}}}}M()}function T(){I();for(const A in o){const B=o[A];for(const O in B){const q=B[O];for(const Z in q)g(q[Z].object),delete q[Z];delete B[O]}delete o[A]}}function R(A){if(o[A.id]===void 0)return;const B=o[A.id];for(const O in B){const q=B[O];for(const Z in q)g(q[Z].object),delete q[Z];delete B[O]}delete o[A.id]}function D(A){for(const B in o){const O=o[B];if(O[A.id]===void 0)continue;const q=O[A.id];for(const Z in q)g(q[Z].object),delete q[Z];delete O[A.id]}}function I(){U(),h=!0,c!==a&&(c=a,d(c.object))}function U(){a.geometry=null,a.program=null,a.wireframe=!1}return{setup:u,reset:I,resetDefaultState:U,dispose:T,releaseStatesOfGeometry:R,releaseStatesOfProgram:D,initAttributes:b,enableAttribute:y,disableUnusedAttributes:M}}function ry(l,e,t,i){const n=i.isWebGL2;let r;function s(c){r=c}function o(c,h){l.drawArrays(r,c,h),t.update(h,r,1)}function a(c,h,u){if(u===0)return;let f,d;if(n)f=l,d="drawArraysInstanced";else if(f=e.get("ANGLE_instanced_arrays"),d="drawArraysInstancedANGLE",f===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}f[d](r,c,h,u),t.update(h,r,u)}this.setMode=s,this.render=o,this.renderInstances=a}function sy(l,e,t){let i;function n(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const S=e.get("EXT_texture_filter_anisotropic");i=l.getParameter(S.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function r(S){if(S==="highp"){if(l.getShaderPrecisionFormat(35633,36338).precision>0&&l.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";S="mediump"}return S==="mediump"&&l.getShaderPrecisionFormat(35633,36337).precision>0&&l.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const s=typeof WebGL2RenderingContext!="undefined"&&l instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&l instanceof WebGL2ComputeRenderingContext;let o=t.precision!==void 0?t.precision:"highp";const a=r(o);a!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",a,"instead."),o=a);const c=s||e.has("WEBGL_draw_buffers"),h=t.logarithmicDepthBuffer===!0,u=l.getParameter(34930),f=l.getParameter(35660),d=l.getParameter(3379),g=l.getParameter(34076),p=l.getParameter(34921),m=l.getParameter(36347),_=l.getParameter(36348),x=l.getParameter(36349),b=f>0,y=s||e.has("OES_texture_float"),v=b&&y,M=s?l.getParameter(36183):0;return{isWebGL2:s,drawBuffers:c,getMaxAnisotropy:n,getMaxPrecision:r,precision:o,logarithmicDepthBuffer:h,maxTextures:u,maxVertexTextures:f,maxTextureSize:d,maxCubemapSize:g,maxAttributes:p,maxVertexUniforms:m,maxVaryings:_,maxFragmentUniforms:x,vertexTextures:b,floatFragmentTextures:y,floatVertexTextures:v,maxSamples:M}}function oy(l){const e=this;let t=null,i=0,n=!1,r=!1;const s=new er,o=new yn,a={value:null,needsUpdate:!1};this.uniform=a,this.numPlanes=0,this.numIntersection=0,this.init=function(u,f,d){const g=u.length!==0||f||i!==0||n;return n=f,t=h(u,d,0),i=u.length,g},this.beginShadows=function(){r=!0,h(null)},this.endShadows=function(){r=!1,c()},this.setState=function(u,f,d){const g=u.clippingPlanes,p=u.clipIntersection,m=u.clipShadows,_=l.get(u);if(!n||g===null||g.length===0||r&&!m)r?h(null):c();else{const x=r?0:i,b=x*4;let y=_.clippingState||null;a.value=y,y=h(g,f,b,d);for(let v=0;v!==b;++v)y[v]=t[v];_.clippingState=y,this.numIntersection=p?this.numPlanes:0,this.numPlanes+=x}};function c(){a.value!==t&&(a.value=t,a.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function h(u,f,d,g){const p=u!==null?u.length:0;let m=null;if(p!==0){if(m=a.value,g!==!0||m===null){const _=d+p*4,x=f.matrixWorldInverse;o.getNormalMatrix(x),(m===null||m.length<_)&&(m=new Float32Array(_));for(let b=0,y=d;b!==p;++b,y+=4)s.copy(u[b]).applyMatrix4(x,o),s.normal.toArray(m,y),m[y+3]=s.constant}a.value=m,a.needsUpdate=!0}return e.numPlanes=p,e.numIntersection=0,m}}function ay(l){let e=new WeakMap;function t(s,o){return o===ya?s.mapping=hr:o===ba&&(s.mapping=ur),s}function i(s){if(s&&s.isTexture&&s.isRenderTargetTexture===!1){const o=s.mapping;if(o===ya||o===ba)if(e.has(s)){const a=e.get(s).texture;return t(a,s.mapping)}else{const a=s.image;if(a&&a.height>0){const c=new U0(a.height/2);return c.fromEquirectangularTexture(l,s),e.set(s,c),s.addEventListener("dispose",n),t(c.texture,s.mapping)}else return null}}return s}function n(s){const o=s.target;o.removeEventListener("dispose",n);const a=e.get(o);a!==void 0&&(e.delete(o),a.dispose())}function r(){e=new WeakMap}return{get:i,dispose:r}}class qa extends Ec{constructor(e=-1,t=1,i=1,n=-1,r=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=n,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,n,r,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2;let r=i-e,s=i+e,o=n+t,a=n-t;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=c*this.view.offsetX,s=r+c*this.view.width,o-=h*this.view.offsetY,a=o-h*this.view.height}this.projectionMatrix.makeOrthographic(r,s,o,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const qs=4,Id=[.125,.215,.35,.446,.526,.582],Wr=20,Ah=new qa,Fd=new Ae;let Eh=null;const Br=(1+Math.sqrt(5))/2,Os=1/Br,Od=[new L(1,1,1),new L(-1,1,1),new L(1,1,-1),new L(-1,1,-1),new L(0,Br,Os),new L(0,Br,-Os),new L(Os,0,Br),new L(-Os,0,Br),new L(Br,Os,0),new L(-Br,Os,0)];class Fu{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,n=100){Eh=this._renderer.getRenderTarget(),this._setSize(256);const r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(e,i,n,r),t>0&&this._blur(r,0,0,t),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Nd(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=kd(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Eh),e.scissorTest=!1,Cl(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===hr||e.mapping===ur?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Eh=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:dt,minFilter:dt,generateMipmaps:!1,type:so,format:vn,encoding:pr,depthBuffer:!1},n=Ud(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Ud(e,t,i);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=ly(r)),this._blurMaterial=cy(r,e,t)}return n}_compileMaterial(e){const t=new ht(this._lodPlanes[0],e);this._renderer.compile(t,Ah)}_sceneToCubeUV(e,t,i,n){const o=new Dt(90,1,t,i),a=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],h=this._renderer,u=h.autoClear,f=h.toneMapping;h.getClearColor(Fd),h.toneMapping=li,h.autoClear=!1;const d=new kt({name:"PMREM.Background",side:tn,depthWrite:!1,depthTest:!1}),g=new ht(new fi,d);let p=!1;const m=e.background;m?m.isColor&&(d.color.copy(m),e.background=null,p=!0):(d.color.copy(Fd),p=!0);for(let _=0;_<6;_++){const x=_%3;x===0?(o.up.set(0,a[_],0),o.lookAt(c[_],0,0)):x===1?(o.up.set(0,0,a[_]),o.lookAt(0,c[_],0)):(o.up.set(0,a[_],0),o.lookAt(0,0,c[_]));const b=this._cubeSize;Cl(n,x*b,_>2?b:0,b,b),h.setRenderTarget(n),p&&h.render(g,o),h.render(e,o)}g.geometry.dispose(),g.material.dispose(),h.toneMapping=f,h.autoClear=u,e.background=m}_textureToCubeUV(e,t){const i=this._renderer,n=e.mapping===hr||e.mapping===ur;n?(this._cubemapMaterial===null&&(this._cubemapMaterial=Nd()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=kd());const r=n?this._cubemapMaterial:this._equirectMaterial,s=new ht(this._lodPlanes[0],r),o=r.uniforms;o.envMap.value=e;const a=this._cubeSize;Cl(t,0,0,3*a,2*a),i.setRenderTarget(t),i.render(s,Ah)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let n=1;n<this._lodPlanes.length;n++){const r=Math.sqrt(this._sigmas[n]*this._sigmas[n]-this._sigmas[n-1]*this._sigmas[n-1]),s=Od[(n-1)%Od.length];this._blur(e,n-1,n,r,s)}t.autoClear=i}_blur(e,t,i,n,r){const s=this._pingPongRenderTarget;this._halfBlur(e,s,t,i,n,"latitudinal",r),this._halfBlur(s,e,i,i,n,"longitudinal",r)}_halfBlur(e,t,i,n,r,s,o){const a=this._renderer,c=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const h=3,u=new ht(this._lodPlanes[n],c),f=c.uniforms,d=this._sizeLods[i]-1,g=isFinite(r)?Math.PI/(2*d):2*Math.PI/(2*Wr-1),p=r/g,m=isFinite(r)?1+Math.floor(h*p):Wr;m>Wr&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${Wr}`);const _=[];let x=0;for(let S=0;S<Wr;++S){const w=S/p,T=Math.exp(-w*w/2);_.push(T),S===0?x+=T:S<m&&(x+=2*T)}for(let S=0;S<_.length;S++)_[S]=_[S]/x;f.envMap.value=e.texture,f.samples.value=m,f.weights.value=_,f.latitudinal.value=s==="latitudinal",o&&(f.poleAxis.value=o);const{_lodMax:b}=this;f.dTheta.value=g,f.mipInt.value=b-i;const y=this._sizeLods[n],v=3*y*(n>b-qs?n-b+qs:0),M=4*(this._cubeSize-y);Cl(t,v,M,3*y,2*y),a.setRenderTarget(t),a.render(u,Ah)}}function ly(l){const e=[],t=[],i=[];let n=l;const r=l-qs+1+Id.length;for(let s=0;s<r;s++){const o=Math.pow(2,n);t.push(o);let a=1/o;s>l-qs?a=Id[s-l+qs-1]:s===0&&(a=0),i.push(a);const c=1/(o-2),h=-c,u=1+c,f=[h,h,u,h,u,u,h,h,u,u,h,u],d=6,g=6,p=3,m=2,_=1,x=new Float32Array(p*g*d),b=new Float32Array(m*g*d),y=new Float32Array(_*g*d);for(let M=0;M<d;M++){const S=M%3*2/3-1,w=M>2?0:-1,T=[S,w,0,S+2/3,w,0,S+2/3,w+1,0,S,w,0,S+2/3,w+1,0,S,w+1,0];x.set(T,p*g*M),b.set(f,m*g*M);const R=[M,M,M,M,M,M];y.set(R,_*g*M)}const v=new ze;v.setAttribute("position",new st(x,p)),v.setAttribute("uv",new st(b,m)),v.setAttribute("faceIndex",new st(y,_)),e.push(v),n>qs&&n--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function Ud(l,e,t){const i=new Mn(l,e,t);return i.texture.mapping=Lo,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Cl(l,e,t,i,n){l.viewport.set(e,t,i,n),l.scissor.set(e,t,i,n)}function cy(l,e,t){const i=new Float32Array(Wr),n=new L(0,1,0);return new di({name:"SphericalGaussianBlur",defines:{n:Wr,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${l}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:gf(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ei,depthTest:!1,depthWrite:!1})}function kd(){return new di({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:gf(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ei,depthTest:!1,depthWrite:!1})}function Nd(){return new di({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:gf(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ei,depthTest:!1,depthWrite:!1})}function gf(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function hy(l){let e=new WeakMap,t=null;function i(o){if(o&&o.isTexture){const a=o.mapping,c=a===ya||a===ba,h=a===hr||a===ur;if(c||h)if(o.isRenderTargetTexture&&o.needsPMREMUpdate===!0){o.needsPMREMUpdate=!1;let u=e.get(o);return t===null&&(t=new Fu(l)),u=c?t.fromEquirectangular(o,u):t.fromCubemap(o,u),e.set(o,u),u.texture}else{if(e.has(o))return e.get(o).texture;{const u=o.image;if(c&&u&&u.height>0||h&&u&&n(u)){t===null&&(t=new Fu(l));const f=c?t.fromEquirectangular(o):t.fromCubemap(o);return e.set(o,f),o.addEventListener("dispose",r),f.texture}else return null}}}return o}function n(o){let a=0;const c=6;for(let h=0;h<c;h++)o[h]!==void 0&&a++;return a===c}function r(o){const a=o.target;a.removeEventListener("dispose",r);const c=e.get(a);c!==void 0&&(e.delete(a),c.dispose())}function s(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:s}}function uy(l){const e={};function t(i){if(e[i]!==void 0)return e[i];let n;switch(i){case"WEBGL_depth_texture":n=l.getExtension("WEBGL_depth_texture")||l.getExtension("MOZ_WEBGL_depth_texture")||l.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=l.getExtension("WEBGL_compressed_texture_s3tc")||l.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||l.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=l.getExtension("WEBGL_compressed_texture_pvrtc")||l.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=l.getExtension(i)}return e[i]=n,n}return{has:function(i){return t(i)!==null},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const n=t(i);return n===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),n}}}function fy(l,e,t,i){const n={},r=new WeakMap;function s(u){const f=u.target;f.index!==null&&e.remove(f.index);for(const g in f.attributes)e.remove(f.attributes[g]);f.removeEventListener("dispose",s),delete n[f.id];const d=r.get(f);d&&(e.remove(d),r.delete(f)),i.releaseStatesOfGeometry(f),f.isInstancedBufferGeometry===!0&&delete f._maxInstanceCount,t.memory.geometries--}function o(u,f){return n[f.id]===!0||(f.addEventListener("dispose",s),n[f.id]=!0,t.memory.geometries++),f}function a(u){const f=u.attributes;for(const g in f)e.update(f[g],34962);const d=u.morphAttributes;for(const g in d){const p=d[g];for(let m=0,_=p.length;m<_;m++)e.update(p[m],34962)}}function c(u){const f=[],d=u.index,g=u.attributes.position;let p=0;if(d!==null){const x=d.array;p=d.version;for(let b=0,y=x.length;b<y;b+=3){const v=x[b+0],M=x[b+1],S=x[b+2];f.push(v,M,M,S,S,v)}}else{const x=g.array;p=g.version;for(let b=0,y=x.length/3-1;b<y;b+=3){const v=b+0,M=b+1,S=b+2;f.push(v,M,M,S,S,v)}}const m=new(I0(f)?pf:df)(f,1);m.version=p;const _=r.get(u);_&&e.remove(_),r.set(u,m)}function h(u){const f=r.get(u);if(f){const d=u.index;d!==null&&f.version<d.version&&c(u)}else c(u);return r.get(u)}return{get:o,update:a,getWireframeAttribute:h}}function dy(l,e,t,i){const n=i.isWebGL2;let r;function s(f){r=f}let o,a;function c(f){o=f.type,a=f.bytesPerElement}function h(f,d){l.drawElements(r,d,o,f*a),t.update(d,r,1)}function u(f,d,g){if(g===0)return;let p,m;if(n)p=l,m="drawElementsInstanced";else if(p=e.get("ANGLE_instanced_arrays"),m="drawElementsInstancedANGLE",p===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}p[m](r,d,o,f*a,g),t.update(d,r,g)}this.setMode=s,this.setIndex=c,this.render=h,this.renderInstances=u}function py(l){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(r,s,o){switch(t.calls++,s){case 4:t.triangles+=o*(r/3);break;case 1:t.lines+=o*(r/2);break;case 3:t.lines+=o*(r-1);break;case 2:t.lines+=o*r;break;case 0:t.points+=o*r;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",s);break}}function n(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:n,update:i}}function my(l,e){return l[0]-e[0]}function gy(l,e){return Math.abs(e[1])-Math.abs(l[1])}function Lh(l,e){let t=1;const i=e.isInterleavedBufferAttribute?e.data.array:e.array;i instanceof Int8Array?t=127:i instanceof Int16Array?t=32767:i instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",i),l.divideScalar(t)}function _y(l,e,t){const i={},n=new Float32Array(8),r=new WeakMap,s=new it,o=[];for(let c=0;c<8;c++)o[c]=[c,0];function a(c,h,u,f){const d=c.morphTargetInfluences;if(e.isWebGL2===!0){const p=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,m=p!==void 0?p.length:0;let _=r.get(h);if(_===void 0||_.count!==m){let O=function(){A.dispose(),r.delete(h),h.removeEventListener("dispose",O)};var g=O;_!==void 0&&_.texture.dispose();const y=h.morphAttributes.position!==void 0,v=h.morphAttributes.normal!==void 0,M=h.morphAttributes.color!==void 0,S=h.morphAttributes.position||[],w=h.morphAttributes.normal||[],T=h.morphAttributes.color||[];let R=0;y===!0&&(R=1),v===!0&&(R=2),M===!0&&(R=3);let D=h.attributes.position.count*R,I=1;D>e.maxTextureSize&&(I=Math.ceil(D/e.maxTextureSize),D=e.maxTextureSize);const U=new Float32Array(D*I*4*m),A=new Ha(U,D,I,m);A.type=Ai,A.needsUpdate=!0;const B=R*4;for(let q=0;q<m;q++){const Z=S[q],k=w[q],V=T[q],F=D*I*4*q;for(let z=0;z<Z.count;z++){const X=z*B;y===!0&&(s.fromBufferAttribute(Z,z),Z.normalized===!0&&Lh(s,Z),U[F+X+0]=s.x,U[F+X+1]=s.y,U[F+X+2]=s.z,U[F+X+3]=0),v===!0&&(s.fromBufferAttribute(k,z),k.normalized===!0&&Lh(s,k),U[F+X+4]=s.x,U[F+X+5]=s.y,U[F+X+6]=s.z,U[F+X+7]=0),M===!0&&(s.fromBufferAttribute(V,z),V.normalized===!0&&Lh(s,V),U[F+X+8]=s.x,U[F+X+9]=s.y,U[F+X+10]=s.z,U[F+X+11]=V.itemSize===4?s.w:1)}}_={count:m,texture:A,size:new pe(D,I)},r.set(h,_),h.addEventListener("dispose",O)}let x=0;for(let y=0;y<d.length;y++)x+=d[y];const b=h.morphTargetsRelative?1:1-x;f.getUniforms().setValue(l,"morphTargetBaseInfluence",b),f.getUniforms().setValue(l,"morphTargetInfluences",d),f.getUniforms().setValue(l,"morphTargetsTexture",_.texture,t),f.getUniforms().setValue(l,"morphTargetsTextureSize",_.size)}else{const p=d===void 0?0:d.length;let m=i[h.id];if(m===void 0||m.length!==p){m=[];for(let v=0;v<p;v++)m[v]=[v,0];i[h.id]=m}for(let v=0;v<p;v++){const M=m[v];M[0]=v,M[1]=d[v]}m.sort(gy);for(let v=0;v<8;v++)v<p&&m[v][1]?(o[v][0]=m[v][0],o[v][1]=m[v][1]):(o[v][0]=Number.MAX_SAFE_INTEGER,o[v][1]=0);o.sort(my);const _=h.morphAttributes.position,x=h.morphAttributes.normal;let b=0;for(let v=0;v<8;v++){const M=o[v],S=M[0],w=M[1];S!==Number.MAX_SAFE_INTEGER&&w?(_&&h.getAttribute("morphTarget"+v)!==_[S]&&h.setAttribute("morphTarget"+v,_[S]),x&&h.getAttribute("morphNormal"+v)!==x[S]&&h.setAttribute("morphNormal"+v,x[S]),n[v]=w,b+=w):(_&&h.hasAttribute("morphTarget"+v)===!0&&h.deleteAttribute("morphTarget"+v),x&&h.hasAttribute("morphNormal"+v)===!0&&h.deleteAttribute("morphNormal"+v),n[v]=0)}const y=h.morphTargetsRelative?1:1-b;f.getUniforms().setValue(l,"morphTargetBaseInfluence",y),f.getUniforms().setValue(l,"morphTargetInfluences",n)}}return{update:a}}function xy(l,e,t,i){let n=new WeakMap;function r(a){const c=i.render.frame,h=a.geometry,u=e.get(a,h);return n.get(u)!==c&&(e.update(u),n.set(u,c)),a.isInstancedMesh&&(a.hasEventListener("dispose",o)===!1&&a.addEventListener("dispose",o),t.update(a.instanceMatrix,34962),a.instanceColor!==null&&t.update(a.instanceColor,34962)),u}function s(){n=new WeakMap}function o(a){const c=a.target;c.removeEventListener("dispose",o),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:r,dispose:s}}const N0=new wt,B0=new Ha,z0=new Cc,G0=new Xa,Bd=[],zd=[],Gd=new Float32Array(16),Vd=new Float32Array(9),Hd=new Float32Array(4);function Po(l,e,t){const i=l[0];if(i<=0||i>0)return l;const n=e*t;let r=Bd[n];if(r===void 0&&(r=new Float32Array(n),Bd[n]=r),e!==0){i.toArray(r,0);for(let s=1,o=0;s!==e;++s)o+=t,l[s].toArray(r,o)}return r}function nn(l,e){if(l.length!==e.length)return!1;for(let t=0,i=l.length;t<i;t++)if(l[t]!==e[t])return!1;return!0}function rn(l,e){for(let t=0,i=e.length;t<i;t++)l[t]=e[t]}function Rc(l,e){let t=zd[e];t===void 0&&(t=new Int32Array(e),zd[e]=t);for(let i=0;i!==e;++i)t[i]=l.allocateTextureUnit();return t}function vy(l,e){const t=this.cache;t[0]!==e&&(l.uniform1f(this.addr,e),t[0]=e)}function yy(l,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(l.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(nn(t,e))return;l.uniform2fv(this.addr,e),rn(t,e)}}function by(l,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(l.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(l.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(nn(t,e))return;l.uniform3fv(this.addr,e),rn(t,e)}}function wy(l,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(l.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(nn(t,e))return;l.uniform4fv(this.addr,e),rn(t,e)}}function My(l,e){const t=this.cache,i=e.elements;if(i===void 0){if(nn(t,e))return;l.uniformMatrix2fv(this.addr,!1,e),rn(t,e)}else{if(nn(t,i))return;Hd.set(i),l.uniformMatrix2fv(this.addr,!1,Hd),rn(t,i)}}function Sy(l,e){const t=this.cache,i=e.elements;if(i===void 0){if(nn(t,e))return;l.uniformMatrix3fv(this.addr,!1,e),rn(t,e)}else{if(nn(t,i))return;Vd.set(i),l.uniformMatrix3fv(this.addr,!1,Vd),rn(t,i)}}function Ty(l,e){const t=this.cache,i=e.elements;if(i===void 0){if(nn(t,e))return;l.uniformMatrix4fv(this.addr,!1,e),rn(t,e)}else{if(nn(t,i))return;Gd.set(i),l.uniformMatrix4fv(this.addr,!1,Gd),rn(t,i)}}function Cy(l,e){const t=this.cache;t[0]!==e&&(l.uniform1i(this.addr,e),t[0]=e)}function Ay(l,e){const t=this.cache;nn(t,e)||(l.uniform2iv(this.addr,e),rn(t,e))}function Ey(l,e){const t=this.cache;nn(t,e)||(l.uniform3iv(this.addr,e),rn(t,e))}function Ly(l,e){const t=this.cache;nn(t,e)||(l.uniform4iv(this.addr,e),rn(t,e))}function Ry(l,e){const t=this.cache;t[0]!==e&&(l.uniform1ui(this.addr,e),t[0]=e)}function Py(l,e){const t=this.cache;nn(t,e)||(l.uniform2uiv(this.addr,e),rn(t,e))}function Dy(l,e){const t=this.cache;nn(t,e)||(l.uniform3uiv(this.addr,e),rn(t,e))}function Iy(l,e){const t=this.cache;nn(t,e)||(l.uniform4uiv(this.addr,e),rn(t,e))}function Fy(l,e,t){const i=this.cache,n=t.allocateTextureUnit();i[0]!==n&&(l.uniform1i(this.addr,n),i[0]=n),t.setTexture2D(e||N0,n)}function Oy(l,e,t){const i=this.cache,n=t.allocateTextureUnit();i[0]!==n&&(l.uniform1i(this.addr,n),i[0]=n),t.setTexture3D(e||z0,n)}function Uy(l,e,t){const i=this.cache,n=t.allocateTextureUnit();i[0]!==n&&(l.uniform1i(this.addr,n),i[0]=n),t.setTextureCube(e||G0,n)}function ky(l,e,t){const i=this.cache,n=t.allocateTextureUnit();i[0]!==n&&(l.uniform1i(this.addr,n),i[0]=n),t.setTexture2DArray(e||B0,n)}function Ny(l){switch(l){case 5126:return vy;case 35664:return yy;case 35665:return by;case 35666:return wy;case 35674:return My;case 35675:return Sy;case 35676:return Ty;case 5124:case 35670:return Cy;case 35667:case 35671:return Ay;case 35668:case 35672:return Ey;case 35669:case 35673:return Ly;case 5125:return Ry;case 36294:return Py;case 36295:return Dy;case 36296:return Iy;case 35678:case 36198:case 36298:case 36306:case 35682:return Fy;case 35679:case 36299:case 36307:return Oy;case 35680:case 36300:case 36308:case 36293:return Uy;case 36289:case 36303:case 36311:case 36292:return ky}}function By(l,e){l.uniform1fv(this.addr,e)}function zy(l,e){const t=Po(e,this.size,2);l.uniform2fv(this.addr,t)}function Gy(l,e){const t=Po(e,this.size,3);l.uniform3fv(this.addr,t)}function Vy(l,e){const t=Po(e,this.size,4);l.uniform4fv(this.addr,t)}function Hy(l,e){const t=Po(e,this.size,4);l.uniformMatrix2fv(this.addr,!1,t)}function Wy(l,e){const t=Po(e,this.size,9);l.uniformMatrix3fv(this.addr,!1,t)}function Xy(l,e){const t=Po(e,this.size,16);l.uniformMatrix4fv(this.addr,!1,t)}function qy(l,e){l.uniform1iv(this.addr,e)}function Yy(l,e){l.uniform2iv(this.addr,e)}function Zy(l,e){l.uniform3iv(this.addr,e)}function jy(l,e){l.uniform4iv(this.addr,e)}function Jy(l,e){l.uniform1uiv(this.addr,e)}function Ky(l,e){l.uniform2uiv(this.addr,e)}function Qy(l,e){l.uniform3uiv(this.addr,e)}function $y(l,e){l.uniform4uiv(this.addr,e)}function e3(l,e,t){const i=e.length,n=Rc(t,i);l.uniform1iv(this.addr,n);for(let r=0;r!==i;++r)t.setTexture2D(e[r]||N0,n[r])}function t3(l,e,t){const i=e.length,n=Rc(t,i);l.uniform1iv(this.addr,n);for(let r=0;r!==i;++r)t.setTexture3D(e[r]||z0,n[r])}function n3(l,e,t){const i=e.length,n=Rc(t,i);l.uniform1iv(this.addr,n);for(let r=0;r!==i;++r)t.setTextureCube(e[r]||G0,n[r])}function i3(l,e,t){const i=e.length,n=Rc(t,i);l.uniform1iv(this.addr,n);for(let r=0;r!==i;++r)t.setTexture2DArray(e[r]||B0,n[r])}function r3(l){switch(l){case 5126:return By;case 35664:return zy;case 35665:return Gy;case 35666:return Vy;case 35674:return Hy;case 35675:return Wy;case 35676:return Xy;case 5124:case 35670:return qy;case 35667:case 35671:return Yy;case 35668:case 35672:return Zy;case 35669:case 35673:return jy;case 5125:return Jy;case 36294:return Ky;case 36295:return Qy;case 36296:return $y;case 35678:case 36198:case 36298:case 36306:case 35682:return e3;case 35679:case 36299:case 36307:return t3;case 35680:case 36300:case 36308:case 36293:return n3;case 36289:case 36303:case 36311:case 36292:return i3}}class s3{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=Ny(t.type)}}class o3{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=r3(t.type)}}class a3{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const n=this.seq;for(let r=0,s=n.length;r!==s;++r){const o=n[r];o.setValue(e,t[o.id],i)}}}const Rh=/(\w+)(\])?(\[|\.)?/g;function Wd(l,e){l.seq.push(e),l.map[e.id]=e}function l3(l,e,t){const i=l.name,n=i.length;for(Rh.lastIndex=0;;){const r=Rh.exec(i),s=Rh.lastIndex;let o=r[1];const a=r[2]==="]",c=r[3];if(a&&(o=o|0),c===void 0||c==="["&&s+2===n){Wd(t,c===void 0?new s3(o,l,e):new o3(o,l,e));break}else{let u=t.map[o];u===void 0&&(u=new a3(o),Wd(t,u)),t=u}}}class ac{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,35718);for(let n=0;n<i;++n){const r=e.getActiveUniform(t,n),s=e.getUniformLocation(t,r.name);l3(r,s,this)}}setValue(e,t,i,n){const r=this.map[t];r!==void 0&&r.setValue(e,i,n)}setOptional(e,t,i){const n=t[i];n!==void 0&&this.setValue(e,i,n)}static upload(e,t,i,n){for(let r=0,s=t.length;r!==s;++r){const o=t[r],a=i[o.id];a.needsUpdate!==!1&&o.setValue(e,a.value,n)}}static seqWithValue(e,t){const i=[];for(let n=0,r=e.length;n!==r;++n){const s=e[n];s.id in t&&i.push(s)}return i}}function Xd(l,e,t){const i=l.createShader(e);return l.shaderSource(i,t),l.compileShader(i),i}let c3=0;function h3(l,e){const t=l.split(`
`),i=[],n=Math.max(e-6,0),r=Math.min(e+6,t.length);for(let s=n;s<r;s++){const o=s+1;i.push(`${o===e?">":" "} ${o}: ${t[s]}`)}return i.join(`
`)}function u3(l){switch(l){case pr:return["Linear","( value )"];case nt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",l),["Linear","( value )"]}}function qd(l,e,t){const i=l.getShaderParameter(e,35713),n=l.getShaderInfoLog(e).trim();if(i&&n==="")return"";const r=/ERROR: 0:(\d+)/.exec(n);if(r){const s=parseInt(r[1]);return t.toUpperCase()+`

`+n+`

`+h3(l.getShaderSource(e),s)}else return n}function f3(l,e){const t=u3(e);return"vec4 "+l+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function d3(l,e){let t;switch(e){case s0:t="Linear";break;case o0:t="Reinhard";break;case a0:t="OptimizedCineon";break;case l0:t="ACESFilmic";break;case c0:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+l+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function p3(l){return[l.extensionDerivatives||!!l.envMapCubeUVHeight||l.bumpMap||l.tangentSpaceNormalMap||l.clearcoatNormalMap||l.flatShading||l.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(l.extensionFragDepth||l.logarithmicDepthBuffer)&&l.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",l.extensionDrawBuffers&&l.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(l.extensionShaderTextureLOD||l.envMap||l.transmission)&&l.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(aa).join(`
`)}function m3(l){const e=[];for(const t in l){const i=l[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function g3(l,e){const t={},i=l.getProgramParameter(e,35721);for(let n=0;n<i;n++){const r=l.getActiveAttrib(e,n),s=r.name;let o=1;r.type===35674&&(o=2),r.type===35675&&(o=3),r.type===35676&&(o=4),t[s]={type:r.type,location:l.getAttribLocation(e,s),locationSize:o}}return t}function aa(l){return l!==""}function Yd(l,e){return l.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Zd(l,e){return l.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const _3=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ou(l){return l.replace(_3,x3)}function x3(l,e){const t=He[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return Ou(t)}const v3=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,y3=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function jd(l){return l.replace(y3,V0).replace(v3,b3)}function b3(l,e,t,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),V0(l,e,t,i)}function V0(l,e,t,i){let n="";for(let r=parseInt(e);r<parseInt(t);r++)n+=i.replace(/\[\s*i\s*\]/g,"[ "+r+" ]").replace(/UNROLLED_LOOP_INDEX/g,r);return n}function Jd(l){let e="precision "+l.precision+` float;
precision `+l.precision+" int;";return l.precision==="highp"?e+=`
#define HIGH_PRECISION`:l.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:l.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function w3(l){let e="SHADOWMAP_TYPE_BASIC";return l.shadowMapType===rf?e="SHADOWMAP_TYPE_PCF":l.shadowMapType===Um?e="SHADOWMAP_TYPE_PCF_SOFT":l.shadowMapType===Ws&&(e="SHADOWMAP_TYPE_VSM"),e}function M3(l){let e="ENVMAP_TYPE_CUBE";if(l.envMap)switch(l.envMapMode){case hr:case ur:e="ENVMAP_TYPE_CUBE";break;case Lo:e="ENVMAP_TYPE_CUBE_UV";break}return e}function S3(l){let e="ENVMAP_MODE_REFLECTION";if(l.envMap)switch(l.envMapMode){case ur:e="ENVMAP_MODE_REFRACTION";break}return e}function T3(l){let e="ENVMAP_BLENDING_NONE";if(l.envMap)switch(l.combine){case Va:e="ENVMAP_BLENDING_MULTIPLY";break;case i0:e="ENVMAP_BLENDING_MIX";break;case r0:e="ENVMAP_BLENDING_ADD";break}return e}function C3(l){const e=l.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function A3(l,e,t,i){const n=l.getContext(),r=t.defines;let s=t.vertexShader,o=t.fragmentShader;const a=w3(t),c=M3(t),h=S3(t),u=T3(t),f=C3(t),d=t.isWebGL2?"":p3(t),g=m3(r),p=n.createProgram();let m,_,x=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(m=[g].filter(aa).join(`
`),m.length>0&&(m+=`
`),_=[d,g].filter(aa).join(`
`),_.length>0&&(_+=`
`)):(m=[Jd(t),"#define SHADER_NAME "+t.shaderName,g,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+a:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(aa).join(`
`),_=[d,Jd(t),"#define SHADER_NAME "+t.shaderName,g,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+h:"",t.envMap?"#define "+u:"",f?"#define CUBEUV_TEXEL_WIDTH "+f.texelWidth:"",f?"#define CUBEUV_TEXEL_HEIGHT "+f.texelHeight:"",f?"#define CUBEUV_MAX_MIP "+f.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+a:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==li?"#define TONE_MAPPING":"",t.toneMapping!==li?He.tonemapping_pars_fragment:"",t.toneMapping!==li?d3("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",He.encodings_pars_fragment,f3("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(aa).join(`
`)),s=Ou(s),s=Yd(s,t),s=Zd(s,t),o=Ou(o),o=Yd(o,t),o=Zd(o,t),s=jd(s),o=jd(o),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(x=`#version 300 es
`,m=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+m,_=["#define varying in",t.glslVersion===Du?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Du?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+_);const b=x+m+s,y=x+_+o,v=Xd(n,35633,b),M=Xd(n,35632,y);if(n.attachShader(p,v),n.attachShader(p,M),t.index0AttributeName!==void 0?n.bindAttribLocation(p,0,t.index0AttributeName):t.morphTargets===!0&&n.bindAttribLocation(p,0,"position"),n.linkProgram(p),l.debug.checkShaderErrors){const T=n.getProgramInfoLog(p).trim(),R=n.getShaderInfoLog(v).trim(),D=n.getShaderInfoLog(M).trim();let I=!0,U=!0;if(n.getProgramParameter(p,35714)===!1){I=!1;const A=qd(n,v,"vertex"),B=qd(n,M,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(p,35715)+`

Program Info Log: `+T+`
`+A+`
`+B)}else T!==""?console.warn("THREE.WebGLProgram: Program Info Log:",T):(R===""||D==="")&&(U=!1);U&&(this.diagnostics={runnable:I,programLog:T,vertexShader:{log:R,prefix:m},fragmentShader:{log:D,prefix:_}})}n.deleteShader(v),n.deleteShader(M);let S;this.getUniforms=function(){return S===void 0&&(S=new ac(n,p)),S};let w;return this.getAttributes=function(){return w===void 0&&(w=g3(n,p)),w},this.destroy=function(){i.releaseStatesOfProgram(this),n.deleteProgram(p),this.program=void 0},this.name=t.shaderName,this.id=c3++,this.cacheKey=e,this.usedTimes=1,this.program=p,this.vertexShader=v,this.fragmentShader=M,this}let E3=0;class L3{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,n=this._getShaderStage(t),r=this._getShaderStage(i),s=this._getShaderCacheForMaterial(e);return s.has(n)===!1&&(s.add(n),n.usedTimes++),s.has(r)===!1&&(s.add(r),r.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return t.has(e)===!1&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(t.has(e)===!1){const i=new R3(e);t.set(e,i)}return t.get(e)}}class R3{constructor(e){this.id=E3++,this.code=e,this.usedTimes=0}}function P3(l,e,t,i,n,r,s){const o=new Ac,a=new L3,c=[],h=n.isWebGL2,u=n.logarithmicDepthBuffer,f=n.vertexTextures;let d=n.precision;const g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function p(w,T,R,D,I){const U=D.fog,A=I.geometry,B=w.isMeshStandardMaterial?D.environment:null,O=(w.isMeshStandardMaterial?t:e).get(w.envMap||B),q=!!O&&O.mapping===Lo?O.image.height:null,Z=g[w.type];w.precision!==null&&(d=n.getMaxPrecision(w.precision),d!==w.precision&&console.warn("THREE.WebGLProgram.getParameters:",w.precision,"not supported, using",d,"instead."));const k=A.morphAttributes.position||A.morphAttributes.normal||A.morphAttributes.color,V=k!==void 0?k.length:0;let F=0;A.morphAttributes.position!==void 0&&(F=1),A.morphAttributes.normal!==void 0&&(F=2),A.morphAttributes.color!==void 0&&(F=3);let z,X,j,K;if(Z){const ge=Yn[Z];z=ge.vertexShader,X=ge.fragmentShader}else z=w.vertexShader,X=w.fragmentShader,a.update(w),j=a.getVertexShaderID(w),K=a.getFragmentShaderID(w);const G=l.getRenderTarget(),ee=w.alphaTest>0,ne=w.clearcoat>0,de=w.iridescence>0;return{isWebGL2:h,shaderID:Z,shaderName:w.type,vertexShader:z,fragmentShader:X,defines:w.defines,customVertexShaderID:j,customFragmentShaderID:K,isRawShaderMaterial:w.isRawShaderMaterial===!0,glslVersion:w.glslVersion,precision:d,instancing:I.isInstancedMesh===!0,instancingColor:I.isInstancedMesh===!0&&I.instanceColor!==null,supportsVertexTextures:f,outputEncoding:G===null?l.outputEncoding:G.isXRRenderTarget===!0?G.texture.encoding:pr,map:!!w.map,matcap:!!w.matcap,envMap:!!O,envMapMode:O&&O.mapping,envMapCubeUVHeight:q,lightMap:!!w.lightMap,aoMap:!!w.aoMap,emissiveMap:!!w.emissiveMap,bumpMap:!!w.bumpMap,normalMap:!!w.normalMap,objectSpaceNormalMap:w.normalMapType===R0,tangentSpaceNormalMap:w.normalMapType===wr,decodeVideoTexture:!!w.map&&w.map.isVideoTexture===!0&&w.map.encoding===nt,clearcoat:ne,clearcoatMap:ne&&!!w.clearcoatMap,clearcoatRoughnessMap:ne&&!!w.clearcoatRoughnessMap,clearcoatNormalMap:ne&&!!w.clearcoatNormalMap,iridescence:de,iridescenceMap:de&&!!w.iridescenceMap,iridescenceThicknessMap:de&&!!w.iridescenceThicknessMap,displacementMap:!!w.displacementMap,roughnessMap:!!w.roughnessMap,metalnessMap:!!w.metalnessMap,specularMap:!!w.specularMap,specularIntensityMap:!!w.specularIntensityMap,specularColorMap:!!w.specularColorMap,opaque:w.transparent===!1&&w.blending===Kr,alphaMap:!!w.alphaMap,alphaTest:ee,gradientMap:!!w.gradientMap,sheen:w.sheen>0,sheenColorMap:!!w.sheenColorMap,sheenRoughnessMap:!!w.sheenRoughnessMap,transmission:w.transmission>0,transmissionMap:!!w.transmissionMap,thicknessMap:!!w.thicknessMap,combine:w.combine,vertexTangents:!!w.normalMap&&!!A.attributes.tangent,vertexColors:w.vertexColors,vertexAlphas:w.vertexColors===!0&&!!A.attributes.color&&A.attributes.color.itemSize===4,vertexUvs:!!w.map||!!w.bumpMap||!!w.normalMap||!!w.specularMap||!!w.alphaMap||!!w.emissiveMap||!!w.roughnessMap||!!w.metalnessMap||!!w.clearcoatMap||!!w.clearcoatRoughnessMap||!!w.clearcoatNormalMap||!!w.iridescenceMap||!!w.iridescenceThicknessMap||!!w.displacementMap||!!w.transmissionMap||!!w.thicknessMap||!!w.specularIntensityMap||!!w.specularColorMap||!!w.sheenColorMap||!!w.sheenRoughnessMap,uvsVertexOnly:!(!!w.map||!!w.bumpMap||!!w.normalMap||!!w.specularMap||!!w.alphaMap||!!w.emissiveMap||!!w.roughnessMap||!!w.metalnessMap||!!w.clearcoatNormalMap||!!w.iridescenceMap||!!w.iridescenceThicknessMap||w.transmission>0||!!w.transmissionMap||!!w.thicknessMap||!!w.specularIntensityMap||!!w.specularColorMap||w.sheen>0||!!w.sheenColorMap||!!w.sheenRoughnessMap)&&!!w.displacementMap,fog:!!U,useFog:w.fog===!0,fogExp2:U&&U.isFogExp2,flatShading:!!w.flatShading,sizeAttenuation:w.sizeAttenuation,logarithmicDepthBuffer:u,skinning:I.isSkinnedMesh===!0,morphTargets:A.morphAttributes.position!==void 0,morphNormals:A.morphAttributes.normal!==void 0,morphColors:A.morphAttributes.color!==void 0,morphTargetsCount:V,morphTextureStride:F,numDirLights:T.directional.length,numPointLights:T.point.length,numSpotLights:T.spot.length,numRectAreaLights:T.rectArea.length,numHemiLights:T.hemi.length,numDirLightShadows:T.directionalShadowMap.length,numPointLightShadows:T.pointShadowMap.length,numSpotLightShadows:T.spotShadowMap.length,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:w.dithering,shadowMapEnabled:l.shadowMap.enabled&&R.length>0,shadowMapType:l.shadowMap.type,toneMapping:w.toneMapped?l.toneMapping:li,physicallyCorrectLights:l.physicallyCorrectLights,premultipliedAlpha:w.premultipliedAlpha,doubleSided:w.side===ui,flipSided:w.side===tn,useDepthPacking:!!w.depthPacking,depthPacking:w.depthPacking||0,index0AttributeName:w.index0AttributeName,extensionDerivatives:w.extensions&&w.extensions.derivatives,extensionFragDepth:w.extensions&&w.extensions.fragDepth,extensionDrawBuffers:w.extensions&&w.extensions.drawBuffers,extensionShaderTextureLOD:w.extensions&&w.extensions.shaderTextureLOD,rendererExtensionFragDepth:h||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||i.has("EXT_shader_texture_lod"),customProgramCacheKey:w.customProgramCacheKey()}}function m(w){const T=[];if(w.shaderID?T.push(w.shaderID):(T.push(w.customVertexShaderID),T.push(w.customFragmentShaderID)),w.defines!==void 0)for(const R in w.defines)T.push(R),T.push(w.defines[R]);return w.isRawShaderMaterial===!1&&(_(T,w),x(T,w),T.push(l.outputEncoding)),T.push(w.customProgramCacheKey),T.join()}function _(w,T){w.push(T.precision),w.push(T.outputEncoding),w.push(T.envMapMode),w.push(T.envMapCubeUVHeight),w.push(T.combine),w.push(T.vertexUvs),w.push(T.fogExp2),w.push(T.sizeAttenuation),w.push(T.morphTargetsCount),w.push(T.morphAttributeCount),w.push(T.numDirLights),w.push(T.numPointLights),w.push(T.numSpotLights),w.push(T.numHemiLights),w.push(T.numRectAreaLights),w.push(T.numDirLightShadows),w.push(T.numPointLightShadows),w.push(T.numSpotLightShadows),w.push(T.shadowMapType),w.push(T.toneMapping),w.push(T.numClippingPlanes),w.push(T.numClipIntersection),w.push(T.depthPacking)}function x(w,T){o.disableAll(),T.isWebGL2&&o.enable(0),T.supportsVertexTextures&&o.enable(1),T.instancing&&o.enable(2),T.instancingColor&&o.enable(3),T.map&&o.enable(4),T.matcap&&o.enable(5),T.envMap&&o.enable(6),T.lightMap&&o.enable(7),T.aoMap&&o.enable(8),T.emissiveMap&&o.enable(9),T.bumpMap&&o.enable(10),T.normalMap&&o.enable(11),T.objectSpaceNormalMap&&o.enable(12),T.tangentSpaceNormalMap&&o.enable(13),T.clearcoat&&o.enable(14),T.clearcoatMap&&o.enable(15),T.clearcoatRoughnessMap&&o.enable(16),T.clearcoatNormalMap&&o.enable(17),T.iridescence&&o.enable(18),T.iridescenceMap&&o.enable(19),T.iridescenceThicknessMap&&o.enable(20),T.displacementMap&&o.enable(21),T.specularMap&&o.enable(22),T.roughnessMap&&o.enable(23),T.metalnessMap&&o.enable(24),T.gradientMap&&o.enable(25),T.alphaMap&&o.enable(26),T.alphaTest&&o.enable(27),T.vertexColors&&o.enable(28),T.vertexAlphas&&o.enable(29),T.vertexUvs&&o.enable(30),T.vertexTangents&&o.enable(31),T.uvsVertexOnly&&o.enable(32),T.fog&&o.enable(33),w.push(o.mask),o.disableAll(),T.useFog&&o.enable(0),T.flatShading&&o.enable(1),T.logarithmicDepthBuffer&&o.enable(2),T.skinning&&o.enable(3),T.morphTargets&&o.enable(4),T.morphNormals&&o.enable(5),T.morphColors&&o.enable(6),T.premultipliedAlpha&&o.enable(7),T.shadowMapEnabled&&o.enable(8),T.physicallyCorrectLights&&o.enable(9),T.doubleSided&&o.enable(10),T.flipSided&&o.enable(11),T.useDepthPacking&&o.enable(12),T.dithering&&o.enable(13),T.specularIntensityMap&&o.enable(14),T.specularColorMap&&o.enable(15),T.transmission&&o.enable(16),T.transmissionMap&&o.enable(17),T.thicknessMap&&o.enable(18),T.sheen&&o.enable(19),T.sheenColorMap&&o.enable(20),T.sheenRoughnessMap&&o.enable(21),T.decodeVideoTexture&&o.enable(22),T.opaque&&o.enable(23),w.push(o.mask)}function b(w){const T=g[w.type];let R;if(T){const D=Yn[T];R=mf.clone(D.uniforms)}else R=w.uniforms;return R}function y(w,T){let R;for(let D=0,I=c.length;D<I;D++){const U=c[D];if(U.cacheKey===T){R=U,++R.usedTimes;break}}return R===void 0&&(R=new A3(l,T,w,r),c.push(R)),R}function v(w){if(--w.usedTimes===0){const T=c.indexOf(w);c[T]=c[c.length-1],c.pop(),w.destroy()}}function M(w){a.remove(w)}function S(){a.dispose()}return{getParameters:p,getProgramCacheKey:m,getUniforms:b,acquireProgram:y,releaseProgram:v,releaseShaderCache:M,programs:c,dispose:S}}function D3(){let l=new WeakMap;function e(r){let s=l.get(r);return s===void 0&&(s={},l.set(r,s)),s}function t(r){l.delete(r)}function i(r,s,o){l.get(r)[s]=o}function n(){l=new WeakMap}return{get:e,remove:t,update:i,dispose:n}}function I3(l,e){return l.groupOrder!==e.groupOrder?l.groupOrder-e.groupOrder:l.renderOrder!==e.renderOrder?l.renderOrder-e.renderOrder:l.material.id!==e.material.id?l.material.id-e.material.id:l.z!==e.z?l.z-e.z:l.id-e.id}function Kd(l,e){return l.groupOrder!==e.groupOrder?l.groupOrder-e.groupOrder:l.renderOrder!==e.renderOrder?l.renderOrder-e.renderOrder:l.z!==e.z?e.z-l.z:l.id-e.id}function Qd(){const l=[];let e=0;const t=[],i=[],n=[];function r(){e=0,t.length=0,i.length=0,n.length=0}function s(u,f,d,g,p,m){let _=l[e];return _===void 0?(_={id:u.id,object:u,geometry:f,material:d,groupOrder:g,renderOrder:u.renderOrder,z:p,group:m},l[e]=_):(_.id=u.id,_.object=u,_.geometry=f,_.material=d,_.groupOrder=g,_.renderOrder=u.renderOrder,_.z=p,_.group=m),e++,_}function o(u,f,d,g,p,m){const _=s(u,f,d,g,p,m);d.transmission>0?i.push(_):d.transparent===!0?n.push(_):t.push(_)}function a(u,f,d,g,p,m){const _=s(u,f,d,g,p,m);d.transmission>0?i.unshift(_):d.transparent===!0?n.unshift(_):t.unshift(_)}function c(u,f){t.length>1&&t.sort(u||I3),i.length>1&&i.sort(f||Kd),n.length>1&&n.sort(f||Kd)}function h(){for(let u=e,f=l.length;u<f;u++){const d=l[u];if(d.id===null)break;d.id=null,d.object=null,d.geometry=null,d.material=null,d.group=null}}return{opaque:t,transmissive:i,transparent:n,init:r,push:o,unshift:a,finish:h,sort:c}}function F3(){let l=new WeakMap;function e(i,n){let r;return l.has(i)===!1?(r=new Qd,l.set(i,[r])):n>=l.get(i).length?(r=new Qd,l.get(i).push(r)):r=l.get(i)[n],r}function t(){l=new WeakMap}return{get:e,dispose:t}}function O3(){const l={};return{get:function(e){if(l[e.id]!==void 0)return l[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new L,color:new Ae};break;case"SpotLight":t={position:new L,direction:new L,color:new Ae,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new L,color:new Ae,distance:0,decay:0};break;case"HemisphereLight":t={direction:new L,skyColor:new Ae,groundColor:new Ae};break;case"RectAreaLight":t={color:new Ae,position:new L,halfWidth:new L,halfHeight:new L};break}return l[e.id]=t,t}}}function U3(){const l={};return{get:function(e){if(l[e.id]!==void 0)return l[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new pe};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new pe};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new pe,shadowCameraNear:1,shadowCameraFar:1e3};break}return l[e.id]=t,t}}}let k3=0;function N3(l,e){return(e.castShadow?1:0)-(l.castShadow?1:0)}function B3(l,e){const t=new O3,i=U3(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let h=0;h<9;h++)n.probe.push(new L);const r=new L,s=new Ne,o=new Ne;function a(h,u){let f=0,d=0,g=0;for(let T=0;T<9;T++)n.probe[T].set(0,0,0);let p=0,m=0,_=0,x=0,b=0,y=0,v=0,M=0;h.sort(N3);const S=u!==!0?Math.PI:1;for(let T=0,R=h.length;T<R;T++){const D=h[T],I=D.color,U=D.intensity,A=D.distance,B=D.shadow&&D.shadow.map?D.shadow.map.texture:null;if(D.isAmbientLight)f+=I.r*U*S,d+=I.g*U*S,g+=I.b*U*S;else if(D.isLightProbe)for(let O=0;O<9;O++)n.probe[O].addScaledVector(D.sh.coefficients[O],U);else if(D.isDirectionalLight){const O=t.get(D);if(O.color.copy(D.color).multiplyScalar(D.intensity*S),D.castShadow){const q=D.shadow,Z=i.get(D);Z.shadowBias=q.bias,Z.shadowNormalBias=q.normalBias,Z.shadowRadius=q.radius,Z.shadowMapSize=q.mapSize,n.directionalShadow[p]=Z,n.directionalShadowMap[p]=B,n.directionalShadowMatrix[p]=D.shadow.matrix,y++}n.directional[p]=O,p++}else if(D.isSpotLight){const O=t.get(D);if(O.position.setFromMatrixPosition(D.matrixWorld),O.color.copy(I).multiplyScalar(U*S),O.distance=A,O.coneCos=Math.cos(D.angle),O.penumbraCos=Math.cos(D.angle*(1-D.penumbra)),O.decay=D.decay,D.castShadow){const q=D.shadow,Z=i.get(D);Z.shadowBias=q.bias,Z.shadowNormalBias=q.normalBias,Z.shadowRadius=q.radius,Z.shadowMapSize=q.mapSize,n.spotShadow[_]=Z,n.spotShadowMap[_]=B,n.spotShadowMatrix[_]=D.shadow.matrix,M++}n.spot[_]=O,_++}else if(D.isRectAreaLight){const O=t.get(D);O.color.copy(I).multiplyScalar(U),O.halfWidth.set(D.width*.5,0,0),O.halfHeight.set(0,D.height*.5,0),n.rectArea[x]=O,x++}else if(D.isPointLight){const O=t.get(D);if(O.color.copy(D.color).multiplyScalar(D.intensity*S),O.distance=D.distance,O.decay=D.decay,D.castShadow){const q=D.shadow,Z=i.get(D);Z.shadowBias=q.bias,Z.shadowNormalBias=q.normalBias,Z.shadowRadius=q.radius,Z.shadowMapSize=q.mapSize,Z.shadowCameraNear=q.camera.near,Z.shadowCameraFar=q.camera.far,n.pointShadow[m]=Z,n.pointShadowMap[m]=B,n.pointShadowMatrix[m]=D.shadow.matrix,v++}n.point[m]=O,m++}else if(D.isHemisphereLight){const O=t.get(D);O.skyColor.copy(D.color).multiplyScalar(U*S),O.groundColor.copy(D.groundColor).multiplyScalar(U*S),n.hemi[b]=O,b++}}x>0&&(e.isWebGL2||l.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Re.LTC_FLOAT_1,n.rectAreaLTC2=Re.LTC_FLOAT_2):l.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=Re.LTC_HALF_1,n.rectAreaLTC2=Re.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=f,n.ambient[1]=d,n.ambient[2]=g;const w=n.hash;(w.directionalLength!==p||w.pointLength!==m||w.spotLength!==_||w.rectAreaLength!==x||w.hemiLength!==b||w.numDirectionalShadows!==y||w.numPointShadows!==v||w.numSpotShadows!==M)&&(n.directional.length=p,n.spot.length=_,n.rectArea.length=x,n.point.length=m,n.hemi.length=b,n.directionalShadow.length=y,n.directionalShadowMap.length=y,n.pointShadow.length=v,n.pointShadowMap.length=v,n.spotShadow.length=M,n.spotShadowMap.length=M,n.directionalShadowMatrix.length=y,n.pointShadowMatrix.length=v,n.spotShadowMatrix.length=M,w.directionalLength=p,w.pointLength=m,w.spotLength=_,w.rectAreaLength=x,w.hemiLength=b,w.numDirectionalShadows=y,w.numPointShadows=v,w.numSpotShadows=M,n.version=k3++)}function c(h,u){let f=0,d=0,g=0,p=0,m=0;const _=u.matrixWorldInverse;for(let x=0,b=h.length;x<b;x++){const y=h[x];if(y.isDirectionalLight){const v=n.directional[f];v.direction.setFromMatrixPosition(y.matrixWorld),r.setFromMatrixPosition(y.target.matrixWorld),v.direction.sub(r),v.direction.transformDirection(_),f++}else if(y.isSpotLight){const v=n.spot[g];v.position.setFromMatrixPosition(y.matrixWorld),v.position.applyMatrix4(_),v.direction.setFromMatrixPosition(y.matrixWorld),r.setFromMatrixPosition(y.target.matrixWorld),v.direction.sub(r),v.direction.transformDirection(_),g++}else if(y.isRectAreaLight){const v=n.rectArea[p];v.position.setFromMatrixPosition(y.matrixWorld),v.position.applyMatrix4(_),o.identity(),s.copy(y.matrixWorld),s.premultiply(_),o.extractRotation(s),v.halfWidth.set(y.width*.5,0,0),v.halfHeight.set(0,y.height*.5,0),v.halfWidth.applyMatrix4(o),v.halfHeight.applyMatrix4(o),p++}else if(y.isPointLight){const v=n.point[d];v.position.setFromMatrixPosition(y.matrixWorld),v.position.applyMatrix4(_),d++}else if(y.isHemisphereLight){const v=n.hemi[m];v.direction.setFromMatrixPosition(y.matrixWorld),v.direction.transformDirection(_),m++}}}return{setup:a,setupView:c,state:n}}function $d(l,e){const t=new B3(l,e),i=[],n=[];function r(){i.length=0,n.length=0}function s(u){i.push(u)}function o(u){n.push(u)}function a(u){t.setup(i,u)}function c(u){t.setupView(i,u)}return{init:r,state:{lightsArray:i,shadowsArray:n,lights:t},setupLights:a,setupLightsView:c,pushLight:s,pushShadow:o}}function z3(l,e){let t=new WeakMap;function i(r,s=0){let o;return t.has(r)===!1?(o=new $d(l,e),t.set(r,[o])):s>=t.get(r).length?(o=new $d(l,e),t.get(r).push(o)):o=t.get(r)[s],o}function n(){t=new WeakMap}return{get:i,dispose:n}}class Pc extends bt{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=L0,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Dc extends bt{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new L,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const G3=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,V3=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function H3(l,e,t){let i=new Lc;const n=new pe,r=new pe,s=new it,o=new Pc({depthPacking:hf}),a=new Dc,c={},h=t.maxTextureSize,u={0:tn,1:Pi,2:ui},f=new di({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new pe},radius:{value:4}},vertexShader:G3,fragmentShader:V3}),d=f.clone();d.defines.HORIZONTAL_PASS=1;const g=new ze;g.setAttribute("position",new st(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const p=new ht(g,f),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=rf,this.render=function(y,v,M){if(m.enabled===!1||m.autoUpdate===!1&&m.needsUpdate===!1||y.length===0)return;const S=l.getRenderTarget(),w=l.getActiveCubeFace(),T=l.getActiveMipmapLevel(),R=l.state;R.setBlending(Ei),R.buffers.color.setClear(1,1,1,1),R.buffers.depth.setTest(!0),R.setScissorTest(!1);for(let D=0,I=y.length;D<I;D++){const U=y[D],A=U.shadow;if(A===void 0){console.warn("THREE.WebGLShadowMap:",U,"has no shadow.");continue}if(A.autoUpdate===!1&&A.needsUpdate===!1)continue;n.copy(A.mapSize);const B=A.getFrameExtents();if(n.multiply(B),r.copy(A.mapSize),(n.x>h||n.y>h)&&(n.x>h&&(r.x=Math.floor(h/B.x),n.x=r.x*B.x,A.mapSize.x=r.x),n.y>h&&(r.y=Math.floor(h/B.y),n.y=r.y*B.y,A.mapSize.y=r.y)),A.map===null&&!A.isPointLightShadow&&this.type===Ws&&(A.map=new Mn(n.x,n.y),A.map.texture.name=U.name+".shadowMap",A.mapPass=new Mn(n.x,n.y),A.camera.updateProjectionMatrix()),A.map===null){const q={minFilter:Tt,magFilter:Tt,format:vn};A.map=new Mn(n.x,n.y,q),A.map.texture.name=U.name+".shadowMap",A.camera.updateProjectionMatrix()}l.setRenderTarget(A.map),l.clear();const O=A.getViewportCount();for(let q=0;q<O;q++){const Z=A.getViewport(q);s.set(r.x*Z.x,r.y*Z.y,r.x*Z.z,r.y*Z.w),R.viewport(s),A.updateMatrices(U,q),i=A.getFrustum(),b(v,M,A.camera,U,this.type)}!A.isPointLightShadow&&this.type===Ws&&_(A,M),A.needsUpdate=!1}m.needsUpdate=!1,l.setRenderTarget(S,w,T)};function _(y,v){const M=e.update(p);f.defines.VSM_SAMPLES!==y.blurSamples&&(f.defines.VSM_SAMPLES=y.blurSamples,d.defines.VSM_SAMPLES=y.blurSamples,f.needsUpdate=!0,d.needsUpdate=!0),f.uniforms.shadow_pass.value=y.map.texture,f.uniforms.resolution.value=y.mapSize,f.uniforms.radius.value=y.radius,l.setRenderTarget(y.mapPass),l.clear(),l.renderBufferDirect(v,null,M,f,p,null),d.uniforms.shadow_pass.value=y.mapPass.texture,d.uniforms.resolution.value=y.mapSize,d.uniforms.radius.value=y.radius,l.setRenderTarget(y.map),l.clear(),l.renderBufferDirect(v,null,M,d,p,null)}function x(y,v,M,S,w,T){let R=null;const D=M.isPointLight===!0?y.customDistanceMaterial:y.customDepthMaterial;if(D!==void 0?R=D:R=M.isPointLight===!0?a:o,l.localClippingEnabled&&v.clipShadows===!0&&v.clippingPlanes.length!==0||v.displacementMap&&v.displacementScale!==0||v.alphaMap&&v.alphaTest>0){const I=R.uuid,U=v.uuid;let A=c[I];A===void 0&&(A={},c[I]=A);let B=A[U];B===void 0&&(B=R.clone(),A[U]=B),R=B}return R.visible=v.visible,R.wireframe=v.wireframe,T===Ws?R.side=v.shadowSide!==null?v.shadowSide:v.side:R.side=v.shadowSide!==null?v.shadowSide:u[v.side],R.alphaMap=v.alphaMap,R.alphaTest=v.alphaTest,R.clipShadows=v.clipShadows,R.clippingPlanes=v.clippingPlanes,R.clipIntersection=v.clipIntersection,R.displacementMap=v.displacementMap,R.displacementScale=v.displacementScale,R.displacementBias=v.displacementBias,R.wireframeLinewidth=v.wireframeLinewidth,R.linewidth=v.linewidth,M.isPointLight===!0&&R.isMeshDistanceMaterial===!0&&(R.referencePosition.setFromMatrixPosition(M.matrixWorld),R.nearDistance=S,R.farDistance=w),R}function b(y,v,M,S,w){if(y.visible===!1)return;if(y.layers.test(v.layers)&&(y.isMesh||y.isLine||y.isPoints)&&(y.castShadow||y.receiveShadow&&w===Ws)&&(!y.frustumCulled||i.intersectsObject(y))){y.modelViewMatrix.multiplyMatrices(M.matrixWorldInverse,y.matrixWorld);const D=e.update(y),I=y.material;if(Array.isArray(I)){const U=D.groups;for(let A=0,B=U.length;A<B;A++){const O=U[A],q=I[O.materialIndex];if(q&&q.visible){const Z=x(y,q,S,M.near,M.far,w);l.renderBufferDirect(M,null,D,Z,y,O)}}}else if(I.visible){const U=x(y,I,S,M.near,M.far,w);l.renderBufferDirect(M,null,D,U,y,null)}}const R=y.children;for(let D=0,I=R.length;D<I;D++)b(R[D],v,M,S,w)}}function W3(l,e,t){const i=t.isWebGL2;function n(){let N=!1;const ae=new it;let re=null;const Ee=new it(0,0,0,0);return{setMask:function(Me){re!==Me&&!N&&(l.colorMask(Me,Me,Me,Me),re=Me)},setLocked:function(Me){N=Me},setClear:function(Me,Oe,ve,Ie,We){We===!0&&(Me*=Ie,Oe*=Ie,ve*=Ie),ae.set(Me,Oe,ve,Ie),Ee.equals(ae)===!1&&(l.clearColor(Me,Oe,ve,Ie),Ee.copy(ae))},reset:function(){N=!1,re=null,Ee.set(-1,0,0,0)}}}function r(){let N=!1,ae=null,re=null,Ee=null;return{setTest:function(Me){Me?K(2929):G(2929)},setMask:function(Me){ae!==Me&&!N&&(l.depthMask(Me),ae=Me)},setFunc:function(Me){if(re!==Me){if(Me)switch(Me){case Jm:l.depthFunc(512);break;case Km:l.depthFunc(519);break;case Qm:l.depthFunc(513);break;case hc:l.depthFunc(515);break;case $m:l.depthFunc(514);break;case e0:l.depthFunc(518);break;case t0:l.depthFunc(516);break;case n0:l.depthFunc(517);break;default:l.depthFunc(515)}else l.depthFunc(515);re=Me}},setLocked:function(Me){N=Me},setClear:function(Me){Ee!==Me&&(l.clearDepth(Me),Ee=Me)},reset:function(){N=!1,ae=null,re=null,Ee=null}}}function s(){let N=!1,ae=null,re=null,Ee=null,Me=null,Oe=null,ve=null,Ie=null,We=null;return{setTest:function(je){N||(je?K(2960):G(2960))},setMask:function(je){ae!==je&&!N&&(l.stencilMask(je),ae=je)},setFunc:function(je,Qe,Ht){(re!==je||Ee!==Qe||Me!==Ht)&&(l.stencilFunc(je,Qe,Ht),re=je,Ee=Qe,Me=Ht)},setOp:function(je,Qe,Ht){(Oe!==je||ve!==Qe||Ie!==Ht)&&(l.stencilOp(je,Qe,Ht),Oe=je,ve=Qe,Ie=Ht)},setLocked:function(je){N=je},setClear:function(je){We!==je&&(l.clearStencil(je),We=je)},reset:function(){N=!1,ae=null,re=null,Ee=null,Me=null,Oe=null,ve=null,Ie=null,We=null}}}const o=new n,a=new r,c=new s;let h={},u={},f=new WeakMap,d=[],g=null,p=!1,m=null,_=null,x=null,b=null,y=null,v=null,M=null,S=!1,w=null,T=null,R=null,D=null,I=null;const U=l.getParameter(35661);let A=!1,B=0;const O=l.getParameter(7938);O.indexOf("WebGL")!==-1?(B=parseFloat(/^WebGL (\d)/.exec(O)[1]),A=B>=1):O.indexOf("OpenGL ES")!==-1&&(B=parseFloat(/^OpenGL ES (\d)/.exec(O)[1]),A=B>=2);let q=null,Z={};const k=l.getParameter(3088),V=l.getParameter(2978),F=new it().fromArray(k),z=new it().fromArray(V);function X(N,ae,re){const Ee=new Uint8Array(4),Me=l.createTexture();l.bindTexture(N,Me),l.texParameteri(N,10241,9728),l.texParameteri(N,10240,9728);for(let Oe=0;Oe<re;Oe++)l.texImage2D(ae+Oe,0,6408,1,1,0,6408,5121,Ee);return Me}const j={};j[3553]=X(3553,3553,1),j[34067]=X(34067,34069,6),o.setClear(0,0,0,1),a.setClear(1),c.setClear(0),K(2929),a.setFunc(hc),ue(!1),xe(su),K(2884),W(Ei);function K(N){h[N]!==!0&&(l.enable(N),h[N]=!0)}function G(N){h[N]!==!1&&(l.disable(N),h[N]=!1)}function ee(N,ae){return u[N]!==ae?(l.bindFramebuffer(N,ae),u[N]=ae,i&&(N===36009&&(u[36160]=ae),N===36160&&(u[36009]=ae)),!0):!1}function ne(N,ae){let re=d,Ee=!1;if(N)if(re=f.get(ae),re===void 0&&(re=[],f.set(ae,re)),N.isWebGLMultipleRenderTargets){const Me=N.texture;if(re.length!==Me.length||re[0]!==36064){for(let Oe=0,ve=Me.length;Oe<ve;Oe++)re[Oe]=36064+Oe;re.length=Me.length,Ee=!0}}else re[0]!==36064&&(re[0]=36064,Ee=!0);else re[0]!==1029&&(re[0]=1029,Ee=!0);Ee&&(t.isWebGL2?l.drawBuffers(re):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(re))}function de(N){return g!==N?(l.useProgram(N),g=N,!0):!1}const le={[Hr]:32774,[Bm]:32778,[zm]:32779};if(i)le[cu]=32775,le[hu]=32776;else{const N=e.get("EXT_blend_minmax");N!==null&&(le[cu]=N.MIN_EXT,le[hu]=N.MAX_EXT)}const ge={[Gm]:0,[Vm]:1,[Hm]:768,[sf]:770,[jm]:776,[Ym]:774,[Xm]:772,[Wm]:769,[of]:771,[Zm]:775,[qm]:773};function W(N,ae,re,Ee,Me,Oe,ve,Ie){if(N===Ei){p===!0&&(G(3042),p=!1);return}if(p===!1&&(K(3042),p=!0),N!==Nm){if(N!==m||Ie!==S){if((_!==Hr||y!==Hr)&&(l.blendEquation(32774),_=Hr,y=Hr),Ie)switch(N){case Kr:l.blendFuncSeparate(1,771,1,771);break;case ou:l.blendFunc(1,1);break;case au:l.blendFuncSeparate(0,769,0,1);break;case lu:l.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",N);break}else switch(N){case Kr:l.blendFuncSeparate(770,771,1,771);break;case ou:l.blendFunc(770,1);break;case au:l.blendFuncSeparate(0,769,0,1);break;case lu:l.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",N);break}x=null,b=null,v=null,M=null,m=N,S=Ie}return}Me=Me||ae,Oe=Oe||re,ve=ve||Ee,(ae!==_||Me!==y)&&(l.blendEquationSeparate(le[ae],le[Me]),_=ae,y=Me),(re!==x||Ee!==b||Oe!==v||ve!==M)&&(l.blendFuncSeparate(ge[re],ge[Ee],ge[Oe],ge[ve]),x=re,b=Ee,v=Oe,M=ve),m=N,S=null}function se(N,ae){N.side===ui?G(2884):K(2884);let re=N.side===tn;ae&&(re=!re),ue(re),N.blending===Kr&&N.transparent===!1?W(Ei):W(N.blending,N.blendEquation,N.blendSrc,N.blendDst,N.blendEquationAlpha,N.blendSrcAlpha,N.blendDstAlpha,N.premultipliedAlpha),a.setFunc(N.depthFunc),a.setTest(N.depthTest),a.setMask(N.depthWrite),o.setMask(N.colorWrite);const Ee=N.stencilWrite;c.setTest(Ee),Ee&&(c.setMask(N.stencilWriteMask),c.setFunc(N.stencilFunc,N.stencilRef,N.stencilFuncMask),c.setOp(N.stencilFail,N.stencilZFail,N.stencilZPass)),Pe(N.polygonOffset,N.polygonOffsetFactor,N.polygonOffsetUnits),N.alphaToCoverage===!0?K(32926):G(32926)}function ue(N){w!==N&&(N?l.frontFace(2304):l.frontFace(2305),w=N)}function xe(N){N!==Fm?(K(2884),N!==T&&(N===su?l.cullFace(1029):N===Om?l.cullFace(1028):l.cullFace(1032))):G(2884),T=N}function ce(N){N!==R&&(A&&l.lineWidth(N),R=N)}function Pe(N,ae,re){N?(K(32823),(D!==ae||I!==re)&&(l.polygonOffset(ae,re),D=ae,I=re)):G(32823)}function ie(N){N?K(3089):G(3089)}function ye(N){N===void 0&&(N=33984+U-1),q!==N&&(l.activeTexture(N),q=N)}function Se(N,ae){q===null&&ye();let re=Z[q];re===void 0&&(re={type:void 0,texture:void 0},Z[q]=re),(re.type!==N||re.texture!==ae)&&(l.bindTexture(N,ae||j[N]),re.type=N,re.texture=ae)}function oe(){const N=Z[q];N!==void 0&&N.type!==void 0&&(l.bindTexture(N.type,null),N.type=void 0,N.texture=void 0)}function E(){try{l.compressedTexImage2D.apply(l,arguments)}catch(N){console.error("THREE.WebGLState:",N)}}function C(){try{l.texSubImage2D.apply(l,arguments)}catch(N){console.error("THREE.WebGLState:",N)}}function H(){try{l.texSubImage3D.apply(l,arguments)}catch(N){console.error("THREE.WebGLState:",N)}}function Q(){try{l.compressedTexSubImage2D.apply(l,arguments)}catch(N){console.error("THREE.WebGLState:",N)}}function fe(){try{l.texStorage2D.apply(l,arguments)}catch(N){console.error("THREE.WebGLState:",N)}}function _e(){try{l.texStorage3D.apply(l,arguments)}catch(N){console.error("THREE.WebGLState:",N)}}function me(){try{l.texImage2D.apply(l,arguments)}catch(N){console.error("THREE.WebGLState:",N)}}function Y(){try{l.texImage3D.apply(l,arguments)}catch(N){console.error("THREE.WebGLState:",N)}}function Le(N){F.equals(N)===!1&&(l.scissor(N.x,N.y,N.z,N.w),F.copy(N))}function be(N){z.equals(N)===!1&&(l.viewport(N.x,N.y,N.z,N.w),z.copy(N))}function we(){l.disable(3042),l.disable(2884),l.disable(2929),l.disable(32823),l.disable(3089),l.disable(2960),l.disable(32926),l.blendEquation(32774),l.blendFunc(1,0),l.blendFuncSeparate(1,0,1,0),l.colorMask(!0,!0,!0,!0),l.clearColor(0,0,0,0),l.depthMask(!0),l.depthFunc(513),l.clearDepth(1),l.stencilMask(4294967295),l.stencilFunc(519,0,4294967295),l.stencilOp(7680,7680,7680),l.clearStencil(0),l.cullFace(1029),l.frontFace(2305),l.polygonOffset(0,0),l.activeTexture(33984),l.bindFramebuffer(36160,null),i===!0&&(l.bindFramebuffer(36009,null),l.bindFramebuffer(36008,null)),l.useProgram(null),l.lineWidth(1),l.scissor(0,0,l.canvas.width,l.canvas.height),l.viewport(0,0,l.canvas.width,l.canvas.height),h={},q=null,Z={},u={},f=new WeakMap,d=[],g=null,p=!1,m=null,_=null,x=null,b=null,y=null,v=null,M=null,S=!1,w=null,T=null,R=null,D=null,I=null,F.set(0,0,l.canvas.width,l.canvas.height),z.set(0,0,l.canvas.width,l.canvas.height),o.reset(),a.reset(),c.reset()}return{buffers:{color:o,depth:a,stencil:c},enable:K,disable:G,bindFramebuffer:ee,drawBuffers:ne,useProgram:de,setBlending:W,setMaterial:se,setFlipSided:ue,setCullFace:xe,setLineWidth:ce,setPolygonOffset:Pe,setScissorTest:ie,activeTexture:ye,bindTexture:Se,unbindTexture:oe,compressedTexImage2D:E,texImage2D:me,texImage3D:Y,texStorage2D:fe,texStorage3D:_e,texSubImage2D:C,texSubImage3D:H,compressedTexSubImage2D:Q,scissor:Le,viewport:be,reset:we}}function X3(l,e,t,i,n,r,s){const o=n.isWebGL2,a=n.maxTextures,c=n.maxCubemapSize,h=n.maxTextureSize,u=n.maxSamples,f=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,d=/OculusBrowser/g.test(navigator.userAgent),g=new WeakMap;let p;const m=new WeakMap;let _=!1;try{_=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function x(E,C){return _?new OffscreenCanvas(E,C):Ca("canvas")}function b(E,C,H,Q){let fe=1;if((E.width>Q||E.height>Q)&&(fe=Q/Math.max(E.width,E.height)),fe<1||C===!0)if(typeof HTMLImageElement!="undefined"&&E instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&E instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&E instanceof ImageBitmap){const _e=C?dc:Math.floor,me=_e(fe*E.width),Y=_e(fe*E.height);p===void 0&&(p=x(me,Y));const Le=H?x(me,Y):p;return Le.width=me,Le.height=Y,Le.getContext("2d").drawImage(E,0,0,me,Y),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+E.width+"x"+E.height+") to ("+me+"x"+Y+")."),Le}else return"data"in E&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+E.width+"x"+E.height+")."),E;return E}function y(E){return Iu(E.width)&&Iu(E.height)}function v(E){return o?!1:E.wrapS!==Yt||E.wrapT!==Yt||E.minFilter!==Tt&&E.minFilter!==dt}function M(E,C){return E.generateMipmaps&&C&&E.minFilter!==Tt&&E.minFilter!==dt}function S(E){l.generateMipmap(E)}function w(E,C,H,Q,fe=!1){if(o===!1)return C;if(E!==null){if(l[E]!==void 0)return l[E];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+E+"'")}let _e=C;return C===6403&&(H===5126&&(_e=33326),H===5131&&(_e=33325),H===5121&&(_e=33321)),C===33319&&(H===5126&&(_e=33328),H===5131&&(_e=33327),H===5121&&(_e=33323)),C===6408&&(H===5126&&(_e=34836),H===5131&&(_e=34842),H===5121&&(_e=Q===nt&&fe===!1?35907:32856),H===32819&&(_e=32854),H===32820&&(_e=32855)),(_e===33325||_e===33326||_e===33327||_e===33328||_e===34842||_e===34836)&&e.get("EXT_color_buffer_float"),_e}function T(E,C,H){return M(E,H)===!0||E.isFramebufferTexture&&E.minFilter!==Tt&&E.minFilter!==dt?Math.log2(Math.max(C.width,C.height))+1:E.mipmaps!==void 0&&E.mipmaps.length>0?E.mipmaps.length:E.isCompressedTexture&&Array.isArray(E.image)?C.mipmaps.length:1}function R(E){return E===Tt||E===wa||E===Ma?9728:9729}function D(E){const C=E.target;C.removeEventListener("dispose",D),U(C),C.isVideoTexture&&g.delete(C)}function I(E){const C=E.target;C.removeEventListener("dispose",I),B(C)}function U(E){const C=i.get(E);if(C.__webglInit===void 0)return;const H=E.source,Q=m.get(H);if(Q){const fe=Q[C.__cacheKey];fe.usedTimes--,fe.usedTimes===0&&A(E),Object.keys(Q).length===0&&m.delete(H)}i.remove(E)}function A(E){const C=i.get(E);l.deleteTexture(C.__webglTexture);const H=E.source,Q=m.get(H);delete Q[C.__cacheKey],s.memory.textures--}function B(E){const C=E.texture,H=i.get(E),Q=i.get(C);if(Q.__webglTexture!==void 0&&(l.deleteTexture(Q.__webglTexture),s.memory.textures--),E.depthTexture&&E.depthTexture.dispose(),E.isWebGLCubeRenderTarget)for(let fe=0;fe<6;fe++)l.deleteFramebuffer(H.__webglFramebuffer[fe]),H.__webglDepthbuffer&&l.deleteRenderbuffer(H.__webglDepthbuffer[fe]);else{if(l.deleteFramebuffer(H.__webglFramebuffer),H.__webglDepthbuffer&&l.deleteRenderbuffer(H.__webglDepthbuffer),H.__webglMultisampledFramebuffer&&l.deleteFramebuffer(H.__webglMultisampledFramebuffer),H.__webglColorRenderbuffer)for(let fe=0;fe<H.__webglColorRenderbuffer.length;fe++)H.__webglColorRenderbuffer[fe]&&l.deleteRenderbuffer(H.__webglColorRenderbuffer[fe]);H.__webglDepthRenderbuffer&&l.deleteRenderbuffer(H.__webglDepthRenderbuffer)}if(E.isWebGLMultipleRenderTargets)for(let fe=0,_e=C.length;fe<_e;fe++){const me=i.get(C[fe]);me.__webglTexture&&(l.deleteTexture(me.__webglTexture),s.memory.textures--),i.remove(C[fe])}i.remove(C),i.remove(E)}let O=0;function q(){O=0}function Z(){const E=O;return E>=a&&console.warn("THREE.WebGLTextures: Trying to use "+E+" texture units while this GPU supports only "+a),O+=1,E}function k(E){const C=[];return C.push(E.wrapS),C.push(E.wrapT),C.push(E.magFilter),C.push(E.minFilter),C.push(E.anisotropy),C.push(E.internalFormat),C.push(E.format),C.push(E.type),C.push(E.generateMipmaps),C.push(E.premultiplyAlpha),C.push(E.flipY),C.push(E.unpackAlignment),C.push(E.encoding),C.join()}function V(E,C){const H=i.get(E);if(E.isVideoTexture&&Se(E),E.isRenderTargetTexture===!1&&E.version>0&&H.__version!==E.version){const Q=E.image;if(Q===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Q.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ne(H,E,C);return}}t.activeTexture(33984+C),t.bindTexture(3553,H.__webglTexture)}function F(E,C){const H=i.get(E);if(E.version>0&&H.__version!==E.version){ne(H,E,C);return}t.activeTexture(33984+C),t.bindTexture(35866,H.__webglTexture)}function z(E,C){const H=i.get(E);if(E.version>0&&H.__version!==E.version){ne(H,E,C);return}t.activeTexture(33984+C),t.bindTexture(32879,H.__webglTexture)}function X(E,C){const H=i.get(E);if(E.version>0&&H.__version!==E.version){de(H,E,C);return}t.activeTexture(33984+C),t.bindTexture(34067,H.__webglTexture)}const j={[fr]:10497,[Yt]:33071,[ro]:33648},K={[Tt]:9728,[wa]:9984,[Ma]:9986,[dt]:9729,[Sc]:9985,[Ui]:9987};function G(E,C,H){if(H?(l.texParameteri(E,10242,j[C.wrapS]),l.texParameteri(E,10243,j[C.wrapT]),(E===32879||E===35866)&&l.texParameteri(E,32882,j[C.wrapR]),l.texParameteri(E,10240,K[C.magFilter]),l.texParameteri(E,10241,K[C.minFilter])):(l.texParameteri(E,10242,33071),l.texParameteri(E,10243,33071),(E===32879||E===35866)&&l.texParameteri(E,32882,33071),(C.wrapS!==Yt||C.wrapT!==Yt)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),l.texParameteri(E,10240,R(C.magFilter)),l.texParameteri(E,10241,R(C.minFilter)),C.minFilter!==Tt&&C.minFilter!==dt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const Q=e.get("EXT_texture_filter_anisotropic");if(C.type===Ai&&e.has("OES_texture_float_linear")===!1||o===!1&&C.type===so&&e.has("OES_texture_half_float_linear")===!1)return;(C.anisotropy>1||i.get(C).__currentAnisotropy)&&(l.texParameterf(E,Q.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(C.anisotropy,n.getMaxAnisotropy())),i.get(C).__currentAnisotropy=C.anisotropy)}}function ee(E,C){let H=!1;E.__webglInit===void 0&&(E.__webglInit=!0,C.addEventListener("dispose",D));const Q=C.source;let fe=m.get(Q);fe===void 0&&(fe={},m.set(Q,fe));const _e=k(C);if(_e!==E.__cacheKey){fe[_e]===void 0&&(fe[_e]={texture:l.createTexture(),usedTimes:0},s.memory.textures++,H=!0),fe[_e].usedTimes++;const me=fe[E.__cacheKey];me!==void 0&&(fe[E.__cacheKey].usedTimes--,me.usedTimes===0&&A(C)),E.__cacheKey=_e,E.__webglTexture=fe[_e].texture}return H}function ne(E,C,H){let Q=3553;C.isDataArrayTexture&&(Q=35866),C.isData3DTexture&&(Q=32879);const fe=ee(E,C),_e=C.source;if(t.activeTexture(33984+H),t.bindTexture(Q,E.__webglTexture),_e.version!==_e.__currentVersion||fe===!0){l.pixelStorei(37440,C.flipY),l.pixelStorei(37441,C.premultiplyAlpha),l.pixelStorei(3317,C.unpackAlignment),l.pixelStorei(37443,0);const me=v(C)&&y(C.image)===!1;let Y=b(C.image,me,!1,h);Y=oe(C,Y);const Le=y(Y)||o,be=r.convert(C.format,C.encoding);let we=r.convert(C.type),N=w(C.internalFormat,be,we,C.encoding,C.isVideoTexture);G(Q,C,Le);let ae;const re=C.mipmaps,Ee=o&&C.isVideoTexture!==!0,Me=_e.__currentVersion===void 0||fe===!0,Oe=T(C,Y,Le);if(C.isDepthTexture)N=6402,o?C.type===Ai?N=36012:C.type===tr?N=33190:C.type===Qr?N=35056:N=33189:C.type===Ai&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),C.format===ar&&N===6402&&C.type!==af&&C.type!==tr&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),C.type=tr,we=r.convert(C.type)),C.format===as&&N===6402&&(N=34041,C.type!==Qr&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),C.type=Qr,we=r.convert(C.type))),Me&&(Ee?t.texStorage2D(3553,1,N,Y.width,Y.height):t.texImage2D(3553,0,N,Y.width,Y.height,0,be,we,null));else if(C.isDataTexture)if(re.length>0&&Le){Ee&&Me&&t.texStorage2D(3553,Oe,N,re[0].width,re[0].height);for(let ve=0,Ie=re.length;ve<Ie;ve++)ae=re[ve],Ee?t.texSubImage2D(3553,ve,0,0,ae.width,ae.height,be,we,ae.data):t.texImage2D(3553,ve,N,ae.width,ae.height,0,be,we,ae.data);C.generateMipmaps=!1}else Ee?(Me&&t.texStorage2D(3553,Oe,N,Y.width,Y.height),t.texSubImage2D(3553,0,0,0,Y.width,Y.height,be,we,Y.data)):t.texImage2D(3553,0,N,Y.width,Y.height,0,be,we,Y.data);else if(C.isCompressedTexture){Ee&&Me&&t.texStorage2D(3553,Oe,N,re[0].width,re[0].height);for(let ve=0,Ie=re.length;ve<Ie;ve++)ae=re[ve],C.format!==vn?be!==null?Ee?t.compressedTexSubImage2D(3553,ve,0,0,ae.width,ae.height,be,ae.data):t.compressedTexImage2D(3553,ve,N,ae.width,ae.height,0,ae.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ee?t.texSubImage2D(3553,ve,0,0,ae.width,ae.height,be,we,ae.data):t.texImage2D(3553,ve,N,ae.width,ae.height,0,be,we,ae.data)}else if(C.isDataArrayTexture)Ee?(Me&&t.texStorage3D(35866,Oe,N,Y.width,Y.height,Y.depth),t.texSubImage3D(35866,0,0,0,0,Y.width,Y.height,Y.depth,be,we,Y.data)):t.texImage3D(35866,0,N,Y.width,Y.height,Y.depth,0,be,we,Y.data);else if(C.isData3DTexture)Ee?(Me&&t.texStorage3D(32879,Oe,N,Y.width,Y.height,Y.depth),t.texSubImage3D(32879,0,0,0,0,Y.width,Y.height,Y.depth,be,we,Y.data)):t.texImage3D(32879,0,N,Y.width,Y.height,Y.depth,0,be,we,Y.data);else if(C.isFramebufferTexture){if(Me)if(Ee)t.texStorage2D(3553,Oe,N,Y.width,Y.height);else{let ve=Y.width,Ie=Y.height;for(let We=0;We<Oe;We++)t.texImage2D(3553,We,N,ve,Ie,0,be,we,null),ve>>=1,Ie>>=1}}else if(re.length>0&&Le){Ee&&Me&&t.texStorage2D(3553,Oe,N,re[0].width,re[0].height);for(let ve=0,Ie=re.length;ve<Ie;ve++)ae=re[ve],Ee?t.texSubImage2D(3553,ve,0,0,be,we,ae):t.texImage2D(3553,ve,N,be,we,ae);C.generateMipmaps=!1}else Ee?(Me&&t.texStorage2D(3553,Oe,N,Y.width,Y.height),t.texSubImage2D(3553,0,0,0,be,we,Y)):t.texImage2D(3553,0,N,be,we,Y);M(C,Le)&&S(Q),_e.__currentVersion=_e.version,C.onUpdate&&C.onUpdate(C)}E.__version=C.version}function de(E,C,H){if(C.image.length!==6)return;const Q=ee(E,C),fe=C.source;if(t.activeTexture(33984+H),t.bindTexture(34067,E.__webglTexture),fe.version!==fe.__currentVersion||Q===!0){l.pixelStorei(37440,C.flipY),l.pixelStorei(37441,C.premultiplyAlpha),l.pixelStorei(3317,C.unpackAlignment),l.pixelStorei(37443,0);const _e=C.isCompressedTexture||C.image[0].isCompressedTexture,me=C.image[0]&&C.image[0].isDataTexture,Y=[];for(let ve=0;ve<6;ve++)!_e&&!me?Y[ve]=b(C.image[ve],!1,!0,c):Y[ve]=me?C.image[ve].image:C.image[ve],Y[ve]=oe(C,Y[ve]);const Le=Y[0],be=y(Le)||o,we=r.convert(C.format,C.encoding),N=r.convert(C.type),ae=w(C.internalFormat,we,N,C.encoding),re=o&&C.isVideoTexture!==!0,Ee=fe.__currentVersion===void 0||Q===!0;let Me=T(C,Le,be);G(34067,C,be);let Oe;if(_e){re&&Ee&&t.texStorage2D(34067,Me,ae,Le.width,Le.height);for(let ve=0;ve<6;ve++){Oe=Y[ve].mipmaps;for(let Ie=0;Ie<Oe.length;Ie++){const We=Oe[Ie];C.format!==vn?we!==null?re?t.compressedTexSubImage2D(34069+ve,Ie,0,0,We.width,We.height,we,We.data):t.compressedTexImage2D(34069+ve,Ie,ae,We.width,We.height,0,We.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):re?t.texSubImage2D(34069+ve,Ie,0,0,We.width,We.height,we,N,We.data):t.texImage2D(34069+ve,Ie,ae,We.width,We.height,0,we,N,We.data)}}}else{Oe=C.mipmaps,re&&Ee&&(Oe.length>0&&Me++,t.texStorage2D(34067,Me,ae,Y[0].width,Y[0].height));for(let ve=0;ve<6;ve++)if(me){re?t.texSubImage2D(34069+ve,0,0,0,Y[ve].width,Y[ve].height,we,N,Y[ve].data):t.texImage2D(34069+ve,0,ae,Y[ve].width,Y[ve].height,0,we,N,Y[ve].data);for(let Ie=0;Ie<Oe.length;Ie++){const je=Oe[Ie].image[ve].image;re?t.texSubImage2D(34069+ve,Ie+1,0,0,je.width,je.height,we,N,je.data):t.texImage2D(34069+ve,Ie+1,ae,je.width,je.height,0,we,N,je.data)}}else{re?t.texSubImage2D(34069+ve,0,0,0,we,N,Y[ve]):t.texImage2D(34069+ve,0,ae,we,N,Y[ve]);for(let Ie=0;Ie<Oe.length;Ie++){const We=Oe[Ie];re?t.texSubImage2D(34069+ve,Ie+1,0,0,we,N,We.image[ve]):t.texImage2D(34069+ve,Ie+1,ae,we,N,We.image[ve])}}}M(C,be)&&S(34067),fe.__currentVersion=fe.version,C.onUpdate&&C.onUpdate(C)}E.__version=C.version}function le(E,C,H,Q,fe){const _e=r.convert(H.format,H.encoding),me=r.convert(H.type),Y=w(H.internalFormat,_e,me,H.encoding);i.get(C).__hasExternalTextures||(fe===32879||fe===35866?t.texImage3D(fe,0,Y,C.width,C.height,C.depth,0,_e,me,null):t.texImage2D(fe,0,Y,C.width,C.height,0,_e,me,null)),t.bindFramebuffer(36160,E),ye(C)?f.framebufferTexture2DMultisampleEXT(36160,Q,fe,i.get(H).__webglTexture,0,ie(C)):l.framebufferTexture2D(36160,Q,fe,i.get(H).__webglTexture,0),t.bindFramebuffer(36160,null)}function ge(E,C,H){if(l.bindRenderbuffer(36161,E),C.depthBuffer&&!C.stencilBuffer){let Q=33189;if(H||ye(C)){const fe=C.depthTexture;fe&&fe.isDepthTexture&&(fe.type===Ai?Q=36012:fe.type===tr&&(Q=33190));const _e=ie(C);ye(C)?f.renderbufferStorageMultisampleEXT(36161,_e,Q,C.width,C.height):l.renderbufferStorageMultisample(36161,_e,Q,C.width,C.height)}else l.renderbufferStorage(36161,Q,C.width,C.height);l.framebufferRenderbuffer(36160,36096,36161,E)}else if(C.depthBuffer&&C.stencilBuffer){const Q=ie(C);H&&ye(C)===!1?l.renderbufferStorageMultisample(36161,Q,35056,C.width,C.height):ye(C)?f.renderbufferStorageMultisampleEXT(36161,Q,35056,C.width,C.height):l.renderbufferStorage(36161,34041,C.width,C.height),l.framebufferRenderbuffer(36160,33306,36161,E)}else{const Q=C.isWebGLMultipleRenderTargets===!0?C.texture:[C.texture];for(let fe=0;fe<Q.length;fe++){const _e=Q[fe],me=r.convert(_e.format,_e.encoding),Y=r.convert(_e.type),Le=w(_e.internalFormat,me,Y,_e.encoding),be=ie(C);H&&ye(C)===!1?l.renderbufferStorageMultisample(36161,be,Le,C.width,C.height):ye(C)?f.renderbufferStorageMultisampleEXT(36161,be,Le,C.width,C.height):l.renderbufferStorage(36161,Le,C.width,C.height)}}l.bindRenderbuffer(36161,null)}function W(E,C){if(C&&C.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,E),!(C.depthTexture&&C.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(C.depthTexture).__webglTexture||C.depthTexture.image.width!==C.width||C.depthTexture.image.height!==C.height)&&(C.depthTexture.image.width=C.width,C.depthTexture.image.height=C.height,C.depthTexture.needsUpdate=!0),V(C.depthTexture,0);const Q=i.get(C.depthTexture).__webglTexture,fe=ie(C);if(C.depthTexture.format===ar)ye(C)?f.framebufferTexture2DMultisampleEXT(36160,36096,3553,Q,0,fe):l.framebufferTexture2D(36160,36096,3553,Q,0);else if(C.depthTexture.format===as)ye(C)?f.framebufferTexture2DMultisampleEXT(36160,33306,3553,Q,0,fe):l.framebufferTexture2D(36160,33306,3553,Q,0);else throw new Error("Unknown depthTexture format")}function se(E){const C=i.get(E),H=E.isWebGLCubeRenderTarget===!0;if(E.depthTexture&&!C.__autoAllocateDepthBuffer){if(H)throw new Error("target.depthTexture not supported in Cube render targets");W(C.__webglFramebuffer,E)}else if(H){C.__webglDepthbuffer=[];for(let Q=0;Q<6;Q++)t.bindFramebuffer(36160,C.__webglFramebuffer[Q]),C.__webglDepthbuffer[Q]=l.createRenderbuffer(),ge(C.__webglDepthbuffer[Q],E,!1)}else t.bindFramebuffer(36160,C.__webglFramebuffer),C.__webglDepthbuffer=l.createRenderbuffer(),ge(C.__webglDepthbuffer,E,!1);t.bindFramebuffer(36160,null)}function ue(E,C,H){const Q=i.get(E);C!==void 0&&le(Q.__webglFramebuffer,E,E.texture,36064,3553),H!==void 0&&se(E)}function xe(E){const C=E.texture,H=i.get(E),Q=i.get(C);E.addEventListener("dispose",I),E.isWebGLMultipleRenderTargets!==!0&&(Q.__webglTexture===void 0&&(Q.__webglTexture=l.createTexture()),Q.__version=C.version,s.memory.textures++);const fe=E.isWebGLCubeRenderTarget===!0,_e=E.isWebGLMultipleRenderTargets===!0,me=y(E)||o;if(fe){H.__webglFramebuffer=[];for(let Y=0;Y<6;Y++)H.__webglFramebuffer[Y]=l.createFramebuffer()}else{if(H.__webglFramebuffer=l.createFramebuffer(),_e)if(n.drawBuffers){const Y=E.texture;for(let Le=0,be=Y.length;Le<be;Le++){const we=i.get(Y[Le]);we.__webglTexture===void 0&&(we.__webglTexture=l.createTexture(),s.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(o&&E.samples>0&&ye(E)===!1){const Y=_e?C:[C];H.__webglMultisampledFramebuffer=l.createFramebuffer(),H.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,H.__webglMultisampledFramebuffer);for(let Le=0;Le<Y.length;Le++){const be=Y[Le];H.__webglColorRenderbuffer[Le]=l.createRenderbuffer(),l.bindRenderbuffer(36161,H.__webglColorRenderbuffer[Le]);const we=r.convert(be.format,be.encoding),N=r.convert(be.type),ae=w(be.internalFormat,we,N,be.encoding),re=ie(E);l.renderbufferStorageMultisample(36161,re,ae,E.width,E.height),l.framebufferRenderbuffer(36160,36064+Le,36161,H.__webglColorRenderbuffer[Le])}l.bindRenderbuffer(36161,null),E.depthBuffer&&(H.__webglDepthRenderbuffer=l.createRenderbuffer(),ge(H.__webglDepthRenderbuffer,E,!0)),t.bindFramebuffer(36160,null)}}if(fe){t.bindTexture(34067,Q.__webglTexture),G(34067,C,me);for(let Y=0;Y<6;Y++)le(H.__webglFramebuffer[Y],E,C,36064,34069+Y);M(C,me)&&S(34067),t.unbindTexture()}else if(_e){const Y=E.texture;for(let Le=0,be=Y.length;Le<be;Le++){const we=Y[Le],N=i.get(we);t.bindTexture(3553,N.__webglTexture),G(3553,we,me),le(H.__webglFramebuffer,E,we,36064+Le,3553),M(we,me)&&S(3553)}t.unbindTexture()}else{let Y=3553;(E.isWebGL3DRenderTarget||E.isWebGLArrayRenderTarget)&&(o?Y=E.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Y,Q.__webglTexture),G(Y,C,me),le(H.__webglFramebuffer,E,C,36064,Y),M(C,me)&&S(Y),t.unbindTexture()}E.depthBuffer&&se(E)}function ce(E){const C=y(E)||o,H=E.isWebGLMultipleRenderTargets===!0?E.texture:[E.texture];for(let Q=0,fe=H.length;Q<fe;Q++){const _e=H[Q];if(M(_e,C)){const me=E.isWebGLCubeRenderTarget?34067:3553,Y=i.get(_e).__webglTexture;t.bindTexture(me,Y),S(me),t.unbindTexture()}}}function Pe(E){if(o&&E.samples>0&&ye(E)===!1){const C=E.isWebGLMultipleRenderTargets?E.texture:[E.texture],H=E.width,Q=E.height;let fe=16384;const _e=[],me=E.stencilBuffer?33306:36096,Y=i.get(E),Le=E.isWebGLMultipleRenderTargets===!0;if(Le)for(let be=0;be<C.length;be++)t.bindFramebuffer(36160,Y.__webglMultisampledFramebuffer),l.framebufferRenderbuffer(36160,36064+be,36161,null),t.bindFramebuffer(36160,Y.__webglFramebuffer),l.framebufferTexture2D(36009,36064+be,3553,null,0);t.bindFramebuffer(36008,Y.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,Y.__webglFramebuffer);for(let be=0;be<C.length;be++){_e.push(36064+be),E.depthBuffer&&_e.push(me);const we=Y.__ignoreDepthValues!==void 0?Y.__ignoreDepthValues:!1;if(we===!1&&(E.depthBuffer&&(fe|=256),E.stencilBuffer&&(fe|=1024)),Le&&l.framebufferRenderbuffer(36008,36064,36161,Y.__webglColorRenderbuffer[be]),we===!0&&(l.invalidateFramebuffer(36008,[me]),l.invalidateFramebuffer(36009,[me])),Le){const N=i.get(C[be]).__webglTexture;l.framebufferTexture2D(36009,36064,3553,N,0)}l.blitFramebuffer(0,0,H,Q,0,0,H,Q,fe,9728),d&&l.invalidateFramebuffer(36008,_e)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),Le)for(let be=0;be<C.length;be++){t.bindFramebuffer(36160,Y.__webglMultisampledFramebuffer),l.framebufferRenderbuffer(36160,36064+be,36161,Y.__webglColorRenderbuffer[be]);const we=i.get(C[be]).__webglTexture;t.bindFramebuffer(36160,Y.__webglFramebuffer),l.framebufferTexture2D(36009,36064+be,3553,we,0)}t.bindFramebuffer(36009,Y.__webglMultisampledFramebuffer)}}function ie(E){return Math.min(u,E.samples)}function ye(E){const C=i.get(E);return o&&E.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&C.__useRenderToTexture!==!1}function Se(E){const C=s.render.frame;g.get(E)!==C&&(g.set(E,C),E.update())}function oe(E,C){const H=E.encoding,Q=E.format,fe=E.type;return E.isCompressedTexture===!0||E.isVideoTexture===!0||E.format===fc||H!==pr&&(H===nt?o===!1?e.has("EXT_sRGB")===!0&&Q===vn?(E.format=fc,E.minFilter=dt,E.generateMipmaps=!1):C=ff.sRGBToLinear(C):(Q!==vn||fe!==dr)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",H)),C}this.allocateTextureUnit=Z,this.resetTextureUnits=q,this.setTexture2D=V,this.setTexture2DArray=F,this.setTexture3D=z,this.setTextureCube=X,this.rebindTextures=ue,this.setupRenderTarget=xe,this.updateRenderTargetMipmap=ce,this.updateMultisampleRenderTarget=Pe,this.setupDepthRenderbuffer=se,this.setupFrameBufferTexture=le,this.useMultisampledRTT=ye}function H0(l,e,t){const i=t.isWebGL2;function n(r,s=null){let o;if(r===dr)return 5121;if(r===d0)return 32819;if(r===p0)return 32820;if(r===h0)return 5120;if(r===u0)return 5122;if(r===af)return 5123;if(r===f0)return 5124;if(r===tr)return 5125;if(r===Ai)return 5126;if(r===so)return i?5131:(o=e.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(r===m0)return 6406;if(r===vn)return 6408;if(r===_0)return 6409;if(r===x0)return 6410;if(r===ar)return 6402;if(r===as)return 34041;if(r===v0)return 6403;if(r===g0)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(r===fc)return o=e.get("EXT_sRGB"),o!==null?o.SRGB_ALPHA_EXT:null;if(r===y0)return 36244;if(r===b0)return 33319;if(r===w0)return 33320;if(r===M0)return 36249;if(r===ec||r===tc||r===nc||r===ic)if(s===nt)if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(r===ec)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===tc)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===nc)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===ic)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(r===ec)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===tc)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===nc)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===ic)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(r===uu||r===fu||r===du||r===pu)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(r===uu)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===fu)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===du)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===pu)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(r===S0)return o=e.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(r===mu||r===gu)if(o=e.get("WEBGL_compressed_texture_etc"),o!==null){if(r===mu)return s===nt?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(r===gu)return s===nt?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(r===_u||r===xu||r===vu||r===yu||r===bu||r===wu||r===Mu||r===Su||r===Tu||r===Cu||r===Au||r===Eu||r===Lu||r===Ru)if(o=e.get("WEBGL_compressed_texture_astc"),o!==null){if(r===_u)return s===nt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===xu)return s===nt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===vu)return s===nt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===yu)return s===nt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===bu)return s===nt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===wu)return s===nt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===Mu)return s===nt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===Su)return s===nt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===Tu)return s===nt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===Cu)return s===nt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===Au)return s===nt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===Eu)return s===nt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===Lu)return s===nt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===Ru)return s===nt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(r===Pu)if(o=e.get("EXT_texture_compression_bptc"),o!==null){if(r===Pu)return s===nt?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;return r===Qr?i?34042:(o=e.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null):l[r]!==void 0?l[r]:null}return{convert:n}}class W0 extends Dt{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class bn extends $e{constructor(){super(),this.isGroup=!0,this.type="Group"}}const q3={type:"move"};class Ph{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new bn,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new bn,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new L,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new L),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new bn,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new L,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new L),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let n=null,r=null,s=null;const o=this._targetRay,a=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred")if(o!==null&&(n=t.getPose(e.targetRaySpace,i),n!==null&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(q3))),c&&e.hand){s=!0;for(const p of e.hand.values()){const m=t.getJointPose(p,i);if(c.joints[p.jointName]===void 0){const x=new bn;x.matrixAutoUpdate=!1,x.visible=!1,c.joints[p.jointName]=x,c.add(x)}const _=c.joints[p.jointName];m!==null&&(_.matrix.fromArray(m.transform.matrix),_.matrix.decompose(_.position,_.rotation,_.scale),_.jointRadius=m.radius),_.visible=m!==null}const h=c.joints["index-finger-tip"],u=c.joints["thumb-tip"],f=h.position.distanceTo(u.position),d=.02,g=.005;c.inputState.pinching&&f>d+g?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&f<=d-g&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else a!==null&&e.gripSpace&&(r=t.getPose(e.gripSpace,i),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1));return o!==null&&(o.visible=n!==null),a!==null&&(a.visible=r!==null),c!==null&&(c.visible=s!==null),this}}class X0 extends wt{constructor(e,t,i,n,r,s,o,a,c,h){if(h=h!==void 0?h:ar,h!==ar&&h!==as)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&h===ar&&(i=tr),i===void 0&&h===as&&(i=Qr),super(null,n,r,s,o,a,h,i,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=o!==void 0?o:Tt,this.minFilter=a!==void 0?a:Tt,this.flipY=!1,this.generateMipmaps=!1}}class Y3 extends Mr{constructor(e,t){super();const i=this;let n=null,r=1,s=null,o="local-floor",a=null,c=null,h=null,u=null,f=null,d=null;const g=t.getContextAttributes();let p=null,m=null;const _=[],x=new Map,b=new Dt;b.layers.enable(1),b.viewport=new it;const y=new Dt;y.layers.enable(2),y.viewport=new it;const v=[b,y],M=new W0;M.layers.enable(1),M.layers.enable(2);let S=null,w=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(k){let V=_[k];return V===void 0&&(V=new Ph,_[k]=V),V.getTargetRaySpace()},this.getControllerGrip=function(k){let V=_[k];return V===void 0&&(V=new Ph,_[k]=V),V.getGripSpace()},this.getHand=function(k){let V=_[k];return V===void 0&&(V=new Ph,_[k]=V),V.getHandSpace()};function T(k){const V=x.get(k.inputSource);V!==void 0&&V.dispatchEvent({type:k.type,data:k.inputSource})}function R(){n.removeEventListener("select",T),n.removeEventListener("selectstart",T),n.removeEventListener("selectend",T),n.removeEventListener("squeeze",T),n.removeEventListener("squeezestart",T),n.removeEventListener("squeezeend",T),n.removeEventListener("end",R),n.removeEventListener("inputsourceschange",D),x.forEach(function(k,V){k!==void 0&&k.disconnect(V)}),x.clear(),S=null,w=null,e.setRenderTarget(p),f=null,u=null,h=null,n=null,m=null,Z.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(k){r=k,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(k){o=k,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return a||s},this.setReferenceSpace=function(k){a=k},this.getBaseLayer=function(){return u!==null?u:f},this.getBinding=function(){return h},this.getFrame=function(){return d},this.getSession=function(){return n},this.setSession=async function(k){if(n=k,n!==null){if(p=e.getRenderTarget(),n.addEventListener("select",T),n.addEventListener("selectstart",T),n.addEventListener("selectend",T),n.addEventListener("squeeze",T),n.addEventListener("squeezestart",T),n.addEventListener("squeezeend",T),n.addEventListener("end",R),n.addEventListener("inputsourceschange",D),g.xrCompatible!==!0&&await t.makeXRCompatible(),n.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const V={antialias:n.renderState.layers===void 0?g.antialias:!0,alpha:g.alpha,depth:g.depth,stencil:g.stencil,framebufferScaleFactor:r};f=new XRWebGLLayer(n,t,V),n.updateRenderState({baseLayer:f}),m=new Mn(f.framebufferWidth,f.framebufferHeight,{format:vn,type:dr,encoding:e.outputEncoding})}else{let V=null,F=null,z=null;g.depth&&(z=g.stencil?35056:33190,V=g.stencil?as:ar,F=g.stencil?Qr:tr);const X={colorFormat:e.outputEncoding===nt?35907:32856,depthFormat:z,scaleFactor:r};h=new XRWebGLBinding(n,t),u=h.createProjectionLayer(X),n.updateRenderState({layers:[u]}),m=new Mn(u.textureWidth,u.textureHeight,{format:vn,type:dr,depthTexture:new X0(u.textureWidth,u.textureHeight,F,void 0,void 0,void 0,void 0,void 0,void 0,V),stencilBuffer:g.stencil,encoding:e.outputEncoding,samples:g.antialias?4:0});const j=e.properties.get(m);j.__ignoreDepthValues=u.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(1),a=null,s=await n.requestReferenceSpace(o),Z.setContext(n),Z.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}};function D(k){const V=n.inputSources;for(let F=0;F<V.length;F++){const z=V[F].handedness==="right"?1:0;x.set(V[F],_[z])}for(let F=0;F<k.removed.length;F++){const z=k.removed[F],X=x.get(z);X&&(X.dispatchEvent({type:"disconnected",data:z}),x.delete(z))}for(let F=0;F<k.added.length;F++){const z=k.added[F],X=x.get(z);X&&X.dispatchEvent({type:"connected",data:z})}}const I=new L,U=new L;function A(k,V,F){I.setFromMatrixPosition(V.matrixWorld),U.setFromMatrixPosition(F.matrixWorld);const z=I.distanceTo(U),X=V.projectionMatrix.elements,j=F.projectionMatrix.elements,K=X[14]/(X[10]-1),G=X[14]/(X[10]+1),ee=(X[9]+1)/X[5],ne=(X[9]-1)/X[5],de=(X[8]-1)/X[0],le=(j[8]+1)/j[0],ge=K*de,W=K*le,se=z/(-de+le),ue=se*-de;V.matrixWorld.decompose(k.position,k.quaternion,k.scale),k.translateX(ue),k.translateZ(se),k.matrixWorld.compose(k.position,k.quaternion,k.scale),k.matrixWorldInverse.copy(k.matrixWorld).invert();const xe=K+se,ce=G+se,Pe=ge-ue,ie=W+(z-ue),ye=ee*G/ce*xe,Se=ne*G/ce*xe;k.projectionMatrix.makePerspective(Pe,ie,ye,Se,xe,ce)}function B(k,V){V===null?k.matrixWorld.copy(k.matrix):k.matrixWorld.multiplyMatrices(V.matrixWorld,k.matrix),k.matrixWorldInverse.copy(k.matrixWorld).invert()}this.updateCamera=function(k){if(n===null)return;M.near=y.near=b.near=k.near,M.far=y.far=b.far=k.far,(S!==M.near||w!==M.far)&&(n.updateRenderState({depthNear:M.near,depthFar:M.far}),S=M.near,w=M.far);const V=k.parent,F=M.cameras;B(M,V);for(let X=0;X<F.length;X++)B(F[X],V);M.matrixWorld.decompose(M.position,M.quaternion,M.scale),k.position.copy(M.position),k.quaternion.copy(M.quaternion),k.scale.copy(M.scale),k.matrix.copy(M.matrix),k.matrixWorld.copy(M.matrixWorld);const z=k.children;for(let X=0,j=z.length;X<j;X++)z[X].updateMatrixWorld(!0);F.length===2?A(M,b,y):M.projectionMatrix.copy(b.projectionMatrix)},this.getCamera=function(){return M},this.getFoveation=function(){if(u!==null)return u.fixedFoveation;if(f!==null)return f.fixedFoveation},this.setFoveation=function(k){u!==null&&(u.fixedFoveation=k),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=k)};let O=null;function q(k,V){if(c=V.getViewerPose(a||s),d=V,c!==null){const z=c.views;f!==null&&(e.setRenderTargetFramebuffer(m,f.framebuffer),e.setRenderTarget(m));let X=!1;z.length!==M.cameras.length&&(M.cameras.length=0,X=!0);for(let j=0;j<z.length;j++){const K=z[j];let G=null;if(f!==null)G=f.getViewport(K);else{const ne=h.getViewSubImage(u,K);G=ne.viewport,j===0&&(e.setRenderTargetTextures(m,ne.colorTexture,u.ignoreDepthValues?void 0:ne.depthStencilTexture),e.setRenderTarget(m))}let ee=v[j];ee===void 0&&(ee=new Dt,ee.layers.enable(j),ee.viewport=new it,v[j]=ee),ee.matrix.fromArray(K.transform.matrix),ee.projectionMatrix.fromArray(K.projectionMatrix),ee.viewport.set(G.x,G.y,G.width,G.height),j===0&&M.matrix.copy(ee.matrix),X===!0&&M.cameras.push(ee)}}const F=n.inputSources;for(let z=0;z<_.length;z++){const X=F[z],j=x.get(X);j!==void 0&&j.update(X,V,a||s)}O&&O(k,V),d=null}const Z=new k0;Z.setAnimationLoop(q),this.setAnimationLoop=function(k){O=k},this.dispose=function(){}}}function Z3(l,e){function t(p,m){p.fogColor.value.copy(m.color),m.isFog?(p.fogNear.value=m.near,p.fogFar.value=m.far):m.isFogExp2&&(p.fogDensity.value=m.density)}function i(p,m,_,x,b){m.isMeshBasicMaterial||m.isMeshLambertMaterial?n(p,m):m.isMeshToonMaterial?(n(p,m),h(p,m)):m.isMeshPhongMaterial?(n(p,m),c(p,m)):m.isMeshStandardMaterial?(n(p,m),u(p,m),m.isMeshPhysicalMaterial&&f(p,m,b)):m.isMeshMatcapMaterial?(n(p,m),d(p,m)):m.isMeshDepthMaterial?n(p,m):m.isMeshDistanceMaterial?(n(p,m),g(p,m)):m.isMeshNormalMaterial?n(p,m):m.isLineBasicMaterial?(r(p,m),m.isLineDashedMaterial&&s(p,m)):m.isPointsMaterial?o(p,m,_,x):m.isSpriteMaterial?a(p,m):m.isShadowMaterial?(p.color.value.copy(m.color),p.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}function n(p,m){p.opacity.value=m.opacity,m.color&&p.diffuse.value.copy(m.color),m.emissive&&p.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(p.map.value=m.map),m.alphaMap&&(p.alphaMap.value=m.alphaMap),m.bumpMap&&(p.bumpMap.value=m.bumpMap,p.bumpScale.value=m.bumpScale,m.side===tn&&(p.bumpScale.value*=-1)),m.displacementMap&&(p.displacementMap.value=m.displacementMap,p.displacementScale.value=m.displacementScale,p.displacementBias.value=m.displacementBias),m.emissiveMap&&(p.emissiveMap.value=m.emissiveMap),m.normalMap&&(p.normalMap.value=m.normalMap,p.normalScale.value.copy(m.normalScale),m.side===tn&&p.normalScale.value.negate()),m.specularMap&&(p.specularMap.value=m.specularMap),m.alphaTest>0&&(p.alphaTest.value=m.alphaTest);const _=e.get(m).envMap;if(_&&(p.envMap.value=_,p.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,p.reflectivity.value=m.reflectivity,p.ior.value=m.ior,p.refractionRatio.value=m.refractionRatio),m.lightMap){p.lightMap.value=m.lightMap;const y=l.physicallyCorrectLights!==!0?Math.PI:1;p.lightMapIntensity.value=m.lightMapIntensity*y}m.aoMap&&(p.aoMap.value=m.aoMap,p.aoMapIntensity.value=m.aoMapIntensity);let x;m.map?x=m.map:m.specularMap?x=m.specularMap:m.displacementMap?x=m.displacementMap:m.normalMap?x=m.normalMap:m.bumpMap?x=m.bumpMap:m.roughnessMap?x=m.roughnessMap:m.metalnessMap?x=m.metalnessMap:m.alphaMap?x=m.alphaMap:m.emissiveMap?x=m.emissiveMap:m.clearcoatMap?x=m.clearcoatMap:m.clearcoatNormalMap?x=m.clearcoatNormalMap:m.clearcoatRoughnessMap?x=m.clearcoatRoughnessMap:m.iridescenceMap?x=m.iridescenceMap:m.iridescenceThicknessMap?x=m.iridescenceThicknessMap:m.specularIntensityMap?x=m.specularIntensityMap:m.specularColorMap?x=m.specularColorMap:m.transmissionMap?x=m.transmissionMap:m.thicknessMap?x=m.thicknessMap:m.sheenColorMap?x=m.sheenColorMap:m.sheenRoughnessMap&&(x=m.sheenRoughnessMap),x!==void 0&&(x.isWebGLRenderTarget&&(x=x.texture),x.matrixAutoUpdate===!0&&x.updateMatrix(),p.uvTransform.value.copy(x.matrix));let b;m.aoMap?b=m.aoMap:m.lightMap&&(b=m.lightMap),b!==void 0&&(b.isWebGLRenderTarget&&(b=b.texture),b.matrixAutoUpdate===!0&&b.updateMatrix(),p.uv2Transform.value.copy(b.matrix))}function r(p,m){p.diffuse.value.copy(m.color),p.opacity.value=m.opacity}function s(p,m){p.dashSize.value=m.dashSize,p.totalSize.value=m.dashSize+m.gapSize,p.scale.value=m.scale}function o(p,m,_,x){p.diffuse.value.copy(m.color),p.opacity.value=m.opacity,p.size.value=m.size*_,p.scale.value=x*.5,m.map&&(p.map.value=m.map),m.alphaMap&&(p.alphaMap.value=m.alphaMap),m.alphaTest>0&&(p.alphaTest.value=m.alphaTest);let b;m.map?b=m.map:m.alphaMap&&(b=m.alphaMap),b!==void 0&&(b.matrixAutoUpdate===!0&&b.updateMatrix(),p.uvTransform.value.copy(b.matrix))}function a(p,m){p.diffuse.value.copy(m.color),p.opacity.value=m.opacity,p.rotation.value=m.rotation,m.map&&(p.map.value=m.map),m.alphaMap&&(p.alphaMap.value=m.alphaMap),m.alphaTest>0&&(p.alphaTest.value=m.alphaTest);let _;m.map?_=m.map:m.alphaMap&&(_=m.alphaMap),_!==void 0&&(_.matrixAutoUpdate===!0&&_.updateMatrix(),p.uvTransform.value.copy(_.matrix))}function c(p,m){p.specular.value.copy(m.specular),p.shininess.value=Math.max(m.shininess,1e-4)}function h(p,m){m.gradientMap&&(p.gradientMap.value=m.gradientMap)}function u(p,m){p.roughness.value=m.roughness,p.metalness.value=m.metalness,m.roughnessMap&&(p.roughnessMap.value=m.roughnessMap),m.metalnessMap&&(p.metalnessMap.value=m.metalnessMap),e.get(m).envMap&&(p.envMapIntensity.value=m.envMapIntensity)}function f(p,m,_){p.ior.value=m.ior,m.sheen>0&&(p.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),p.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(p.sheenColorMap.value=m.sheenColorMap),m.sheenRoughnessMap&&(p.sheenRoughnessMap.value=m.sheenRoughnessMap)),m.clearcoat>0&&(p.clearcoat.value=m.clearcoat,p.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(p.clearcoatMap.value=m.clearcoatMap),m.clearcoatRoughnessMap&&(p.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap),m.clearcoatNormalMap&&(p.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),p.clearcoatNormalMap.value=m.clearcoatNormalMap,m.side===tn&&p.clearcoatNormalScale.value.negate())),m.iridescence>0&&(p.iridescence.value=m.iridescence,p.iridescenceIOR.value=m.iridescenceIOR,p.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],p.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(p.iridescenceMap.value=m.iridescenceMap),m.iridescenceThicknessMap&&(p.iridescenceThicknessMap.value=m.iridescenceThicknessMap)),m.transmission>0&&(p.transmission.value=m.transmission,p.transmissionSamplerMap.value=_.texture,p.transmissionSamplerSize.value.set(_.width,_.height),m.transmissionMap&&(p.transmissionMap.value=m.transmissionMap),p.thickness.value=m.thickness,m.thicknessMap&&(p.thicknessMap.value=m.thicknessMap),p.attenuationDistance.value=m.attenuationDistance,p.attenuationColor.value.copy(m.attenuationColor)),p.specularIntensity.value=m.specularIntensity,p.specularColor.value.copy(m.specularColor),m.specularIntensityMap&&(p.specularIntensityMap.value=m.specularIntensityMap),m.specularColorMap&&(p.specularColorMap.value=m.specularColorMap)}function d(p,m){m.matcap&&(p.matcap.value=m.matcap)}function g(p,m){p.referencePosition.value.copy(m.referencePosition),p.nearDistance.value=m.nearDistance,p.farDistance.value=m.farDistance}return{refreshFogUniforms:t,refreshMaterialUniforms:i}}function j3(){const l=Ca("canvas");return l.style.display="block",l}function _f(l={}){this.isWebGLRenderer=!0;const e=l.canvas!==void 0?l.canvas:j3(),t=l.context!==void 0?l.context:null,i=l.depth!==void 0?l.depth:!0,n=l.stencil!==void 0?l.stencil:!0,r=l.antialias!==void 0?l.antialias:!1,s=l.premultipliedAlpha!==void 0?l.premultipliedAlpha:!0,o=l.preserveDrawingBuffer!==void 0?l.preserveDrawingBuffer:!1,a=l.powerPreference!==void 0?l.powerPreference:"default",c=l.failIfMajorPerformanceCaveat!==void 0?l.failIfMajorPerformanceCaveat:!1;let h;t!==null?h=t.getContextAttributes().alpha:h=l.alpha!==void 0?l.alpha:!1;let u=null,f=null;const d=[],g=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=pr,this.physicallyCorrectLights=!1,this.toneMapping=li,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});const p=this;let m=!1,_=0,x=0,b=null,y=-1,v=null;const M=new it,S=new it;let w=null,T=e.width,R=e.height,D=1,I=null,U=null;const A=new it(0,0,T,R),B=new it(0,0,T,R);let O=!1;const q=new Lc;let Z=!1,k=!1,V=null;const F=new Ne,z=new pe,X=new L,j={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function K(){return b===null?D:1}let G=t;function ee(P,J){for(let te=0;te<P.length;te++){const $=P[te],he=e.getContext($,J);if(he!==null)return he}return null}try{const P={alpha:!0,depth:i,stencil:n,antialias:r,premultipliedAlpha:s,preserveDrawingBuffer:o,powerPreference:a,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${wc}`),e.addEventListener("webglcontextlost",N,!1),e.addEventListener("webglcontextrestored",ae,!1),e.addEventListener("webglcontextcreationerror",re,!1),G===null){const J=["webgl2","webgl","experimental-webgl"];if(p.isWebGL1Renderer===!0&&J.shift(),G=ee(J,P),G===null)throw ee(J)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}G.getShaderPrecisionFormat===void 0&&(G.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(P){throw console.error("THREE.WebGLRenderer: "+P.message),P}let ne,de,le,ge,W,se,ue,xe,ce,Pe,ie,ye,Se,oe,E,C,H,Q,fe,_e,me,Y,Le;function be(){ne=new uy(G),de=new sy(G,ne,l),ne.init(de),Y=new H0(G,ne,de),le=new W3(G,ne,de),ge=new py,W=new D3,se=new X3(G,ne,le,W,de,Y,ge),ue=new ay(p),xe=new hy(p),ce=new C_(G,de),Le=new iy(G,ne,ce,de),Pe=new fy(G,ce,ge,Le),ie=new xy(G,Pe,ce,ge),fe=new _y(G,de,se),C=new oy(W),ye=new P3(p,ue,xe,ne,de,Le,C),Se=new Z3(p,W),oe=new F3,E=new z3(ne,de),Q=new ny(p,ue,le,ie,h,s),H=new H3(p,ie,de),_e=new ry(G,ne,ge,de),me=new dy(G,ne,ge,de),ge.programs=ye.programs,p.capabilities=de,p.extensions=ne,p.properties=W,p.renderLists=oe,p.shadowMap=H,p.state=le,p.info=ge}be();const we=new Y3(p,G);this.xr=we,this.getContext=function(){return G},this.getContextAttributes=function(){return G.getContextAttributes()},this.forceContextLoss=function(){const P=ne.get("WEBGL_lose_context");P&&P.loseContext()},this.forceContextRestore=function(){const P=ne.get("WEBGL_lose_context");P&&P.restoreContext()},this.getPixelRatio=function(){return D},this.setPixelRatio=function(P){P!==void 0&&(D=P,this.setSize(T,R,!1))},this.getSize=function(P){return P.set(T,R)},this.setSize=function(P,J,te){if(we.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}T=P,R=J,e.width=Math.floor(P*D),e.height=Math.floor(J*D),te!==!1&&(e.style.width=P+"px",e.style.height=J+"px"),this.setViewport(0,0,P,J)},this.getDrawingBufferSize=function(P){return P.set(T*D,R*D).floor()},this.setDrawingBufferSize=function(P,J,te){T=P,R=J,D=te,e.width=Math.floor(P*te),e.height=Math.floor(J*te),this.setViewport(0,0,P,J)},this.getCurrentViewport=function(P){return P.copy(M)},this.getViewport=function(P){return P.copy(A)},this.setViewport=function(P,J,te,$){P.isVector4?A.set(P.x,P.y,P.z,P.w):A.set(P,J,te,$),le.viewport(M.copy(A).multiplyScalar(D).floor())},this.getScissor=function(P){return P.copy(B)},this.setScissor=function(P,J,te,$){P.isVector4?B.set(P.x,P.y,P.z,P.w):B.set(P,J,te,$),le.scissor(S.copy(B).multiplyScalar(D).floor())},this.getScissorTest=function(){return O},this.setScissorTest=function(P){le.setScissorTest(O=P)},this.setOpaqueSort=function(P){I=P},this.setTransparentSort=function(P){U=P},this.getClearColor=function(P){return P.copy(Q.getClearColor())},this.setClearColor=function(){Q.setClearColor.apply(Q,arguments)},this.getClearAlpha=function(){return Q.getClearAlpha()},this.setClearAlpha=function(){Q.setClearAlpha.apply(Q,arguments)},this.clear=function(P=!0,J=!0,te=!0){let $=0;P&&($|=16384),J&&($|=256),te&&($|=1024),G.clear($)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",N,!1),e.removeEventListener("webglcontextrestored",ae,!1),e.removeEventListener("webglcontextcreationerror",re,!1),oe.dispose(),E.dispose(),W.dispose(),ue.dispose(),xe.dispose(),ie.dispose(),Le.dispose(),ye.dispose(),we.dispose(),we.removeEventListener("sessionstart",We),we.removeEventListener("sessionend",je),V&&(V.dispose(),V=null),Qe.stop()};function N(P){P.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),m=!0}function ae(){console.log("THREE.WebGLRenderer: Context Restored."),m=!1;const P=ge.autoReset,J=H.enabled,te=H.autoUpdate,$=H.needsUpdate,he=H.type;be(),ge.autoReset=P,H.enabled=J,H.autoUpdate=te,H.needsUpdate=$,H.type=he}function re(P){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",P.statusMessage)}function Ee(P){const J=P.target;J.removeEventListener("dispose",Ee),Me(J)}function Me(P){Oe(P),W.remove(P)}function Oe(P){const J=W.get(P).programs;J!==void 0&&(J.forEach(function(te){ye.releaseProgram(te)}),P.isShaderMaterial&&ye.releaseShaderCache(P))}this.renderBufferDirect=function(P,J,te,$,he,ke){J===null&&(J=j);const Be=he.isMesh&&he.matrixWorld.determinant()<0,Ge=Cn(P,J,te,$,he);le.setMaterial($,Be);let Ve=te.index;const tt=te.attributes.position;if(Ve===null){if(tt===void 0||tt.count===0)return}else if(Ve.count===0)return;let Xe=1;$.wireframe===!0&&(Ve=Pe.getWireframeAttribute(te),Xe=2),Le.setup(he,$,Ge,te,Ve);let Ye,pt=_e;Ve!==null&&(Ye=ce.get(Ve),pt=me,pt.setIndex(Ye));const ei=Ve!==null?Ve.count:tt.count,Un=te.drawRange.start*Xe,ti=te.drawRange.count*Xe,sn=ke!==null?ke.start*Xe:0,Te=ke!==null?ke.count*Xe:1/0,An=Math.max(Un,sn),vt=Math.min(ei,Un+ti,sn+Te)-1,$t=Math.max(0,vt-An+1);if($t!==0){if(he.isMesh)$.wireframe===!0?(le.setLineWidth($.wireframeLinewidth*K()),pt.setMode(1)):pt.setMode(4);else if(he.isLine){let kn=$.linewidth;kn===void 0&&(kn=1),le.setLineWidth(kn*K()),he.isLineSegments?pt.setMode(1):he.isLineLoop?pt.setMode(2):pt.setMode(3)}else he.isPoints?pt.setMode(0):he.isSprite&&pt.setMode(4);if(he.isInstancedMesh)pt.renderInstances(An,$t,he.count);else if(te.isInstancedBufferGeometry){const kn=Math.min(te.instanceCount,te._maxInstanceCount);pt.renderInstances(An,$t,kn)}else pt.render(An,$t)}},this.compile=function(P,J){f=E.get(P),f.init(),g.push(f),P.traverseVisible(function(te){te.isLight&&te.layers.test(J.layers)&&(f.pushLight(te),te.castShadow&&f.pushShadow(te))}),f.setupLights(p.physicallyCorrectLights),P.traverse(function(te){const $=te.material;if($)if(Array.isArray($))for(let he=0;he<$.length;he++){const ke=$[he];rt(ke,P,te)}else rt($,P,te)}),g.pop(),f=null};let ve=null;function Ie(P){ve&&ve(P)}function We(){Qe.stop()}function je(){Qe.start()}const Qe=new k0;Qe.setAnimationLoop(Ie),typeof self!="undefined"&&Qe.setContext(self),this.setAnimationLoop=function(P){ve=P,we.setAnimationLoop(P),P===null?Qe.stop():Qe.start()},we.addEventListener("sessionstart",We),we.addEventListener("sessionend",je),this.render=function(P,J){if(J!==void 0&&J.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(m===!0)return;P.autoUpdate===!0&&P.updateMatrixWorld(),J.parent===null&&J.updateMatrixWorld(),we.enabled===!0&&we.isPresenting===!0&&(we.cameraAutoUpdate===!0&&we.updateCamera(J),J=we.getCamera()),P.isScene===!0&&P.onBeforeRender(p,P,J,b),f=E.get(P,g.length),f.init(),g.push(f),F.multiplyMatrices(J.projectionMatrix,J.matrixWorldInverse),q.setFromProjectionMatrix(F),k=this.localClippingEnabled,Z=C.init(this.clippingPlanes,k,J),u=oe.get(P,d.length),u.init(),d.push(u),Ht(P,J,0,p.sortObjects),u.finish(),p.sortObjects===!0&&u.sort(I,U),Z===!0&&C.beginShadows();const te=f.state.shadowsArray;if(H.render(te,P,J),Z===!0&&C.endShadows(),this.info.autoReset===!0&&this.info.reset(),Q.render(u,P),f.setupLights(p.physicallyCorrectLights),J.isArrayCamera){const $=J.cameras;for(let he=0,ke=$.length;he<ke;he++){const Be=$[he];ot(u,P,Be,Be.viewport)}}else ot(u,P,J);b!==null&&(se.updateMultisampleRenderTarget(b),se.updateRenderTargetMipmap(b)),P.isScene===!0&&P.onAfterRender(p,P,J),Le.resetDefaultState(),y=-1,v=null,g.pop(),g.length>0?f=g[g.length-1]:f=null,d.pop(),d.length>0?u=d[d.length-1]:u=null};function Ht(P,J,te,$){if(P.visible===!1)return;if(P.layers.test(J.layers)){if(P.isGroup)te=P.renderOrder;else if(P.isLOD)P.autoUpdate===!0&&P.update(J);else if(P.isLight)f.pushLight(P),P.castShadow&&f.pushShadow(P);else if(P.isSprite){if(!P.frustumCulled||q.intersectsSprite(P)){$&&X.setFromMatrixPosition(P.matrixWorld).applyMatrix4(F);const Be=ie.update(P),Ge=P.material;Ge.visible&&u.push(P,Be,Ge,te,X.z,null)}}else if((P.isMesh||P.isLine||P.isPoints)&&(P.isSkinnedMesh&&P.skeleton.frame!==ge.render.frame&&(P.skeleton.update(),P.skeleton.frame=ge.render.frame),!P.frustumCulled||q.intersectsObject(P))){$&&X.setFromMatrixPosition(P.matrixWorld).applyMatrix4(F);const Be=ie.update(P),Ge=P.material;if(Array.isArray(Ge)){const Ve=Be.groups;for(let tt=0,Xe=Ve.length;tt<Xe;tt++){const Ye=Ve[tt],pt=Ge[Ye.materialIndex];pt&&pt.visible&&u.push(P,Be,pt,te,X.z,Ye)}}else Ge.visible&&u.push(P,Be,Ge,te,X.z,null)}}const ke=P.children;for(let Be=0,Ge=ke.length;Be<Ge;Be++)Ht(ke[Be],J,te,$)}function ot(P,J,te,$){const he=P.opaque,ke=P.transmissive,Be=P.transparent;f.setupLightsView(te),ke.length>0&&et(he,J,te),$&&le.viewport(M.copy($)),he.length>0&&xt(he,J,te),ke.length>0&&xt(ke,J,te),Be.length>0&&xt(Be,J,te),le.buffers.depth.setTest(!0),le.buffers.depth.setMask(!0),le.buffers.color.setMask(!0),le.setPolygonOffset(!1)}function et(P,J,te){const $=de.isWebGL2;V===null&&(V=new Mn(1,1,{generateMipmaps:!0,type:ne.has("EXT_color_buffer_half_float")?so:dr,minFilter:Ui,samples:$&&r===!0?4:0})),p.getDrawingBufferSize(z),$?V.setSize(z.x,z.y):V.setSize(dc(z.x),dc(z.y));const he=p.getRenderTarget();p.setRenderTarget(V),p.clear();const ke=p.toneMapping;p.toneMapping=li,xt(P,J,te),p.toneMapping=ke,se.updateMultisampleRenderTarget(V),se.updateRenderTargetMipmap(V),p.setRenderTarget(he)}function xt(P,J,te){const $=J.isScene===!0?J.overrideMaterial:null;for(let he=0,ke=P.length;he<ke;he++){const Be=P[he],Ge=Be.object,Ve=Be.geometry,tt=$===null?Be.material:$,Xe=Be.group;Ge.layers.test(te.layers)&&Qt(Ge,J,te,Ve,tt,Xe)}}function Qt(P,J,te,$,he,ke){P.onBeforeRender(p,J,te,$,he,ke),P.modelViewMatrix.multiplyMatrices(te.matrixWorldInverse,P.matrixWorld),P.normalMatrix.getNormalMatrix(P.modelViewMatrix),he.onBeforeRender(p,J,te,$,P,ke),he.transparent===!0&&he.side===ui?(he.side=tn,he.needsUpdate=!0,p.renderBufferDirect(te,J,$,he,P,ke),he.side=Pi,he.needsUpdate=!0,p.renderBufferDirect(te,J,$,he,P,ke),he.side=ui):p.renderBufferDirect(te,J,$,he,P,ke),P.onAfterRender(p,J,te,$,he,ke)}function rt(P,J,te){J.isScene!==!0&&(J=j);const $=W.get(P),he=f.state.lights,ke=f.state.shadowsArray,Be=he.state.version,Ge=ye.getParameters(P,he.state,ke,J,te),Ve=ye.getProgramCacheKey(Ge);let tt=$.programs;$.environment=P.isMeshStandardMaterial?J.environment:null,$.fog=J.fog,$.envMap=(P.isMeshStandardMaterial?xe:ue).get(P.envMap||$.environment),tt===void 0&&(P.addEventListener("dispose",Ee),tt=new Map,$.programs=tt);let Xe=tt.get(Ve);if(Xe!==void 0){if($.currentProgram===Xe&&$.lightsStateVersion===Be)return It(P,Ge),Xe}else Ge.uniforms=ye.getUniforms(P),P.onBuild(te,Ge,p),P.onBeforeCompile(Ge,p),Xe=ye.acquireProgram(Ge,Ve),tt.set(Ve,Xe),$.uniforms=Ge.uniforms;const Ye=$.uniforms;(!P.isShaderMaterial&&!P.isRawShaderMaterial||P.clipping===!0)&&(Ye.clippingPlanes=C.uniform),It(P,Ge),$.needsLights=At(P),$.lightsStateVersion=Be,$.needsLights&&(Ye.ambientLightColor.value=he.state.ambient,Ye.lightProbe.value=he.state.probe,Ye.directionalLights.value=he.state.directional,Ye.directionalLightShadows.value=he.state.directionalShadow,Ye.spotLights.value=he.state.spot,Ye.spotLightShadows.value=he.state.spotShadow,Ye.rectAreaLights.value=he.state.rectArea,Ye.ltc_1.value=he.state.rectAreaLTC1,Ye.ltc_2.value=he.state.rectAreaLTC2,Ye.pointLights.value=he.state.point,Ye.pointLightShadows.value=he.state.pointShadow,Ye.hemisphereLights.value=he.state.hemi,Ye.directionalShadowMap.value=he.state.directionalShadowMap,Ye.directionalShadowMatrix.value=he.state.directionalShadowMatrix,Ye.spotShadowMap.value=he.state.spotShadowMap,Ye.spotShadowMatrix.value=he.state.spotShadowMatrix,Ye.pointShadowMap.value=he.state.pointShadowMap,Ye.pointShadowMatrix.value=he.state.pointShadowMatrix);const pt=Xe.getUniforms(),ei=ac.seqWithValue(pt.seq,Ye);return $.currentProgram=Xe,$.uniformsList=ei,Xe}function It(P,J){const te=W.get(P);te.outputEncoding=J.outputEncoding,te.instancing=J.instancing,te.skinning=J.skinning,te.morphTargets=J.morphTargets,te.morphNormals=J.morphNormals,te.morphColors=J.morphColors,te.morphTargetsCount=J.morphTargetsCount,te.numClippingPlanes=J.numClippingPlanes,te.numIntersection=J.numClipIntersection,te.vertexAlphas=J.vertexAlphas,te.vertexTangents=J.vertexTangents,te.toneMapping=J.toneMapping}function Cn(P,J,te,$,he){J.isScene!==!0&&(J=j),se.resetTextureUnits();const ke=J.fog,Be=$.isMeshStandardMaterial?J.environment:null,Ge=b===null?p.outputEncoding:b.isXRRenderTarget===!0?b.texture.encoding:pr,Ve=($.isMeshStandardMaterial?xe:ue).get($.envMap||Be),tt=$.vertexColors===!0&&!!te.attributes.color&&te.attributes.color.itemSize===4,Xe=!!$.normalMap&&!!te.attributes.tangent,Ye=!!te.morphAttributes.position,pt=!!te.morphAttributes.normal,ei=!!te.morphAttributes.color,Un=$.toneMapped?p.toneMapping:li,ti=te.morphAttributes.position||te.morphAttributes.normal||te.morphAttributes.color,sn=ti!==void 0?ti.length:0,Te=W.get($),An=f.state.lights;if(Z===!0&&(k===!0||P!==v)){const dn=P===v&&$.id===y;C.setState($,P,dn)}let vt=!1;$.version===Te.__version?(Te.needsLights&&Te.lightsStateVersion!==An.state.version||Te.outputEncoding!==Ge||he.isInstancedMesh&&Te.instancing===!1||!he.isInstancedMesh&&Te.instancing===!0||he.isSkinnedMesh&&Te.skinning===!1||!he.isSkinnedMesh&&Te.skinning===!0||Te.envMap!==Ve||$.fog===!0&&Te.fog!==ke||Te.numClippingPlanes!==void 0&&(Te.numClippingPlanes!==C.numPlanes||Te.numIntersection!==C.numIntersection)||Te.vertexAlphas!==tt||Te.vertexTangents!==Xe||Te.morphTargets!==Ye||Te.morphNormals!==pt||Te.morphColors!==ei||Te.toneMapping!==Un||de.isWebGL2===!0&&Te.morphTargetsCount!==sn)&&(vt=!0):(vt=!0,Te.__version=$.version);let $t=Te.currentProgram;vt===!0&&($t=rt($,J,he));let kn=!1,_i=!1,Bi=!1;const Et=$t.getUniforms(),zi=Te.uniforms;if(le.useProgram($t.program)&&(kn=!0,_i=!0,Bi=!0),$.id!==y&&(y=$.id,_i=!0),kn||v!==P){if(Et.setValue(G,"projectionMatrix",P.projectionMatrix),de.logarithmicDepthBuffer&&Et.setValue(G,"logDepthBufFC",2/(Math.log(P.far+1)/Math.LN2)),v!==P&&(v=P,_i=!0,Bi=!0),$.isShaderMaterial||$.isMeshPhongMaterial||$.isMeshToonMaterial||$.isMeshStandardMaterial||$.envMap){const dn=Et.map.cameraPosition;dn!==void 0&&dn.setValue(G,X.setFromMatrixPosition(P.matrixWorld))}($.isMeshPhongMaterial||$.isMeshToonMaterial||$.isMeshLambertMaterial||$.isMeshBasicMaterial||$.isMeshStandardMaterial||$.isShaderMaterial)&&Et.setValue(G,"isOrthographic",P.isOrthographicCamera===!0),($.isMeshPhongMaterial||$.isMeshToonMaterial||$.isMeshLambertMaterial||$.isMeshBasicMaterial||$.isMeshStandardMaterial||$.isShaderMaterial||$.isShadowMaterial||he.isSkinnedMesh)&&Et.setValue(G,"viewMatrix",P.matrixWorldInverse)}if(he.isSkinnedMesh){Et.setOptional(G,he,"bindMatrix"),Et.setOptional(G,he,"bindMatrixInverse");const dn=he.skeleton;dn&&(de.floatVertexTextures?(dn.boneTexture===null&&dn.computeBoneTexture(),Et.setValue(G,"boneTexture",dn.boneTexture,se),Et.setValue(G,"boneTextureSize",dn.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Gi=te.morphAttributes;return(Gi.position!==void 0||Gi.normal!==void 0||Gi.color!==void 0&&de.isWebGL2===!0)&&fe.update(he,te,$,$t),(_i||Te.receiveShadow!==he.receiveShadow)&&(Te.receiveShadow=he.receiveShadow,Et.setValue(G,"receiveShadow",he.receiveShadow)),_i&&(Et.setValue(G,"toneMappingExposure",p.toneMappingExposure),Te.needsLights&&Rt(zi,Bi),ke&&$.fog===!0&&Se.refreshFogUniforms(zi,ke),Se.refreshMaterialUniforms(zi,$,D,R,V),ac.upload(G,Te.uniformsList,zi,se)),$.isShaderMaterial&&$.uniformsNeedUpdate===!0&&(ac.upload(G,Te.uniformsList,zi,se),$.uniformsNeedUpdate=!1),$.isSpriteMaterial&&Et.setValue(G,"center",he.center),Et.setValue(G,"modelViewMatrix",he.modelViewMatrix),Et.setValue(G,"normalMatrix",he.normalMatrix),Et.setValue(G,"modelMatrix",he.matrixWorld),$t}function Rt(P,J){P.ambientLightColor.needsUpdate=J,P.lightProbe.needsUpdate=J,P.directionalLights.needsUpdate=J,P.directionalLightShadows.needsUpdate=J,P.pointLights.needsUpdate=J,P.pointLightShadows.needsUpdate=J,P.spotLights.needsUpdate=J,P.spotLightShadows.needsUpdate=J,P.rectAreaLights.needsUpdate=J,P.hemisphereLights.needsUpdate=J}function At(P){return P.isMeshLambertMaterial||P.isMeshToonMaterial||P.isMeshPhongMaterial||P.isMeshStandardMaterial||P.isShadowMaterial||P.isShaderMaterial&&P.lights===!0}this.getActiveCubeFace=function(){return _},this.getActiveMipmapLevel=function(){return x},this.getRenderTarget=function(){return b},this.setRenderTargetTextures=function(P,J,te){W.get(P.texture).__webglTexture=J,W.get(P.depthTexture).__webglTexture=te;const $=W.get(P);$.__hasExternalTextures=!0,$.__hasExternalTextures&&($.__autoAllocateDepthBuffer=te===void 0,$.__autoAllocateDepthBuffer||ne.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),$.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(P,J){const te=W.get(P);te.__webglFramebuffer=J,te.__useDefaultFramebuffer=J===void 0},this.setRenderTarget=function(P,J=0,te=0){b=P,_=J,x=te;let $=!0;if(P){const Ve=W.get(P);Ve.__useDefaultFramebuffer!==void 0?(le.bindFramebuffer(36160,null),$=!1):Ve.__webglFramebuffer===void 0?se.setupRenderTarget(P):Ve.__hasExternalTextures&&se.rebindTextures(P,W.get(P.texture).__webglTexture,W.get(P.depthTexture).__webglTexture)}let he=null,ke=!1,Be=!1;if(P){const Ve=P.texture;(Ve.isData3DTexture||Ve.isDataArrayTexture)&&(Be=!0);const tt=W.get(P).__webglFramebuffer;P.isWebGLCubeRenderTarget?(he=tt[J],ke=!0):de.isWebGL2&&P.samples>0&&se.useMultisampledRTT(P)===!1?he=W.get(P).__webglMultisampledFramebuffer:he=tt,M.copy(P.viewport),S.copy(P.scissor),w=P.scissorTest}else M.copy(A).multiplyScalar(D).floor(),S.copy(B).multiplyScalar(D).floor(),w=O;if(le.bindFramebuffer(36160,he)&&de.drawBuffers&&$&&le.drawBuffers(P,he),le.viewport(M),le.scissor(S),le.setScissorTest(w),ke){const Ve=W.get(P.texture);G.framebufferTexture2D(36160,36064,34069+J,Ve.__webglTexture,te)}else if(Be){const Ve=W.get(P.texture),tt=J||0;G.framebufferTextureLayer(36160,36064,Ve.__webglTexture,te||0,tt)}y=-1},this.readRenderTargetPixels=function(P,J,te,$,he,ke,Be){if(!(P&&P.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Ge=W.get(P).__webglFramebuffer;if(P.isWebGLCubeRenderTarget&&Be!==void 0&&(Ge=Ge[Be]),Ge){le.bindFramebuffer(36160,Ge);try{const Ve=P.texture,tt=Ve.format,Xe=Ve.type;if(tt!==vn&&Y.convert(tt)!==G.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Ye=Xe===so&&(ne.has("EXT_color_buffer_half_float")||de.isWebGL2&&ne.has("EXT_color_buffer_float"));if(Xe!==dr&&Y.convert(Xe)!==G.getParameter(35738)&&!(Xe===Ai&&(de.isWebGL2||ne.has("OES_texture_float")||ne.has("WEBGL_color_buffer_float")))&&!Ye){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}J>=0&&J<=P.width-$&&te>=0&&te<=P.height-he&&G.readPixels(J,te,$,he,Y.convert(tt),Y.convert(Xe),ke)}finally{const Ve=b!==null?W.get(b).__webglFramebuffer:null;le.bindFramebuffer(36160,Ve)}}},this.copyFramebufferToTexture=function(P,J,te=0){const $=Math.pow(2,-te),he=Math.floor(J.image.width*$),ke=Math.floor(J.image.height*$);se.setTexture2D(J,0),G.copyTexSubImage2D(3553,te,0,0,P.x,P.y,he,ke),le.unbindTexture()},this.copyTextureToTexture=function(P,J,te,$=0){const he=J.image.width,ke=J.image.height,Be=Y.convert(te.format),Ge=Y.convert(te.type);se.setTexture2D(te,0),G.pixelStorei(37440,te.flipY),G.pixelStorei(37441,te.premultiplyAlpha),G.pixelStorei(3317,te.unpackAlignment),J.isDataTexture?G.texSubImage2D(3553,$,P.x,P.y,he,ke,Be,Ge,J.image.data):J.isCompressedTexture?G.compressedTexSubImage2D(3553,$,P.x,P.y,J.mipmaps[0].width,J.mipmaps[0].height,Be,J.mipmaps[0].data):G.texSubImage2D(3553,$,P.x,P.y,Be,Ge,J.image),$===0&&te.generateMipmaps&&G.generateMipmap(3553),le.unbindTexture()},this.copyTextureToTexture3D=function(P,J,te,$,he=0){if(p.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const ke=P.max.x-P.min.x+1,Be=P.max.y-P.min.y+1,Ge=P.max.z-P.min.z+1,Ve=Y.convert($.format),tt=Y.convert($.type);let Xe;if($.isData3DTexture)se.setTexture3D($,0),Xe=32879;else if($.isDataArrayTexture)se.setTexture2DArray($,0),Xe=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}G.pixelStorei(37440,$.flipY),G.pixelStorei(37441,$.premultiplyAlpha),G.pixelStorei(3317,$.unpackAlignment);const Ye=G.getParameter(3314),pt=G.getParameter(32878),ei=G.getParameter(3316),Un=G.getParameter(3315),ti=G.getParameter(32877),sn=te.isCompressedTexture?te.mipmaps[0]:te.image;G.pixelStorei(3314,sn.width),G.pixelStorei(32878,sn.height),G.pixelStorei(3316,P.min.x),G.pixelStorei(3315,P.min.y),G.pixelStorei(32877,P.min.z),te.isDataTexture||te.isData3DTexture?G.texSubImage3D(Xe,he,J.x,J.y,J.z,ke,Be,Ge,Ve,tt,sn.data):te.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),G.compressedTexSubImage3D(Xe,he,J.x,J.y,J.z,ke,Be,Ge,Ve,sn.data)):G.texSubImage3D(Xe,he,J.x,J.y,J.z,ke,Be,Ge,Ve,tt,sn),G.pixelStorei(3314,Ye),G.pixelStorei(32878,pt),G.pixelStorei(3316,ei),G.pixelStorei(3315,Un),G.pixelStorei(32877,ti),he===0&&$.generateMipmaps&&G.generateMipmap(Xe),le.unbindTexture()},this.initTexture=function(P){se.setTexture2D(P,0),le.unbindTexture()},this.resetState=function(){_=0,x=0,b=null,le.reset(),Le.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class q0 extends _f{}q0.prototype.isWebGL1Renderer=!0;class Ic{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Ae(e),this.density=t}clone(){return new Ic(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class Fc{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new Ae(e),this.near=t,this.far=i}clone(){return new Fc(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class xf extends $e{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),t}}class Ya{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=uc,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=wn()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let n=0,r=this.stride;n<r;n++)this.array[e+n]=t.array[i+n];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=wn()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=wn()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const en=new L;class mr{constructor(e,t,i,n=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=n===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)en.fromBufferAttribute(this,t),en.applyMatrix4(e),this.setXYZ(t,en.x,en.y,en.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)en.fromBufferAttribute(this,t),en.applyNormalMatrix(e),this.setXYZ(t,en.x,en.y,en.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)en.fromBufferAttribute(this,t),en.transformDirection(e),this.setXYZ(t,en.x,en.y,en.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this}setXYZW(e,t,i,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this.data.array[e+3]=r,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const n=i*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[n+r])}return new st(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new mr(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const n=i*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[n+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class vf extends bt{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Ae(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Us;const Jo=new L,ks=new L,Ns=new L,Bs=new pe,Ko=new pe,Y0=new Ne,Al=new L,Qo=new L,El=new L,ep=new pe,Dh=new pe,tp=new pe;class Z0 extends $e{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",Us===void 0){Us=new ze;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new Ya(t,5);Us.setIndex([0,1,2,0,2,3]),Us.setAttribute("position",new mr(i,3,0,!1)),Us.setAttribute("uv",new mr(i,2,3,!1))}this.geometry=Us,this.material=e!==void 0?e:new vf,this.center=new pe(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),ks.setFromMatrixScale(this.matrixWorld),Y0.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Ns.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&ks.multiplyScalar(-Ns.z);const i=this.material.rotation;let n,r;i!==0&&(r=Math.cos(i),n=Math.sin(i));const s=this.center;Ll(Al.set(-.5,-.5,0),Ns,s,ks,n,r),Ll(Qo.set(.5,-.5,0),Ns,s,ks,n,r),Ll(El.set(.5,.5,0),Ns,s,ks,n,r),ep.set(0,0),Dh.set(1,0),tp.set(1,1);let o=e.ray.intersectTriangle(Al,Qo,El,!1,Jo);if(o===null&&(Ll(Qo.set(-.5,.5,0),Ns,s,ks,n,r),Dh.set(0,1),o=e.ray.intersectTriangle(Al,El,Qo,!1,Jo),o===null))return;const a=e.ray.origin.distanceTo(Jo);a<e.near||a>e.far||t.push({distance:a,point:Jo.clone(),uv:Pn.getUV(Jo,Al,Qo,El,ep,Dh,tp,new pe),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Ll(l,e,t,i,n,r){Bs.subVectors(l,t).addScalar(.5).multiply(i),n!==void 0?(Ko.x=r*Bs.x-n*Bs.y,Ko.y=n*Bs.x+r*Bs.y):Ko.copy(Bs),l.copy(e),l.x+=Ko.x,l.y+=Ko.y,l.applyMatrix4(Y0)}const Rl=new L,np=new L;class j0 extends $e{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let i=0,n=t.length;i<n;i++){const r=t[i];this.addLevel(r.object.clone(),r.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0){t=Math.abs(t);const i=this.levels;let n;for(n=0;n<i.length&&!(t<i[n].distance);n++);return i.splice(n,0,{distance:t,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let i,n;for(i=1,n=t.length;i<n&&!(e<t[i].distance);i++);return t[i-1].object}return null}raycast(e,t){if(this.levels.length>0){Rl.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(Rl);this.getObjectForDistance(n).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Rl.setFromMatrixPosition(e.matrixWorld),np.setFromMatrixPosition(this.matrixWorld);const i=Rl.distanceTo(np)/e.zoom;t[0].object.visible=!0;let n,r;for(n=1,r=t.length;n<r&&i>=t[n].distance;n++)t[n-1].object.visible=!1,t[n].object.visible=!0;for(this._currentLevel=n-1;n<r;n++)t[n].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const i=this.levels;for(let n=0,r=i.length;n<r;n++){const s=i[n];t.object.levels.push({object:s.object.uuid,distance:s.distance})}return t}}const ip=new L,rp=new it,sp=new it,J3=new L,op=new Ne;class yf extends ht{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ne,this.bindMatrixInverse=new Ne}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new it,t=this.geometry.attributes.skinWeight;for(let i=0,n=t.count;i<n;i++){e.fromBufferAttribute(t,i);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const i=this.skeleton,n=this.geometry;rp.fromBufferAttribute(n.attributes.skinIndex,e),sp.fromBufferAttribute(n.attributes.skinWeight,e),ip.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){const s=sp.getComponent(r);if(s!==0){const o=rp.getComponent(r);op.multiplyMatrices(i.bones[o].matrixWorld,i.boneInverses[o]),t.addScaledVector(J3.copy(ip).applyMatrix4(op),s)}}return t.applyMatrix4(this.bindMatrixInverse)}}class Oc extends $e{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Ks extends wt{constructor(e=null,t=1,i=1,n,r,s,o,a,c=Tt,h=Tt,u,f){super(null,s,o,a,c,h,n,r,u,f),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const ap=new Ne,K3=new Ne;class Za{constructor(e=[],t=[]){this.uuid=wn(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,n=this.bones.length;i<n;i++)this.boneInverses.push(new Ne)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new Ne;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,n=this.boneTexture;for(let r=0,s=e.length;r<s;r++){const o=e[r]?e[r].matrixWorld:K3;ap.multiplyMatrices(o,t[r]),ap.toArray(i,r*16)}n!==null&&(n.needsUpdate=!0)}clone(){return new Za(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=D0(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new Ks(t,e,e,vn,Ai);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const n=this.bones[t];if(n.name===e)return n}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,n=e.bones.length;i<n;i++){const r=e.bones[i];let s=t[r];s===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),s=new Oc),this.bones.push(s),this.boneInverses.push(new Ne().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let n=0,r=t.length;n<r;n++){const s=t[n];e.bones.push(s.uuid);const o=i[n];e.boneInverses.push(o.toArray())}return e}}class cs extends st{constructor(e,t,i,n=1){typeof i=="number"&&(n=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const lp=new Ne,cp=new Ne,Pl=[],$o=new ht;class J0 extends ht{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new cs(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const i=this.matrixWorld,n=this.count;if($o.geometry=this.geometry,$o.material=this.material,$o.material!==void 0)for(let r=0;r<n;r++){this.getMatrixAt(r,lp),cp.multiplyMatrices(i,lp),$o.matrixWorld=cp,$o.raycast(e,Pl);for(let s=0,o=Pl.length;s<o;s++){const a=Pl[s];a.instanceId=r,a.object=this,t.push(a)}Pl.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new cs(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Kt extends bt{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ae(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const hp=new L,up=new L,fp=new Ne,Ih=new Wa,Dl=new ki;class Di extends $e{constructor(e=new ze,t=new Kt){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let n=1,r=t.count;n<r;n++)hp.fromBufferAttribute(t,n-1),up.fromBufferAttribute(t,n),i[n]=i[n-1],i[n]+=hp.distanceTo(up);e.setAttribute("lineDistance",new Fe(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,n=this.matrixWorld,r=e.params.Line.threshold,s=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Dl.copy(i.boundingSphere),Dl.applyMatrix4(n),Dl.radius+=r,e.ray.intersectsSphere(Dl)===!1)return;fp.copy(n).invert(),Ih.copy(e.ray).applyMatrix4(fp);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,c=new L,h=new L,u=new L,f=new L,d=this.isLineSegments?2:1,g=i.index,m=i.attributes.position;if(g!==null){const _=Math.max(0,s.start),x=Math.min(g.count,s.start+s.count);for(let b=_,y=x-1;b<y;b+=d){const v=g.getX(b),M=g.getX(b+1);if(c.fromBufferAttribute(m,v),h.fromBufferAttribute(m,M),Ih.distanceSqToSegment(c,h,f,u)>a)continue;f.applyMatrix4(this.matrixWorld);const w=e.ray.origin.distanceTo(f);w<e.near||w>e.far||t.push({distance:w,point:u.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}else{const _=Math.max(0,s.start),x=Math.min(m.count,s.start+s.count);for(let b=_,y=x-1;b<y;b+=d){if(c.fromBufferAttribute(m,b),h.fromBufferAttribute(m,b+1),Ih.distanceSqToSegment(c,h,f,u)>a)continue;f.applyMatrix4(this.matrixWorld);const M=e.ray.origin.distanceTo(f);M<e.near||M>e.far||t.push({distance:M,point:u.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const n=t[i[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,s=n.length;r<s;r++){const o=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=r}}}}}const dp=new L,pp=new L;class Kn extends Di{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let n=0,r=t.count;n<r;n+=2)dp.fromBufferAttribute(t,n),pp.fromBufferAttribute(t,n+1),i[n]=n===0?0:i[n-1],i[n+1]=i[n]+dp.distanceTo(pp);e.setAttribute("lineDistance",new Fe(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class bf extends Di{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Uc extends bt{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ae(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const mp=new Ne,Uu=new Wa,Il=new ki,Fl=new L;class wf extends $e{constructor(e=new ze,t=new Uc){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,n=this.matrixWorld,r=e.params.Points.threshold,s=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Il.copy(i.boundingSphere),Il.applyMatrix4(n),Il.radius+=r,e.ray.intersectsSphere(Il)===!1)return;mp.copy(n).invert(),Uu.copy(e.ray).applyMatrix4(mp);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,c=i.index,u=i.attributes.position;if(c!==null){const f=Math.max(0,s.start),d=Math.min(c.count,s.start+s.count);for(let g=f,p=d;g<p;g++){const m=c.getX(g);Fl.fromBufferAttribute(u,m),gp(Fl,m,a,n,e,t,this)}}else{const f=Math.max(0,s.start),d=Math.min(u.count,s.start+s.count);for(let g=f,p=d;g<p;g++)Fl.fromBufferAttribute(u,g),gp(Fl,g,a,n,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const n=t[i[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,s=n.length;r<s;r++){const o=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=r}}}}}function gp(l,e,t,i,n,r,s){const o=Uu.distanceSqToPoint(l);if(o<t){const a=new L;Uu.closestPointToPoint(l,a),a.applyMatrix4(i);const c=n.ray.origin.distanceTo(a);if(c<n.near||c>n.far)return;r.push({distance:c,distanceToRay:Math.sqrt(o),point:a,index:e,face:null,object:s})}}class Q3 extends wt{constructor(e,t,i,n,r,s,o,a,c){super(e,t,i,n,r,s,o,a,c),this.isVideoTexture=!0,this.minFilter=s!==void 0?s:dt,this.magFilter=r!==void 0?r:dt,this.generateMipmaps=!1;const h=this;function u(){h.needsUpdate=!0,e.requestVideoFrameCallback(u)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(u)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class $3 extends wt{constructor(e,t,i){super({width:e,height:t}),this.isFramebufferTexture=!0,this.format=i,this.magFilter=Tt,this.minFilter=Tt,this.generateMipmaps=!1,this.needsUpdate=!0}}class K0 extends wt{constructor(e,t,i,n,r,s,o,a,c,h,u,f){super(null,s,o,a,c,h,n,r,u,f),this.isCompressedTexture=!0,this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class eb extends wt{constructor(e,t,i,n,r,s,o,a,c){super(e,t,i,n,r,s,o,a,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Qn{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,n=this.getPoint(0),r=0;t.push(0);for(let s=1;s<=e;s++)i=this.getPoint(s/e),r+=i.distanceTo(n),t.push(r),n=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let n=0;const r=i.length;let s;t?s=t:s=e*i[r-1];let o=0,a=r-1,c;for(;o<=a;)if(n=Math.floor(o+(a-o)/2),c=i[n]-s,c<0)o=n+1;else if(c>0)a=n-1;else{a=n;break}if(n=a,i[n]===s)return n/(r-1);const h=i[n],f=i[n+1]-h,d=(s-h)/f;return(n+d)/(r-1)}getTangent(e,t){let n=e-1e-4,r=e+1e-4;n<0&&(n=0),r>1&&(r=1);const s=this.getPoint(n),o=this.getPoint(r),a=t||(s.isVector2?new pe:new L);return a.copy(o).sub(s).normalize(),a}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new L,n=[],r=[],s=[],o=new L,a=new Ne;for(let d=0;d<=e;d++){const g=d/e;n[d]=this.getTangentAt(g,new L)}r[0]=new L,s[0]=new L;let c=Number.MAX_VALUE;const h=Math.abs(n[0].x),u=Math.abs(n[0].y),f=Math.abs(n[0].z);h<=c&&(c=h,i.set(1,0,0)),u<=c&&(c=u,i.set(0,1,0)),f<=c&&i.set(0,0,1),o.crossVectors(n[0],i).normalize(),r[0].crossVectors(n[0],o),s[0].crossVectors(n[0],r[0]);for(let d=1;d<=e;d++){if(r[d]=r[d-1].clone(),s[d]=s[d-1].clone(),o.crossVectors(n[d-1],n[d]),o.length()>Number.EPSILON){o.normalize();const g=Math.acos(Ct(n[d-1].dot(n[d]),-1,1));r[d].applyMatrix4(a.makeRotationAxis(o,g))}s[d].crossVectors(n[d],r[d])}if(t===!0){let d=Math.acos(Ct(r[0].dot(r[e]),-1,1));d/=e,n[0].dot(o.crossVectors(r[0],r[e]))>0&&(d=-d);for(let g=1;g<=e;g++)r[g].applyMatrix4(a.makeRotationAxis(n[g],d*g)),s[g].crossVectors(n[g],r[g])}return{tangents:n,normals:r,binormals:s}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class kc extends Qn{constructor(e=0,t=0,i=1,n=1,r=0,s=Math.PI*2,o=!1,a=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=n,this.aStartAngle=r,this.aEndAngle=s,this.aClockwise=o,this.aRotation=a}getPoint(e,t){const i=t||new pe,n=Math.PI*2;let r=this.aEndAngle-this.aStartAngle;const s=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=n;for(;r>n;)r-=n;r<Number.EPSILON&&(s?r=0:r=n),this.aClockwise===!0&&!s&&(r===n?r=-n:r=r-n);const o=this.aStartAngle+e*r;let a=this.aX+this.xRadius*Math.cos(o),c=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){const h=Math.cos(this.aRotation),u=Math.sin(this.aRotation),f=a-this.aX,d=c-this.aY;a=f*h-d*u+this.aX,c=f*u+d*h+this.aY}return i.set(a,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Q0 extends kc{constructor(e,t,i,n,r,s){super(e,t,i,i,n,r,s),this.isArcCurve=!0,this.type="ArcCurve"}}function Mf(){let l=0,e=0,t=0,i=0;function n(r,s,o,a){l=r,e=o,t=-3*r+3*s-2*o-a,i=2*r-2*s+o+a}return{initCatmullRom:function(r,s,o,a,c){n(s,o,c*(o-r),c*(a-s))},initNonuniformCatmullRom:function(r,s,o,a,c,h,u){let f=(s-r)/c-(o-r)/(c+h)+(o-s)/h,d=(o-s)/h-(a-s)/(h+u)+(a-o)/u;f*=h,d*=h,n(s,o,f,d)},calc:function(r){const s=r*r,o=s*r;return l+e*r+t*s+i*o}}}const Ol=new L,Fh=new Mf,Oh=new Mf,Uh=new Mf;class $0 extends Qn{constructor(e=[],t=!1,i="centripetal",n=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=n}getPoint(e,t=new L){const i=t,n=this.points,r=n.length,s=(r-(this.closed?0:1))*e;let o=Math.floor(s),a=s-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/r)+1)*r:a===0&&o===r-1&&(o=r-2,a=1);let c,h;this.closed||o>0?c=n[(o-1)%r]:(Ol.subVectors(n[0],n[1]).add(n[0]),c=Ol);const u=n[o%r],f=n[(o+1)%r];if(this.closed||o+2<r?h=n[(o+2)%r]:(Ol.subVectors(n[r-1],n[r-2]).add(n[r-1]),h=Ol),this.curveType==="centripetal"||this.curveType==="chordal"){const d=this.curveType==="chordal"?.5:.25;let g=Math.pow(c.distanceToSquared(u),d),p=Math.pow(u.distanceToSquared(f),d),m=Math.pow(f.distanceToSquared(h),d);p<1e-4&&(p=1),g<1e-4&&(g=p),m<1e-4&&(m=p),Fh.initNonuniformCatmullRom(c.x,u.x,f.x,h.x,g,p,m),Oh.initNonuniformCatmullRom(c.y,u.y,f.y,h.y,g,p,m),Uh.initNonuniformCatmullRom(c.z,u.z,f.z,h.z,g,p,m)}else this.curveType==="catmullrom"&&(Fh.initCatmullRom(c.x,u.x,f.x,h.x,this.tension),Oh.initCatmullRom(c.y,u.y,f.y,h.y,this.tension),Uh.initCatmullRom(c.z,u.z,f.z,h.z,this.tension));return i.set(Fh.calc(a),Oh.calc(a),Uh.calc(a)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const n=e.points[t];this.points.push(new L().fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function _p(l,e,t,i,n){const r=(i-e)*.5,s=(n-t)*.5,o=l*l,a=l*o;return(2*t-2*i+r+s)*a+(-3*t+3*i-2*r-s)*o+r*l+t}function tb(l,e){const t=1-l;return t*t*e}function nb(l,e){return 2*(1-l)*l*e}function ib(l,e){return l*l*e}function fa(l,e,t,i){return tb(l,e)+nb(l,t)+ib(l,i)}function rb(l,e){const t=1-l;return t*t*t*e}function sb(l,e){const t=1-l;return 3*t*t*l*e}function ob(l,e){return 3*(1-l)*l*l*e}function ab(l,e){return l*l*l*e}function da(l,e,t,i,n){return rb(l,e)+sb(l,t)+ob(l,i)+ab(l,n)}class Sf extends Qn{constructor(e=new pe,t=new pe,i=new pe,n=new pe){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=n}getPoint(e,t=new pe){const i=t,n=this.v0,r=this.v1,s=this.v2,o=this.v3;return i.set(da(e,n.x,r.x,s.x,o.x),da(e,n.y,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class eg extends Qn{constructor(e=new L,t=new L,i=new L,n=new L){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=n}getPoint(e,t=new L){const i=t,n=this.v0,r=this.v1,s=this.v2,o=this.v3;return i.set(da(e,n.x,r.x,s.x,o.x),da(e,n.y,r.y,s.y,o.y),da(e,n.z,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Nc extends Qn{constructor(e=new pe,t=new pe){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new pe){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const i=t||new pe;return i.copy(this.v2).sub(this.v1).normalize(),i}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class tg extends Qn{constructor(e=new L,t=new L){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new L){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Tf extends Qn{constructor(e=new pe,t=new pe,i=new pe){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new pe){const i=t,n=this.v0,r=this.v1,s=this.v2;return i.set(fa(e,n.x,r.x,s.x),fa(e,n.y,r.y,s.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Cf extends Qn{constructor(e=new L,t=new L,i=new L){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new L){const i=t,n=this.v0,r=this.v1,s=this.v2;return i.set(fa(e,n.x,r.x,s.x),fa(e,n.y,r.y,s.y),fa(e,n.z,r.z,s.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Af extends Qn{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new pe){const i=t,n=this.points,r=(n.length-1)*e,s=Math.floor(r),o=r-s,a=n[s===0?s:s-1],c=n[s],h=n[s>n.length-2?n.length-1:s+1],u=n[s>n.length-3?n.length-1:s+2];return i.set(_p(o,a.x,c.x,h.x,u.x),_p(o,a.y,c.y,h.y,u.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const n=e.points[t];this.points.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const n=e.points[t];this.points.push(new pe().fromArray(n))}return this}}var Ef=Object.freeze({__proto__:null,ArcCurve:Q0,CatmullRomCurve3:$0,CubicBezierCurve:Sf,CubicBezierCurve3:eg,EllipseCurve:kc,LineCurve:Nc,LineCurve3:tg,QuadraticBezierCurve:Tf,QuadraticBezierCurve3:Cf,SplineCurve:Af});class ng extends Qn{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Nc(t,e))}getPoint(e,t){const i=e*this.getLength(),n=this.getCurveLengths();let r=0;for(;r<n.length;){if(n[r]>=i){const s=n[r]-i,o=this.curves[r],a=o.getLength(),c=a===0?0:1-s/a;return o.getPointAt(c,t)}r++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,n=this.curves.length;i<n;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let n=0,r=this.curves;n<r.length;n++){const s=r[n],o=s.isEllipseCurve?e*2:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,a=s.getPoints(o);for(let c=0;c<a.length;c++){const h=a[c];i&&i.equals(h)||(t.push(h),i=h)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){const n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const n=e.curves[t];this.curves.push(new Ef[n.type]().fromJSON(n))}return this}}class Aa extends ng{constructor(e){super(),this.type="Path",this.currentPoint=new pe,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new Nc(this.currentPoint.clone(),new pe(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,n){const r=new Tf(this.currentPoint.clone(),new pe(e,t),new pe(i,n));return this.curves.push(r),this.currentPoint.set(i,n),this}bezierCurveTo(e,t,i,n,r,s){const o=new Sf(this.currentPoint.clone(),new pe(e,t),new pe(i,n),new pe(r,s));return this.curves.push(o),this.currentPoint.set(r,s),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new Af(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,n,r,s){const o=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(e+o,t+a,i,n,r,s),this}absarc(e,t,i,n,r,s){return this.absellipse(e,t,i,i,n,r,s),this}ellipse(e,t,i,n,r,s,o,a){const c=this.currentPoint.x,h=this.currentPoint.y;return this.absellipse(e+c,t+h,i,n,r,s,o,a),this}absellipse(e,t,i,n,r,s,o,a){const c=new kc(e,t,i,n,r,s,o,a);if(this.curves.length>0){const u=c.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(c);const h=c.getPoint(1);return this.currentPoint.copy(h),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class hs extends ze{constructor(e=[new pe(0,.5),new pe(.5,0),new pe(0,-.5)],t=12,i=0,n=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:n},t=Math.floor(t),n=Ct(n,0,Math.PI*2);const r=[],s=[],o=[],a=[],c=[],h=1/t,u=new L,f=new pe,d=new L,g=new L,p=new L;let m=0,_=0;for(let x=0;x<=e.length-1;x++)switch(x){case 0:m=e[x+1].x-e[x].x,_=e[x+1].y-e[x].y,d.x=_*1,d.y=-m,d.z=_*0,p.copy(d),d.normalize(),a.push(d.x,d.y,d.z);break;case e.length-1:a.push(p.x,p.y,p.z);break;default:m=e[x+1].x-e[x].x,_=e[x+1].y-e[x].y,d.x=_*1,d.y=-m,d.z=_*0,g.copy(d),d.x+=p.x,d.y+=p.y,d.z+=p.z,d.normalize(),a.push(d.x,d.y,d.z),p.copy(g)}for(let x=0;x<=t;x++){const b=i+x*h*n,y=Math.sin(b),v=Math.cos(b);for(let M=0;M<=e.length-1;M++){u.x=e[M].x*y,u.y=e[M].y,u.z=e[M].x*v,s.push(u.x,u.y,u.z),f.x=x/t,f.y=M/(e.length-1),o.push(f.x,f.y);const S=a[3*M+0]*y,w=a[3*M+1],T=a[3*M+0]*v;c.push(S,w,T)}}for(let x=0;x<t;x++)for(let b=0;b<e.length-1;b++){const y=b+x*e.length,v=y,M=y+e.length,S=y+e.length+1,w=y+1;r.push(v,M,w),r.push(S,w,M)}this.setIndex(r),this.setAttribute("position",new Fe(s,3)),this.setAttribute("uv",new Fe(o,2)),this.setAttribute("normal",new Fe(c,3))}static fromJSON(e){return new hs(e.points,e.segments,e.phiStart,e.phiLength)}}class lo extends hs{constructor(e=1,t=1,i=4,n=8){const r=new Aa;r.absarc(0,-t/2,e,Math.PI*1.5,0),r.absarc(0,t/2,e,0,Math.PI*.5),super(r.getPoints(i),n),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:i,radialSegments:n}}static fromJSON(e){return new lo(e.radius,e.length,e.capSegments,e.radialSegments)}}class co extends ze{constructor(e=1,t=8,i=0,n=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:n},t=Math.max(3,t);const r=[],s=[],o=[],a=[],c=new L,h=new pe;s.push(0,0,0),o.push(0,0,1),a.push(.5,.5);for(let u=0,f=3;u<=t;u++,f+=3){const d=i+u/t*n;c.x=e*Math.cos(d),c.y=e*Math.sin(d),s.push(c.x,c.y,c.z),o.push(0,0,1),h.x=(s[f]/e+1)/2,h.y=(s[f+1]/e+1)/2,a.push(h.x,h.y)}for(let u=1;u<=t;u++)r.push(u,u+1,0);this.setIndex(r),this.setAttribute("position",new Fe(s,3)),this.setAttribute("normal",new Fe(o,3)),this.setAttribute("uv",new Fe(a,2))}static fromJSON(e){return new co(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class pi extends ze{constructor(e=1,t=1,i=1,n=8,r=1,s=!1,o=0,a=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a};const c=this;n=Math.floor(n),r=Math.floor(r);const h=[],u=[],f=[],d=[];let g=0;const p=[],m=i/2;let _=0;x(),s===!1&&(e>0&&b(!0),t>0&&b(!1)),this.setIndex(h),this.setAttribute("position",new Fe(u,3)),this.setAttribute("normal",new Fe(f,3)),this.setAttribute("uv",new Fe(d,2));function x(){const y=new L,v=new L;let M=0;const S=(t-e)/i;for(let w=0;w<=r;w++){const T=[],R=w/r,D=R*(t-e)+e;for(let I=0;I<=n;I++){const U=I/n,A=U*a+o,B=Math.sin(A),O=Math.cos(A);v.x=D*B,v.y=-R*i+m,v.z=D*O,u.push(v.x,v.y,v.z),y.set(B,S,O).normalize(),f.push(y.x,y.y,y.z),d.push(U,1-R),T.push(g++)}p.push(T)}for(let w=0;w<n;w++)for(let T=0;T<r;T++){const R=p[T][w],D=p[T+1][w],I=p[T+1][w+1],U=p[T][w+1];h.push(R,D,U),h.push(D,I,U),M+=6}c.addGroup(_,M,0),_+=M}function b(y){const v=g,M=new pe,S=new L;let w=0;const T=y===!0?e:t,R=y===!0?1:-1;for(let I=1;I<=n;I++)u.push(0,m*R,0),f.push(0,R,0),d.push(.5,.5),g++;const D=g;for(let I=0;I<=n;I++){const A=I/n*a+o,B=Math.cos(A),O=Math.sin(A);S.x=T*O,S.y=m*R,S.z=T*B,u.push(S.x,S.y,S.z),f.push(0,R,0),M.x=B*.5+.5,M.y=O*.5*R+.5,d.push(M.x,M.y),g++}for(let I=0;I<n;I++){const U=v+I,A=D+I;y===!0?h.push(A,A+1,U):h.push(A+1,A,U),w+=3}c.addGroup(_,w,y===!0?1:2),_+=w}}static fromJSON(e){return new pi(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class ho extends pi{constructor(e=1,t=1,i=8,n=1,r=!1,s=0,o=Math.PI*2){super(0,e,t,i,n,r,s,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:s,thetaLength:o}}static fromJSON(e){return new ho(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class mi extends ze{constructor(e=[],t=[],i=1,n=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:n};const r=[],s=[];o(n),c(i),h(),this.setAttribute("position",new Fe(r,3)),this.setAttribute("normal",new Fe(r.slice(),3)),this.setAttribute("uv",new Fe(s,2)),n===0?this.computeVertexNormals():this.normalizeNormals();function o(x){const b=new L,y=new L,v=new L;for(let M=0;M<t.length;M+=3)d(t[M+0],b),d(t[M+1],y),d(t[M+2],v),a(b,y,v,x)}function a(x,b,y,v){const M=v+1,S=[];for(let w=0;w<=M;w++){S[w]=[];const T=x.clone().lerp(y,w/M),R=b.clone().lerp(y,w/M),D=M-w;for(let I=0;I<=D;I++)I===0&&w===M?S[w][I]=T:S[w][I]=T.clone().lerp(R,I/D)}for(let w=0;w<M;w++)for(let T=0;T<2*(M-w)-1;T++){const R=Math.floor(T/2);T%2===0?(f(S[w][R+1]),f(S[w+1][R]),f(S[w][R])):(f(S[w][R+1]),f(S[w+1][R+1]),f(S[w+1][R]))}}function c(x){const b=new L;for(let y=0;y<r.length;y+=3)b.x=r[y+0],b.y=r[y+1],b.z=r[y+2],b.normalize().multiplyScalar(x),r[y+0]=b.x,r[y+1]=b.y,r[y+2]=b.z}function h(){const x=new L;for(let b=0;b<r.length;b+=3){x.x=r[b+0],x.y=r[b+1],x.z=r[b+2];const y=m(x)/2/Math.PI+.5,v=_(x)/Math.PI+.5;s.push(y,1-v)}g(),u()}function u(){for(let x=0;x<s.length;x+=6){const b=s[x+0],y=s[x+2],v=s[x+4],M=Math.max(b,y,v),S=Math.min(b,y,v);M>.9&&S<.1&&(b<.2&&(s[x+0]+=1),y<.2&&(s[x+2]+=1),v<.2&&(s[x+4]+=1))}}function f(x){r.push(x.x,x.y,x.z)}function d(x,b){const y=x*3;b.x=e[y+0],b.y=e[y+1],b.z=e[y+2]}function g(){const x=new L,b=new L,y=new L,v=new L,M=new pe,S=new pe,w=new pe;for(let T=0,R=0;T<r.length;T+=9,R+=6){x.set(r[T+0],r[T+1],r[T+2]),b.set(r[T+3],r[T+4],r[T+5]),y.set(r[T+6],r[T+7],r[T+8]),M.set(s[R+0],s[R+1]),S.set(s[R+2],s[R+3]),w.set(s[R+4],s[R+5]),v.copy(x).add(b).add(y).divideScalar(3);const D=m(v);p(M,R+0,x,D),p(S,R+2,b,D),p(w,R+4,y,D)}}function p(x,b,y,v){v<0&&x.x===1&&(s[b]=x.x-1),y.x===0&&y.z===0&&(s[b]=v/2/Math.PI+.5)}function m(x){return Math.atan2(x.z,-x.x)}function _(x){return Math.atan2(-x.y,Math.sqrt(x.x*x.x+x.z*x.z))}}static fromJSON(e){return new mi(e.vertices,e.indices,e.radius,e.details)}}class uo extends mi{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,n=1/i,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(r,s,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new uo(e.radius,e.detail)}}const Ul=new L,kl=new L,kh=new L,Nl=new Pn;class ig extends ze{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const n=Math.pow(10,4),r=Math.cos($r*t),s=e.getIndex(),o=e.getAttribute("position"),a=s?s.count:o.count,c=[0,0,0],h=["a","b","c"],u=new Array(3),f={},d=[];for(let g=0;g<a;g+=3){s?(c[0]=s.getX(g),c[1]=s.getX(g+1),c[2]=s.getX(g+2)):(c[0]=g,c[1]=g+1,c[2]=g+2);const{a:p,b:m,c:_}=Nl;if(p.fromBufferAttribute(o,c[0]),m.fromBufferAttribute(o,c[1]),_.fromBufferAttribute(o,c[2]),Nl.getNormal(kh),u[0]=`${Math.round(p.x*n)},${Math.round(p.y*n)},${Math.round(p.z*n)}`,u[1]=`${Math.round(m.x*n)},${Math.round(m.y*n)},${Math.round(m.z*n)}`,u[2]=`${Math.round(_.x*n)},${Math.round(_.y*n)},${Math.round(_.z*n)}`,!(u[0]===u[1]||u[1]===u[2]||u[2]===u[0]))for(let x=0;x<3;x++){const b=(x+1)%3,y=u[x],v=u[b],M=Nl[h[x]],S=Nl[h[b]],w=`${y}_${v}`,T=`${v}_${y}`;T in f&&f[T]?(kh.dot(f[T].normal)<=r&&(d.push(M.x,M.y,M.z),d.push(S.x,S.y,S.z)),f[T]=null):w in f||(f[w]={index0:c[x],index1:c[b],normal:kh.clone()})}}for(const g in f)if(f[g]){const{index0:p,index1:m}=f[g];Ul.fromBufferAttribute(o,p),kl.fromBufferAttribute(o,m),d.push(Ul.x,Ul.y,Ul.z),d.push(kl.x,kl.y,kl.z)}this.setAttribute("position",new Fe(d,3))}}}class ts extends Aa{constructor(e){super(e),this.uuid=wn(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,n=this.holes.length;i<n;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){const n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const n=e.holes[t];this.holes.push(new Aa().fromJSON(n))}return this}}const lb={triangulate:function(l,e,t=2){const i=e&&e.length,n=i?e[0]*t:l.length;let r=rg(l,0,n,t,!0);const s=[];if(!r||r.next===r.prev)return s;let o,a,c,h,u,f,d;if(i&&(r=db(l,e,r,t)),l.length>80*t){o=c=l[0],a=h=l[1];for(let g=t;g<n;g+=t)u=l[g],f=l[g+1],u<o&&(o=u),f<a&&(a=f),u>c&&(c=u),f>h&&(h=f);d=Math.max(c-o,h-a),d=d!==0?1/d:0}return Ea(r,s,t,o,a,d),s}};function rg(l,e,t,i,n){let r,s;if(n===Sb(l,e,t,i)>0)for(r=e;r<t;r+=i)s=xp(r,l[r],l[r+1],s);else for(r=t-i;r>=e;r-=i)s=xp(r,l[r],l[r+1],s);return s&&Bc(s,s.next)&&(Ra(s),s=s.next),s}function gr(l,e){if(!l)return l;e||(e=l);let t=l,i;do if(i=!1,!t.steiner&&(Bc(t,t.next)||_t(t.prev,t,t.next)===0)){if(Ra(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function Ea(l,e,t,i,n,r,s){if(!l)return;!s&&r&&xb(l,i,n,r);let o=l,a,c;for(;l.prev!==l.next;){if(a=l.prev,c=l.next,r?hb(l,i,n,r):cb(l)){e.push(a.i/t),e.push(l.i/t),e.push(c.i/t),Ra(l),l=c.next,o=c.next;continue}if(l=c,l===o){s?s===1?(l=ub(gr(l),e,t),Ea(l,e,t,i,n,r,2)):s===2&&fb(l,e,t,i,n,r):Ea(gr(l),e,t,i,n,r,1);break}}}function cb(l){const e=l.prev,t=l,i=l.next;if(_t(e,t,i)>=0)return!1;let n=l.next.next;for(;n!==l.prev;){if(Ys(e.x,e.y,t.x,t.y,i.x,i.y,n.x,n.y)&&_t(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function hb(l,e,t,i){const n=l.prev,r=l,s=l.next;if(_t(n,r,s)>=0)return!1;const o=n.x<r.x?n.x<s.x?n.x:s.x:r.x<s.x?r.x:s.x,a=n.y<r.y?n.y<s.y?n.y:s.y:r.y<s.y?r.y:s.y,c=n.x>r.x?n.x>s.x?n.x:s.x:r.x>s.x?r.x:s.x,h=n.y>r.y?n.y>s.y?n.y:s.y:r.y>s.y?r.y:s.y,u=ku(o,a,e,t,i),f=ku(c,h,e,t,i);let d=l.prevZ,g=l.nextZ;for(;d&&d.z>=u&&g&&g.z<=f;){if(d!==l.prev&&d!==l.next&&Ys(n.x,n.y,r.x,r.y,s.x,s.y,d.x,d.y)&&_t(d.prev,d,d.next)>=0||(d=d.prevZ,g!==l.prev&&g!==l.next&&Ys(n.x,n.y,r.x,r.y,s.x,s.y,g.x,g.y)&&_t(g.prev,g,g.next)>=0))return!1;g=g.nextZ}for(;d&&d.z>=u;){if(d!==l.prev&&d!==l.next&&Ys(n.x,n.y,r.x,r.y,s.x,s.y,d.x,d.y)&&_t(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;g&&g.z<=f;){if(g!==l.prev&&g!==l.next&&Ys(n.x,n.y,r.x,r.y,s.x,s.y,g.x,g.y)&&_t(g.prev,g,g.next)>=0)return!1;g=g.nextZ}return!0}function ub(l,e,t){let i=l;do{const n=i.prev,r=i.next.next;!Bc(n,r)&&sg(n,i,i.next,r)&&La(n,r)&&La(r,n)&&(e.push(n.i/t),e.push(i.i/t),e.push(r.i/t),Ra(i),Ra(i.next),i=l=r),i=i.next}while(i!==l);return gr(i)}function fb(l,e,t,i,n,r){let s=l;do{let o=s.next.next;for(;o!==s.prev;){if(s.i!==o.i&&bb(s,o)){let a=og(s,o);s=gr(s,s.next),a=gr(a,a.next),Ea(s,e,t,i,n,r),Ea(a,e,t,i,n,r);return}o=o.next}s=s.next}while(s!==l)}function db(l,e,t,i){const n=[];let r,s,o,a,c;for(r=0,s=e.length;r<s;r++)o=e[r]*i,a=r<s-1?e[r+1]*i:l.length,c=rg(l,o,a,i,!1),c===c.next&&(c.steiner=!0),n.push(yb(c));for(n.sort(pb),r=0;r<n.length;r++)mb(n[r],t),t=gr(t,t.next);return t}function pb(l,e){return l.x-e.x}function mb(l,e){if(e=gb(l,e),e){const t=og(e,l);gr(e,e.next),gr(t,t.next)}}function gb(l,e){let t=e;const i=l.x,n=l.y;let r=-1/0,s;do{if(n<=t.y&&n>=t.next.y&&t.next.y!==t.y){const f=t.x+(n-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(f<=i&&f>r){if(r=f,f===i){if(n===t.y)return t;if(n===t.next.y)return t.next}s=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!s)return null;if(i===r)return s;const o=s,a=s.x,c=s.y;let h=1/0,u;t=s;do i>=t.x&&t.x>=a&&i!==t.x&&Ys(n<c?i:r,n,a,c,n<c?r:i,n,t.x,t.y)&&(u=Math.abs(n-t.y)/(i-t.x),La(t,l)&&(u<h||u===h&&(t.x>s.x||t.x===s.x&&_b(s,t)))&&(s=t,h=u)),t=t.next;while(t!==o);return s}function _b(l,e){return _t(l.prev,l,e.prev)<0&&_t(e.next,l,l.next)<0}function xb(l,e,t,i){let n=l;do n.z===null&&(n.z=ku(n.x,n.y,e,t,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==l);n.prevZ.nextZ=null,n.prevZ=null,vb(n)}function vb(l){let e,t,i,n,r,s,o,a,c=1;do{for(t=l,l=null,r=null,s=0;t;){for(s++,i=t,o=0,e=0;e<c&&(o++,i=i.nextZ,!!i);e++);for(a=c;o>0||a>0&&i;)o!==0&&(a===0||!i||t.z<=i.z)?(n=t,t=t.nextZ,o--):(n=i,i=i.nextZ,a--),r?r.nextZ=n:l=n,n.prevZ=r,r=n;t=i}r.nextZ=null,c*=2}while(s>1);return l}function ku(l,e,t,i,n){return l=32767*(l-t)*n,e=32767*(e-i)*n,l=(l|l<<8)&16711935,l=(l|l<<4)&252645135,l=(l|l<<2)&858993459,l=(l|l<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,l|e<<1}function yb(l){let e=l,t=l;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==l);return t}function Ys(l,e,t,i,n,r,s,o){return(n-s)*(e-o)-(l-s)*(r-o)>=0&&(l-s)*(i-o)-(t-s)*(e-o)>=0&&(t-s)*(r-o)-(n-s)*(i-o)>=0}function bb(l,e){return l.next.i!==e.i&&l.prev.i!==e.i&&!wb(l,e)&&(La(l,e)&&La(e,l)&&Mb(l,e)&&(_t(l.prev,l,e.prev)||_t(l,e.prev,e))||Bc(l,e)&&_t(l.prev,l,l.next)>0&&_t(e.prev,e,e.next)>0)}function _t(l,e,t){return(e.y-l.y)*(t.x-e.x)-(e.x-l.x)*(t.y-e.y)}function Bc(l,e){return l.x===e.x&&l.y===e.y}function sg(l,e,t,i){const n=zl(_t(l,e,t)),r=zl(_t(l,e,i)),s=zl(_t(t,i,l)),o=zl(_t(t,i,e));return!!(n!==r&&s!==o||n===0&&Bl(l,t,e)||r===0&&Bl(l,i,e)||s===0&&Bl(t,l,i)||o===0&&Bl(t,e,i))}function Bl(l,e,t){return e.x<=Math.max(l.x,t.x)&&e.x>=Math.min(l.x,t.x)&&e.y<=Math.max(l.y,t.y)&&e.y>=Math.min(l.y,t.y)}function zl(l){return l>0?1:l<0?-1:0}function wb(l,e){let t=l;do{if(t.i!==l.i&&t.next.i!==l.i&&t.i!==e.i&&t.next.i!==e.i&&sg(t,t.next,l,e))return!0;t=t.next}while(t!==l);return!1}function La(l,e){return _t(l.prev,l,l.next)<0?_t(l,e,l.next)>=0&&_t(l,l.prev,e)>=0:_t(l,e,l.prev)<0||_t(l,l.next,e)<0}function Mb(l,e){let t=l,i=!1;const n=(l.x+e.x)/2,r=(l.y+e.y)/2;do t.y>r!=t.next.y>r&&t.next.y!==t.y&&n<(t.next.x-t.x)*(r-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==l);return i}function og(l,e){const t=new Nu(l.i,l.x,l.y),i=new Nu(e.i,e.x,e.y),n=l.next,r=e.prev;return l.next=e,e.prev=l,t.next=n,n.prev=t,i.next=t,t.prev=i,r.next=i,i.prev=r,i}function xp(l,e,t,i){const n=new Nu(l,e,t);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function Ra(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function Nu(l,e,t){this.i=l,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Sb(l,e,t,i){let n=0;for(let r=e,s=t-i;r<t;r+=i)n+=(l[s]-l[r])*(l[r+1]+l[s+1]),s=r;return n}class ci{static area(e){const t=e.length;let i=0;for(let n=t-1,r=0;r<t;n=r++)i+=e[n].x*e[r].y-e[r].x*e[n].y;return i*.5}static isClockWise(e){return ci.area(e)<0}static triangulateShape(e,t){const i=[],n=[],r=[];vp(e),yp(i,e);let s=e.length;t.forEach(vp);for(let a=0;a<t.length;a++)n.push(s),s+=t[a].length,yp(i,t[a]);const o=lb.triangulate(i,n);for(let a=0;a<o.length;a+=3)r.push(o.slice(a,a+3));return r}}function vp(l){const e=l.length;e>2&&l[e-1].equals(l[0])&&l.pop()}function yp(l,e){for(let t=0;t<e.length;t++)l.push(e[t].x),l.push(e[t].y)}class fo extends ze{constructor(e=new ts([new pe(.5,.5),new pe(-.5,.5),new pe(-.5,-.5),new pe(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,n=[],r=[];for(let o=0,a=e.length;o<a;o++){const c=e[o];s(c)}this.setAttribute("position",new Fe(n,3)),this.setAttribute("uv",new Fe(r,2)),this.computeVertexNormals();function s(o){const a=[],c=t.curveSegments!==void 0?t.curveSegments:12,h=t.steps!==void 0?t.steps:1;let u=t.depth!==void 0?t.depth:1,f=t.bevelEnabled!==void 0?t.bevelEnabled:!0,d=t.bevelThickness!==void 0?t.bevelThickness:.2,g=t.bevelSize!==void 0?t.bevelSize:d-.1,p=t.bevelOffset!==void 0?t.bevelOffset:0,m=t.bevelSegments!==void 0?t.bevelSegments:3;const _=t.extrudePath,x=t.UVGenerator!==void 0?t.UVGenerator:Tb;t.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),u=t.amount);let b,y=!1,v,M,S,w;_&&(b=_.getSpacedPoints(h),y=!0,f=!1,v=_.computeFrenetFrames(h,!1),M=new L,S=new L,w=new L),f||(m=0,d=0,g=0,p=0);const T=o.extractPoints(c);let R=T.shape;const D=T.holes;if(!ci.isClockWise(R)){R=R.reverse();for(let W=0,se=D.length;W<se;W++){const ue=D[W];ci.isClockWise(ue)&&(D[W]=ue.reverse())}}const U=ci.triangulateShape(R,D),A=R;for(let W=0,se=D.length;W<se;W++){const ue=D[W];R=R.concat(ue)}function B(W,se,ue){return se||console.error("THREE.ExtrudeGeometry: vec does not exist"),se.clone().multiplyScalar(ue).add(W)}const O=R.length,q=U.length;function Z(W,se,ue){let xe,ce,Pe;const ie=W.x-se.x,ye=W.y-se.y,Se=ue.x-W.x,oe=ue.y-W.y,E=ie*ie+ye*ye,C=ie*oe-ye*Se;if(Math.abs(C)>Number.EPSILON){const H=Math.sqrt(E),Q=Math.sqrt(Se*Se+oe*oe),fe=se.x-ye/H,_e=se.y+ie/H,me=ue.x-oe/Q,Y=ue.y+Se/Q,Le=((me-fe)*oe-(Y-_e)*Se)/(ie*oe-ye*Se);xe=fe+ie*Le-W.x,ce=_e+ye*Le-W.y;const be=xe*xe+ce*ce;if(be<=2)return new pe(xe,ce);Pe=Math.sqrt(be/2)}else{let H=!1;ie>Number.EPSILON?Se>Number.EPSILON&&(H=!0):ie<-Number.EPSILON?Se<-Number.EPSILON&&(H=!0):Math.sign(ye)===Math.sign(oe)&&(H=!0),H?(xe=-ye,ce=ie,Pe=Math.sqrt(E)):(xe=ie,ce=ye,Pe=Math.sqrt(E/2))}return new pe(xe/Pe,ce/Pe)}const k=[];for(let W=0,se=A.length,ue=se-1,xe=W+1;W<se;W++,ue++,xe++)ue===se&&(ue=0),xe===se&&(xe=0),k[W]=Z(A[W],A[ue],A[xe]);const V=[];let F,z=k.concat();for(let W=0,se=D.length;W<se;W++){const ue=D[W];F=[];for(let xe=0,ce=ue.length,Pe=ce-1,ie=xe+1;xe<ce;xe++,Pe++,ie++)Pe===ce&&(Pe=0),ie===ce&&(ie=0),F[xe]=Z(ue[xe],ue[Pe],ue[ie]);V.push(F),z=z.concat(F)}for(let W=0;W<m;W++){const se=W/m,ue=d*Math.cos(se*Math.PI/2),xe=g*Math.sin(se*Math.PI/2)+p;for(let ce=0,Pe=A.length;ce<Pe;ce++){const ie=B(A[ce],k[ce],xe);ee(ie.x,ie.y,-ue)}for(let ce=0,Pe=D.length;ce<Pe;ce++){const ie=D[ce];F=V[ce];for(let ye=0,Se=ie.length;ye<Se;ye++){const oe=B(ie[ye],F[ye],xe);ee(oe.x,oe.y,-ue)}}}const X=g+p;for(let W=0;W<O;W++){const se=f?B(R[W],z[W],X):R[W];y?(S.copy(v.normals[0]).multiplyScalar(se.x),M.copy(v.binormals[0]).multiplyScalar(se.y),w.copy(b[0]).add(S).add(M),ee(w.x,w.y,w.z)):ee(se.x,se.y,0)}for(let W=1;W<=h;W++)for(let se=0;se<O;se++){const ue=f?B(R[se],z[se],X):R[se];y?(S.copy(v.normals[W]).multiplyScalar(ue.x),M.copy(v.binormals[W]).multiplyScalar(ue.y),w.copy(b[W]).add(S).add(M),ee(w.x,w.y,w.z)):ee(ue.x,ue.y,u/h*W)}for(let W=m-1;W>=0;W--){const se=W/m,ue=d*Math.cos(se*Math.PI/2),xe=g*Math.sin(se*Math.PI/2)+p;for(let ce=0,Pe=A.length;ce<Pe;ce++){const ie=B(A[ce],k[ce],xe);ee(ie.x,ie.y,u+ue)}for(let ce=0,Pe=D.length;ce<Pe;ce++){const ie=D[ce];F=V[ce];for(let ye=0,Se=ie.length;ye<Se;ye++){const oe=B(ie[ye],F[ye],xe);y?ee(oe.x,oe.y+b[h-1].y,b[h-1].x+ue):ee(oe.x,oe.y,u+ue)}}}j(),K();function j(){const W=n.length/3;if(f){let se=0,ue=O*se;for(let xe=0;xe<q;xe++){const ce=U[xe];ne(ce[2]+ue,ce[1]+ue,ce[0]+ue)}se=h+m*2,ue=O*se;for(let xe=0;xe<q;xe++){const ce=U[xe];ne(ce[0]+ue,ce[1]+ue,ce[2]+ue)}}else{for(let se=0;se<q;se++){const ue=U[se];ne(ue[2],ue[1],ue[0])}for(let se=0;se<q;se++){const ue=U[se];ne(ue[0]+O*h,ue[1]+O*h,ue[2]+O*h)}}i.addGroup(W,n.length/3-W,0)}function K(){const W=n.length/3;let se=0;G(A,se),se+=A.length;for(let ue=0,xe=D.length;ue<xe;ue++){const ce=D[ue];G(ce,se),se+=ce.length}i.addGroup(W,n.length/3-W,1)}function G(W,se){let ue=W.length;for(;--ue>=0;){const xe=ue;let ce=ue-1;ce<0&&(ce=W.length-1);for(let Pe=0,ie=h+m*2;Pe<ie;Pe++){const ye=O*Pe,Se=O*(Pe+1),oe=se+xe+ye,E=se+ce+ye,C=se+ce+Se,H=se+xe+Se;de(oe,E,C,H)}}}function ee(W,se,ue){a.push(W),a.push(se),a.push(ue)}function ne(W,se,ue){le(W),le(se),le(ue);const xe=n.length/3,ce=x.generateTopUV(i,n,xe-3,xe-2,xe-1);ge(ce[0]),ge(ce[1]),ge(ce[2])}function de(W,se,ue,xe){le(W),le(se),le(xe),le(se),le(ue),le(xe);const ce=n.length/3,Pe=x.generateSideWallUV(i,n,ce-6,ce-3,ce-2,ce-1);ge(Pe[0]),ge(Pe[1]),ge(Pe[3]),ge(Pe[1]),ge(Pe[2]),ge(Pe[3])}function le(W){n.push(a[W*3+0]),n.push(a[W*3+1]),n.push(a[W*3+2])}function ge(W){r.push(W.x),r.push(W.y)}}}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,i=this.parameters.options;return Cb(t,i,e)}static fromJSON(e,t){const i=[];for(let r=0,s=e.shapes.length;r<s;r++){const o=t[e.shapes[r]];i.push(o)}const n=e.options.extrudePath;return n!==void 0&&(e.options.extrudePath=new Ef[n.type]().fromJSON(n)),new fo(i,e.options)}}const Tb={generateTopUV:function(l,e,t,i,n){const r=e[t*3],s=e[t*3+1],o=e[i*3],a=e[i*3+1],c=e[n*3],h=e[n*3+1];return[new pe(r,s),new pe(o,a),new pe(c,h)]},generateSideWallUV:function(l,e,t,i,n,r){const s=e[t*3],o=e[t*3+1],a=e[t*3+2],c=e[i*3],h=e[i*3+1],u=e[i*3+2],f=e[n*3],d=e[n*3+1],g=e[n*3+2],p=e[r*3],m=e[r*3+1],_=e[r*3+2];return Math.abs(o-h)<Math.abs(s-c)?[new pe(s,1-a),new pe(c,1-u),new pe(f,1-g),new pe(p,1-_)]:[new pe(o,1-a),new pe(h,1-u),new pe(d,1-g),new pe(m,1-_)]}};function Cb(l,e,t){if(t.shapes=[],Array.isArray(l))for(let i=0,n=l.length;i<n;i++){const r=l[i];t.shapes.push(r.uuid)}else t.shapes.push(l.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class po extends mi{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(n,r,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new po(e.radius,e.detail)}}class us extends mi{constructor(e=1,t=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],n=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,n,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new us(e.radius,e.detail)}}class mo extends ze{constructor(e=.5,t=1,i=8,n=1,r=0,s=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:s},i=Math.max(3,i),n=Math.max(1,n);const o=[],a=[],c=[],h=[];let u=e;const f=(t-e)/n,d=new L,g=new pe;for(let p=0;p<=n;p++){for(let m=0;m<=i;m++){const _=r+m/i*s;d.x=u*Math.cos(_),d.y=u*Math.sin(_),a.push(d.x,d.y,d.z),c.push(0,0,1),g.x=(d.x/t+1)/2,g.y=(d.y/t+1)/2,h.push(g.x,g.y)}u+=f}for(let p=0;p<n;p++){const m=p*(i+1);for(let _=0;_<i;_++){const x=_+m,b=x,y=x+i+1,v=x+i+2,M=x+1;o.push(b,y,M),o.push(y,v,M)}}this.setIndex(o),this.setAttribute("position",new Fe(a,3)),this.setAttribute("normal",new Fe(c,3)),this.setAttribute("uv",new Fe(h,2))}static fromJSON(e){return new mo(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class go extends ze{constructor(e=new ts([new pe(0,.5),new pe(-.5,-.5),new pe(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const i=[],n=[],r=[],s=[];let o=0,a=0;if(Array.isArray(e)===!1)c(e);else for(let h=0;h<e.length;h++)c(e[h]),this.addGroup(o,a,h),o+=a,a=0;this.setIndex(i),this.setAttribute("position",new Fe(n,3)),this.setAttribute("normal",new Fe(r,3)),this.setAttribute("uv",new Fe(s,2));function c(h){const u=n.length/3,f=h.extractPoints(t);let d=f.shape;const g=f.holes;ci.isClockWise(d)===!1&&(d=d.reverse());for(let m=0,_=g.length;m<_;m++){const x=g[m];ci.isClockWise(x)===!0&&(g[m]=x.reverse())}const p=ci.triangulateShape(d,g);for(let m=0,_=g.length;m<_;m++){const x=g[m];d=d.concat(x)}for(let m=0,_=d.length;m<_;m++){const x=d[m];n.push(x.x,x.y,0),r.push(0,0,1),s.push(x.x,x.y)}for(let m=0,_=p.length;m<_;m++){const x=p[m],b=x[0]+u,y=x[1]+u,v=x[2]+u;i.push(b,y,v),a+=3}}}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return Ab(t,e)}static fromJSON(e,t){const i=[];for(let n=0,r=e.shapes.length;n<r;n++){const s=t[e.shapes[n]];i.push(s)}return new go(i,e.curveSegments)}}function Ab(l,e){if(e.shapes=[],Array.isArray(l))for(let t=0,i=l.length;t<i;t++){const n=l[t];e.shapes.push(n.uuid)}else e.shapes.push(l.uuid);return e}class _r extends ze{constructor(e=1,t=32,i=16,n=0,r=Math.PI*2,s=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:n,phiLength:r,thetaStart:s,thetaLength:o},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const a=Math.min(s+o,Math.PI);let c=0;const h=[],u=new L,f=new L,d=[],g=[],p=[],m=[];for(let _=0;_<=i;_++){const x=[],b=_/i;let y=0;_==0&&s==0?y=.5/t:_==i&&a==Math.PI&&(y=-.5/t);for(let v=0;v<=t;v++){const M=v/t;u.x=-e*Math.cos(n+M*r)*Math.sin(s+b*o),u.y=e*Math.cos(s+b*o),u.z=e*Math.sin(n+M*r)*Math.sin(s+b*o),g.push(u.x,u.y,u.z),f.copy(u).normalize(),p.push(f.x,f.y,f.z),m.push(M+y,1-b),x.push(c++)}h.push(x)}for(let _=0;_<i;_++)for(let x=0;x<t;x++){const b=h[_][x+1],y=h[_][x],v=h[_+1][x],M=h[_+1][x+1];(_!==0||s>0)&&d.push(b,y,M),(_!==i-1||a<Math.PI)&&d.push(y,v,M)}this.setIndex(d),this.setAttribute("position",new Fe(g,3)),this.setAttribute("normal",new Fe(p,3)),this.setAttribute("uv",new Fe(m,2))}static fromJSON(e){return new _r(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class _o extends mi{constructor(e=1,t=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],n=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,n,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new _o(e.radius,e.detail)}}class xo extends ze{constructor(e=1,t=.4,i=8,n=6,r=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:n,arc:r},i=Math.floor(i),n=Math.floor(n);const s=[],o=[],a=[],c=[],h=new L,u=new L,f=new L;for(let d=0;d<=i;d++)for(let g=0;g<=n;g++){const p=g/n*r,m=d/i*Math.PI*2;u.x=(e+t*Math.cos(m))*Math.cos(p),u.y=(e+t*Math.cos(m))*Math.sin(p),u.z=t*Math.sin(m),o.push(u.x,u.y,u.z),h.x=e*Math.cos(p),h.y=e*Math.sin(p),f.subVectors(u,h).normalize(),a.push(f.x,f.y,f.z),c.push(g/n),c.push(d/i)}for(let d=1;d<=i;d++)for(let g=1;g<=n;g++){const p=(n+1)*d+g-1,m=(n+1)*(d-1)+g-1,_=(n+1)*(d-1)+g,x=(n+1)*d+g;s.push(p,m,x),s.push(m,_,x)}this.setIndex(s),this.setAttribute("position",new Fe(o,3)),this.setAttribute("normal",new Fe(a,3)),this.setAttribute("uv",new Fe(c,2))}static fromJSON(e){return new xo(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class vo extends ze{constructor(e=1,t=.4,i=64,n=8,r=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:n,p:r,q:s},i=Math.floor(i),n=Math.floor(n);const o=[],a=[],c=[],h=[],u=new L,f=new L,d=new L,g=new L,p=new L,m=new L,_=new L;for(let b=0;b<=i;++b){const y=b/i*r*Math.PI*2;x(y,r,s,e,d),x(y+.01,r,s,e,g),m.subVectors(g,d),_.addVectors(g,d),p.crossVectors(m,_),_.crossVectors(p,m),p.normalize(),_.normalize();for(let v=0;v<=n;++v){const M=v/n*Math.PI*2,S=-t*Math.cos(M),w=t*Math.sin(M);u.x=d.x+(S*_.x+w*p.x),u.y=d.y+(S*_.y+w*p.y),u.z=d.z+(S*_.z+w*p.z),a.push(u.x,u.y,u.z),f.subVectors(u,d).normalize(),c.push(f.x,f.y,f.z),h.push(b/i),h.push(v/n)}}for(let b=1;b<=i;b++)for(let y=1;y<=n;y++){const v=(n+1)*(b-1)+(y-1),M=(n+1)*b+(y-1),S=(n+1)*b+y,w=(n+1)*(b-1)+y;o.push(v,M,w),o.push(M,S,w)}this.setIndex(o),this.setAttribute("position",new Fe(a,3)),this.setAttribute("normal",new Fe(c,3)),this.setAttribute("uv",new Fe(h,2));function x(b,y,v,M,S){const w=Math.cos(b),T=Math.sin(b),R=v/y*b,D=Math.cos(R);S.x=M*(2+D)*.5*w,S.y=M*(2+D)*T*.5,S.z=M*Math.sin(R)*.5}}static fromJSON(e){return new vo(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class yo extends ze{constructor(e=new Cf(new L(-1,-1,0),new L(-1,1,0),new L(1,1,0)),t=64,i=1,n=8,r=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:n,closed:r};const s=e.computeFrenetFrames(t,r);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;const o=new L,a=new L,c=new pe;let h=new L;const u=[],f=[],d=[],g=[];p(),this.setIndex(g),this.setAttribute("position",new Fe(u,3)),this.setAttribute("normal",new Fe(f,3)),this.setAttribute("uv",new Fe(d,2));function p(){for(let b=0;b<t;b++)m(b);m(r===!1?t:0),x(),_()}function m(b){h=e.getPointAt(b/t,h);const y=s.normals[b],v=s.binormals[b];for(let M=0;M<=n;M++){const S=M/n*Math.PI*2,w=Math.sin(S),T=-Math.cos(S);a.x=T*y.x+w*v.x,a.y=T*y.y+w*v.y,a.z=T*y.z+w*v.z,a.normalize(),f.push(a.x,a.y,a.z),o.x=h.x+i*a.x,o.y=h.y+i*a.y,o.z=h.z+i*a.z,u.push(o.x,o.y,o.z)}}function _(){for(let b=1;b<=t;b++)for(let y=1;y<=n;y++){const v=(n+1)*(b-1)+(y-1),M=(n+1)*b+(y-1),S=(n+1)*b+y,w=(n+1)*(b-1)+y;g.push(v,M,w),g.push(M,S,w)}}function x(){for(let b=0;b<=t;b++)for(let y=0;y<=n;y++)c.x=b/t,c.y=y/n,d.push(c.x,c.y)}}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new yo(new Ef[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class ag extends ze{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],i=new Set,n=new L,r=new L;if(e.index!==null){const s=e.attributes.position,o=e.index;let a=e.groups;a.length===0&&(a=[{start:0,count:o.count,materialIndex:0}]);for(let c=0,h=a.length;c<h;++c){const u=a[c],f=u.start,d=u.count;for(let g=f,p=f+d;g<p;g+=3)for(let m=0;m<3;m++){const _=o.getX(g+m),x=o.getX(g+(m+1)%3);n.fromBufferAttribute(s,_),r.fromBufferAttribute(s,x),bp(n,r,i)===!0&&(t.push(n.x,n.y,n.z),t.push(r.x,r.y,r.z))}}}else{const s=e.attributes.position;for(let o=0,a=s.count/3;o<a;o++)for(let c=0;c<3;c++){const h=3*o+c,u=3*o+(c+1)%3;n.fromBufferAttribute(s,h),r.fromBufferAttribute(s,u),bp(n,r,i)===!0&&(t.push(n.x,n.y,n.z),t.push(r.x,r.y,r.z))}}this.setAttribute("position",new Fe(t,3))}}}function bp(l,e,t){const i=`${l.x},${l.y},${l.z}-${e.x},${e.y},${e.z}`,n=`${e.x},${e.y},${e.z}-${l.x},${l.y},${l.z}`;return t.has(i)===!0||t.has(n)===!0?!1:(t.add(i),t.add(n),!0)}var wp=Object.freeze({__proto__:null,BoxGeometry:fi,BoxBufferGeometry:fi,CapsuleGeometry:lo,CapsuleBufferGeometry:lo,CircleGeometry:co,CircleBufferGeometry:co,ConeGeometry:ho,ConeBufferGeometry:ho,CylinderGeometry:pi,CylinderBufferGeometry:pi,DodecahedronGeometry:uo,DodecahedronBufferGeometry:uo,EdgesGeometry:ig,ExtrudeGeometry:fo,ExtrudeBufferGeometry:fo,IcosahedronGeometry:po,IcosahedronBufferGeometry:po,LatheGeometry:hs,LatheBufferGeometry:hs,OctahedronGeometry:us,OctahedronBufferGeometry:us,PlaneGeometry:Zn,PlaneBufferGeometry:Zn,PolyhedronGeometry:mi,PolyhedronBufferGeometry:mi,RingGeometry:mo,RingBufferGeometry:mo,ShapeGeometry:go,ShapeBufferGeometry:go,SphereGeometry:_r,SphereBufferGeometry:_r,TetrahedronGeometry:_o,TetrahedronBufferGeometry:_o,TorusGeometry:xo,TorusBufferGeometry:xo,TorusKnotGeometry:vo,TorusKnotBufferGeometry:vo,TubeGeometry:yo,TubeBufferGeometry:yo,WireframeGeometry:ag});class lg extends bt{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Ae(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class cg extends di{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class ps extends bt{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ae(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ae(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wr,this.normalScale=new pe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Ni extends ps{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new pe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Ct(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ae(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Ae(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ae(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class hg extends bt{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ae(16777215),this.specular=new Ae(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ae(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wr,this.normalScale=new pe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Va,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ug extends bt{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ae(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ae(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wr,this.normalScale=new pe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class fg extends bt{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wr,this.normalScale=new pe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class dg extends bt{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ae(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ae(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Va,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class pg extends bt{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ae(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wr,this.normalScale=new pe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class mg extends Kt{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}const Eb={ShadowMaterial:lg,SpriteMaterial:vf,RawShaderMaterial:cg,ShaderMaterial:di,PointsMaterial:Uc,MeshPhysicalMaterial:Ni,MeshStandardMaterial:ps,MeshPhongMaterial:hg,MeshToonMaterial:ug,MeshNormalMaterial:fg,MeshLambertMaterial:dg,MeshDepthMaterial:Pc,MeshDistanceMaterial:Dc,MeshBasicMaterial:kt,MeshMatcapMaterial:pg,LineDashedMaterial:mg,LineBasicMaterial:Kt,Material:bt};bt.fromType=function(l){return new Eb[l]};const ft={arraySlice:function(l,e,t){return ft.isTypedArray(l)?new l.constructor(l.subarray(e,t!==void 0?t:l.length)):l.slice(e,t)},convertArray:function(l,e,t){return!l||!t&&l.constructor===e?l:typeof e.BYTES_PER_ELEMENT=="number"?new e(l):Array.prototype.slice.call(l)},isTypedArray:function(l){return ArrayBuffer.isView(l)&&!(l instanceof DataView)},getKeyframeOrder:function(l){function e(n,r){return l[n]-l[r]}const t=l.length,i=new Array(t);for(let n=0;n!==t;++n)i[n]=n;return i.sort(e),i},sortedArray:function(l,e,t){const i=l.length,n=new l.constructor(i);for(let r=0,s=0;s!==i;++r){const o=t[r]*e;for(let a=0;a!==e;++a)n[s++]=l[o+a]}return n},flattenJSON:function(l,e,t,i){let n=1,r=l[0];for(;r!==void 0&&r[i]===void 0;)r=l[n++];if(r===void 0)return;let s=r[i];if(s!==void 0)if(Array.isArray(s))do s=r[i],s!==void 0&&(e.push(r.time),t.push.apply(t,s)),r=l[n++];while(r!==void 0);else if(s.toArray!==void 0)do s=r[i],s!==void 0&&(e.push(r.time),s.toArray(t,t.length)),r=l[n++];while(r!==void 0);else do s=r[i],s!==void 0&&(e.push(r.time),t.push(s)),r=l[n++];while(r!==void 0)},subclip:function(l,e,t,i,n=30){const r=l.clone();r.name=e;const s=[];for(let a=0;a<r.tracks.length;++a){const c=r.tracks[a],h=c.getValueSize(),u=[],f=[];for(let d=0;d<c.times.length;++d){const g=c.times[d]*n;if(!(g<t||g>=i)){u.push(c.times[d]);for(let p=0;p<h;++p)f.push(c.values[d*h+p])}}u.length!==0&&(c.times=ft.convertArray(u,c.times.constructor),c.values=ft.convertArray(f,c.values.constructor),s.push(c))}r.tracks=s;let o=1/0;for(let a=0;a<r.tracks.length;++a)o>r.tracks[a].times[0]&&(o=r.tracks[a].times[0]);for(let a=0;a<r.tracks.length;++a)r.tracks[a].shift(-1*o);return r.resetDuration(),r},makeClipAdditive:function(l,e=0,t=l,i=30){i<=0&&(i=30);const n=t.tracks.length,r=e/i;for(let s=0;s<n;++s){const o=t.tracks[s],a=o.ValueTypeName;if(a==="bool"||a==="string")continue;const c=l.tracks.find(function(_){return _.name===o.name&&_.ValueTypeName===a});if(c===void 0)continue;let h=0;const u=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=u/3);let f=0;const d=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=d/3);const g=o.times.length-1;let p;if(r<=o.times[0]){const _=h,x=u-h;p=ft.arraySlice(o.values,_,x)}else if(r>=o.times[g]){const _=g*u+h,x=_+u-h;p=ft.arraySlice(o.values,_,x)}else{const _=o.createInterpolant(),x=h,b=u-h;_.evaluate(r),p=ft.arraySlice(_.resultBuffer,x,b)}a==="quaternion"&&new jt().fromArray(p).normalize().conjugate().toArray(p);const m=c.times.length;for(let _=0;_<m;++_){const x=_*d+f;if(a==="quaternion")jt.multiplyQuaternionsFlat(c.values,x,p,0,c.values,x);else{const b=d-f*2;for(let y=0;y<b;++y)c.values[x+y]-=p[y]}}}return l.blendMode=lf,l}};class Do{constructor(e,t,i,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=n!==void 0?n:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,n=t[i],r=t[i-1];e:{t:{let s;n:{i:if(!(e<n)){for(let o=i+2;;){if(n===void 0){if(e<r)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===o)break;if(r=n,n=t[++i],e<n)break t}s=t.length;break n}if(!(e>=r)){const o=t[1];e<o&&(i=2,r=o);for(let a=i-2;;){if(r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===a)break;if(n=r,r=t[--i-1],e>=r)break t}s=i,i=0;break n}break e}for(;i<s;){const o=i+s>>>1;e<t[o]?s=o:i=o+1}if(n=t[i],r=t[i-1],r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,e,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=e*n;for(let s=0;s!==n;++s)t[s]=i[r+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class gg extends Do{constructor(e,t,i,n){super(e,t,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:qr,endingEnd:qr}}intervalChanged_(e,t,i){const n=this.parameterPositions;let r=e-2,s=e+1,o=n[r],a=n[s];if(o===void 0)switch(this.getSettings_().endingStart){case Yr:r=e,o=2*t-i;break;case Sa:r=n.length-2,o=t+n[r]-n[r+1];break;default:r=e,o=i}if(a===void 0)switch(this.getSettings_().endingEnd){case Yr:s=e,a=2*i-t;break;case Sa:s=1,a=i+n[1]-n[0];break;default:s=e-1,a=t}const c=(i-t)*.5,h=this.valueSize;this._weightPrev=c/(t-o),this._weightNext=c/(a-i),this._offsetPrev=r*h,this._offsetNext=s*h}interpolate_(e,t,i,n){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=e*o,c=a-o,h=this._offsetPrev,u=this._offsetNext,f=this._weightPrev,d=this._weightNext,g=(i-t)/(n-t),p=g*g,m=p*g,_=-f*m+2*f*p-f*g,x=(1+f)*m+(-1.5-2*f)*p+(-.5+f)*g+1,b=(-1-d)*m+(1.5+d)*p+.5*g,y=d*m-d*p;for(let v=0;v!==o;++v)r[v]=_*s[h+v]+x*s[c+v]+b*s[a+v]+y*s[u+v];return r}}class Lf extends Do{constructor(e,t,i,n){super(e,t,i,n)}interpolate_(e,t,i,n){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=e*o,c=a-o,h=(i-t)/(n-t),u=1-h;for(let f=0;f!==o;++f)r[f]=s[c+f]*u+s[a+f]*h;return r}}class _g extends Do{constructor(e,t,i,n){super(e,t,i,n)}interpolate_(e){return this.copySampleValue_(e-1)}}class $n{constructor(e,t,i,n){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ft.convertArray(t,this.TimeBufferType),this.values=ft.convertArray(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:ft.convertArray(e.times,Array),values:ft.convertArray(e.values,Array)};const n=e.getInterpolation();n!==e.DefaultInterpolation&&(i.interpolation=n)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new _g(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Lf(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new gg(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case oo:t=this.InterpolantFactoryMethodDiscrete;break;case ls:t=this.InterpolantFactoryMethodLinear;break;case rc:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return oo;case this.InterpolantFactoryMethodLinear:return ls;case this.InterpolantFactoryMethodSmooth:return rc}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let i=0,n=t.length;i!==n;++i)t[i]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let i=0,n=t.length;i!==n;++i)t[i]*=e}return this}trim(e,t){const i=this.times,n=i.length;let r=0,s=n-1;for(;r!==n&&i[r]<e;)++r;for(;s!==-1&&i[s]>t;)--s;if(++s,r!==0||s!==n){r>=s&&(s=Math.max(s,1),r=s-1);const o=this.getValueSize();this.times=ft.arraySlice(i,r,s),this.values=ft.arraySlice(this.values,r*o,s*o)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,n=this.values,r=i.length;r===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let o=0;o!==r;o++){const a=i[o];if(typeof a=="number"&&isNaN(a)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,a),e=!1;break}if(s!==null&&s>a){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,a,s),e=!1;break}s=a}if(n!==void 0&&ft.isTypedArray(n))for(let o=0,a=n.length;o!==a;++o){const c=n[o];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,c),e=!1;break}}return e}optimize(){const e=ft.arraySlice(this.times),t=ft.arraySlice(this.values),i=this.getValueSize(),n=this.getInterpolation()===rc,r=e.length-1;let s=1;for(let o=1;o<r;++o){let a=!1;const c=e[o],h=e[o+1];if(c!==h&&(o!==1||c!==e[0]))if(n)a=!0;else{const u=o*i,f=u-i,d=u+i;for(let g=0;g!==i;++g){const p=t[u+g];if(p!==t[f+g]||p!==t[d+g]){a=!0;break}}}if(a){if(o!==s){e[s]=e[o];const u=o*i,f=s*i;for(let d=0;d!==i;++d)t[f+d]=t[u+d]}++s}}if(r>0){e[s]=e[r];for(let o=r*i,a=s*i,c=0;c!==i;++c)t[a+c]=t[o+c];++s}return s!==e.length?(this.times=ft.arraySlice(e,0,s),this.values=ft.arraySlice(t,0,s*i)):(this.times=e,this.values=t),this}clone(){const e=ft.arraySlice(this.times,0),t=ft.arraySlice(this.values,0),i=this.constructor,n=new i(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}$n.prototype.TimeBufferType=Float32Array;$n.prototype.ValueBufferType=Float32Array;$n.prototype.DefaultInterpolation=ls;class ms extends $n{}ms.prototype.ValueTypeName="bool";ms.prototype.ValueBufferType=Array;ms.prototype.DefaultInterpolation=oo;ms.prototype.InterpolantFactoryMethodLinear=void 0;ms.prototype.InterpolantFactoryMethodSmooth=void 0;class Rf extends $n{}Rf.prototype.ValueTypeName="color";class bo extends $n{}bo.prototype.ValueTypeName="number";class xg extends Do{constructor(e,t,i,n){super(e,t,i,n)}interpolate_(e,t,i,n){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=(i-t)/(n-t);let c=e*o;for(let h=c+o;c!==h;c+=4)jt.slerpFlat(r,0,s,c-o,s,c,a);return r}}class xr extends $n{InterpolantFactoryMethodLinear(e){return new xg(this.times,this.values,this.getValueSize(),e)}}xr.prototype.ValueTypeName="quaternion";xr.prototype.DefaultInterpolation=ls;xr.prototype.InterpolantFactoryMethodSmooth=void 0;class gs extends $n{}gs.prototype.ValueTypeName="string";gs.prototype.ValueBufferType=Array;gs.prototype.DefaultInterpolation=oo;gs.prototype.InterpolantFactoryMethodLinear=void 0;gs.prototype.InterpolantFactoryMethodSmooth=void 0;class wo extends $n{}wo.prototype.ValueTypeName="vector";class Mo{constructor(e,t=-1,i,n=Tc){this.name=e,this.tracks=i,this.duration=t,this.blendMode=n,this.uuid=wn(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,n=1/(e.fps||1);for(let s=0,o=i.length;s!==o;++s)t.push(Rb(i[s]).scale(n));const r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r}static toJSON(e){const t=[],i=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let r=0,s=i.length;r!==s;++r)t.push($n.toJSON(i[r]));return n}static CreateFromMorphTargetSequence(e,t,i,n){const r=t.length,s=[];for(let o=0;o<r;o++){let a=[],c=[];a.push((o+r-1)%r,o,(o+1)%r),c.push(0,1,0);const h=ft.getKeyframeOrder(a);a=ft.sortedArray(a,1,h),c=ft.sortedArray(c,1,h),!n&&a[0]===0&&(a.push(r),c.push(c[0])),s.push(new bo(".morphTargetInfluences["+t[o].name+"]",a,c).scale(1/i))}return new this(e,-1,s)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const n=e;i=n.geometry&&n.geometry.animations||n.animations}for(let n=0;n<i.length;n++)if(i[n].name===t)return i[n];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const n={},r=/^([\w-]*?)([\d]+)$/;for(let o=0,a=e.length;o<a;o++){const c=e[o],h=c.name.match(r);if(h&&h.length>1){const u=h[1];let f=n[u];f||(n[u]=f=[]),f.push(c)}}const s=[];for(const o in n)s.push(this.CreateFromMorphTargetSequence(o,n[o],t,i));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(u,f,d,g,p){if(d.length!==0){const m=[],_=[];ft.flattenJSON(d,m,_,g),m.length!==0&&p.push(new u(f,m,_))}},n=[],r=e.name||"default",s=e.fps||30,o=e.blendMode;let a=e.length||-1;const c=e.hierarchy||[];for(let u=0;u<c.length;u++){const f=c[u].keys;if(!(!f||f.length===0))if(f[0].morphTargets){const d={};let g;for(g=0;g<f.length;g++)if(f[g].morphTargets)for(let p=0;p<f[g].morphTargets.length;p++)d[f[g].morphTargets[p]]=-1;for(const p in d){const m=[],_=[];for(let x=0;x!==f[g].morphTargets.length;++x){const b=f[g];m.push(b.time),_.push(b.morphTarget===p?1:0)}n.push(new bo(".morphTargetInfluence["+p+"]",m,_))}a=d.length*s}else{const d=".bones["+t[u].name+"]";i(wo,d+".position",f,"pos",n),i(xr,d+".quaternion",f,"rot",n),i(wo,d+".scale",f,"scl",n)}}return n.length===0?null:new this(r,a,n,o)}resetDuration(){const e=this.tracks;let t=0;for(let i=0,n=e.length;i!==n;++i){const r=this.tracks[i];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Lb(l){switch(l.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return bo;case"vector":case"vector2":case"vector3":case"vector4":return wo;case"color":return Rf;case"quaternion":return xr;case"bool":case"boolean":return ms;case"string":return gs}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+l)}function Rb(l){if(l.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=Lb(l.type);if(l.times===void 0){const t=[],i=[];ft.flattenJSON(l.keys,t,i,"value"),l.times=t,l.values=i}return e.parse!==void 0?e.parse(l):new e(l.name,l.times,l.values,l.interpolation)}const fs={enabled:!1,files:{},add:function(l,e){this.enabled!==!1&&(this.files[l]=e)},get:function(l){if(this.enabled!==!1)return this.files[l]},remove:function(l){delete this.files[l]},clear:function(){this.files={}}};class Pf{constructor(e,t,i){const n=this;let r=!1,s=0,o=0,a;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(h){o++,r===!1&&n.onStart!==void 0&&n.onStart(h,s,o),r=!0},this.itemEnd=function(h){s++,n.onProgress!==void 0&&n.onProgress(h,s,o),s===o&&(r=!1,n.onLoad!==void 0&&n.onLoad())},this.itemError=function(h){n.onError!==void 0&&n.onError(h)},this.resolveURL=function(h){return a?a(h):h},this.setURLModifier=function(h){return a=h,this},this.addHandler=function(h,u){return c.push(h,u),this},this.removeHandler=function(h){const u=c.indexOf(h);return u!==-1&&c.splice(u,2),this},this.getHandler=function(h){for(let u=0,f=c.length;u<f;u+=2){const d=c[u],g=c[u+1];if(d.global&&(d.lastIndex=0),d.test(h))return g}return null}}}const vg=new Pf;class fn{constructor(e){this.manager=e!==void 0?e:vg,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(n,r){i.load(e,n,t,r)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Si={};class jn extends fn{constructor(e){super(e)}load(e,t,i,n){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=fs.get(e);if(r!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(r),this.manager.itemEnd(e)},0),r;if(Si[e]!==void 0){Si[e].push({onLoad:t,onProgress:i,onError:n});return}Si[e]=[],Si[e].push({onLoad:t,onProgress:i,onError:n});const s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,a=this.responseType;fetch(s).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream=="undefined"||c.body===void 0||c.body.getReader===void 0)return c;const h=Si[e],u=c.body.getReader(),f=c.headers.get("Content-Length"),d=f?parseInt(f):0,g=d!==0;let p=0;const m=new ReadableStream({start(_){x();function x(){u.read().then(({done:b,value:y})=>{if(b)_.close();else{p+=y.byteLength;const v=new ProgressEvent("progress",{lengthComputable:g,loaded:p,total:d});for(let M=0,S=h.length;M<S;M++){const w=h[M];w.onProgress&&w.onProgress(v)}_.enqueue(y),x()}})}}});return new Response(m)}else throw Error(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`)}).then(c=>{switch(a){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(h=>new DOMParser().parseFromString(h,o));case"json":return c.json();default:if(o===void 0)return c.text();{const u=/charset="?([^;"\s]*)"?/i.exec(o),f=u&&u[1]?u[1].toLowerCase():void 0,d=new TextDecoder(f);return c.arrayBuffer().then(g=>d.decode(g))}}}).then(c=>{fs.add(e,c);const h=Si[e];delete Si[e];for(let u=0,f=h.length;u<f;u++){const d=h[u];d.onLoad&&d.onLoad(c)}}).catch(c=>{const h=Si[e];if(h===void 0)throw this.manager.itemError(e),c;delete Si[e];for(let u=0,f=h.length;u<f;u++){const d=h[u];d.onError&&d.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Pb extends fn{constructor(e){super(e)}load(e,t,i,n){const r=this,s=new jn(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(o){try{t(r.parse(JSON.parse(o)))}catch(a){n?n(a):console.error(a),r.manager.itemError(e)}},i,n)}parse(e){const t=[];for(let i=0;i<e.length;i++){const n=Mo.parse(e[i]);t.push(n)}return t}}class Db extends fn{constructor(e){super(e)}load(e,t,i,n){const r=this,s=[],o=new K0,a=new jn(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(r.withCredentials);let c=0;function h(u){a.load(e[u],function(f){const d=r.parse(f,!0);s[u]={width:d.width,height:d.height,format:d.format,mipmaps:d.mipmaps},c+=1,c===6&&(d.mipmapCount===1&&(o.minFilter=dt),o.image=s,o.format=d.format,o.needsUpdate=!0,t&&t(o))},i,n)}if(Array.isArray(e))for(let u=0,f=e.length;u<f;++u)h(u);else a.load(e,function(u){const f=r.parse(u,!0);if(f.isCubemap){const d=f.mipmaps.length/f.mipmapCount;for(let g=0;g<d;g++){s[g]={mipmaps:[]};for(let p=0;p<f.mipmapCount;p++)s[g].mipmaps.push(f.mipmaps[g*f.mipmapCount+p]),s[g].format=f.format,s[g].width=f.width,s[g].height=f.height}o.image=s}else o.image.width=f.width,o.image.height=f.height,o.mipmaps=f.mipmaps;f.mipmapCount===1&&(o.minFilter=dt),o.format=f.format,o.needsUpdate=!0,t&&t(o)},i,n);return o}}class Pa extends fn{constructor(e){super(e)}load(e,t,i,n){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,s=fs.get(e);if(s!==void 0)return r.manager.itemStart(e),setTimeout(function(){t&&t(s),r.manager.itemEnd(e)},0),s;const o=Ca("img");function a(){h(),fs.add(e,this),t&&t(this),r.manager.itemEnd(e)}function c(u){h(),n&&n(u),r.manager.itemError(e),r.manager.itemEnd(e)}function h(){o.removeEventListener("load",a,!1),o.removeEventListener("error",c,!1)}return o.addEventListener("load",a,!1),o.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(e),o.src=e,o}}class Ib extends fn{constructor(e){super(e)}load(e,t,i,n){const r=new Xa,s=new Pa(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let o=0;function a(c){s.load(e[c],function(h){r.images[c]=h,o++,o===6&&(r.needsUpdate=!0,t&&t(r))},void 0,n)}for(let c=0;c<e.length;++c)a(c);return r}}class Fb extends fn{constructor(e){super(e)}load(e,t,i,n){const r=this,s=new Ks,o=new jn(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(r.withCredentials),o.load(e,function(a){const c=r.parse(a);!c||(c.image!==void 0?s.image=c.image:c.data!==void 0&&(s.image.width=c.width,s.image.height=c.height,s.image.data=c.data),s.wrapS=c.wrapS!==void 0?c.wrapS:Yt,s.wrapT=c.wrapT!==void 0?c.wrapT:Yt,s.magFilter=c.magFilter!==void 0?c.magFilter:dt,s.minFilter=c.minFilter!==void 0?c.minFilter:dt,s.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.encoding!==void 0&&(s.encoding=c.encoding),c.flipY!==void 0&&(s.flipY=c.flipY),c.format!==void 0&&(s.format=c.format),c.type!==void 0&&(s.type=c.type),c.mipmaps!==void 0&&(s.mipmaps=c.mipmaps,s.minFilter=Ui),c.mipmapCount===1&&(s.minFilter=dt),c.generateMipmaps!==void 0&&(s.generateMipmaps=c.generateMipmaps),s.needsUpdate=!0,t&&t(s,c))},i,n),s}}class yg extends fn{constructor(e){super(e)}load(e,t,i,n){const r=new wt,s=new Pa(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,function(o){r.image=o,r.needsUpdate=!0,t!==void 0&&t(r)},i,n),r}}class Sr extends $e{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ae(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class bg extends Sr{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy($e.DefaultUp),this.updateMatrix(),this.groundColor=new Ae(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const Mp=new Ne,Sp=new L,Tp=new L;class Df{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new pe(512,512),this.map=null,this.mapPass=null,this.matrix=new Ne,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Lc,this._frameExtents=new pe(1,1),this._viewportCount=1,this._viewports=[new it(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;Sp.setFromMatrixPosition(e.matrixWorld),t.position.copy(Sp),Tp.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Tp),t.updateMatrixWorld(),Mp.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Mp),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(t.projectionMatrix),i.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Ob extends Df{constructor(){super(new Dt(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=Ta*2*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;(i!==t.fov||n!==t.aspect||r!==t.far)&&(t.fov=i,t.aspect=n,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class If extends Sr{constructor(e,t,i=0,n=Math.PI/3,r=0,s=1){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy($e.DefaultUp),this.updateMatrix(),this.target=new $e,this.distance=i,this.angle=n,this.penumbra=r,this.decay=s,this.shadow=new Ob}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const Cp=new Ne,ea=new L,Nh=new L;class Ub extends Df{constructor(){super(new Dt(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new pe(4,2),this._viewportCount=6,this._viewports=[new it(2,1,1,1),new it(0,1,1,1),new it(3,1,1,1),new it(1,1,1,1),new it(3,0,1,1),new it(1,0,1,1)],this._cubeDirections=[new L(1,0,0),new L(-1,0,0),new L(0,0,1),new L(0,0,-1),new L(0,1,0),new L(0,-1,0)],this._cubeUps=[new L(0,1,0),new L(0,1,0),new L(0,1,0),new L(0,1,0),new L(0,0,1),new L(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,n=this.matrix,r=e.distance||i.far;r!==i.far&&(i.far=r,i.updateProjectionMatrix()),ea.setFromMatrixPosition(e.matrixWorld),i.position.copy(ea),Nh.copy(i.position),Nh.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(Nh),i.updateMatrixWorld(),n.makeTranslation(-ea.x,-ea.y,-ea.z),Cp.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Cp)}}class zc extends Sr{constructor(e,t,i=0,n=1){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=n,this.shadow=new Ub}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class kb extends Df{constructor(){super(new qa(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Ff extends Sr{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy($e.DefaultUp),this.updateMatrix(),this.target=new $e,this.shadow=new kb}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class wg extends Sr{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Mg extends Sr{constructor(e,t,i=10,n=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=n}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class Sg{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new L)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,n=e.y,r=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.282095),t.addScaledVector(s[1],.488603*n),t.addScaledVector(s[2],.488603*r),t.addScaledVector(s[3],.488603*i),t.addScaledVector(s[4],1.092548*(i*n)),t.addScaledVector(s[5],1.092548*(n*r)),t.addScaledVector(s[6],.315392*(3*r*r-1)),t.addScaledVector(s[7],1.092548*(i*r)),t.addScaledVector(s[8],.546274*(i*i-n*n)),t}getIrradianceAt(e,t){const i=e.x,n=e.y,r=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.886227),t.addScaledVector(s[1],2*.511664*n),t.addScaledVector(s[2],2*.511664*r),t.addScaledVector(s[3],2*.511664*i),t.addScaledVector(s[4],2*.429043*i*n),t.addScaledVector(s[5],2*.429043*n*r),t.addScaledVector(s[6],.743125*r*r-.247708),t.addScaledVector(s[7],2*.429043*i*r),t.addScaledVector(s[8],.429043*(i*i-n*n)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let n=0;n<9;n++)i[n].fromArray(e,t+n*3);return this}toArray(e=[],t=0){const i=this.coefficients;for(let n=0;n<9;n++)i[n].toArray(e,t+n*3);return e}static getBasisAt(e,t){const i=e.x,n=e.y,r=e.z;t[0]=.282095,t[1]=.488603*n,t[2]=.488603*r,t[3]=.488603*i,t[4]=1.092548*i*n,t[5]=1.092548*n*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*i*r,t[8]=.546274*(i*i-n*n)}}class Gc extends Sr{constructor(e=new Sg,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class Tg extends fn{constructor(e){super(e),this.textures={}}load(e,t,i,n){const r=this,s=new jn(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(e,function(o){try{t(r.parse(JSON.parse(o)))}catch(a){n?n(a):console.error(a),r.manager.itemError(e)}},i,n)}parse(e){const t=this.textures;function i(r){return t[r]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",r),t[r]}const n=bt.fromType(e.type);if(e.uuid!==void 0&&(n.uuid=e.uuid),e.name!==void 0&&(n.name=e.name),e.color!==void 0&&n.color!==void 0&&n.color.setHex(e.color),e.roughness!==void 0&&(n.roughness=e.roughness),e.metalness!==void 0&&(n.metalness=e.metalness),e.sheen!==void 0&&(n.sheen=e.sheen),e.sheenColor!==void 0&&(n.sheenColor=new Ae().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(n.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&n.emissive!==void 0&&n.emissive.setHex(e.emissive),e.specular!==void 0&&n.specular!==void 0&&n.specular.setHex(e.specular),e.specularIntensity!==void 0&&(n.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&n.specularColor!==void 0&&n.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(n.shininess=e.shininess),e.clearcoat!==void 0&&(n.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(n.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(n.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(n.transmission=e.transmission),e.thickness!==void 0&&(n.thickness=e.thickness),e.attenuationDistance!==void 0&&(n.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&n.attenuationColor!==void 0&&n.attenuationColor.setHex(e.attenuationColor),e.fog!==void 0&&(n.fog=e.fog),e.flatShading!==void 0&&(n.flatShading=e.flatShading),e.blending!==void 0&&(n.blending=e.blending),e.combine!==void 0&&(n.combine=e.combine),e.side!==void 0&&(n.side=e.side),e.shadowSide!==void 0&&(n.shadowSide=e.shadowSide),e.opacity!==void 0&&(n.opacity=e.opacity),e.transparent!==void 0&&(n.transparent=e.transparent),e.alphaTest!==void 0&&(n.alphaTest=e.alphaTest),e.depthTest!==void 0&&(n.depthTest=e.depthTest),e.depthWrite!==void 0&&(n.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(n.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(n.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(n.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(n.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(n.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(n.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(n.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(n.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(n.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(n.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(n.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(n.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(n.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(n.rotation=e.rotation),e.linewidth!==1&&(n.linewidth=e.linewidth),e.dashSize!==void 0&&(n.dashSize=e.dashSize),e.gapSize!==void 0&&(n.gapSize=e.gapSize),e.scale!==void 0&&(n.scale=e.scale),e.polygonOffset!==void 0&&(n.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(n.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(n.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(n.dithering=e.dithering),e.alphaToCoverage!==void 0&&(n.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(n.premultipliedAlpha=e.premultipliedAlpha),e.visible!==void 0&&(n.visible=e.visible),e.toneMapped!==void 0&&(n.toneMapped=e.toneMapped),e.userData!==void 0&&(n.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?n.vertexColors=e.vertexColors>0:n.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const r in e.uniforms){const s=e.uniforms[r];switch(n.uniforms[r]={},s.type){case"t":n.uniforms[r].value=i(s.value);break;case"c":n.uniforms[r].value=new Ae().setHex(s.value);break;case"v2":n.uniforms[r].value=new pe().fromArray(s.value);break;case"v3":n.uniforms[r].value=new L().fromArray(s.value);break;case"v4":n.uniforms[r].value=new it().fromArray(s.value);break;case"m3":n.uniforms[r].value=new yn().fromArray(s.value);break;case"m4":n.uniforms[r].value=new Ne().fromArray(s.value);break;default:n.uniforms[r].value=s.value}}if(e.defines!==void 0&&(n.defines=e.defines),e.vertexShader!==void 0&&(n.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(n.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(const r in e.extensions)n.extensions[r]=e.extensions[r];if(e.shading!==void 0&&(n.flatShading=e.shading===1),e.size!==void 0&&(n.size=e.size),e.sizeAttenuation!==void 0&&(n.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(n.map=i(e.map)),e.matcap!==void 0&&(n.matcap=i(e.matcap)),e.alphaMap!==void 0&&(n.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(n.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(n.bumpScale=e.bumpScale),e.normalMap!==void 0&&(n.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(n.normalMapType=e.normalMapType),e.normalScale!==void 0){let r=e.normalScale;Array.isArray(r)===!1&&(r=[r,r]),n.normalScale=new pe().fromArray(r)}return e.displacementMap!==void 0&&(n.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(n.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(n.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(n.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(n.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(n.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(n.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(n.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(n.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(n.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(n.envMap=i(e.envMap)),e.envMapIntensity!==void 0&&(n.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(n.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(n.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(n.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(n.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(n.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(n.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(n.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(n.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(n.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(n.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(n.clearcoatNormalScale=new pe().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(n.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(n.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(n.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(n.thicknessMap=i(e.thicknessMap)),e.sheenColorMap!==void 0&&(n.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(n.sheenRoughnessMap=i(e.sheenRoughnessMap)),n}setTextures(e){return this.textures=e,this}}class hi{static decodeText(e){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(e);let t="";for(let i=0,n=e.length;i<n;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class Of extends ze{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class Cg extends fn{constructor(e){super(e)}load(e,t,i,n){const r=this,s=new jn(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(e,function(o){try{t(r.parse(JSON.parse(o)))}catch(a){n?n(a):console.error(a),r.manager.itemError(e)}},i,n)}parse(e){const t={},i={};function n(d,g){if(t[g]!==void 0)return t[g];const m=d.interleavedBuffers[g],_=r(d,m.buffer),x=Xs(m.type,_),b=new Ya(x,m.stride);return b.uuid=m.uuid,t[g]=b,b}function r(d,g){if(i[g]!==void 0)return i[g];const m=d.arrayBuffers[g],_=new Uint32Array(m).buffer;return i[g]=_,_}const s=e.isInstancedBufferGeometry?new Of:new ze,o=e.data.index;if(o!==void 0){const d=Xs(o.type,o.array);s.setIndex(new st(d,1))}const a=e.data.attributes;for(const d in a){const g=a[d];let p;if(g.isInterleavedBufferAttribute){const m=n(e.data,g.data);p=new mr(m,g.itemSize,g.offset,g.normalized)}else{const m=Xs(g.type,g.array),_=g.isInstancedBufferAttribute?cs:st;p=new _(m,g.itemSize,g.normalized)}g.name!==void 0&&(p.name=g.name),g.usage!==void 0&&p.setUsage(g.usage),g.updateRange!==void 0&&(p.updateRange.offset=g.updateRange.offset,p.updateRange.count=g.updateRange.count),s.setAttribute(d,p)}const c=e.data.morphAttributes;if(c)for(const d in c){const g=c[d],p=[];for(let m=0,_=g.length;m<_;m++){const x=g[m];let b;if(x.isInterleavedBufferAttribute){const y=n(e.data,x.data);b=new mr(y,x.itemSize,x.offset,x.normalized)}else{const y=Xs(x.type,x.array);b=new st(y,x.itemSize,x.normalized)}x.name!==void 0&&(b.name=x.name),p.push(b)}s.morphAttributes[d]=p}e.data.morphTargetsRelative&&(s.morphTargetsRelative=!0);const u=e.data.groups||e.data.drawcalls||e.data.offsets;if(u!==void 0)for(let d=0,g=u.length;d!==g;++d){const p=u[d];s.addGroup(p.start,p.count,p.materialIndex)}const f=e.data.boundingSphere;if(f!==void 0){const d=new L;f.center!==void 0&&d.fromArray(f.center),s.boundingSphere=new ki(d,f.radius)}return e.name&&(s.name=e.name),e.userData&&(s.userData=e.userData),s}}class Nb extends fn{constructor(e){super(e)}load(e,t,i,n){const r=this,s=this.path===""?hi.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const o=new jn(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){let c=null;try{c=JSON.parse(a)}catch(u){n!==void 0&&n(u),console.error("THREE:ObjectLoader: Can't parse "+e+".",u.message);return}const h=c.metadata;if(h===void 0||h.type===void 0||h.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+e);return}r.parse(c,t)},i,n)}async loadAsync(e,t){const i=this,n=this.path===""?hi.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||n;const r=new jn(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const s=await r.loadAsync(e,t),o=JSON.parse(s),a=o.metadata;if(a===void 0||a.type===void 0||a.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(o)}parse(e,t){const i=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),s=this.parseImages(e.images,function(){t!==void 0&&t(c)}),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),c=this.parseObject(e.object,r,a,o,i),h=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,h),t!==void 0){let u=!1;for(const f in s)if(s[f].data instanceof HTMLImageElement){u=!0;break}u===!1&&t(c)}return c}async parseAsync(e){const t=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),n=this.parseGeometries(e.geometries,i),r=await this.parseImagesAsync(e.images),s=this.parseTextures(e.textures,r),o=this.parseMaterials(e.materials,s),a=this.parseObject(e.object,n,o,s,t),c=this.parseSkeletons(e.skeletons,a);return this.bindSkeletons(a,c),a}parseShapes(e){const t={};if(e!==void 0)for(let i=0,n=e.length;i<n;i++){const r=new ts().fromJSON(e[i]);t[r.uuid]=r}return t}parseSkeletons(e,t){const i={},n={};if(t.traverse(function(r){r.isBone&&(n[r.uuid]=r)}),e!==void 0)for(let r=0,s=e.length;r<s;r++){const o=new Za().fromJSON(e[r],n);i[o.uuid]=o}return i}parseGeometries(e,t){const i={};if(e!==void 0){const n=new Cg;for(let r=0,s=e.length;r<s;r++){let o;const a=e[r];switch(a.type){case"BufferGeometry":case"InstancedBufferGeometry":o=n.parse(a);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:a.type in wp?o=wp[a.type].fromJSON(a,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${a.type}"`)}o.uuid=a.uuid,a.name!==void 0&&(o.name=a.name),o.isBufferGeometry===!0&&a.userData!==void 0&&(o.userData=a.userData),i[a.uuid]=o}}return i}parseMaterials(e,t){const i={},n={};if(e!==void 0){const r=new Tg;r.setTextures(t);for(let s=0,o=e.length;s<o;s++){const a=e[s];if(a.type==="MultiMaterial"){const c=[];for(let h=0;h<a.materials.length;h++){const u=a.materials[h];i[u.uuid]===void 0&&(i[u.uuid]=r.parse(u)),c.push(i[u.uuid])}n[a.uuid]=c}else i[a.uuid]===void 0&&(i[a.uuid]=r.parse(a)),n[a.uuid]=i[a.uuid]}}return n}parseAnimations(e){const t={};if(e!==void 0)for(let i=0;i<e.length;i++){const n=e[i],r=Mo.parse(n);t[r.uuid]=r}return t}parseImages(e,t){const i=this,n={};let r;function s(a){return i.manager.itemStart(a),r.load(a,function(){i.manager.itemEnd(a)},void 0,function(){i.manager.itemError(a),i.manager.itemEnd(a)})}function o(a){if(typeof a=="string"){const c=a,h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:i.resourcePath+c;return s(h)}else return a.data?{data:Xs(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){const a=new Pf(t);r=new Pa(a),r.setCrossOrigin(this.crossOrigin);for(let c=0,h=e.length;c<h;c++){const u=e[c],f=u.url;if(Array.isArray(f)){const d=[];for(let g=0,p=f.length;g<p;g++){const m=f[g],_=o(m);_!==null&&(_ instanceof HTMLImageElement?d.push(_):d.push(new Ks(_.data,_.width,_.height)))}n[u.uuid]=new Zr(d)}else{const d=o(u.url);n[u.uuid]=new Zr(d)}}}return n}async parseImagesAsync(e){const t=this,i={};let n;async function r(s){if(typeof s=="string"){const o=s,a=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(o)?o:t.resourcePath+o;return await n.loadAsync(a)}else return s.data?{data:Xs(s.type,s.data),width:s.width,height:s.height}:null}if(e!==void 0&&e.length>0){n=new Pa(this.manager),n.setCrossOrigin(this.crossOrigin);for(let s=0,o=e.length;s<o;s++){const a=e[s],c=a.url;if(Array.isArray(c)){const h=[];for(let u=0,f=c.length;u<f;u++){const d=c[u],g=await r(d);g!==null&&(g instanceof HTMLImageElement?h.push(g):h.push(new Ks(g.data,g.width,g.height)))}i[a.uuid]=new Zr(h)}else{const h=await r(a.url);i[a.uuid]=new Zr(h)}}}return i}parseTextures(e,t){function i(r,s){return typeof r=="number"?r:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",r),s[r])}const n={};if(e!==void 0)for(let r=0,s=e.length;r<s;r++){const o=e[r];o.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),t[o.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",o.image);const a=t[o.image],c=a.data;let h;Array.isArray(c)?(h=new Xa,c.length===6&&(h.needsUpdate=!0)):(c&&c.data?h=new Ks:h=new wt,c&&(h.needsUpdate=!0)),h.source=a,h.uuid=o.uuid,o.name!==void 0&&(h.name=o.name),o.mapping!==void 0&&(h.mapping=i(o.mapping,Bb)),o.offset!==void 0&&h.offset.fromArray(o.offset),o.repeat!==void 0&&h.repeat.fromArray(o.repeat),o.center!==void 0&&h.center.fromArray(o.center),o.rotation!==void 0&&(h.rotation=o.rotation),o.wrap!==void 0&&(h.wrapS=i(o.wrap[0],Ap),h.wrapT=i(o.wrap[1],Ap)),o.format!==void 0&&(h.format=o.format),o.type!==void 0&&(h.type=o.type),o.encoding!==void 0&&(h.encoding=o.encoding),o.minFilter!==void 0&&(h.minFilter=i(o.minFilter,Ep)),o.magFilter!==void 0&&(h.magFilter=i(o.magFilter,Ep)),o.anisotropy!==void 0&&(h.anisotropy=o.anisotropy),o.flipY!==void 0&&(h.flipY=o.flipY),o.premultiplyAlpha!==void 0&&(h.premultiplyAlpha=o.premultiplyAlpha),o.unpackAlignment!==void 0&&(h.unpackAlignment=o.unpackAlignment),o.userData!==void 0&&(h.userData=o.userData),n[o.uuid]=h}return n}parseObject(e,t,i,n,r){let s;function o(f){return t[f]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",f),t[f]}function a(f){if(f!==void 0){if(Array.isArray(f)){const d=[];for(let g=0,p=f.length;g<p;g++){const m=f[g];i[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",m),d.push(i[m])}return d}return i[f]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",f),i[f]}}function c(f){return n[f]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",f),n[f]}let h,u;switch(e.type){case"Scene":s=new xf,e.background!==void 0&&(Number.isInteger(e.background)?s.background=new Ae(e.background):s.background=c(e.background)),e.environment!==void 0&&(s.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?s.fog=new Fc(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(s.fog=new Ic(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":s=new Dt(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(s.focus=e.focus),e.zoom!==void 0&&(s.zoom=e.zoom),e.filmGauge!==void 0&&(s.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(s.filmOffset=e.filmOffset),e.view!==void 0&&(s.view=Object.assign({},e.view));break;case"OrthographicCamera":s=new qa(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(s.zoom=e.zoom),e.view!==void 0&&(s.view=Object.assign({},e.view));break;case"AmbientLight":s=new wg(e.color,e.intensity);break;case"DirectionalLight":s=new Ff(e.color,e.intensity);break;case"PointLight":s=new zc(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":s=new Mg(e.color,e.intensity,e.width,e.height);break;case"SpotLight":s=new If(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":s=new bg(e.color,e.groundColor,e.intensity);break;case"LightProbe":s=new Gc().fromJSON(e);break;case"SkinnedMesh":h=o(e.geometry),u=a(e.material),s=new yf(h,u),e.bindMode!==void 0&&(s.bindMode=e.bindMode),e.bindMatrix!==void 0&&s.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(s.skeleton=e.skeleton);break;case"Mesh":h=o(e.geometry),u=a(e.material),s=new ht(h,u);break;case"InstancedMesh":h=o(e.geometry),u=a(e.material);const f=e.count,d=e.instanceMatrix,g=e.instanceColor;s=new J0(h,u,f),s.instanceMatrix=new cs(new Float32Array(d.array),16),g!==void 0&&(s.instanceColor=new cs(new Float32Array(g.array),g.itemSize));break;case"LOD":s=new j0;break;case"Line":s=new Di(o(e.geometry),a(e.material));break;case"LineLoop":s=new bf(o(e.geometry),a(e.material));break;case"LineSegments":s=new Kn(o(e.geometry),a(e.material));break;case"PointCloud":case"Points":s=new wf(o(e.geometry),a(e.material));break;case"Sprite":s=new Z0(a(e.material));break;case"Group":s=new bn;break;case"Bone":s=new Oc;break;default:s=new $e}if(s.uuid=e.uuid,e.name!==void 0&&(s.name=e.name),e.matrix!==void 0?(s.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(s.matrixAutoUpdate=e.matrixAutoUpdate),s.matrixAutoUpdate&&s.matrix.decompose(s.position,s.quaternion,s.scale)):(e.position!==void 0&&s.position.fromArray(e.position),e.rotation!==void 0&&s.rotation.fromArray(e.rotation),e.quaternion!==void 0&&s.quaternion.fromArray(e.quaternion),e.scale!==void 0&&s.scale.fromArray(e.scale)),e.castShadow!==void 0&&(s.castShadow=e.castShadow),e.receiveShadow!==void 0&&(s.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(s.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(s.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(s.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&s.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(s.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(s.visible=e.visible),e.frustumCulled!==void 0&&(s.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(s.renderOrder=e.renderOrder),e.userData!==void 0&&(s.userData=e.userData),e.layers!==void 0&&(s.layers.mask=e.layers),e.children!==void 0){const f=e.children;for(let d=0;d<f.length;d++)s.add(this.parseObject(f[d],t,i,n,r))}if(e.animations!==void 0){const f=e.animations;for(let d=0;d<f.length;d++){const g=f[d];s.animations.push(r[g])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(s.autoUpdate=e.autoUpdate);const f=e.levels;for(let d=0;d<f.length;d++){const g=f[d],p=s.getObjectByProperty("uuid",g.object);p!==void 0&&s.addLevel(p,g.distance)}}return s}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const n=t[i.skeleton];n===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(n,i.bindMatrix)}})}setTexturePath(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}const Bb={UVMapping:Mc,CubeReflectionMapping:hr,CubeRefractionMapping:ur,EquirectangularReflectionMapping:ya,EquirectangularRefractionMapping:ba,CubeUVReflectionMapping:Lo},Ap={RepeatWrapping:fr,ClampToEdgeWrapping:Yt,MirroredRepeatWrapping:ro},Ep={NearestFilter:Tt,NearestMipmapNearestFilter:wa,NearestMipmapLinearFilter:Ma,LinearFilter:dt,LinearMipmapNearestFilter:Sc,LinearMipmapLinearFilter:Ui};class Ag extends fn{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,n){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,s=fs.get(e);if(s!==void 0)return r.manager.itemStart(e),setTimeout(function(){t&&t(s),r.manager.itemEnd(e)},0),s;const o={};o.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",o.headers=this.requestHeader,fetch(e,o).then(function(a){return a.blob()}).then(function(a){return createImageBitmap(a,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(a){fs.add(e,a),t&&t(a),r.manager.itemEnd(e)}).catch(function(a){n&&n(a),r.manager.itemError(e),r.manager.itemEnd(e)}),r.manager.itemStart(e)}}let Gl;const Uf={getContext:function(){return Gl===void 0&&(Gl=new(window.AudioContext||window.webkitAudioContext)),Gl},setContext:function(l){Gl=l}};class zb extends fn{constructor(e){super(e)}load(e,t,i,n){const r=this,s=new jn(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(o){try{const a=o.slice(0);Uf.getContext().decodeAudioData(a,function(h){t(h)})}catch(a){n?n(a):console.error(a),r.manager.itemError(e)}},i,n)}}class Gb extends Gc{constructor(e,t,i=1){super(void 0,i),this.isHemisphereLightProbe=!0;const n=new Ae().set(e),r=new Ae().set(t),s=new L(n.r,n.g,n.b),o=new L(r.r,r.g,r.b),a=Math.sqrt(Math.PI),c=a*Math.sqrt(.75);this.sh.coefficients[0].copy(s).add(o).multiplyScalar(a),this.sh.coefficients[1].copy(s).sub(o).multiplyScalar(c)}}class Vb extends Gc{constructor(e,t=1){super(void 0,t),this.isAmbientLightProbe=!0;const i=new Ae().set(e);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const Lp=new Ne,Rp=new Ne,Lr=new Ne;class Hb{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Dt,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Dt,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Lr.copy(e.projectionMatrix);const n=t.eyeSep/2,r=n*t.near/t.focus,s=t.near*Math.tan($r*t.fov*.5)/t.zoom;let o,a;Rp.elements[12]=-n,Lp.elements[12]=n,o=-s*t.aspect+r,a=s*t.aspect+r,Lr.elements[0]=2*t.near/(a-o),Lr.elements[8]=(a+o)/(a-o),this.cameraL.projectionMatrix.copy(Lr),o=-s*t.aspect-r,a=s*t.aspect-r,Lr.elements[0]=2*t.near/(a-o),Lr.elements[8]=(a+o)/(a-o),this.cameraR.projectionMatrix.copy(Lr)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Rp),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Lp)}}class kf{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Pp(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=Pp();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function Pp(){return(typeof performance=="undefined"?Date:performance).now()}const Rr=new L,Dp=new jt,Wb=new L,Pr=new L;class Xb extends $e{constructor(){super(),this.type="AudioListener",this.context=Uf.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new kf}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Rr,Dp,Wb),Pr.set(0,0,-1).applyQuaternion(Dp),t.positionX){const n=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Rr.x,n),t.positionY.linearRampToValueAtTime(Rr.y,n),t.positionZ.linearRampToValueAtTime(Rr.z,n),t.forwardX.linearRampToValueAtTime(Pr.x,n),t.forwardY.linearRampToValueAtTime(Pr.y,n),t.forwardZ.linearRampToValueAtTime(Pr.z,n),t.upX.linearRampToValueAtTime(i.x,n),t.upY.linearRampToValueAtTime(i.y,n),t.upZ.linearRampToValueAtTime(i.z,n)}else t.setPosition(Rr.x,Rr.y,Rr.z),t.setOrientation(Pr.x,Pr.y,Pr.z,i.x,i.y,i.z)}}class Eg extends $e{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Dr=new L,Ip=new jt,qb=new L,Ir=new L;class Yb extends Eg{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Dr,Ip,qb),Ir.set(0,0,1).applyQuaternion(Ip);const t=this.panner;if(t.positionX){const i=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Dr.x,i),t.positionY.linearRampToValueAtTime(Dr.y,i),t.positionZ.linearRampToValueAtTime(Dr.z,i),t.orientationX.linearRampToValueAtTime(Ir.x,i),t.orientationY.linearRampToValueAtTime(Ir.y,i),t.orientationZ.linearRampToValueAtTime(Ir.z,i)}else t.setPosition(Dr.x,Dr.y,Dr.z),t.setOrientation(Ir.x,Ir.y,Ir.z)}}class Zb{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let i=0;i<t.length;i++)e+=t[i];return e/t.length}}class Lg{constructor(e,t,i){this.binding=e,this.valueSize=i;let n,r,s;switch(t){case"quaternion":n=this._slerp,r=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":n=this._select,r=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:n=this._lerp,r=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=n,this._mixBufferRegionAdditive=r,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,n=this.valueSize,r=e*n+n;let s=this.cumulativeWeight;if(s===0){for(let o=0;o!==n;++o)i[r+o]=i[o];s=t}else{s+=t;const o=t/s;this._mixBufferRegion(i,r,0,o,n)}this.cumulativeWeight=s}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,n=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,n,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,n=e*t+t,r=this.cumulativeWeight,s=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const a=t*this._origIndex;this._mixBufferRegion(i,n,a,1-r,t)}s>0&&this._mixBufferRegionAdditive(i,n,this._addIndex*t,1,t);for(let a=t,c=t+t;a!==c;++a)if(i[a]!==i[a+t]){o.setValue(i,n);break}}saveOriginalState(){const e=this.binding,t=this.buffer,i=this.valueSize,n=i*this._origIndex;e.getValue(t,n);for(let r=i,s=n;r!==s;++r)t[r]=t[n+r%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,n,r){if(n>=.5)for(let s=0;s!==r;++s)e[t+s]=e[i+s]}_slerp(e,t,i,n){jt.slerpFlat(e,t,e,t,e,i,n)}_slerpAdditive(e,t,i,n,r){const s=this._workIndex*r;jt.multiplyQuaternionsFlat(e,s,e,t,e,i),jt.slerpFlat(e,t,e,t,e,s,n)}_lerp(e,t,i,n,r){const s=1-n;for(let o=0;o!==r;++o){const a=t+o;e[a]=e[a]*s+e[i+o]*n}}_lerpAdditive(e,t,i,n,r){for(let s=0;s!==r;++s){const o=t+s;e[o]=e[o]+e[i+s]*n}}}const Nf="\\[\\]\\.:\\/",jb=new RegExp("["+Nf+"]","g"),Bf="[^"+Nf+"]",Jb="[^"+Nf.replace("\\.","")+"]",Kb=/((?:WC+[\/:])*)/.source.replace("WC",Bf),Qb=/(WCOD+)?/.source.replace("WCOD",Jb),$b=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Bf),ew=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Bf),tw=new RegExp("^"+Kb+Qb+$b+ew+"$"),nw=["material","materials","bones"];class iw{constructor(e,t,i){const n=i||Ke.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}getValue(e,t){this.bind();const i=this._targetGroup.nCachedObjects_,n=this._bindings[i];n!==void 0&&n.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}class Ke{constructor(e,t,i){this.path=t,this.parsedPath=i||Ke.parseTrackName(t),this.node=Ke.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new Ke.Composite(e,t,i):new Ke(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(jb,"")}static parseTrackName(e){const t=tw.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=i.nodeName&&i.nodeName.lastIndexOf(".");if(n!==void 0&&n!==-1){const r=i.nodeName.substring(n+1);nw.indexOf(r)!==-1&&(i.nodeName=i.nodeName.substring(0,n),i.objectName=r)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){const i=function(r){for(let s=0;s<r.length;s++){const o=r[s];if(o.name===t||o.uuid===t)return o;const a=i(o.children);if(a)return a}return null},n=i(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)e[t++]=i[n]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,i=t.objectName,n=t.propertyName;let r=t.propertyIndex;if(e||(e=Ke.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(i){let c=t.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let h=0;h<e.length;h++)if(e[h].name===c){c=h;break}break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const s=e[n];if(s===void 0){const c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+n+" but it wasn't found.",e);return}let o=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?o=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(r!==void 0){if(n==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[r]!==void 0&&(r=e.morphTargetDictionary[r])}a=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else s.fromArray!==void 0&&s.toArray!==void 0?(a=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(a=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Ke.Composite=iw;Ke.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Ke.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Ke.prototype.GetterByBindingType=[Ke.prototype._getValue_direct,Ke.prototype._getValue_array,Ke.prototype._getValue_arrayElement,Ke.prototype._getValue_toArray];Ke.prototype.SetterByBindingTypeAndVersioning=[[Ke.prototype._setValue_direct,Ke.prototype._setValue_direct_setNeedsUpdate,Ke.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ke.prototype._setValue_array,Ke.prototype._setValue_array_setNeedsUpdate,Ke.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ke.prototype._setValue_arrayElement,Ke.prototype._setValue_arrayElement_setNeedsUpdate,Ke.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ke.prototype._setValue_fromArray,Ke.prototype._setValue_fromArray_setNeedsUpdate,Ke.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class rw{constructor(){this.isAnimationObjectGroup=!0,this.uuid=wn(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,n=arguments.length;i!==n;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,i=this._paths,n=this._parsedPaths,r=this._bindings,s=r.length;let o,a=e.length,c=this.nCachedObjects_;for(let h=0,u=arguments.length;h!==u;++h){const f=arguments[h],d=f.uuid;let g=t[d];if(g===void 0){g=a++,t[d]=g,e.push(f);for(let p=0,m=s;p!==m;++p)r[p].push(new Ke(f,i[p],n[p]))}else if(g<c){o=e[g];const p=--c,m=e[p];t[m.uuid]=g,e[g]=m,t[d]=p,e[p]=f;for(let _=0,x=s;_!==x;++_){const b=r[_],y=b[p];let v=b[g];b[g]=y,v===void 0&&(v=new Ke(f,i[_],n[_])),b[p]=v}}else e[g]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,n=i.length;let r=this.nCachedObjects_;for(let s=0,o=arguments.length;s!==o;++s){const a=arguments[s],c=a.uuid,h=t[c];if(h!==void 0&&h>=r){const u=r++,f=e[u];t[f.uuid]=h,e[h]=f,t[c]=u,e[u]=a;for(let d=0,g=n;d!==g;++d){const p=i[d],m=p[u],_=p[h];p[h]=m,p[u]=_}}}this.nCachedObjects_=r}uncache(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,n=i.length;let r=this.nCachedObjects_,s=e.length;for(let o=0,a=arguments.length;o!==a;++o){const c=arguments[o],h=c.uuid,u=t[h];if(u!==void 0)if(delete t[h],u<r){const f=--r,d=e[f],g=--s,p=e[g];t[d.uuid]=u,e[u]=d,t[p.uuid]=f,e[f]=p,e.pop();for(let m=0,_=n;m!==_;++m){const x=i[m],b=x[f],y=x[g];x[u]=b,x[f]=y,x.pop()}}else{const f=--s,d=e[f];f>0&&(t[d.uuid]=u),e[u]=d,e.pop();for(let g=0,p=n;g!==p;++g){const m=i[g];m[u]=m[f],m.pop()}}}this.nCachedObjects_=r}subscribe_(e,t){const i=this._bindingsIndicesByPath;let n=i[e];const r=this._bindings;if(n!==void 0)return r[n];const s=this._paths,o=this._parsedPaths,a=this._objects,c=a.length,h=this.nCachedObjects_,u=new Array(c);n=r.length,i[e]=n,s.push(e),o.push(t),r.push(u);for(let f=h,d=a.length;f!==d;++f){const g=a[f];u[f]=new Ke(g,e,t)}return u}unsubscribe_(e){const t=this._bindingsIndicesByPath,i=t[e];if(i!==void 0){const n=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length-1,a=s[o],c=e[o];t[c]=i,s[i]=a,s.pop(),r[i]=r[o],r.pop(),n[i]=n[o],n.pop()}}}class sw{constructor(e,t,i=null,n=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=n;const r=t.tracks,s=r.length,o=new Array(s),a={endingStart:qr,endingEnd:qr};for(let c=0;c!==s;++c){const h=r[c].createInterpolant(null);o[c]=h,h.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=C0,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){const n=this._clip.duration,r=e._clip.duration,s=r/n,o=n/r;e.warp(1,s,t),this.warp(o,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const n=this._mixer,r=n.time,s=this.timeScale;let o=this._timeScaleInterpolant;o===null&&(o=n._lendControlInterpolant(),this._timeScaleInterpolant=o);const a=o.parameterPositions,c=o.sampleValues;return a[0]=r,a[1]=r+i,c[0]=e/s,c[1]=t/s,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,n){if(!this.enabled){this._updateWeight(e);return}const r=this._startTime;if(r!==null){const a=(e-r)*i;if(a<0||i===0)return;this._startTime=null,t=i*a}t*=this._updateTimeScale(e);const s=this._updateTime(t),o=this._updateWeight(e);if(o>0){const a=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case lf:for(let h=0,u=a.length;h!==u;++h)a[h].evaluate(s),c[h].accumulateAdditive(o);break;case Tc:default:for(let h=0,u=a.length;h!==u;++h)a[h].evaluate(s),c[h].accumulate(n,o)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(i!==null){const n=i.evaluate(e)[0];t*=n,e>i.parameterPositions[1]&&(this.stopFading(),n===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;i!==null&&(t*=i.evaluate(e)[0],e>i.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let n=this.time+e,r=this._loopCount;const s=i===A0;if(e===0)return r===-1?n:s&&(r&1)===1?t-n:n;if(i===T0){r===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n>=t)n=t;else if(n<0)n=0;else{this.time=n;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(r===-1&&(e>=0?(r=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),n>=t||n<0){const o=Math.floor(n/t);n-=t*o,r+=Math.abs(o);const a=this.repetitions-r;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,n=e>0?t:0,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(a===1){const c=e<0;this._setEndings(c,!c,s)}else this._setEndings(!1,!1,s);this._loopCount=r,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=n;if(s&&(r&1)===1)return t-n}return n}_setEndings(e,t,i){const n=this._interpolantSettings;i?(n.endingStart=Yr,n.endingEnd=Yr):(e?n.endingStart=this.zeroSlopeAtStart?Yr:qr:n.endingStart=Sa,t?n.endingEnd=this.zeroSlopeAtEnd?Yr:qr:n.endingEnd=Sa)}_scheduleFading(e,t,i){const n=this._mixer,r=n.time;let s=this._weightInterpolant;s===null&&(s=n._lendControlInterpolant(),this._weightInterpolant=s);const o=s.parameterPositions,a=s.sampleValues;return o[0]=r,a[0]=t,o[1]=r+e,a[1]=i,this}}const ow=new Float32Array(1);class aw extends Mr{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,n=e._clip.tracks,r=n.length,s=e._propertyBindings,o=e._interpolants,a=i.uuid,c=this._bindingsByRootAndName;let h=c[a];h===void 0&&(h={},c[a]=h);for(let u=0;u!==r;++u){const f=n[u],d=f.name;let g=h[d];if(g!==void 0)++g.referenceCount,s[u]=g;else{if(g=s[u],g!==void 0){g._cacheIndex===null&&(++g.referenceCount,this._addInactiveBinding(g,a,d));continue}const p=t&&t._propertyBindings[u].binding.parsedPath;g=new Lg(Ke.create(i,d,p),f.ValueTypeName,f.getValueSize()),++g.referenceCount,this._addInactiveBinding(g,a,d),s[u]=g}o[u].resultBuffer=g.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,i)}const t=e._propertyBindings;for(let i=0,n=t.length;i!==n;++i){const r=t[i];r.useCount++===0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,n=t.length;i!==n;++i){const r=t[i];--r.useCount===0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,i){const n=this._actions,r=this._actionsByClip;let s=r[t];if(s===void 0)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=s;else{const o=s.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=n.length,n.push(e),s.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],n=e._cacheIndex;i._cacheIndex=n,t[n]=i,t.pop(),e._cacheIndex=null;const r=e._clip.uuid,s=this._actionsByClip,o=s[r],a=o.knownActions,c=a[a.length-1],h=e._byClipCacheIndex;c._byClipCacheIndex=h,a[h]=c,a.pop(),e._byClipCacheIndex=null;const u=o.actionByRoot,f=(e._localRoot||this._root).uuid;delete u[f],a.length===0&&delete s[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,n=t.length;i!==n;++i){const r=t[i];--r.referenceCount===0&&this._removeInactiveBinding(r)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,n=this._nActiveActions++,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,n=--this._nActiveActions,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r}_addInactiveBinding(e,t,i){const n=this._bindingsByRootAndName,r=this._bindings;let s=n[t];s===void 0&&(s={},n[t]=s),s[i]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,n=i.rootNode.uuid,r=i.path,s=this._bindingsByRootAndName,o=s[n],a=t[t.length-1],c=e._cacheIndex;a._cacheIndex=c,t[c]=a,t.pop(),delete o[r],Object.keys(o).length===0&&delete s[n]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,n=this._nActiveBindings++,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,n=--this._nActiveBindings,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return i===void 0&&(i=new Lf(new Float32Array(2),new Float32Array(2),1,ow),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,n=--this._nActiveControlInterpolants,r=t[n];e.__cacheIndex=n,t[n]=e,r.__cacheIndex=i,t[i]=r}clipAction(e,t,i){const n=t||this._root,r=n.uuid;let s=typeof e=="string"?Mo.findByName(n,e):e;const o=s!==null?s.uuid:e,a=this._actionsByClip[o];let c=null;if(i===void 0&&(s!==null?i=s.blendMode:i=Tc),a!==void 0){const u=a.actionByRoot[r];if(u!==void 0&&u.blendMode===i)return u;c=a.knownActions[0],s===null&&(s=c._clip)}if(s===null)return null;const h=new sw(this,s,t,i);return this._bindAction(h,c),this._addInactiveAction(h,o,r),h}existingAction(e,t){const i=t||this._root,n=i.uuid,r=typeof e=="string"?Mo.findByName(i,e):e,s=r?r.uuid:e,o=this._actionsByClip[s];return o!==void 0&&o.actionByRoot[n]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let i=t-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const t=this._actions,i=this._nActiveActions,n=this.time+=e,r=Math.sign(e),s=this._accuIndex^=1;for(let c=0;c!==i;++c)t[c]._update(n,e,r,s);const o=this._bindings,a=this._nActiveBindings;for(let c=0;c!==a;++c)o[c].apply(s);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,n=this._actionsByClip,r=n[i];if(r!==void 0){const s=r.knownActions;for(let o=0,a=s.length;o!==a;++o){const c=s[o];this._deactivateAction(c);const h=c._cacheIndex,u=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,u._cacheIndex=h,t[h]=u,t.pop(),this._removeInactiveBindingsForAction(c)}delete n[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const s in i){const o=i[s].actionByRoot,a=o[t];a!==void 0&&(this._deactivateAction(a),this._removeInactiveAction(a))}const n=this._bindingsByRootAndName,r=n[t];if(r!==void 0)for(const s in r){const o=r[s];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(e,t){const i=this.existingAction(e,t);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class zf{constructor(e){typeof e=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new zf(this.value.clone===void 0?this.value:this.value.clone())}}class lw extends Ya{constructor(e,t,i=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class cw{constructor(e,t,i,n,r){this.isGLBufferAttribute=!0,this.buffer=e,this.type=t,this.itemSize=i,this.elementSize=n,this.count=r,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class Rg{constructor(e,t,i=0,n=1/0){this.ray=new Wa(e,t),this.near=i,this.far=n,this.camera=null,this.layers=new Ac,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return Bu(e,this,i,t),i.sort(Fp),i}intersectObjects(e,t=!0,i=[]){for(let n=0,r=e.length;n<r;n++)Bu(e[n],this,i,t);return i.sort(Fp),i}}function Fp(l,e){return l.distance-e.distance}function Bu(l,e,t,i){if(l.layers.test(e.layers)&&l.raycast(e,t),i===!0){const n=l.children;for(let r=0,s=n.length;r<s;r++)Bu(n[r],e,t,!0)}}class hw{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Ct(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class uw{constructor(e=1,t=0,i=0){return this.radius=e,this.theta=t,this.y=i,this}set(e,t,i){return this.radius=e,this.theta=t,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=t,this}clone(){return new this.constructor().copy(this)}}const Op=new pe;class fw{constructor(e=new pe(1/0,1/0),t=new pe(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Op.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Op.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Up=new L,Vl=new L;class dw{constructor(e=new L,t=new L){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){Up.subVectors(e,this.start),Vl.subVectors(this.end,this.start);const i=Vl.dot(Vl);let r=Vl.dot(Up)/i;return t&&(r=Ct(r,0,1)),r}closestPointToPoint(e,t,i){const n=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(n).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const kp=new L;class pw extends $e{constructor(e,t){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;const i=new ze,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,o=1,a=32;s<a;s++,o++){const c=s/a*Math.PI*2,h=o/a*Math.PI*2;n.push(Math.cos(c),Math.sin(c),1,Math.cos(h),Math.sin(h),1)}i.setAttribute("position",new Fe(n,3));const r=new Kt({fog:!1,toneMapped:!1});this.cone=new Kn(i,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),kp.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(kp),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Ki=new L,Hl=new Ne,Bh=new Ne;class mw extends Kn{constructor(e){const t=Pg(e),i=new ze,n=[],r=[],s=new Ae(0,0,1),o=new Ae(0,1,0);for(let c=0;c<t.length;c++){const h=t[c];h.parent&&h.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),r.push(s.r,s.g,s.b),r.push(o.r,o.g,o.b))}i.setAttribute("position",new Fe(n,3)),i.setAttribute("color",new Fe(r,3));const a=new Kt({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,a),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,i=this.geometry,n=i.getAttribute("position");Bh.copy(this.root.matrixWorld).invert();for(let r=0,s=0;r<t.length;r++){const o=t[r];o.parent&&o.parent.isBone&&(Hl.multiplyMatrices(Bh,o.matrixWorld),Ki.setFromMatrixPosition(Hl),n.setXYZ(s,Ki.x,Ki.y,Ki.z),Hl.multiplyMatrices(Bh,o.parent.matrixWorld),Ki.setFromMatrixPosition(Hl),n.setXYZ(s+1,Ki.x,Ki.y,Ki.z),s+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}function Pg(l){const e=[];l.isBone===!0&&e.push(l);for(let t=0;t<l.children.length;t++)e.push.apply(e,Pg(l.children[t]));return e}class gw extends ht{constructor(e,t,i){const n=new _r(t,4,2),r=new kt({wireframe:!0,fog:!1,toneMapped:!1});super(n,r),this.light=e,this.light.updateMatrixWorld(),this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const _w=new L,Np=new Ae,Bp=new Ae;class xw extends $e{constructor(e,t,i){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i;const n=new us(t);n.rotateY(Math.PI*.5),this.material=new kt({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const r=n.getAttribute("position"),s=new Float32Array(r.count*3);n.setAttribute("color",new st(s,3)),this.add(new ht(n,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");Np.copy(this.light.color),Bp.copy(this.light.groundColor);for(let i=0,n=t.count;i<n;i++){const r=i<n/2?Np:Bp;t.setXYZ(i,r.r,r.g,r.b)}t.needsUpdate=!0}e.lookAt(_w.setFromMatrixPosition(this.light.matrixWorld).negate())}}class vw extends Kn{constructor(e=10,t=10,i=4473924,n=8947848){i=new Ae(i),n=new Ae(n);const r=t/2,s=e/t,o=e/2,a=[],c=[];for(let f=0,d=0,g=-o;f<=t;f++,g+=s){a.push(-o,0,g,o,0,g),a.push(g,0,-o,g,0,o);const p=f===r?i:n;p.toArray(c,d),d+=3,p.toArray(c,d),d+=3,p.toArray(c,d),d+=3,p.toArray(c,d),d+=3}const h=new ze;h.setAttribute("position",new Fe(a,3)),h.setAttribute("color",new Fe(c,3));const u=new Kt({vertexColors:!0,toneMapped:!1});super(h,u),this.type="GridHelper"}}class yw extends Kn{constructor(e=10,t=16,i=8,n=64,r=4473924,s=8947848){r=new Ae(r),s=new Ae(s);const o=[],a=[];for(let u=0;u<=t;u++){const f=u/t*(Math.PI*2),d=Math.sin(f)*e,g=Math.cos(f)*e;o.push(0,0,0),o.push(d,0,g);const p=u&1?r:s;a.push(p.r,p.g,p.b),a.push(p.r,p.g,p.b)}for(let u=0;u<=i;u++){const f=u&1?r:s,d=e-e/i*u;for(let g=0;g<n;g++){let p=g/n*(Math.PI*2),m=Math.sin(p)*d,_=Math.cos(p)*d;o.push(m,0,_),a.push(f.r,f.g,f.b),p=(g+1)/n*(Math.PI*2),m=Math.sin(p)*d,_=Math.cos(p)*d,o.push(m,0,_),a.push(f.r,f.g,f.b)}}const c=new ze;c.setAttribute("position",new Fe(o,3)),c.setAttribute("color",new Fe(a,3));const h=new Kt({vertexColors:!0,toneMapped:!1});super(c,h),this.type="PolarGridHelper"}}const zp=new L,Wl=new L,Gp=new L;class bw extends $e{constructor(e,t,i){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,t===void 0&&(t=1);let n=new ze;n.setAttribute("position",new Fe([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const r=new Kt({fog:!1,toneMapped:!1});this.lightPlane=new Di(n,r),this.add(this.lightPlane),n=new ze,n.setAttribute("position",new Fe([0,0,0,0,0,1],3)),this.targetLine=new Di(n,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){zp.setFromMatrixPosition(this.light.matrixWorld),Wl.setFromMatrixPosition(this.light.target.matrixWorld),Gp.subVectors(Wl,zp),this.lightPlane.lookAt(Wl),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Wl),this.targetLine.scale.z=Gp.length()}}const Xl=new L,yt=new Ec;class ww extends Kn{constructor(e){const t=new ze,i=new Kt({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],r=[],s={},o=new Ae(16755200),a=new Ae(16711680),c=new Ae(43775),h=new Ae(16777215),u=new Ae(3355443);f("n1","n2",o),f("n2","n4",o),f("n4","n3",o),f("n3","n1",o),f("f1","f2",o),f("f2","f4",o),f("f4","f3",o),f("f3","f1",o),f("n1","f1",o),f("n2","f2",o),f("n3","f3",o),f("n4","f4",o),f("p","n1",a),f("p","n2",a),f("p","n3",a),f("p","n4",a),f("u1","u2",c),f("u2","u3",c),f("u3","u1",c),f("c","t",h),f("p","c",u),f("cn1","cn2",u),f("cn3","cn4",u),f("cf1","cf2",u),f("cf3","cf4",u);function f(g,p,m){d(g,m),d(p,m)}function d(g,p){n.push(0,0,0),r.push(p.r,p.g,p.b),s[g]===void 0&&(s[g]=[]),s[g].push(n.length/3-1)}t.setAttribute("position",new Fe(n,3)),t.setAttribute("color",new Fe(r,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){const e=this.geometry,t=this.pointMap,i=1,n=1;yt.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Mt("c",t,e,yt,0,0,-1),Mt("t",t,e,yt,0,0,1),Mt("n1",t,e,yt,-i,-n,-1),Mt("n2",t,e,yt,i,-n,-1),Mt("n3",t,e,yt,-i,n,-1),Mt("n4",t,e,yt,i,n,-1),Mt("f1",t,e,yt,-i,-n,1),Mt("f2",t,e,yt,i,-n,1),Mt("f3",t,e,yt,-i,n,1),Mt("f4",t,e,yt,i,n,1),Mt("u1",t,e,yt,i*.7,n*1.1,-1),Mt("u2",t,e,yt,-i*.7,n*1.1,-1),Mt("u3",t,e,yt,0,n*2,-1),Mt("cf1",t,e,yt,-i,0,1),Mt("cf2",t,e,yt,i,0,1),Mt("cf3",t,e,yt,0,-n,1),Mt("cf4",t,e,yt,0,n,1),Mt("cn1",t,e,yt,-i,0,-1),Mt("cn2",t,e,yt,i,0,-1),Mt("cn3",t,e,yt,0,-n,-1),Mt("cn4",t,e,yt,0,n,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Mt(l,e,t,i,n,r,s){Xl.set(n,r,s).unproject(i);const o=e[l];if(o!==void 0){const a=t.getAttribute("position");for(let c=0,h=o.length;c<h;c++)a.setXYZ(o[c],Xl.x,Xl.y,Xl.z)}}const ql=new gi;class Mw extends Kn{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(8*3),r=new ze;r.setIndex(new st(i,1)),r.setAttribute("position",new st(n,3)),super(r,new Kt({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&ql.setFromObject(this.object),ql.isEmpty())return;const t=ql.min,i=ql.max,n=this.geometry.attributes.position,r=n.array;r[0]=i.x,r[1]=i.y,r[2]=i.z,r[3]=t.x,r[4]=i.y,r[5]=i.z,r[6]=t.x,r[7]=t.y,r[8]=i.z,r[9]=i.x,r[10]=t.y,r[11]=i.z,r[12]=i.x,r[13]=i.y,r[14]=t.z,r[15]=t.x,r[16]=i.y,r[17]=t.z,r[18]=t.x,r[19]=t.y,r[20]=t.z,r[21]=i.x,r[22]=t.y,r[23]=t.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}}class Sw extends Kn{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],r=new ze;r.setIndex(new st(i,1)),r.setAttribute("position",new Fe(n,3)),super(r,new Kt({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}}class Tw extends Di{constructor(e,t=1,i=16776960){const n=i,r=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],s=new ze;s.setAttribute("position",new Fe(r,3)),s.computeBoundingSphere(),super(s,new Kt({color:n,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const o=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],a=new ze;a.setAttribute("position",new Fe(o,3)),a.computeBoundingSphere(),this.add(new ht(a,new kt({color:n,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){let t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?tn:Pi,this.lookAt(this.plane.normal),super.updateMatrixWorld(e)}}const Vp=new L;let Yl,zh;class Cw extends $e{constructor(e=new L(0,0,1),t=new L(0,0,0),i=1,n=16776960,r=i*.2,s=r*.2){super(),this.type="ArrowHelper",Yl===void 0&&(Yl=new ze,Yl.setAttribute("position",new Fe([0,0,0,0,1,0],3)),zh=new pi(0,.5,1,5,1),zh.translate(0,-.5,0)),this.position.copy(t),this.line=new Di(Yl,new Kt({color:n,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ht(zh,new kt({color:n,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,r,s)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Vp.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Vp,t)}}setLength(e,t=e*.2,i=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}class Aw extends Kn{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],n=new ze;n.setAttribute("position",new Fe(t,3)),n.setAttribute("color",new Fe(i,3));const r=new Kt({vertexColors:!0,toneMapped:!1});super(n,r),this.type="AxesHelper"}setColors(e,t,i){const n=new Ae,r=this.geometry.attributes.color.array;return n.set(e),n.toArray(r,0),n.toArray(r,3),n.set(t),n.toArray(r,6),n.toArray(r,9),n.set(i),n.toArray(r,12),n.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Ew{constructor(){this.type="ShapePath",this.color=new Ae,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Aa,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,n){return this.currentPath.quadraticCurveTo(e,t,i,n),this}bezierCurveTo(e,t,i,n,r,s){return this.currentPath.bezierCurveTo(e,t,i,n,r,s),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,t){function i(x){const b=[];for(let y=0,v=x.length;y<v;y++){const M=x[y],S=new ts;S.curves=M.curves,b.push(S)}return b}function n(x,b){const y=b.length;let v=!1;for(let M=y-1,S=0;S<y;M=S++){let w=b[M],T=b[S],R=T.x-w.x,D=T.y-w.y;if(Math.abs(D)>Number.EPSILON){if(D<0&&(w=b[S],R=-R,T=b[M],D=-D),x.y<w.y||x.y>T.y)continue;if(x.y===w.y){if(x.x===w.x)return!0}else{const I=D*(x.x-w.x)-R*(x.y-w.y);if(I===0)return!0;if(I<0)continue;v=!v}}else{if(x.y!==w.y)continue;if(T.x<=x.x&&x.x<=w.x||w.x<=x.x&&x.x<=T.x)return!0}}return v}const r=ci.isClockWise,s=this.subPaths;if(s.length===0)return[];if(t===!0)return i(s);let o,a,c;const h=[];if(s.length===1)return a=s[0],c=new ts,c.curves=a.curves,h.push(c),h;let u=!r(s[0].getPoints());u=e?!u:u;const f=[],d=[];let g=[],p=0,m;d[p]=void 0,g[p]=[];for(let x=0,b=s.length;x<b;x++)a=s[x],m=a.getPoints(),o=r(m),o=e?!o:o,o?(!u&&d[p]&&p++,d[p]={s:new ts,p:m},d[p].s.curves=a.curves,u&&p++,g[p]=[]):g[p].push({h:a,p:m[0]});if(!d[0])return i(s);if(d.length>1){let x=!1,b=0;for(let y=0,v=d.length;y<v;y++)f[y]=[];for(let y=0,v=d.length;y<v;y++){const M=g[y];for(let S=0;S<M.length;S++){const w=M[S];let T=!0;for(let R=0;R<d.length;R++)n(w.p,d[R].p)&&(y!==R&&b++,T?(T=!1,f[R].push(w)):x=!0);T&&f[y].push(w)}}b>0&&x===!1&&(g=f)}let _;for(let x=0,b=d.length;x<b;x++){c=d[x].s,h.push(c),_=g[x];for(let y=0,v=_.length;y<v;y++)c.holes.push(_[y].h)}return h}}class Lw{static toHalfFloat(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=Ct(e,-65504,65504),Hp[0]=e;const t=Wp[0],i=t>>23&511;return Xn[i]+((t&8388607)>>qn[i])}static fromHalfFloat(e){const t=e>>10;return Wp[0]=Gf[Ig[t]+(e&1023)]+Io[t],Hp[0]}}const Dg=new ArrayBuffer(4),Hp=new Float32Array(Dg),Wp=new Uint32Array(Dg),Xn=new Uint32Array(512),qn=new Uint32Array(512);for(let l=0;l<256;++l){const e=l-127;e<-27?(Xn[l]=0,Xn[l|256]=32768,qn[l]=24,qn[l|256]=24):e<-14?(Xn[l]=1024>>-e-14,Xn[l|256]=1024>>-e-14|32768,qn[l]=-e-1,qn[l|256]=-e-1):e<=15?(Xn[l]=e+15<<10,Xn[l|256]=e+15<<10|32768,qn[l]=13,qn[l|256]=13):e<128?(Xn[l]=31744,Xn[l|256]=64512,qn[l]=24,qn[l|256]=24):(Xn[l]=31744,Xn[l|256]=64512,qn[l]=13,qn[l|256]=13)}const Gf=new Uint32Array(2048),Io=new Uint32Array(64),Ig=new Uint32Array(64);for(let l=1;l<1024;++l){let e=l<<13,t=0;for(;(e&8388608)===0;)e<<=1,t-=8388608;e&=-8388609,t+=947912704,Gf[l]=e|t}for(let l=1024;l<2048;++l)Gf[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)Io[l]=l<<23;Io[31]=1199570944;Io[32]=2147483648;for(let l=33;l<63;++l)Io[l]=2147483648+(l-32<<23);Io[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(Ig[l]=1024);class Rw extends ze{constructor(){console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),super()}}class Pw extends ze{constructor(){console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),super()}}function Dw(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")}function Iw(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")}function Fw(){console.error("THREE.ImmediateRenderObject has been removed.")}class Ow extends Mn{constructor(e,t,i){console.error('THREE.WebGLMultisampleRenderTarget has been removed. Use a normal render target and set the "samples" property to greater 0 to enable multisampling.'),super(e,t,i),this.samples=4}}class Uw extends Ha{constructor(e,t,i,n){console.warn("THREE.DataTexture2DArray has been renamed to DataArrayTexture."),super(e,t,i,n)}}class kw extends Cc{constructor(e,t,i,n){console.warn("THREE.DataTexture3D has been renamed to Data3DTexture."),super(e,t,i,n)}}typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:wc}}));typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=wc);var Nw=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:l0,AddEquation:Hr,AddOperation:r0,AdditiveAnimationBlendMode:lf,AdditiveBlending:ou,AlphaFormat:m0,AlwaysDepth:Km,AlwaysStencilFunc:P0,AmbientLight:wg,AmbientLightProbe:Vb,AnimationClip:Mo,AnimationLoader:Pb,AnimationMixer:aw,AnimationObjectGroup:rw,AnimationUtils:ft,ArcCurve:Q0,ArrayCamera:W0,ArrowHelper:Cw,Audio:Eg,AudioAnalyser:Zb,AudioContext:Uf,AudioListener:Xb,AudioLoader:zb,AxesHelper:Aw,BackSide:tn,BasicDepthPacking:L0,BasicShadowMap:l2,Bone:Oc,BooleanKeyframeTrack:ms,Box2:fw,Box3:gi,Box3Helper:Sw,BoxBufferGeometry:fi,BoxGeometry:fi,BoxHelper:Mw,BufferAttribute:st,BufferGeometry:ze,BufferGeometryLoader:Cg,ByteType:h0,Cache:fs,Camera:Ec,CameraHelper:ww,CanvasTexture:eb,CapsuleBufferGeometry:lo,CapsuleGeometry:lo,CatmullRomCurve3:$0,CineonToneMapping:a0,CircleBufferGeometry:co,CircleGeometry:co,ClampToEdgeWrapping:Yt,Clock:kf,Color:Ae,ColorKeyframeTrack:Rf,ColorManagement:Ln,CompressedTexture:K0,CompressedTextureLoader:Db,ConeBufferGeometry:ho,ConeGeometry:ho,CubeCamera:O0,CubeReflectionMapping:hr,CubeRefractionMapping:ur,CubeTexture:Xa,CubeTextureLoader:Ib,CubeUVReflectionMapping:Lo,CubicBezierCurve:Sf,CubicBezierCurve3:eg,CubicInterpolant:gg,CullFaceBack:su,CullFaceFront:Om,CullFaceFrontBack:a2,CullFaceNone:Fm,Curve:Qn,CurvePath:ng,CustomBlending:Nm,CustomToneMapping:c0,CylinderBufferGeometry:pi,CylinderGeometry:pi,Cylindrical:uw,Data3DTexture:Cc,DataArrayTexture:Ha,DataTexture:Ks,DataTexture2DArray:Uw,DataTexture3D:kw,DataTextureLoader:Fb,DataUtils:Lw,DecrementStencilOp:v2,DecrementWrapStencilOp:b2,DefaultLoadingManager:vg,DepthFormat:ar,DepthStencilFormat:as,DepthTexture:X0,DirectionalLight:Ff,DirectionalLightHelper:bw,DiscreteInterpolant:_g,DodecahedronBufferGeometry:uo,DodecahedronGeometry:uo,DoubleSide:ui,DstAlphaFactor:Xm,DstColorFactor:Ym,DynamicCopyUsage:U2,DynamicDrawUsage:R2,DynamicReadUsage:I2,EdgesGeometry:ig,EllipseCurve:kc,EqualDepth:$m,EqualStencilFunc:T2,EquirectangularReflectionMapping:ya,EquirectangularRefractionMapping:ba,Euler:Ro,EventDispatcher:Mr,ExtrudeBufferGeometry:fo,ExtrudeGeometry:fo,FileLoader:jn,FlatShading:km,Float16BufferAttribute:x_,Float32BufferAttribute:Fe,Float64BufferAttribute:v_,FloatType:Ai,Fog:Fc,FogExp2:Ic,Font:Iw,FontLoader:Dw,FramebufferTexture:$3,FrontSide:Pi,Frustum:Lc,GLBufferAttribute:cw,GLSL1:N2,GLSL3:Du,GreaterDepth:t0,GreaterEqualDepth:e0,GreaterEqualStencilFunc:L2,GreaterStencilFunc:A2,GridHelper:vw,Group:bn,HalfFloatType:so,HemisphereLight:bg,HemisphereLightHelper:xw,HemisphereLightProbe:Gb,IcosahedronBufferGeometry:po,IcosahedronGeometry:po,ImageBitmapLoader:Ag,ImageLoader:Pa,ImageUtils:ff,ImmediateRenderObject:Fw,IncrementStencilOp:x2,IncrementWrapStencilOp:y2,InstancedBufferAttribute:cs,InstancedBufferGeometry:Of,InstancedInterleavedBuffer:lw,InstancedMesh:J0,Int16BufferAttribute:g_,Int32BufferAttribute:__,Int8BufferAttribute:d_,IntType:f0,InterleavedBuffer:Ya,InterleavedBufferAttribute:mr,Interpolant:Do,InterpolateDiscrete:oo,InterpolateLinear:ls,InterpolateSmooth:rc,InvertStencilOp:w2,KeepStencilOp:sc,KeyframeTrack:$n,LOD:j0,LatheBufferGeometry:hs,LatheGeometry:hs,Layers:Ac,LessDepth:Qm,LessEqualDepth:hc,LessEqualStencilFunc:C2,LessStencilFunc:S2,Light:Sr,LightProbe:Gc,Line:Di,Line3:dw,LineBasicMaterial:Kt,LineCurve:Nc,LineCurve3:tg,LineDashedMaterial:mg,LineLoop:bf,LineSegments:Kn,LinearEncoding:pr,LinearFilter:dt,LinearInterpolant:Lf,LinearMipMapLinearFilter:d2,LinearMipMapNearestFilter:f2,LinearMipmapLinearFilter:Ui,LinearMipmapNearestFilter:Sc,LinearSRGBColorSpace:nr,LinearToneMapping:s0,Loader:fn,LoaderUtils:hi,LoadingManager:Pf,LoopOnce:T0,LoopPingPong:A0,LoopRepeat:C0,LuminanceAlphaFormat:x0,LuminanceFormat:_0,MOUSE:s2,Material:bt,MaterialLoader:Tg,MathUtils:ua,Matrix3:yn,Matrix4:Ne,MaxEquation:hu,Mesh:ht,MeshBasicMaterial:kt,MeshDepthMaterial:Pc,MeshDistanceMaterial:Dc,MeshLambertMaterial:dg,MeshMatcapMaterial:pg,MeshNormalMaterial:fg,MeshPhongMaterial:hg,MeshPhysicalMaterial:Ni,MeshStandardMaterial:ps,MeshToonMaterial:ug,MinEquation:cu,MirroredRepeatWrapping:ro,MixOperation:i0,MultiplyBlending:lu,MultiplyOperation:Va,NearestFilter:Tt,NearestMipMapLinearFilter:u2,NearestMipMapNearestFilter:h2,NearestMipmapLinearFilter:Ma,NearestMipmapNearestFilter:wa,NeverDepth:Jm,NeverStencilFunc:M2,NoBlending:Ei,NoColorSpace:m2,NoToneMapping:li,NormalAnimationBlendMode:Tc,NormalBlending:Kr,NotEqualDepth:n0,NotEqualStencilFunc:E2,NumberKeyframeTrack:bo,Object3D:$e,ObjectLoader:Nb,ObjectSpaceNormalMap:R0,OctahedronBufferGeometry:us,OctahedronGeometry:us,OneFactor:Vm,OneMinusDstAlphaFactor:qm,OneMinusDstColorFactor:Zm,OneMinusSrcAlphaFactor:of,OneMinusSrcColorFactor:Wm,OrthographicCamera:qa,PCFShadowMap:rf,PCFSoftShadowMap:Um,PMREMGenerator:Fu,ParametricGeometry:Rw,Path:Aa,PerspectiveCamera:Dt,Plane:er,PlaneBufferGeometry:Zn,PlaneGeometry:Zn,PlaneHelper:Tw,PointLight:zc,PointLightHelper:gw,Points:wf,PointsMaterial:Uc,PolarGridHelper:yw,PolyhedronBufferGeometry:mi,PolyhedronGeometry:mi,PositionalAudio:Yb,PropertyBinding:Ke,PropertyMixer:Lg,QuadraticBezierCurve:Tf,QuadraticBezierCurve3:Cf,Quaternion:jt,QuaternionKeyframeTrack:xr,QuaternionLinearInterpolant:xg,REVISION:wc,RGBADepthPacking:hf,RGBAFormat:vn,RGBAIntegerFormat:M0,RGBA_ASTC_10x10_Format:Eu,RGBA_ASTC_10x5_Format:Tu,RGBA_ASTC_10x6_Format:Cu,RGBA_ASTC_10x8_Format:Au,RGBA_ASTC_12x10_Format:Lu,RGBA_ASTC_12x12_Format:Ru,RGBA_ASTC_4x4_Format:_u,RGBA_ASTC_5x4_Format:xu,RGBA_ASTC_5x5_Format:vu,RGBA_ASTC_6x5_Format:yu,RGBA_ASTC_6x6_Format:bu,RGBA_ASTC_8x5_Format:wu,RGBA_ASTC_8x6_Format:Mu,RGBA_ASTC_8x8_Format:Su,RGBA_BPTC_Format:Pu,RGBA_ETC2_EAC_Format:gu,RGBA_PVRTC_2BPPV1_Format:pu,RGBA_PVRTC_4BPPV1_Format:du,RGBA_S3TC_DXT1_Format:tc,RGBA_S3TC_DXT3_Format:nc,RGBA_S3TC_DXT5_Format:ic,RGBFormat:g0,RGB_ETC1_Format:S0,RGB_ETC2_Format:mu,RGB_PVRTC_2BPPV1_Format:fu,RGB_PVRTC_4BPPV1_Format:uu,RGB_S3TC_DXT1_Format:ec,RGFormat:b0,RGIntegerFormat:w0,RawShaderMaterial:cg,Ray:Wa,Raycaster:Rg,RectAreaLight:Mg,RedFormat:v0,RedIntegerFormat:y0,ReinhardToneMapping:o0,RepeatWrapping:fr,ReplaceStencilOp:_2,ReverseSubtractEquation:zm,RingBufferGeometry:mo,RingGeometry:mo,SRGBColorSpace:oi,Scene:xf,ShaderChunk:He,ShaderLib:Yn,ShaderMaterial:di,ShadowMaterial:lg,Shape:ts,ShapeBufferGeometry:go,ShapeGeometry:go,ShapePath:Ew,ShapeUtils:ci,ShortType:u0,Skeleton:Za,SkeletonHelper:mw,SkinnedMesh:yf,SmoothShading:c2,Source:Zr,Sphere:ki,SphereBufferGeometry:_r,SphereGeometry:_r,Spherical:hw,SphericalHarmonics3:Sg,SplineCurve:Af,SpotLight:If,SpotLightHelper:pw,Sprite:Z0,SpriteMaterial:vf,SrcAlphaFactor:sf,SrcAlphaSaturateFactor:jm,SrcColorFactor:Hm,StaticCopyUsage:O2,StaticDrawUsage:uc,StaticReadUsage:D2,StereoCamera:Hb,StreamCopyUsage:k2,StreamDrawUsage:P2,StreamReadUsage:F2,StringKeyframeTrack:gs,SubtractEquation:Bm,SubtractiveBlending:au,TOUCH:o2,TangentSpaceNormalMap:wr,TetrahedronBufferGeometry:_o,TetrahedronGeometry:_o,TextGeometry:Pw,Texture:wt,TextureLoader:yg,TorusBufferGeometry:xo,TorusGeometry:xo,TorusKnotBufferGeometry:vo,TorusKnotGeometry:vo,Triangle:Pn,TriangleFanDrawMode:cf,TriangleStripDrawMode:E0,TrianglesDrawMode:p2,TubeBufferGeometry:yo,TubeGeometry:yo,UVMapping:Mc,Uint16BufferAttribute:df,Uint32BufferAttribute:pf,Uint8BufferAttribute:p_,Uint8ClampedBufferAttribute:m_,Uniform:zf,UniformsLib:Re,UniformsUtils:mf,UnsignedByteType:dr,UnsignedInt248Type:Qr,UnsignedIntType:tr,UnsignedShort4444Type:d0,UnsignedShort5551Type:p0,UnsignedShortType:af,VSMShadowMap:Ws,Vector2:pe,Vector3:L,Vector4:it,VectorKeyframeTrack:wo,VideoTexture:Q3,WebGL1Renderer:q0,WebGL3DRenderTarget:i_,WebGLArrayRenderTarget:n_,WebGLCubeRenderTarget:U0,WebGLMultipleRenderTargets:r_,WebGLMultisampleRenderTarget:Ow,WebGLRenderTarget:Mn,WebGLRenderer:_f,WebGLUtils:H0,WireframeGeometry:ag,WrapAroundEnding:Sa,ZeroCurvatureEnding:qr,ZeroFactor:Gm,ZeroSlopeEnding:Yr,ZeroStencilOp:g2,_SRGBAFormat:fc,sRGBEncoding:nt},Symbol.toStringTag,{value:"Module"})),za,Ga;class Bw{constructor(e,t){Ce(this,"scene");Ce(this,"cameraControls");Ce(this,"currentTarget");Ce(this,"isMoving");qo(this,za,async()=>{var n,r,s,o,a,c,h;const e=this.getCurrentPath(),t=xi(this,Ga).call(this,e)||xi(this,Ga).call(this,"404");if(!t||this.isMoving)return;this.onRouteChange(),this.isMoving=!0,(r=(n=this.currentTarget)==null?void 0:n.userData.print)==null||r.off(),await Promise.all([this.cameraControls.navigateTo(((s=t.userData)==null?void 0:s.viewTarget)||t),(o=t.userData.animation)==null?void 0:o.play(),(c=(a=this.currentTarget)==null?void 0:a.userData.animation)==null?void 0:c.reverse()]),(h=t.userData.print)==null||h.on(),this.currentTarget=t,this.isMoving=!1;const i=this.getCurrentPath();e!==i&&t.name!=="404"&&this.handleCurrentPath()});qo(this,Ga,e=>this.scene.getObjectByName(e));Ce(this,"handleCurrentPath",()=>{var t;const e=this.getCurrentPath();((t=this.currentTarget)==null?void 0:t.name)===e||this.isMoving||xi(this,za).call(this)});Ce(this,"goTo",(e="/")=>{e===this.getCurrentPath()||this.isMoving||(window.history.pushState({},"",e),xi(this,za).call(this))});Ce(this,"getCurrentPath",()=>window.location.pathname.replace("/","")||"index");Ce(this,"onRouteChange",()=>{const e=new Event("onroutechange");window.dispatchEvent(e)});window.onpopstate||(window.onpopstate=this.handleCurrentPath),this.isMoving=!1,this.scene=e,this.cameraControls=t}}za=new WeakMap,Ga=new WeakMap;var Xp=class{constructor(l,e){Ce(this,"target");Ce(this,"name");Ce(this,"intersected");Ce(this,"wasIntersected",!1);Ce(this,"distance");this.target=l,this.name=e,this.intersected=!1,this.distance=0}},Hn=class{constructor(l,e=null){Ce(this,"type");Ce(this,"cancelBubble");Ce(this,"originalEvent");Ce(this,"coords",new pe(0,0));Ce(this,"distance",0);Ce(this,"intersected",!1);this.cancelBubble=!1,this.type=l,this.originalEvent=e}stopPropagation(){this.cancelBubble=!0}},zw=class{constructor(l,e,t,i){Ce(this,"renderer");Ce(this,"camera");Ce(this,"domElement");Ce(this,"bindEventsOnBodyElement");Ce(this,"mouse");Ce(this,"supportsPointerEvents");Ce(this,"interactiveObjects");Ce(this,"closestObject");Ce(this,"raycaster");Ce(this,"treatTouchEventsAsMouseEvents");Ce(this,"dispose",()=>{this.domElement.removeEventListener("click",this.onMouseClick),this.supportsPointerEvents?(this.domElement.ownerDocument.removeEventListener("pointermove",this.onDocumentMouseMove),this.domElement.removeEventListener("pointerdown",this.onMouseDown),this.domElement.removeEventListener("pointerup",this.onMouseUp)):(this.domElement.ownerDocument.removeEventListener("mousemove",this.onDocumentMouseMove),this.domElement.removeEventListener("mousedown",this.onMouseDown),this.domElement.removeEventListener("mouseup",this.onMouseUp),this.domElement.removeEventListener("touchstart",this.onTouchStart),this.domElement.removeEventListener("touchmove",this.onTouchMove),this.domElement.removeEventListener("touchend",this.onTouchEnd))});Ce(this,"add",(l,e=[])=>{if(l)if(e.length>0)e.forEach(t=>{let i=l.getObjectByName(t);if(i){let n=new Xp(i,t);this.interactiveObjects.push(n)}});else{let t=new Xp(l,l.name);this.interactiveObjects.push(t)}});Ce(this,"remove",(l,e=[])=>{if(!l)return;let t=new Set(e.length>0?e:[l.name]);this.interactiveObjects=this.interactiveObjects.filter(i=>!t.has(i.name))});Ce(this,"update",()=>{var i;this.raycaster.setFromCamera(this.mouse,this.camera),this.interactiveObjects.forEach(n=>{n.target&&this.checkIntersection(n)}),this.interactiveObjects.sort(function(n,r){return n.distance-r.distance});let l=(i=this.interactiveObjects.find(n=>n.intersected))!=null?i:null;if(l!=this.closestObject){if(this.closestObject){let n=new Hn("mouseout");this.dispatch(this.closestObject,n)}if(l){let n=new Hn("mouseover");this.dispatch(l,n)}this.closestObject=l}let e;this.interactiveObjects.forEach(n=>{!n.intersected&&n.wasIntersected&&(e||(e=new Hn("mouseleave")),this.dispatch(n,e))});let t;this.interactiveObjects.forEach(n=>{n.intersected&&!n.wasIntersected&&(t||(t=new Hn("mouseenter")),this.dispatch(n,t))})});Ce(this,"checkIntersection",l=>{let e=this.raycaster.intersectObjects([l.target],!0);if(l.wasIntersected=l.intersected,e.length>0){let t=e[0].distance;e.forEach(i=>{i.distance<t&&(t=i.distance)}),l.intersected=!0,l.distance=t}else l.intersected=!1});Ce(this,"onDocumentMouseMove",l=>{this.mapPositionToPoint(this.mouse,l.clientX,l.clientY);let e=new Hn("mousemove",l);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})});Ce(this,"onTouchMove",l=>{this.mapPositionToPoint(this.mouse,l.touches[0].clientX,l.touches[0].clientY);let e=new Hn(this.treatTouchEventsAsMouseEvents?"mousemove":"touchmove",l);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})});Ce(this,"onMouseClick",l=>{this.update();let e=new Hn("click",l);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})});Ce(this,"onMouseDown",l=>{this.mapPositionToPoint(this.mouse,l.clientX,l.clientY),this.update();let e=new Hn("mousedown",l);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})});Ce(this,"onTouchStart",l=>{this.mapPositionToPoint(this.mouse,l.touches[0].clientX,l.touches[0].clientY),this.update();let e=new Hn(this.treatTouchEventsAsMouseEvents?"mousedown":"touchstart",l);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})});Ce(this,"onMouseUp",l=>{let e=new Hn("mouseup",l);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})});Ce(this,"onTouchEnd",l=>{this.mapPositionToPoint(this.mouse,l.touches[0].clientX,l.touches[0].clientY),this.update();let e=new Hn(this.treatTouchEventsAsMouseEvents?"mouseup":"touchend",l);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})});Ce(this,"dispatch",(l,e)=>{l.target&&!e.cancelBubble&&(e.coords=this.mouse,e.distance=l.distance,e.intersected=l.intersected,l.target.dispatchEvent(e))});Ce(this,"mapPositionToPoint",(l,e,t)=>{let i=this.renderer.domElement.getBoundingClientRect();l.x=(e-i.left)/i.width*2-1,l.y=-((t-i.top)/i.height)*2+1});this.renderer=l,this.camera=e,this.domElement=t,this.bindEventsOnBodyElement=!0,typeof i<"u"&&i&&(this.bindEventsOnBodyElement=!1),this.mouse=new pe(-1,1),this.supportsPointerEvents=!!window.PointerEvent,this.interactiveObjects=[],this.closestObject=null,this.raycaster=new Rg,t.addEventListener("click",this.onMouseClick),this.supportsPointerEvents?(this.bindEventsOnBodyElement?t.ownerDocument.addEventListener("pointermove",this.onDocumentMouseMove):t.addEventListener("pointermove",this.onDocumentMouseMove),t.addEventListener("pointerdown",this.onMouseDown),t.addEventListener("pointerup",this.onMouseUp)):(this.bindEventsOnBodyElement?t.ownerDocument.addEventListener("mousemove",this.onDocumentMouseMove):t.addEventListener("mousemove",this.onDocumentMouseMove),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("mouseup",this.onMouseUp),t.addEventListener("touchstart",this.onTouchStart,{passive:!0}),t.addEventListener("touchmove",this.onTouchMove,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd,{passive:!0})),this.treatTouchEventsAsMouseEvents=!0}};class Gw extends zw{constructor(e,t){super(e,t,e.domElement,!1)}}class Vw{constructor(e){Ce(this,"textBlocks");Ce(this,"stopped",!1);Ce(this,"extendTextNodes",e=>{for(const t of Array.from(e.childNodes))if(Boolean(t.childNodes.length))this.extendTextNodes(t);else{const i=t;i.__originalText=i.textContent||"",i.textContent=""}});Ce(this,"resetTextNodes",e=>{for(const t of Array.from(e.childNodes))if(Boolean(t.childNodes.length))this.resetTextNodes(t);else{const i=t;i.textContent=i.__originalText}});Ce(this,"start",async()=>{var e;window.addEventListener("click",this.stop,{once:!0});for(const t of this.textBlocks){if(this.stopped)break;(e=t.style)!=null&&e.visibility&&(t.style.visibility="visible"),await this.traverse(t)}});Ce(this,"stop",()=>{this.stopped=!0,this.textBlocks.forEach(e=>{e.style.visibility="visible",this.resetTextNodes(e)})});Ce(this,"traverse",async e=>{for(const t of Array.from(e.childNodes)){if(this.stopped)break;if(Boolean(t.childNodes.length))await this.traverse(t);else{const i=t;await this.typeOut(i)}}});Ce(this,"typeOut",async e=>{let t=0;await new Promise(i=>{let n=setInterval(()=>{const r=e.__originalText[t];r&&!this.stopped?e.textContent+=r:(clearInterval(n),i(null)),t++},20)})});this.textBlocks=Array.from(e.childNodes),this.textBlocks.forEach(t=>{t.style&&(t.style.visibility="hidden"),this.extendTextNodes(t)})}}class Hw extends Dt{constructor(){super(75,window.innerWidth/window.innerHeight,.1,1e4),this.up.set(0,1,0)}}/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */const Ot={LEFT:1,RIGHT:2,MIDDLE:4},De=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_ZOOM_TRUCK:4096,TOUCH_ZOOM_OFFSET:8192});function Fr(l){return l.isPerspectiveCamera}function $i(l){return l.isOrthographicCamera}const zs=Math.PI*2,qp=Math.PI/2,Fg=1e-5;function ut(l,e=Fg){return Math.abs(l)<e}function mt(l,e,t=Fg){return ut(l-e,t)}function Yp(l,e){return Math.round(l/e)*e}function ta(l){return isFinite(l)?l:l<0?-Number.MAX_VALUE:Number.MAX_VALUE}function na(l){return Math.abs(l)<Number.MAX_VALUE?l:l*(1/0)}function Gh(l,e){e.set(0,0),l.forEach(t=>{e.x+=t.clientX,e.y+=t.clientY}),e.x/=l.length,e.y/=l.length}function Vh(l,e){return $i(l)?(console.warn(`${e} is not supported in OrthographicCamera`),!0):!1}function Zp(l){return l.invert?l.invert():l.inverse(),l}class Ww{constructor(){this._listeners={}}addEventListener(e,t){const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}removeEventListener(e,t){const n=this._listeners[e];if(n!==void 0){const r=n.indexOf(t);r!==-1&&n.splice(r,1)}}removeAllEventListeners(e){if(!e){this._listeners={};return}Array.isArray(this._listeners[e])&&(this._listeners[e].length=0)}dispatchEvent(e){const i=this._listeners[e.type];if(i!==void 0){e.target=this;const n=i.slice(0);for(let r=0,s=n.length;r<s;r++)n[r].call(this,e)}}}const Og=typeof window!="undefined",Xw=Og&&/Mac/.test(navigator.platform),jp=!(Og&&"PointerEvent"in window),Zl=1/8;let Ue,Jp,jl,Hh,an,Ze,at,Gs,ni,ii,Or,Kp,Qp,Wn,ia,Qs,$p,Wh,em,Xh,qh,Jl;class Ug extends Ww{constructor(e,t){if(super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=0,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.dampingFactor=.05,this.draggingDampingFactor=.25,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=De.NONE,this._viewport=null,this._dollyControlAmount=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._activePointers=[],this._truckInternal=(i,n,r)=>{if(Fr(this._camera)){const s=Ze.copy(this._camera.position).sub(this._target),o=this._camera.getEffectiveFOV()*Ue.MathUtils.DEG2RAD,a=s.length()*Math.tan(o*.5),c=this.truckSpeed*i*a/this._elementRect.height,h=this.truckSpeed*n*a/this._elementRect.height;this.verticalDragToForward?(r?this.setFocalOffset(this._focalOffsetEnd.x+c,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(c,0,!0),this.forward(-h,!0)):r?this.setFocalOffset(this._focalOffsetEnd.x+c,this._focalOffsetEnd.y+h,this._focalOffsetEnd.z,!0):this.truck(c,h,!0)}else if($i(this._camera)){const s=this._camera,o=i*(s.right-s.left)/s.zoom/this._elementRect.width,a=n*(s.top-s.bottom)/s.zoom/this._elementRect.height;r?this.setFocalOffset(this._focalOffsetEnd.x+o,this._focalOffsetEnd.y+a,this._focalOffsetEnd.z,!0):this.truck(o,a,!0)}},this._rotateInternal=(i,n)=>{const r=zs*this.azimuthRotateSpeed*i/this._elementRect.height,s=zs*this.polarRotateSpeed*n/this._elementRect.height;this.rotate(r,s,!0)},this._dollyInternal=(i,n,r)=>{const s=Math.pow(.95,-i*this.dollySpeed),o=this._sphericalEnd.radius*s,a=this._sphericalEnd.radius,c=a*(i>=0?-1:1);this.dollyTo(o),this.infinityDolly&&(o<this.minDistance||this.maxDistance===this.minDistance)&&(this._camera.getWorldDirection(Ze),this._targetEnd.add(Ze.normalize().multiplyScalar(c)),this._target.add(Ze.normalize().multiplyScalar(c))),this.dollyToCursor&&(this._dollyControlAmount+=this._sphericalEnd.radius-a,this.infinityDolly&&(o<this.minDistance||this.maxDistance===this.minDistance)&&(this._dollyControlAmount-=c),this._dollyControlCoord.set(n,r))},this._zoomInternal=(i,n,r)=>{const s=Math.pow(.95,i*this.dollySpeed);this.zoomTo(this._zoom*s),this.dollyToCursor&&(this._dollyControlAmount=this._zoomEnd,this._dollyControlCoord.set(n,r))},typeof Ue=="undefined"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=new Ue.Quaternion().setFromUnitVectors(this._camera.up,jl),this._yAxisUpSpaceInverse=Zp(this._yAxisUpSpace.clone()),this._state=De.NONE,this._domElement=t,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._target=new Ue.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new Ue.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new Ue.Spherical().setFromVector3(Ze.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._nearPlaneCorners=[new Ue.Vector3,new Ue.Vector3,new Ue.Vector3,new Ue.Vector3],this._updateNearPlaneCorners(),this._boundary=new Ue.Box3(new Ue.Vector3(-1/0,-1/0,-1/0),new Ue.Vector3(1/0,1/0,1/0)),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlAmount=0,this._dollyControlCoord=new Ue.Vector2,this.mouseButtons={left:De.ROTATE,middle:De.DOLLY,right:De.TRUCK,wheel:Fr(this._camera)?De.DOLLY:$i(this._camera)?De.ZOOM:De.NONE},this.touches={one:De.TOUCH_ROTATE,two:Fr(this._camera)?De.TOUCH_DOLLY_TRUCK:$i(this._camera)?De.TOUCH_ZOOM_TRUCK:De.NONE,three:De.TOUCH_TRUCK},this._domElement){const i=new Ue.Vector2,n=new Ue.Vector2,r=new Ue.Vector2,s=v=>{if(!this._enabled)return;const M={pointerId:v.pointerId,clientX:v.clientX,clientY:v.clientY,deltaX:0,deltaY:0};this._activePointers.push(M),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",f),this._domElement.ownerDocument.addEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",f),x(v)},o=v=>{if(!this._enabled)return;const M={pointerId:0,clientX:v.clientX,clientY:v.clientY,deltaX:0,deltaY:0};this._activePointers.push(M),this._domElement.ownerDocument.removeEventListener("mousemove",h),this._domElement.ownerDocument.removeEventListener("mouseup",d),this._domElement.ownerDocument.addEventListener("mousemove",h),this._domElement.ownerDocument.addEventListener("mouseup",d),x(v)},a=v=>{!this._enabled||(v.preventDefault(),Array.prototype.forEach.call(v.changedTouches,M=>{const S={pointerId:M.identifier,clientX:M.clientX,clientY:M.clientY,deltaX:0,deltaY:0};this._activePointers.push(S)}),this._domElement.ownerDocument.removeEventListener("touchmove",u,{passive:!1}),this._domElement.ownerDocument.removeEventListener("touchend",g),this._domElement.ownerDocument.addEventListener("touchmove",u,{passive:!1}),this._domElement.ownerDocument.addEventListener("touchend",g),x(v))},c=v=>{v.cancelable&&v.preventDefault();const M=v.pointerId,S=this._findPointerById(M);if(!!S){if(S.clientX=v.clientX,S.clientY=v.clientY,S.deltaX=v.movementX,S.deltaY=v.movementY,v.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=0,(v.buttons&Ot.LEFT)===Ot.LEFT&&(this._state=this._state|this.mouseButtons.left),(v.buttons&Ot.MIDDLE)===Ot.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(v.buttons&Ot.RIGHT)===Ot.RIGHT&&(this._state=this._state|this.mouseButtons.right);b()}},h=v=>{const M=this._findPointerById(0);!M||(M.clientX=v.clientX,M.clientY=v.clientY,M.deltaX=v.movementX,M.deltaY=v.movementY,this._state=0,(v.buttons&Ot.LEFT)===Ot.LEFT&&(this._state=this._state|this.mouseButtons.left),(v.buttons&Ot.MIDDLE)===Ot.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(v.buttons&Ot.RIGHT)===Ot.RIGHT&&(this._state=this._state|this.mouseButtons.right),b())},u=v=>{v.cancelable&&v.preventDefault(),Array.prototype.forEach.call(v.changedTouches,M=>{const S=M.identifier,w=this._findPointerById(S);!w||(w.clientX=M.clientX,w.clientY=M.clientY)}),b()},f=v=>{const M=v.pointerId,S=this._findPointerById(M);if(S&&this._activePointers.splice(this._activePointers.indexOf(S),1),v.pointerType==="touch")switch(this._activePointers.length){case 0:this._state=De.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=De.NONE;y()},d=()=>{const v=this._findPointerById(0);v&&this._activePointers.splice(this._activePointers.indexOf(v),1),this._state=De.NONE,y()},g=v=>{switch(Array.prototype.forEach.call(v.changedTouches,M=>{const S=M.identifier,w=this._findPointerById(S);w&&this._activePointers.splice(this._activePointers.indexOf(w),1)}),this._activePointers.length){case 0:this._state=De.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}y()};let p=-1;const m=v=>{if(!this._enabled||this.mouseButtons.wheel===De.NONE)return;if(v.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===De.ROTATE||this.mouseButtons.wheel===De.TRUCK){const R=performance.now();p-R<1e3&&this._getClientRect(this._elementRect),p=R}const M=Xw?-1:-3,S=v.deltaMode===1?v.deltaY/M:v.deltaY/(M*10),w=this.dollyToCursor?(v.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,T=this.dollyToCursor?(v.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case De.ROTATE:{this._rotateInternal(v.deltaX,v.deltaY);break}case De.TRUCK:{this._truckInternal(v.deltaX,v.deltaY,!1);break}case De.OFFSET:{this._truckInternal(v.deltaX,v.deltaY,!0);break}case De.DOLLY:{this._dollyInternal(-S,w,T);break}case De.ZOOM:{this._zoomInternal(-S,w,T);break}}this.dispatchEvent({type:"control"})},_=v=>{!this._enabled||v.preventDefault()},x=v=>{if(!this._enabled)return;if(Gh(this._activePointers,an),this._getClientRect(this._elementRect),i.copy(an),n.copy(an),this._activePointers.length>=2){const S=an.x-this._activePointers[1].clientX,w=an.y-this._activePointers[1].clientY,T=Math.sqrt(S*S+w*w);r.set(0,T);const R=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,D=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;n.set(R,D)}if("touches"in v||"pointerType"in v&&v.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=0,(v.buttons&Ot.LEFT)===Ot.LEFT&&(this._state=this._state|this.mouseButtons.left),(v.buttons&Ot.MIDDLE)===Ot.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(v.buttons&Ot.RIGHT)===Ot.RIGHT&&(this._state=this._state|this.mouseButtons.right);this.dispatchEvent({type:"controlstart"})},b=()=>{if(!this._enabled)return;Gh(this._activePointers,an);const v=this._domElement&&document.pointerLockElement===this._domElement,M=v?-this._activePointers[0].deltaX:n.x-an.x,S=v?-this._activePointers[0].deltaY:n.y-an.y;if(n.copy(an),((this._state&De.ROTATE)===De.ROTATE||(this._state&De.TOUCH_ROTATE)===De.TOUCH_ROTATE)&&this._rotateInternal(M,S),(this._state&De.DOLLY)===De.DOLLY||(this._state&De.ZOOM)===De.ZOOM){const w=this.dollyToCursor?(i.x-this._elementRect.x)/this._elementRect.width*2-1:0,T=this.dollyToCursor?(i.y-this._elementRect.y)/this._elementRect.height*-2+1:0;this._state===De.DOLLY?this._dollyInternal(S*Zl,w,T):this._zoomInternal(S*Zl,w,T)}if((this._state&De.TOUCH_DOLLY)===De.TOUCH_DOLLY||(this._state&De.TOUCH_ZOOM)===De.TOUCH_ZOOM||(this._state&De.TOUCH_DOLLY_TRUCK)===De.TOUCH_DOLLY_TRUCK||(this._state&De.TOUCH_ZOOM_TRUCK)===De.TOUCH_ZOOM_TRUCK||(this._state&De.TOUCH_DOLLY_OFFSET)===De.TOUCH_DOLLY_OFFSET||(this._state&De.TOUCH_ZOOM_OFFSET)===De.TOUCH_ZOOM_OFFSET){const w=an.x-this._activePointers[1].clientX,T=an.y-this._activePointers[1].clientY,R=Math.sqrt(w*w+T*T),D=r.y-R;r.set(0,R);const I=this.dollyToCursor?(n.x-this._elementRect.x)/this._elementRect.width*2-1:0,U=this.dollyToCursor?(n.y-this._elementRect.y)/this._elementRect.height*-2+1:0;this._state===De.TOUCH_DOLLY||this._state===De.TOUCH_DOLLY_TRUCK||this._state===De.TOUCH_DOLLY_OFFSET?this._dollyInternal(D*Zl,I,U):this._zoomInternal(D*Zl,I,U)}((this._state&De.TRUCK)===De.TRUCK||(this._state&De.TOUCH_TRUCK)===De.TOUCH_TRUCK||(this._state&De.TOUCH_DOLLY_TRUCK)===De.TOUCH_DOLLY_TRUCK||(this._state&De.TOUCH_ZOOM_TRUCK)===De.TOUCH_ZOOM_TRUCK)&&this._truckInternal(M,S,!1),((this._state&De.OFFSET)===De.OFFSET||(this._state&De.TOUCH_OFFSET)===De.TOUCH_OFFSET||(this._state&De.TOUCH_DOLLY_OFFSET)===De.TOUCH_DOLLY_OFFSET||(this._state&De.TOUCH_ZOOM_OFFSET)===De.TOUCH_ZOOM_OFFSET)&&this._truckInternal(M,S,!0),this.dispatchEvent({type:"control"})},y=()=>{Gh(this._activePointers,an),n.copy(an),this._activePointers.length===0&&(this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",f),this._domElement.ownerDocument.removeEventListener("touchmove",u,{passive:!1}),this._domElement.ownerDocument.removeEventListener("touchend",g),this.dispatchEvent({type:"controlend"}))};this._domElement.addEventListener("pointerdown",s),jp&&this._domElement.addEventListener("mousedown",o),jp&&this._domElement.addEventListener("touchstart",a),this._domElement.addEventListener("pointercancel",f),this._domElement.addEventListener("wheel",m,{passive:!1}),this._domElement.addEventListener("contextmenu",_),this._removeAllEventListeners=()=>{this._domElement.removeEventListener("pointerdown",s),this._domElement.removeEventListener("mousedown",o),this._domElement.removeEventListener("touchstart",a),this._domElement.removeEventListener("pointercancel",f),this._domElement.removeEventListener("wheel",m,{passive:!1}),this._domElement.removeEventListener("contextmenu",_),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",h),this._domElement.ownerDocument.removeEventListener("touchmove",u,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",f),this._domElement.ownerDocument.removeEventListener("mouseup",d),this._domElement.ownerDocument.removeEventListener("touchend",g)},this.cancel=()=>{this._state!==De.NONE&&(this._state=De.NONE,this._activePointers.length=0,y())}}this.update(0)}static install(e){Ue=e.THREE,Jp=Object.freeze(new Ue.Vector3(0,0,0)),jl=Object.freeze(new Ue.Vector3(0,1,0)),Hh=Object.freeze(new Ue.Vector3(0,0,1)),an=new Ue.Vector2,Ze=new Ue.Vector3,at=new Ue.Vector3,Gs=new Ue.Vector3,ni=new Ue.Vector3,ii=new Ue.Vector3,Or=new Ue.Vector3,Kp=new Ue.Vector3,Qp=new Ue.Vector3,Wn=new Ue.Spherical,ia=new Ue.Spherical,Qs=new Ue.Box3,$p=new Ue.Box3,Wh=new Ue.Sphere,em=new Ue.Quaternion,Xh=new Ue.Quaternion,qh=new Ue.Matrix4,Jl=new Ue.Raycaster}static get ACTION(){return De}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="")}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t,i=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,i)}rotateAzimuthTo(e,t=!1){return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e,t=!1){return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t,i=!1){const n=Ue.MathUtils.clamp(e,this.minAzimuthAngle,this.maxAzimuthAngle),r=Ue.MathUtils.clamp(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=n,this._sphericalEnd.phi=r,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,i||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const s=!i||mt(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&mt(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(s)}dolly(e,t=!1){return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e,t=!1){const i=this._sphericalEnd.radius,n=Ue.MathUtils.clamp(e,this.minDistance,this.maxDistance);if(this.colliderMeshes.length>=1){const o=this._collisionTest(),a=mt(o,this._spherical.radius);if(!(i>n)&&a)return Promise.resolve();this._sphericalEnd.radius=Math.min(n,o)}else this._sphericalEnd.radius=n;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);const s=!t||mt(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(s)}zoom(e,t=!1){return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e,t=!1){this._zoomEnd=Ue.MathUtils.clamp(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);const i=!t||mt(this._zoom,this._zoomEnd,this.restThreshold);return this._createOnRestPromise(i)}pan(e,t,i=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,i)}truck(e,t,i=!1){this._camera.updateMatrix(),ni.setFromMatrixColumn(this._camera.matrix,0),ii.setFromMatrixColumn(this._camera.matrix,1),ni.multiplyScalar(e),ii.multiplyScalar(-t);const n=Ze.copy(ni).add(ii),r=at.copy(this._targetEnd).add(n);return this.moveTo(r.x,r.y,r.z,i)}forward(e,t=!1){Ze.setFromMatrixColumn(this._camera.matrix,0),Ze.crossVectors(this._camera.up,Ze),Ze.multiplyScalar(e);const i=at.copy(this._targetEnd).add(Ze);return this.moveTo(i.x,i.y,i.z,t)}moveTo(e,t,i,n=!1){const r=Ze.set(e,t,i).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,r,this.boundaryFriction),this._needsUpdate=!0,n||this._target.copy(this._targetEnd);const s=!n||mt(this._target.x,this._targetEnd.x,this.restThreshold)&&mt(this._target.y,this._targetEnd.y,this.restThreshold)&&mt(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(s)}fitToBox(e,t,{cover:i=!1,paddingLeft:n=0,paddingRight:r=0,paddingBottom:s=0,paddingTop:o=0}={}){const a=[],c=e.isBox3?Qs.copy(e):Qs.setFromObject(e);c.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const h=Yp(this._sphericalEnd.theta,qp),u=Yp(this._sphericalEnd.phi,qp);a.push(this.rotateTo(h,u,t));const f=Ze.setFromSpherical(this._sphericalEnd).normalize(),d=em.setFromUnitVectors(f,Hh),g=mt(Math.abs(f.y),1);g&&d.multiply(Xh.setFromAxisAngle(jl,h)),d.multiply(this._yAxisUpSpaceInverse);const p=$p.makeEmpty();at.copy(c.min).applyQuaternion(d),p.expandByPoint(at),at.copy(c.min).setX(c.max.x).applyQuaternion(d),p.expandByPoint(at),at.copy(c.min).setY(c.max.y).applyQuaternion(d),p.expandByPoint(at),at.copy(c.max).setZ(c.min.z).applyQuaternion(d),p.expandByPoint(at),at.copy(c.min).setZ(c.max.z).applyQuaternion(d),p.expandByPoint(at),at.copy(c.max).setY(c.min.y).applyQuaternion(d),p.expandByPoint(at),at.copy(c.max).setX(c.min.x).applyQuaternion(d),p.expandByPoint(at),at.copy(c.max).applyQuaternion(d),p.expandByPoint(at),p.min.x-=n,p.min.y-=s,p.max.x+=r,p.max.y+=o,d.setFromUnitVectors(Hh,f),g&&d.premultiply(Xh.invert()),d.premultiply(this._yAxisUpSpace);const m=p.getSize(Ze),_=p.getCenter(at).applyQuaternion(d);if(Fr(this._camera)){const x=this.getDistanceToFitBox(m.x,m.y,m.z,i);a.push(this.moveTo(_.x,_.y,_.z,t)),a.push(this.dollyTo(x,t)),a.push(this.setFocalOffset(0,0,0,t))}else if($i(this._camera)){const x=this._camera,b=x.right-x.left,y=x.top-x.bottom,v=i?Math.max(b/m.x,y/m.y):Math.min(b/m.x,y/m.y);a.push(this.moveTo(_.x,_.y,_.z,t)),a.push(this.zoomTo(v,t)),a.push(this.setFocalOffset(0,0,0,t))}return Promise.all(a)}fitToSphere(e,t){const i=[],r=e instanceof Ue.Sphere?Wh.copy(e):qw(e,Wh);if(i.push(this.moveTo(r.center.x,r.center.y,r.center.z,t)),Fr(this._camera)){const s=this.getDistanceToFitSphere(r.radius);i.push(this.dollyTo(s,t))}else if($i(this._camera)){const s=this._camera.right-this._camera.left,o=this._camera.top-this._camera.bottom,a=2*r.radius,c=Math.min(s/a,o/a);i.push(this.zoomTo(c,t))}return i.push(this.setFocalOffset(0,0,0,t)),Promise.all(i)}setLookAt(e,t,i,n,r,s,o=!1){const a=at.set(n,r,s),c=Ze.set(e,t,i);this._targetEnd.copy(a),this._sphericalEnd.setFromVector3(c.sub(a).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,o||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const h=!o||mt(this._target.x,this._targetEnd.x,this.restThreshold)&&mt(this._target.y,this._targetEnd.y,this.restThreshold)&&mt(this._target.z,this._targetEnd.z,this.restThreshold)&&mt(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&mt(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&mt(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(h)}lerpLookAt(e,t,i,n,r,s,o,a,c,h,u,f,d,g=!1){const p=Ze.set(n,r,s),m=at.set(e,t,i);Wn.setFromVector3(m.sub(p).applyQuaternion(this._yAxisUpSpace));const _=Gs.set(h,u,f),x=at.set(o,a,c);ia.setFromVector3(x.sub(_).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(p.lerp(_,d));const b=ia.theta-Wn.theta,y=ia.phi-Wn.phi,v=ia.radius-Wn.radius;this._sphericalEnd.set(Wn.radius+v*d,Wn.phi+y*d,Wn.theta+b*d),this.normalizeRotations(),this._needsUpdate=!0,g||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const M=!g||mt(this._target.x,this._targetEnd.x,this.restThreshold)&&mt(this._target.y,this._targetEnd.y,this.restThreshold)&&mt(this._target.z,this._targetEnd.z,this.restThreshold)&&mt(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&mt(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&mt(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(M)}setPosition(e,t,i,n=!1){return this.setLookAt(e,t,i,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,n)}setTarget(e,t,i,n=!1){const r=this.getPosition(Ze);return this.setLookAt(r.x,r.y,r.z,e,t,i,n)}setFocalOffset(e,t,i,n=!1){this._focalOffsetEnd.set(e,t,i),this._needsUpdate=!0,n||this._focalOffset.copy(this._focalOffsetEnd);const r=!n||mt(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&mt(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&mt(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(r)}setOrbitPoint(e,t,i){ni.setFromMatrixColumn(this._camera.matrixWorldInverse,0),ii.setFromMatrixColumn(this._camera.matrixWorldInverse,1),Or.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const n=Ze.set(e,t,i),r=n.distanceTo(this._camera.position),s=n.sub(this._camera.position);ni.multiplyScalar(s.x),ii.multiplyScalar(s.y),Or.multiplyScalar(s.z),Ze.copy(ni).add(ii).add(Or),Ze.z=Ze.z+r,this.dollyTo(r,!1),this.setFocalOffset(-Ze.x,Ze.y,-Ze.z,!1),this.moveTo(e,t,i,!1)}setBoundary(e){if(!e){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,i,n){if(e===null){this._viewport=null;return}this._viewport=this._viewport||new Ue.Vector4,typeof e=="number"?this._viewport.set(e,t,i,n):this._viewport.copy(e)}getDistanceToFitBox(e,t,i,n=!1){if(Vh(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const r=e/t,s=this._camera.getEffectiveFOV()*Ue.MathUtils.DEG2RAD,o=this._camera.aspect;return((n?r>o:r<o)?t:e/o)*.5/Math.tan(s*.5)+i*.5}getDistanceToFitSphere(e){if(Vh(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const t=this._camera.getEffectiveFOV()*Ue.MathUtils.DEG2RAD,i=Math.atan(Math.tan(t*.5)*this._camera.aspect)*2,n=1<this._camera.aspect?t:i;return e/Math.sin(n*.5)}getTarget(e){return(!!e&&e.isVector3?e:new Ue.Vector3).copy(this._targetEnd)}getPosition(e){return(!!e&&e.isVector3?e:new Ue.Vector3).setFromSpherical(this._sphericalEnd).applyQuaternion(this._yAxisUpSpaceInverse).add(this._targetEnd)}getFocalOffset(e){return(!!e&&e.isVector3?e:new Ue.Vector3).copy(this._focalOffsetEnd)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%zs,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=zs),this._spherical.theta+=zs*Math.round((this._sphericalEnd.theta-this._spherical.theta)/zs)}reset(e=!1){const t=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)];return Promise.all(t)}saveState(){this._target0.copy(this._target),this._position0.copy(this._camera.position),this._zoom0=this._zoom}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,jl),Zp(this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace))}update(e){const t=this._state===De.NONE?this.dampingFactor:this.draggingDampingFactor,i=Math.min(t*e*60,1),n=this._sphericalEnd.theta-this._spherical.theta,r=this._sphericalEnd.phi-this._spherical.phi,s=this._sphericalEnd.radius-this._spherical.radius,o=Kp.subVectors(this._targetEnd,this._target),a=Qp.subVectors(this._focalOffsetEnd,this._focalOffset);if(!ut(n)||!ut(r)||!ut(s)||!ut(o.x)||!ut(o.y)||!ut(o.z)||!ut(a.x)||!ut(a.y)||!ut(a.z)?(this._spherical.set(this._spherical.radius+s*i,this._spherical.phi+r*i,this._spherical.theta+n*i),this._target.add(o.multiplyScalar(i)),this._focalOffset.add(a.multiplyScalar(i)),this._needsUpdate=!0):(this._spherical.copy(this._sphericalEnd),this._target.copy(this._targetEnd),this._focalOffset.copy(this._focalOffsetEnd)),this._dollyControlAmount!==0){if(Fr(this._camera)){const d=this._camera,g=Ze.setFromSpherical(this._sphericalEnd).applyQuaternion(this._yAxisUpSpaceInverse).normalize().negate(),p=at.copy(g).cross(d.up).normalize();p.lengthSq()===0&&(p.x=1);const m=Gs.crossVectors(p,g),_=this._sphericalEnd.radius*Math.tan(d.getEffectiveFOV()*Ue.MathUtils.DEG2RAD*.5),b=(this._sphericalEnd.radius-this._dollyControlAmount-this._sphericalEnd.radius)/this._sphericalEnd.radius,y=Ze.copy(this._targetEnd).add(p.multiplyScalar(this._dollyControlCoord.x*_*d.aspect)).add(m.multiplyScalar(this._dollyControlCoord.y*_));this._targetEnd.lerp(y,b),this._target.copy(this._targetEnd)}else if($i(this._camera)){const d=this._camera,g=Ze.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(d.near+d.far)/(d.near-d.far)).unproject(d),p=at.set(0,0,-1).applyQuaternion(d.quaternion),m=p.dot(d.up),_=ut(m)?-g.dot(d.up):-g.dot(d.up)/m,x=Gs.copy(g).add(p.multiplyScalar(_));this._targetEnd.lerp(x,1-d.zoom/this._dollyControlAmount),this._target.copy(this._targetEnd)}this._dollyControlAmount=0}const c=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,c),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!ut(this._focalOffset.x)||!ut(this._focalOffset.y)||!ut(this._focalOffset.z))&&(this._camera.updateMatrix(),ni.setFromMatrixColumn(this._camera.matrix,0),ii.setFromMatrixColumn(this._camera.matrix,1),Or.setFromMatrixColumn(this._camera.matrix,2),ni.multiplyScalar(this._focalOffset.x),ii.multiplyScalar(-this._focalOffset.y),Or.multiplyScalar(this._focalOffset.z),Ze.copy(ni).add(ii).add(Or),this._camera.position.add(Ze)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),Ze.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const u=this._zoomEnd-this._zoom;this._zoom+=u*i,this._camera.zoom!==this._zoom&&(ut(u)&&(this._zoom=this._zoomEnd),this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0);const f=this._needsUpdate;return f&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):f?(this.dispatchEvent({type:"update"}),ut(n,this.restThreshold)&&ut(r,this.restThreshold)&&ut(s,this.restThreshold)&&ut(o.x,this.restThreshold)&&ut(o.y,this.restThreshold)&&ut(o.z,this.restThreshold)&&ut(a.x,this.restThreshold)&&ut(a.y,this.restThreshold)&&ut(a.z,this.restThreshold)&&ut(u,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!f&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._updatedLastTime=f,this._needsUpdate=!1,f}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:ta(this.maxDistance),minZoom:this.minZoom,maxZoom:ta(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:ta(this.maxPolarAngle),minAzimuthAngle:ta(this.minAzimuthAngle),maxAzimuthAngle:ta(this.maxAzimuthAngle),dampingFactor:this.dampingFactor,draggingDampingFactor:this.draggingDampingFactor,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:Ze.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,t=!1){const i=JSON.parse(e),n=Ze.fromArray(i.position);this.enabled=i.enabled,this.minDistance=i.minDistance,this.maxDistance=na(i.maxDistance),this.minZoom=i.minZoom,this.maxZoom=na(i.maxZoom),this.minPolarAngle=i.minPolarAngle,this.maxPolarAngle=na(i.maxPolarAngle),this.minAzimuthAngle=na(i.minAzimuthAngle),this.maxAzimuthAngle=na(i.maxAzimuthAngle),this.dampingFactor=i.dampingFactor,this.draggingDampingFactor=i.draggingDampingFactor,this.dollySpeed=i.dollySpeed,this.truckSpeed=i.truckSpeed,this.dollyToCursor=i.dollyToCursor,this.verticalDragToForward=i.verticalDragToForward,this._target0.fromArray(i.target0),this._position0.fromArray(i.position0),this._zoom0=i.zoom0,this._focalOffset0.fromArray(i.focalOffset0),this.moveTo(i.target[0],i.target[1],i.target[2],t),Wn.setFromVector3(n.sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(Wn.theta,Wn.phi,t),this.zoomTo(i.zoom,t),this.setFocalOffset(i.focalOffset[0],i.focalOffset[1],i.focalOffset[2],t),this._needsUpdate=!0}dispose(){this._removeAllEventListeners()}_findPointerById(e){let t=null;return this._activePointers.some(i=>i.pointerId===e?(t=i,!0):!1),t}_encloseToBoundary(e,t,i){const n=t.lengthSq();if(n===0)return e;const r=at.copy(t).add(e),o=this._boundary.clampPoint(r,Gs).sub(r),a=o.lengthSq();if(a===0)return e.add(t);if(a===n)return e;if(i===0)return e.add(t).add(o);{const c=1+i*a/t.dot(o);return e.add(at.copy(t).multiplyScalar(c)).add(o.multiplyScalar(1-i))}}_updateNearPlaneCorners(){if(Fr(this._camera)){const e=this._camera,t=e.near,i=e.getEffectiveFOV()*Ue.MathUtils.DEG2RAD,n=Math.tan(i*.5)*t,r=n*e.aspect;this._nearPlaneCorners[0].set(-r,-n,0),this._nearPlaneCorners[1].set(r,-n,0),this._nearPlaneCorners[2].set(r,n,0),this._nearPlaneCorners[3].set(-r,n,0)}else if($i(this._camera)){const e=this._camera,t=1/e.zoom,i=e.left*t,n=e.right*t,r=e.top*t,s=e.bottom*t;this._nearPlaneCorners[0].set(i,r,0),this._nearPlaneCorners[1].set(n,r,0),this._nearPlaneCorners[2].set(n,s,0),this._nearPlaneCorners[3].set(i,s,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||Vh(this._camera,"_collisionTest"))return e;const i=Ze.setFromSpherical(this._spherical).divideScalar(this._spherical.radius);qh.lookAt(Jp,i,this._camera.up);for(let n=0;n<4;n++){const r=at.copy(this._nearPlaneCorners[n]);r.applyMatrix4(qh);const s=Gs.addVectors(this._target,r);Jl.set(s,i),Jl.far=this._spherical.radius+1;const o=Jl.intersectObjects(this.colliderMeshes);o.length!==0&&o[0].distance<e&&(e=o[0].distance)}return e}_getClientRect(e){const t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(t=>{const i=()=>{this.removeEventListener("rest",i),t()};this.addEventListener("rest",i)}))}_removeAllEventListeners(){}}function qw(l,e){const t=e,i=t.center;Qs.makeEmpty(),l.traverseVisible(r=>{!r.isMesh||Qs.expandByObject(r)}),Qs.getCenter(i);let n=0;return l.traverseVisible(r=>{if(!r.isMesh)return;const s=r,o=s.geometry.clone();if(o.applyMatrix4(s.matrixWorld),o.isBufferGeometry){const c=o.attributes.position;for(let h=0,u=c.count;h<u;h++)Ze.fromBufferAttribute(c,h),n=Math.max(n,i.distanceToSquared(Ze))}else{const a=o.attributes.position,c=new Ue.Vector3;for(let h=0,u=a.count;h<u;h++)c.fromBufferAttribute(a,h),n=Math.max(n,i.distanceToSquared(c))}}),t.radius=Math.sqrt(n),t}Ug.install({THREE:Nw});class Yw extends Ug{constructor(t,i){super(t,i.domElement);Ce(this,"animate",!0);this.setTarget(0,0,0),this.updateCameraUp(),this.dampingFactor=.07,this.restThreshold=.5}async navigateTo(t){this.targetObject=t,this.removeControlBoundaries(),this.setPosition(-100,100,100,this.animate),await this.setTarget(t.position.x,t.position.y,t.position.z,this.animate),await this.fitToBox(t,this.animate),this.setControlBoundaries()}removeControlBoundaries(){this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minDistance=0,this.maxDistance=1/0,this.enabled=!1}setControlBoundaries(){const t=Math.PI/4;this.minAzimuthAngle=this.azimuthAngle-t,this.maxAzimuthAngle=this.azimuthAngle+t,this.minPolarAngle=0+t,this.maxPolarAngle=Math.PI-t,this.minDistance=this.distance,this.maxDistance=this.distance,this.enabled=!0}}const Zw=document.querySelector("#three");class jw extends _f{constructor(){super({canvas:Zw,antialias:!0}),this.setPixelRatio(window.devicePixelRatio),this.setSize(window.innerWidth,window.innerHeight)}}const tm=new L,Jw=new jt,nm=new L;class Kw extends $e{constructor(e=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof Element&&t.element.parentNode!==null&&t.element.parentNode.removeChild(t.element)})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this}}const ri=new Ne,Qw=new Ne;class $w{constructor(e={}){const t=this;let i,n,r,s;const o={camera:{fov:0,style:""},objects:new WeakMap},a=e.element!==void 0?e.element:document.createElement("div");a.style.overflow="hidden",this.domElement=a;const c=document.createElement("div");c.style.transformStyle="preserve-3d",c.style.pointerEvents="none",a.appendChild(c),this.getSize=function(){return{width:i,height:n}},this.render=function(g,p){const m=p.projectionMatrix.elements[5]*s;o.camera.fov!==m&&(a.style.perspective=p.isPerspectiveCamera?m+"px":"",o.camera.fov=m),g.autoUpdate===!0&&g.updateMatrixWorld(),p.parent===null&&p.updateMatrixWorld();let _,x;p.isOrthographicCamera&&(_=-(p.right+p.left)/2,x=(p.top+p.bottom)/2);const y=(p.isOrthographicCamera?"scale("+m+")translate("+h(_)+"px,"+h(x)+"px)"+u(p.matrixWorldInverse):"translateZ("+m+"px)"+u(p.matrixWorldInverse))+"translate("+r+"px,"+s+"px)";o.camera.style!==y&&(c.style.transform=y,o.camera.style=y),d(g,g,p)},this.setSize=function(g,p){i=g,n=p,r=i/2,s=n/2,a.style.width=g+"px",a.style.height=p+"px",c.style.width=g+"px",c.style.height=p+"px"};function h(g){return Math.abs(g)<1e-10?0:g}function u(g){const p=g.elements;return"matrix3d("+h(p[0])+","+h(-p[1])+","+h(p[2])+","+h(p[3])+","+h(p[4])+","+h(-p[5])+","+h(p[6])+","+h(p[7])+","+h(p[8])+","+h(-p[9])+","+h(p[10])+","+h(p[11])+","+h(p[12])+","+h(-p[13])+","+h(p[14])+","+h(p[15])+")"}function f(g){const p=g.elements,m="matrix3d("+h(p[0])+","+h(p[1])+","+h(p[2])+","+h(p[3])+","+h(-p[4])+","+h(-p[5])+","+h(-p[6])+","+h(-p[7])+","+h(p[8])+","+h(p[9])+","+h(p[10])+","+h(p[11])+","+h(p[12])+","+h(p[13])+","+h(p[14])+","+h(p[15])+")";return"translate(-50%,-50%)"+m}function d(g,p,m,_){if(g.isCSS3DObject){const x=g.visible===!0&&g.layers.test(m.layers)===!0;if(g.element.style.display=x===!0?"":"none",x===!0){g.onBeforeRender(t,p,m);let b;g.isCSS3DSprite?(ri.copy(m.matrixWorldInverse),ri.transpose(),g.rotation2D!==0&&ri.multiply(Qw.makeRotationZ(g.rotation2D)),g.matrixWorld.decompose(tm,Jw,nm),ri.setPosition(tm),ri.scale(nm),ri.elements[3]=0,ri.elements[7]=0,ri.elements[11]=0,ri.elements[15]=1,b=f(ri)):b=f(g.matrixWorld);const y=g.element,v=o.objects.get(g);if(v===void 0||v.style!==b){y.style.transform=b;const M={style:b};o.objects.set(g,M)}y.parentNode!==c&&c.appendChild(y),g.onAfterRender(t,p,m)}}for(let x=0,b=g.children.length;x<b;x++)d(g.children[x],p,m)}}}const eM=document.querySelector("#app");class tM extends $w{constructor(){super({element:eM}),this.setSize(window.innerWidth,window.innerHeight)}}class im extends xf{constructor(){super(),this.background=new Ae(16777215),this.scale.set(10,10,10)}}class nM extends ht{constructor(){super();Ce(this,"size",50);Ce(this,"height",this.size/2);this.geometry=new fi(this.size,this.height,this.size),this.material=new ps({color:7566195,side:tn}),this.position.setY(this.height/2)}}class iM extends ht{constructor(e,t){super();const i=.65;this.geometry=new Zn(t.x*i,t.y*i),this.material=new kt({color:16777215});const n=new Wg(e.title,t.y/2);this.position.setX(-t.z/2),this.rotateY(-Math.PI/2),this.add(n)}}function Vf(){var l=0,e=[],t,i=0,n=0;function r(_,x){var b=Vf();function y(){var v=l>0?_:x;if(p(v))try{var M=v(t);M===b&&g();var S=f(M);S?S.call(M,b.resolve,b.reject):b.resolve(M)}catch(w){b.reject(w)}else b[l>0?"resolve":"reject"](t)}return e.push(y),l&&c(),b}var s=d(function(_){n||a(1,_)}),o=d(function(_){n||a(-1,_)});function a(_,x){n++;var b=0;try{x===m&&g();var y=_>0&&f(x);y?y.call(x,d(function(v){b++,a(1,v)}),d(function(v){b++,a(-1,v)})):(l=_,t=x,c())}catch(v){!l&&!b&&a(-1,v)}}function c(){i||(setTimeout(h,0),i=1)}function h(){var _=e;i=0,e=[],_.forEach(u)}function u(_){_()}function f(_){var x=_&&(p(_)||typeof _=="object")&&_.then;return p(x)&&x}function d(_){var x=0;return function(){for(var b=[],y=arguments.length;y--;)b[y]=arguments[y];x++||_.apply(this,b)}}function g(){throw new TypeError("Chaining cycle detected")}var p=function(_){return typeof _=="function"},m={then:r,resolve:s,reject:o};return m}function kg(){var l,e,t=new Promise(function(i,n){l=i,e=n});return{then:t.then.bind(t),resolve:l,reject:e}}Vf.all=kg.all=function(l){var e=0,t=[],i=Ii();return l.length===0?i.resolve([]):l.forEach(function(n,r){var s=Ii();s.resolve(n),s.then(function(o){e++,t[r]=o,e===l.length&&i.resolve(t)},i.reject)}),i};var Ii=typeof Promise=="function"?kg:Vf;function rM(){var l=Object.create(null);function e(n,r){var s=n.id,o=n.name,a=n.dependencies;a===void 0&&(a=[]);var c=n.init;c===void 0&&(c=function(){});var h=n.getTransferables;if(h===void 0&&(h=null),!l[s])try{a=a.map(function(f){return f&&f.isWorkerModule&&(e(f,function(d){if(d instanceof Error)throw d}),f=l[f.id].value),f}),c=i("<"+o+">.init",c),h&&(h=i("<"+o+">.getTransferables",h));var u=null;typeof c=="function"?u=c.apply(void 0,a):console.error("worker module init function failed to rehydrate"),l[s]={id:s,value:u,getTransferables:h},r(u)}catch(f){f&&f.noLog||console.error(f),r(f)}}function t(n,r){var s,o=n.id,a=n.args;(!l[o]||typeof l[o].value!="function")&&r(new Error("Worker module "+o+": not found or its 'init' did not return a function"));try{var c=(s=l[o]).value.apply(s,a);c&&typeof c.then=="function"?c.then(h,function(u){return r(u instanceof Error?u:new Error(""+u))}):h(c)}catch(u){r(u)}function h(u){try{var f=l[o].getTransferables&&l[o].getTransferables(u);(!f||!Array.isArray(f)||!f.length)&&(f=void 0),r(u,f)}catch(d){console.error(d),r(d)}}}function i(n,r){var s=void 0;self.troikaDefine=function(a){return s=a};var o=URL.createObjectURL(new Blob(["/** "+n.replace(/\*/g,"")+` **/

troikaDefine(
`+r+`
)`],{type:"application/javascript"}));try{importScripts(o)}catch(a){console.error(a)}return URL.revokeObjectURL(o),delete self.troikaDefine,s}self.addEventListener("message",function(n){var r=n.data,s=r.messageId,o=r.action,a=r.data;try{o==="registerModule"&&e(a,function(c){c instanceof Error?postMessage({messageId:s,success:!1,error:c.message}):postMessage({messageId:s,success:!0,result:{isCallable:typeof c=="function"}})}),o==="callModule"&&t(a,function(c,h){c instanceof Error?postMessage({messageId:s,success:!1,error:c.message}):postMessage({messageId:s,success:!0,result:c},h||void 0)})}catch(c){postMessage({messageId:s,success:!1,error:c.stack})}})}function sM(l){var e=function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];return e._getInitResult().then(function(n){if(typeof n=="function")return n.apply(void 0,t);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var t=l.dependencies,i=l.init;t=Array.isArray(t)?t.map(function(r){return r&&r._getInitResult?r._getInitResult():r}):[];var n=Ii.all(t).then(function(r){return i.apply(null,r)});return e._getInitResult=function(){return n},n},e}var Ng=function(){var l=!1;if(typeof window!="undefined"&&typeof window.document!="undefined")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),l=!0}catch(t){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+t.message+"]")}return Ng=function(){return l},l},oM=0,aM=0,Yh=!1,pa=Object.create(null),ma=Object.create(null),zu=Object.create(null);function Fo(l){if((!l||typeof l.init!="function")&&!Yh)throw new Error("requires `options.init` function");var e=l.dependencies,t=l.init,i=l.getTransferables,n=l.workerId;if(!Ng())return sM(l);n==null&&(n="#default");var r="workerModule"+ ++oM,s=l.name||r,o=null;e=e&&e.map(function(c){return typeof c=="function"&&!c.workerModuleData&&(Yh=!0,c=Fo({workerId:n,name:"<"+s+"> function dependency: "+c.name,init:`function(){return (
`+lc(c)+`
)}`}),Yh=!1),c&&c.workerModuleData&&(c=c.workerModuleData),c});function a(){for(var c=[],h=arguments.length;h--;)c[h]=arguments[h];if(!o){o=rm(n,"registerModule",a.workerModuleData);var u=function(){o=null,ma[n].delete(u)};(ma[n]||(ma[n]=new Set)).add(u)}return o.then(function(f){var d=f.isCallable;if(d)return rm(n,"callModule",{id:r,args:c});throw new Error("Worker module function was called but `init` did not return a callable function")})}return a.workerModuleData={isWorkerModule:!0,id:r,name:s,dependencies:e,init:lc(t),getTransferables:i&&lc(i)},a}function lM(l){ma[l]&&ma[l].forEach(function(e){e()}),pa[l]&&(pa[l].terminate(),delete pa[l])}function lc(l){var e=l.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function cM(l){var e=pa[l];if(!e){var t=lc(rM);e=pa[l]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+l.replace(/\*/g,"")+` **/

;(`+t+")()"],{type:"application/javascript"}))),e.onmessage=function(i){var n=i.data,r=n.messageId,s=zu[r];if(!s)throw new Error("WorkerModule response with empty or unknown messageId");delete zu[r],s(n)}}return e}function rm(l,e,t){var i=Ii(),n=++aM;return zu[n]=function(r){r.success?i.resolve(r.result):i.reject(new Error("Error in worker "+e+" call: "+r.error))},cM(l).postMessage({messageId:n,action:e,data:t}),i}var hM=Fo({name:"Thenable",dependencies:[Ii],init:function(l){return l}});function Bg(){var l=function(e){function t(k,V,F,z,X,j,K,G){var ee=1-K;G.x=ee*ee*k+2*ee*K*F+K*K*X,G.y=ee*ee*V+2*ee*K*z+K*K*j}function i(k,V,F,z,X,j,K,G,ee,ne){var de=1-ee;ne.x=de*de*de*k+3*de*de*ee*F+3*de*ee*ee*X+ee*ee*ee*K,ne.y=de*de*de*V+3*de*de*ee*z+3*de*ee*ee*j+ee*ee*ee*G}function n(k,V){for(var F=/([MLQCZ])([^MLQCZ]*)/g,z,X,j,K,G;z=F.exec(k);){var ee=z[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(ne){return parseFloat(ne)});switch(z[1]){case"M":K=X=ee[0],G=j=ee[1];break;case"L":(ee[0]!==K||ee[1]!==G)&&V("L",K,G,K=ee[0],G=ee[1]);break;case"Q":{V("Q",K,G,K=ee[2],G=ee[3],ee[0],ee[1]);break}case"C":{V("C",K,G,K=ee[4],G=ee[5],ee[0],ee[1],ee[2],ee[3]);break}case"Z":(K!==X||G!==j)&&V("L",K,G,X,j);break}}}function r(k,V,F){F===void 0&&(F=16);var z={x:0,y:0};n(k,function(X,j,K,G,ee,ne,de,le,ge){switch(X){case"L":V(j,K,G,ee);break;case"Q":{for(var W=j,se=K,ue=1;ue<F;ue++)t(j,K,ne,de,G,ee,ue/(F-1),z),V(W,se,z.x,z.y),W=z.x,se=z.y;break}case"C":{for(var xe=j,ce=K,Pe=1;Pe<F;Pe++)i(j,K,ne,de,le,ge,G,ee,Pe/(F-1),z),V(xe,ce,z.x,z.y),xe=z.x,ce=z.y;break}}})}var s="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",o="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",a=new WeakMap,c={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function h(k,V){var F=k.getContext?k.getContext("webgl",c):k,z=a.get(F);if(!z){let xe=function(oe){var E=j[oe];if(!E&&(E=j[oe]=F.getExtension(oe),!E))throw new Error(oe+" not supported");return E},ce=function(oe,E){var C=F.createShader(E);return F.shaderSource(C,oe),F.compileShader(C),C},Pe=function(oe,E,C,H){if(!K[oe]){var Q={},fe={},_e=F.createProgram();F.attachShader(_e,ce(E,F.VERTEX_SHADER)),F.attachShader(_e,ce(C,F.FRAGMENT_SHADER)),F.linkProgram(_e),K[oe]={program:_e,transaction:function(Y){F.useProgram(_e),Y({setUniform:function(be,we){for(var N=[],ae=arguments.length-2;ae-- >0;)N[ae]=arguments[ae+2];var re=fe[we]||(fe[we]=F.getUniformLocation(_e,we));F["uniform"+be].apply(F,[re].concat(N))},setAttribute:function(be,we,N,ae,re){var Ee=Q[be];Ee||(Ee=Q[be]={buf:F.createBuffer(),loc:F.getAttribLocation(_e,be),data:null}),F.bindBuffer(F.ARRAY_BUFFER,Ee.buf),F.vertexAttribPointer(Ee.loc,we,F.FLOAT,!1,0,0),F.enableVertexAttribArray(Ee.loc),X?F.vertexAttribDivisor(Ee.loc,ae):xe("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(Ee.loc,ae),re!==Ee.data&&(F.bufferData(F.ARRAY_BUFFER,re,N),Ee.data=re)}})}}}K[oe].transaction(H)},ie=function(oe,E){ee++;try{F.activeTexture(F.TEXTURE0+ee);var C=G[oe];C||(C=G[oe]=F.createTexture(),F.bindTexture(F.TEXTURE_2D,C),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MIN_FILTER,F.NEAREST),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MAG_FILTER,F.NEAREST)),F.bindTexture(F.TEXTURE_2D,C),E(C,ee)}finally{ee--}},ye=function(oe,E,C){var H=F.createFramebuffer();ne.push(H),F.bindFramebuffer(F.FRAMEBUFFER,H),F.activeTexture(F.TEXTURE0+E),F.bindTexture(F.TEXTURE_2D,oe),F.framebufferTexture2D(F.FRAMEBUFFER,F.COLOR_ATTACHMENT0,F.TEXTURE_2D,oe,0);try{C(H)}finally{F.deleteFramebuffer(H),F.bindFramebuffer(F.FRAMEBUFFER,ne[--ne.length-1]||null)}},Se=function(){j={},K={},G={},ee=-1,ne.length=0};var le=xe,ge=ce,W=Pe,se=ie,de=ye,ue=Se,X=typeof WebGL2RenderingContext!="undefined"&&F instanceof WebGL2RenderingContext,j={},K={},G={},ee=-1,ne=[];F.canvas.addEventListener("webglcontextlost",function(oe){Se(),oe.preventDefault()},!1),a.set(F,z={gl:F,isWebGL2:X,getExtension:xe,withProgram:Pe,withTexture:ie,withTextureFramebuffer:ye,handleContextLoss:Se})}V(z)}function u(k,V,F,z,X,j,K,G){K===void 0&&(K=15),G===void 0&&(G=null),h(k,function(ee){var ne=ee.gl,de=ee.withProgram,le=ee.withTexture;le("copy",function(ge,W){ne.texImage2D(ne.TEXTURE_2D,0,ne.RGBA,X,j,0,ne.RGBA,ne.UNSIGNED_BYTE,V),de("copy",s,o,function(se){var ue=se.setUniform,xe=se.setAttribute;xe("aUV",2,ne.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),ue("1i","image",W),ne.bindFramebuffer(ne.FRAMEBUFFER,G||null),ne.disable(ne.BLEND),ne.colorMask(K&8,K&4,K&2,K&1),ne.viewport(F,z,X,j),ne.scissor(F,z,X,j),ne.drawArrays(ne.TRIANGLES,0,3)})})})}function f(k,V,F){var z=k.width,X=k.height;h(k,function(j){var K=j.gl,G=new Uint8Array(z*X*4);K.readPixels(0,0,z,X,K.RGBA,K.UNSIGNED_BYTE,G),k.width=V,k.height=F,u(K,G,0,0,z,X)})}var d=Object.freeze({__proto__:null,withWebGLContext:h,renderImageData:u,resizeWebGLCanvasWithoutClearing:f});function g(k,V,F,z,X,j){j===void 0&&(j=1);var K=new Uint8Array(k*V),G=z[2]-z[0],ee=z[3]-z[1],ne=[];r(F,function(xe,ce,Pe,ie){ne.push({x1:xe,y1:ce,x2:Pe,y2:ie,minX:Math.min(xe,Pe),minY:Math.min(ce,ie),maxX:Math.max(xe,Pe),maxY:Math.max(ce,ie)})}),ne.sort(function(xe,ce){return xe.maxX-ce.maxX});for(var de=0;de<k;de++)for(var le=0;le<V;le++){var ge=se(z[0]+G*(de+.5)/k,z[1]+ee*(le+.5)/V),W=Math.pow(1-Math.abs(ge)/X,j)/2;ge<0&&(W=1-W),W=Math.max(0,Math.min(255,Math.round(W*255))),K[le*k+de]=W}return K;function se(xe,ce){for(var Pe=1/0,ie=1/0,ye=ne.length;ye--;){var Se=ne[ye];if(Se.maxX+ie<=xe)break;if(xe+ie>Se.minX&&ce-ie<Se.maxY&&ce+ie>Se.minY){var oe=_(xe,ce,Se.x1,Se.y1,Se.x2,Se.y2);oe<Pe&&(Pe=oe,ie=Math.sqrt(Pe))}}return ue(xe,ce)&&(ie=-ie),ie}function ue(xe,ce){for(var Pe=0,ie=ne.length;ie--;){var ye=ne[ie];if(ye.maxX<=xe)break;var Se=ye.y1>ce!=ye.y2>ce&&xe<(ye.x2-ye.x1)*(ce-ye.y1)/(ye.y2-ye.y1)+ye.x1;Se&&(Pe+=ye.y1<ye.y2?1:-1)}return Pe!==0}}function p(k,V,F,z,X,j,K,G,ee,ne){j===void 0&&(j=1),G===void 0&&(G=0),ee===void 0&&(ee=0),ne===void 0&&(ne=0),m(k,V,F,z,X,j,K,null,G,ee,ne)}function m(k,V,F,z,X,j,K,G,ee,ne,de){j===void 0&&(j=1),ee===void 0&&(ee=0),ne===void 0&&(ne=0),de===void 0&&(de=0);for(var le=g(k,V,F,z,X,j),ge=new Uint8Array(le.length*4),W=0;W<le.length;W++)ge[W*4+de]=le[W];u(K,ge,ee,ne,k,V,1<<3-de,G)}function _(k,V,F,z,X,j){var K=X-F,G=j-z,ee=K*K+G*G,ne=ee?Math.max(0,Math.min(1,((k-F)*K+(V-z)*G)/ee)):0,de=k-(F+ne*K),le=V-(z+ne*G);return de*de+le*le}var x=Object.freeze({__proto__:null,generate:g,generateIntoCanvas:p,generateIntoFramebuffer:m}),b="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",y="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",v="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",M=new Float32Array([0,0,2,0,0,2]),S=null,w=!1,T={},R=new WeakMap;function D(k){if(!w&&!B(k))throw new Error("WebGL generation not supported")}function I(k,V,F,z,X,j,K){if(j===void 0&&(j=1),K===void 0&&(K=null),!K&&(K=S,!K)){var G=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document!="undefined"?document.createElement("canvas"):null;if(!G)throw new Error("OffscreenCanvas or DOM canvas not supported");K=S=G.getContext("webgl",{depth:!1})}D(K);var ee=new Uint8Array(k*V*4);h(K,function(ge){var W=ge.gl,se=ge.withTexture,ue=ge.withTextureFramebuffer;se("readable",function(xe,ce){W.texImage2D(W.TEXTURE_2D,0,W.RGBA,k,V,0,W.RGBA,W.UNSIGNED_BYTE,null),ue(xe,ce,function(Pe){A(k,V,F,z,X,j,W,Pe,0,0,0),W.readPixels(0,0,k,V,W.RGBA,W.UNSIGNED_BYTE,ee)})})});for(var ne=new Uint8Array(k*V),de=0,le=0;de<ee.length;de+=4)ne[le++]=ee[de];return ne}function U(k,V,F,z,X,j,K,G,ee,ne){j===void 0&&(j=1),G===void 0&&(G=0),ee===void 0&&(ee=0),ne===void 0&&(ne=0),A(k,V,F,z,X,j,K,null,G,ee,ne)}function A(k,V,F,z,X,j,K,G,ee,ne,de){j===void 0&&(j=1),ee===void 0&&(ee=0),ne===void 0&&(ne=0),de===void 0&&(de=0),D(K);var le=[];r(F,function(ge,W,se,ue){le.push(ge,W,se,ue)}),le=new Float32Array(le),h(K,function(ge){var W=ge.gl,se=ge.isWebGL2,ue=ge.getExtension,xe=ge.withProgram,ce=ge.withTexture,Pe=ge.withTextureFramebuffer,ie=ge.handleContextLoss;if(ce("rawDistances",function(ye,Se){(k!==ye._lastWidth||V!==ye._lastHeight)&&W.texImage2D(W.TEXTURE_2D,0,W.RGBA,ye._lastWidth=k,ye._lastHeight=V,0,W.RGBA,W.UNSIGNED_BYTE,null),xe("main",b,y,function(oe){var E=oe.setAttribute,C=oe.setUniform,H=!se&&ue("ANGLE_instanced_arrays"),Q=!se&&ue("EXT_blend_minmax");E("aUV",2,W.STATIC_DRAW,0,M),E("aLineSegment",4,W.DYNAMIC_DRAW,1,le),C.apply(void 0,["4f","uGlyphBounds"].concat(z)),C("1f","uMaxDistance",X),C("1f","uExponent",j),Pe(ye,Se,function(fe){W.enable(W.BLEND),W.colorMask(!0,!0,!0,!0),W.viewport(0,0,k,V),W.scissor(0,0,k,V),W.blendFunc(W.ONE,W.ONE),W.blendEquationSeparate(W.FUNC_ADD,se?W.MAX:Q.MAX_EXT),W.clear(W.COLOR_BUFFER_BIT),se?W.drawArraysInstanced(W.TRIANGLES,0,3,le.length/4):H.drawArraysInstancedANGLE(W.TRIANGLES,0,3,le.length/4)})}),xe("post",s,v,function(oe){oe.setAttribute("aUV",2,W.STATIC_DRAW,0,M),oe.setUniform("1i","tex",Se),W.bindFramebuffer(W.FRAMEBUFFER,G),W.disable(W.BLEND),W.colorMask(de===0,de===1,de===2,de===3),W.viewport(ee,ne,k,V),W.scissor(ee,ne,k,V),W.drawArrays(W.TRIANGLES,0,3)})}),W.isContextLost())throw ie(),new Error("webgl context lost")})}function B(k){var V=!k||k===S?T:k.canvas||k,F=R.get(V);if(F===void 0){w=!0;var z=null;try{var X=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],j=I(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,k);F=j&&X.length===j.length&&j.every(function(K,G){return K===X[G]}),F||(z="bad trial run results",console.info(X,j))}catch(K){F=!1,z=K.message}z&&console.warn("WebGL SDF generation not supported:",z),w=!1,R.set(V,F)}return F}var O=Object.freeze({__proto__:null,generate:I,generateIntoCanvas:U,generateIntoFramebuffer:A,isSupported:B});function q(k,V,F,z,X,j){X===void 0&&(X=Math.max(z[2]-z[0],z[3]-z[1])/2),j===void 0&&(j=1);try{return I.apply(O,arguments)}catch(K){return console.info("WebGL SDF generation failed, falling back to JS",K),g.apply(x,arguments)}}function Z(k,V,F,z,X,j,K,G,ee,ne){X===void 0&&(X=Math.max(z[2]-z[0],z[3]-z[1])/2),j===void 0&&(j=1),G===void 0&&(G=0),ee===void 0&&(ee=0),ne===void 0&&(ne=0);try{return U.apply(O,arguments)}catch(de){return console.info("WebGL SDF generation failed, falling back to JS",de),p.apply(x,arguments)}}return e.forEachPathCommand=n,e.generate=q,e.generateIntoCanvas=Z,e.javascript=x,e.pathToLineSegments=r,e.webgl=O,e.webglUtils=d,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return l}function uM(){var l=function(e){var t={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},i={},n={};i.L=1,n[1]="L",Object.keys(t).forEach(function(ie,ye){i[ie]=1<<ye+1,n[i[ie]]=ie}),Object.freeze(i);var r=i.LRI|i.RLI|i.FSI,s=i.L|i.R|i.AL,o=i.B|i.S|i.WS|i.ON|i.FSI|i.LRI|i.RLI|i.PDI,a=i.BN|i.RLE|i.LRE|i.RLO|i.LRO|i.PDF,c=i.S|i.WS|i.B|r|i.PDI|a,h=null;function u(){if(!h){h=new Map;var ie=function(Se){if(t.hasOwnProperty(Se)){var oe=0;t[Se].split(",").forEach(function(E){var C=E.split("+"),H=C[0],Q=C[1];H=parseInt(H,36),Q=Q?parseInt(Q,36):0,h.set(oe+=H,i[Se]);for(var fe=0;fe<Q;fe++)h.set(++oe,i[Se])})}};for(var ye in t)ie(ye)}}function f(ie){return u(),h.get(ie.codePointAt(0))||i.L}function d(ie){return n[f(ie)]}var g={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function p(ie,ye){var Se=36,oe=0,E=new Map,C=ye&&new Map,H;return ie.split(",").forEach(function Q(fe){if(fe.indexOf("+")!==-1)for(var _e=+fe;_e--;)Q(H);else{H=fe;var me=fe.split(">"),Y=me[0],Le=me[1];Y=String.fromCodePoint(oe+=parseInt(Y,Se)),Le=String.fromCodePoint(oe+=parseInt(Le,Se)),E.set(Y,Le),ye&&C.set(Le,Y)}}),{map:E,reverseMap:C}}var m,_,x;function b(){if(!m){var ie=p(g.pairs,!0),ye=ie.map,Se=ie.reverseMap;m=ye,_=Se,x=p(g.canonical,!1).map}}function y(ie){return b(),m.get(ie)||null}function v(ie){return b(),_.get(ie)||null}function M(ie){return b(),x.get(ie)||null}var S=i.L,w=i.R,T=i.EN,R=i.ES,D=i.ET,I=i.AN,U=i.CS,A=i.B,B=i.S,O=i.ON,q=i.BN,Z=i.NSM,k=i.AL,V=i.LRO,F=i.RLO,z=i.LRE,X=i.RLE,j=i.PDF,K=i.LRI,G=i.RLI,ee=i.FSI,ne=i.PDI;function de(ie,ye){for(var Se=125,oe=new Uint32Array(ie.length),E=0;E<ie.length;E++)oe[E]=f(ie[E]);var C=new Map;function H(Wt,Bn){var on=oe[Wt];oe[Wt]=Bn,C.set(on,C.get(on)-1),on&o&&C.set(o,C.get(o)-1),C.set(Bn,(C.get(Bn)||0)+1),Bn&o&&C.set(o,(C.get(o)||0)+1)}for(var Q=new Uint8Array(ie.length),fe=new Map,_e=[],me=null,Y=0;Y<ie.length;Y++)me||_e.push(me={start:Y,end:ie.length-1,level:ye==="rtl"?1:ye==="ltr"?0:xd(Y,!1)}),oe[Y]&A&&(me.end=Y,me=null);for(var Le=X|z|F|V|r|ne|j|A,be=function(Wt){return Wt+(Wt&1?1:2)},we=function(Wt){return Wt+(Wt&1?2:1)},N=0;N<_e.length;N++){me=_e[N];var ae=[{_level:me.level,_override:0,_isolate:0}],re=void 0,Ee=0,Me=0,Oe=0;C.clear();for(var ve=me.start;ve<=me.end;ve++){var Ie=oe[ve];if(re=ae[ae.length-1],C.set(Ie,(C.get(Ie)||0)+1),Ie&o&&C.set(o,(C.get(o)||0)+1),Ie&Le)if(Ie&(X|z)){Q[ve]=re._level;var We=(Ie===X?we:be)(re._level);We<=Se&&!Ee&&!Me?ae.push({_level:We,_override:0,_isolate:0}):Ee||Me++}else if(Ie&(F|V)){Q[ve]=re._level;var je=(Ie===F?we:be)(re._level);je<=Se&&!Ee&&!Me?ae.push({_level:je,_override:Ie&F?w:S,_isolate:0}):Ee||Me++}else if(Ie&r){Ie&ee&&(Ie=xd(ve+1,!0)===1?G:K),Q[ve]=re._level,re._override&&H(ve,re._override);var Qe=(Ie===G?we:be)(re._level);Qe<=Se&&Ee===0&&Me===0?(Oe++,ae.push({_level:Qe,_override:0,_isolate:1,_isolInitIndex:ve})):Ee++}else if(Ie&ne){if(Ee>0)Ee--;else if(Oe>0){for(Me=0;!ae[ae.length-1]._isolate;)ae.pop();var Ht=ae[ae.length-1]._isolInitIndex;Ht!=null&&(fe.set(Ht,ve),fe.set(ve,Ht)),ae.pop(),Oe--}re=ae[ae.length-1],Q[ve]=re._level,re._override&&H(ve,re._override)}else Ie&j?(Ee===0&&(Me>0?Me--:!re._isolate&&ae.length>1&&(ae.pop(),re=ae[ae.length-1])),Q[ve]=re._level):Ie&A&&(Q[ve]=me.level);else Q[ve]=re._level,re._override&&Ie!==q&&H(ve,re._override)}for(var ot=[],et=null,xt=me.start;xt<=me.end;xt++){var Qt=oe[xt];if(!(Qt&a)){var rt=Q[xt],It=Qt&r,Cn=Qt===ne;et&&rt===et._level?(et._end=xt,et._endsWithIsolInit=It):ot.push(et={_start:xt,_end:xt,_level:rt,_startsWithPDI:Cn,_endsWithIsolInit:It})}}for(var Rt=[],At=0;At<ot.length;At++){var P=ot[At];if(!P._startsWithPDI||P._startsWithPDI&&!fe.has(P._start)){for(var J=[et=P],te=void 0;et&&et._endsWithIsolInit&&(te=fe.get(et._end))!=null;)for(var $=At+1;$<ot.length;$++)if(ot[$]._start===te){J.push(et=ot[$]);break}for(var he=[],ke=0;ke<J.length;ke++)for(var Be=J[ke],Ge=Be._start;Ge<=Be._end;Ge++)he.push(Ge);for(var Ve=Q[he[0]],tt=me.level,Xe=he[0]-1;Xe>=0;Xe--)if(!(oe[Xe]&a)){tt=Q[Xe];break}var Ye=he[he.length-1],pt=Q[Ye],ei=me.level;if(!(oe[Ye]&r)){for(var Un=Ye+1;Un<=me.end;Un++)if(!(oe[Un]&a)){ei=Q[Un];break}}Rt.push({_seqIndices:he,_sosType:Math.max(tt,Ve)%2?w:S,_eosType:Math.max(ei,pt)%2?w:S})}}for(var ti=0;ti<Rt.length;ti++){var sn=Rt[ti],Te=sn._seqIndices,An=sn._sosType,vt=sn._eosType;if(C.get(Z))for(var $t=0;$t<Te.length;$t++){var kn=Te[$t];if(oe[kn]&Z){for(var _i=An,Bi=$t-1;Bi>=0;Bi--)if(!(oe[Te[Bi]]&a)){_i=oe[Te[Bi]];break}H(kn,_i&(r|ne)?O:_i)}}if(C.get(T))for(var Et=0;Et<Te.length;Et++){var zi=Te[Et];if(oe[zi]&T)for(var Gi=Et-1;Gi>=-1;Gi--){var dn=Gi===-1?An:oe[Te[Gi]];if(dn&s){dn===k&&H(zi,I);break}}}if(C.get(k))for(var Xc=0;Xc<Te.length;Xc++){var od=Te[Xc];oe[od]&k&&H(od,w)}if(C.get(R)||C.get(U))for(var Oo=1;Oo<Te.length-1;Oo++){var qc=Te[Oo];if(oe[qc]&(R|U)){for(var xs=0,Yc=0,Zc=Oo-1;Zc>=0&&(xs=oe[Te[Zc]],!!(xs&a));Zc--);for(var jc=Oo+1;jc<Te.length&&(Yc=oe[Te[jc]],!!(Yc&a));jc++);xs===Yc&&(oe[qc]===R?xs===T:xs&(T|I))&&H(qc,xs)}}if(C.get(T))for(var Uo=0;Uo<Te.length;Uo++){var Y1=Te[Uo];if(oe[Y1]&T){for(var Ka=Uo-1;Ka>=0&&oe[Te[Ka]]&(D|a);Ka--)H(Te[Ka],T);for(var Qa=Uo+1;Qa<Te.length&&oe[Te[Qa]]&(D|a);Qa++)H(Te[Qa],T)}}if(C.get(D)||C.get(R)||C.get(U))for(var ko=0;ko<Te.length;ko++){var ad=Te[ko];if(oe[ad]&(D|R|U)){H(ad,O);for(var $a=ko-1;$a>=0&&oe[Te[$a]]&a;$a--)H(Te[$a],O);for(var el=ko+1;el<Te.length&&oe[Te[el]]&a;el++)H(Te[el],O)}}if(C.get(T))for(var Jc=0,ld=An;Jc<Te.length;Jc++){var cd=Te[Jc],Kc=oe[cd];Kc&T?ld===S&&H(cd,S):Kc&s&&(ld=Kc)}if(C.get(o)){var No=w|T|I,hd=No|S,tl=[];{for(var vs=[],ys=0;ys<Te.length;ys++)if(oe[Te[ys]]&o){var Bo=ie[Te[ys]],ud=void 0;if(y(Bo)!==null)if(vs.length<63)vs.push({char:Bo,seqIndex:ys});else break;else if((ud=v(Bo))!==null)for(var zo=vs.length-1;zo>=0;zo--){var Qc=vs[zo].char;if(Qc===ud||Qc===v(M(Bo))||y(M(Qc))===Bo){tl.push([vs[zo].seqIndex,ys]),vs.length=zo;break}}}tl.sort(function(Wt,Bn){return Wt[0]-Bn[0]})}for(var $c=0;$c<tl.length;$c++){for(var fd=tl[$c],Go=fd[0],nl=fd[1],dd=!1,Nn=0,eh=Go+1;eh<nl;eh++){var th=Te[eh];if(oe[th]&hd){dd=!0;var pd=oe[th]&No?w:S;if(pd===bs(th)){Nn=pd;break}}}if(dd&&!Nn){Nn=An;for(var nh=Go-1;nh>=0;nh--){var il=Te[nh];if(oe[il]&hd){var md=oe[il]&No?w:S;md!==bs(il)?Nn=md:Nn=bs(il);break}}}if(Nn){if(oe[Te[Go]]=oe[Te[nl]]=Nn,Nn!==bs(Te[Go])){for(var Vo=Go+1;Vo<Te.length;Vo++)if(!(oe[Te[Vo]]&a)){f(ie[Te[Vo]])&Z&&(oe[Te[Vo]]=Nn);break}}if(Nn!==bs(Te[nl])){for(var Ho=nl+1;Ho<Te.length;Ho++)if(!(oe[Te[Ho]]&a)){f(ie[Te[Ho]])&Z&&(oe[Te[Ho]]=Nn);break}}}}for(var Vi=0;Vi<Te.length;Vi++)if(oe[Te[Vi]]&o){for(var gd=Vi,ih=Vi,rh=An,Wo=Vi-1;Wo>=0;Wo--)if(oe[Te[Wo]]&a)gd=Wo;else{rh=oe[Te[Wo]]&No?w:S;break}for(var _d=vt,Xo=Vi+1;Xo<Te.length;Xo++)if(oe[Te[Xo]]&(o|a))ih=Xo;else{_d=oe[Te[Xo]]&No?w:S;break}for(var rl=gd;rl<=ih;rl++)oe[Te[rl]]=rh===_d?rh:bs(Te[rl]);Vi=ih}}}for(var pn=me.start;pn<=me.end;pn++){var Z1=Q[pn],sl=oe[pn];if(Z1&1?sl&(S|T|I)&&Q[pn]++:sl&w?Q[pn]++:sl&(I|T)&&(Q[pn]+=2),sl&a&&(Q[pn]=pn===0?me.level:Q[pn-1]),pn===me.end||f(ie[pn])&(B|A))for(var ol=pn;ol>=0&&f(ie[ol])&c;ol--)Q[ol]=me.level}}return{levels:Q,paragraphs:_e};function xd(Wt,Bn){for(var on=Wt;on<ie.length;on++){var Hi=oe[on];if(Hi&(w|k))return 1;if(Hi&(A|S)||Bn&&Hi===ne)return 0;if(Hi&r){var vd=j1(on);on=vd===-1?ie.length:vd}}return 0}function j1(Wt){for(var Bn=1,on=Wt+1;on<ie.length;on++){var Hi=oe[on];if(Hi&A)break;if(Hi&ne){if(--Bn===0)return on}else Hi&r&&Bn++}return-1}function bs(Wt){return Q[Wt]&1?w:S}}var le="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",ge;function W(){if(!ge){var ie=p(le,!0),ye=ie.map,Se=ie.reverseMap;Se.forEach(function(oe,E){ye.set(E,oe)}),ge=ye}}function se(ie){return W(),ge.get(ie)||null}function ue(ie,ye,Se,oe){var E=ie.length;Se=Math.max(0,Se==null?0:+Se),oe=Math.min(E-1,oe==null?E-1:+oe);for(var C=new Map,H=Se;H<=oe;H++)if(ye[H]&1){var Q=se(ie[H]);Q!==null&&C.set(H,Q)}return C}function xe(ie,ye,Se,oe){var E=ie.length;Se=Math.max(0,Se==null?0:+Se),oe=Math.min(E-1,oe==null?E-1:+oe);var C=[];return ye.paragraphs.forEach(function(H){var Q=Math.max(Se,H.start),fe=Math.min(oe,H.end);if(Q<fe){for(var _e=ye.levels.slice(Q,fe+1),me=fe;me>=Q&&f(ie[me])&c;me--)_e[me]=H.level;for(var Y=H.level,Le=1/0,be=0;be<_e.length;be++){var we=_e[be];we>Y&&(Y=we),we<Le&&(Le=we|1)}for(var N=Y;N>=Le;N--)for(var ae=0;ae<_e.length;ae++)if(_e[ae]>=N){for(var re=ae;ae+1<_e.length&&_e[ae+1]>=N;)ae++;ae>re&&C.push([re+Se,ae+Se])}}}),C}function ce(ie,ye,Se,oe){var E=Pe(ie,ye,Se,oe),C=[].concat(ie);return E.forEach(function(H,Q){C[Q]=(ye.levels[H]&1?se(ie[H]):null)||ie[H]}),C.join("")}function Pe(ie,ye,Se,oe){for(var E=xe(ie,ye,Se,oe),C=[],H=0;H<ie.length;H++)C[H]=H;return E.forEach(function(Q){for(var fe=Q[0],_e=Q[1],me=C.slice(fe,_e+1),Y=me.length;Y--;)C[_e-Y]=me[Y]}),C}return e.closingToOpeningBracket=v,e.getBidiCharType=f,e.getBidiCharTypeName=d,e.getCanonicalBracket=M,e.getEmbeddingLevels=de,e.getMirroredCharacter=se,e.getMirroredCharactersMap=ue,e.getReorderSegments=xe,e.getReorderedIndices=Pe,e.getReorderedString=ce,e.openingToClosingBracket=y,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return l}const zg=/\bvoid\s+main\s*\(\s*\)\s*{/g;function Gu(l){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function t(i,n){let r=He[n];return r?Gu(r):i}return l.replace(e,t)}const Gt=[];for(let l=0;l<256;l++)Gt[l]=(l<16?"0":"")+l.toString(16);function fM(){const l=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Gt[l&255]+Gt[l>>8&255]+Gt[l>>16&255]+Gt[l>>24&255]+"-"+Gt[e&255]+Gt[e>>8&255]+"-"+Gt[e>>16&15|64]+Gt[e>>24&255]+"-"+Gt[t&63|128]+Gt[t>>8&255]+"-"+Gt[t>>16&255]+Gt[t>>24&255]+Gt[i&255]+Gt[i>>8&255]+Gt[i>>16&255]+Gt[i>>24&255]).toUpperCase()}const Ur=Object.assign||function(){let l=arguments[0];for(let e=1,t=arguments.length;e<t;e++){let i=arguments[e];if(i)for(let n in i)i.hasOwnProperty(n)&&(l[n]=i[n])}return l},dM=Date.now(),sm=new WeakMap,om=new Map;let pM=1e10;function Vu(l,e){const t=xM(e);let i=sm.get(l);if(i||sm.set(l,i=Object.create(null)),i[t])return new i[t];const n=`_onBeforeCompile${t}`,r=function(c){l.onBeforeCompile.call(this,c);const h=this.customProgramCacheKey()+"|"+c.vertexShader+"|"+c.fragmentShader;let u=om[h];if(!u){const f=mM(c,e,t);u=om[h]=f}c.vertexShader=u.vertexShader,c.fragmentShader=u.fragmentShader,Ur(c.uniforms,this.uniforms),e.timeUniform&&(c.uniforms[e.timeUniform]={get value(){return Date.now()-dM}}),this[n]&&this[n](c)},s=function(){return o(e.chained?l:l.clone())},o=function(c){const h=Object.create(c,a);return Object.defineProperty(h,"baseMaterial",{value:l}),Object.defineProperty(h,"id",{value:pM++}),h.uuid=fM(),h.uniforms=Ur({},c.uniforms,e.uniforms),h.defines=Ur({},c.defines,e.defines),h.defines[`TROIKA_DERIVED_MATERIAL_${t}`]="",h.extensions=Ur({},c.extensions,e.extensions),h._listeners=void 0,h},a={constructor:{value:s},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return l.customProgramCacheKey()+"|"+t}},onBeforeCompile:{get(){return r},set(c){this[n]=c}},copy:{writable:!0,configurable:!0,value:function(c){return l.copy.call(this,c),!l.isShaderMaterial&&!l.isDerivedMaterial&&(Ur(this.extensions,c.extensions),Ur(this.defines,c.defines),Ur(this.uniforms,mf.clone(c.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const c=new l.constructor;return o(c).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let c=this._depthMaterial;return c||(c=this._depthMaterial=Vu(l.isDerivedMaterial?l.getDepthMaterial():new Pc({depthPacking:hf}),e),c.defines.IS_DEPTH_MATERIAL="",c.uniforms=this.uniforms),c}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let c=this._distanceMaterial;return c||(c=this._distanceMaterial=Vu(l.isDerivedMaterial?l.getDistanceMaterial():new Dc,e),c.defines.IS_DISTANCE_MATERIAL="",c.uniforms=this.uniforms),c}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:c,_distanceMaterial:h}=this;c&&c.dispose(),h&&h.dispose(),l.dispose.call(this)}}};return i[t]=s,new s}function mM({vertexShader:l,fragmentShader:e},t,i){let{vertexDefs:n,vertexMainIntro:r,vertexMainOutro:s,vertexTransform:o,fragmentDefs:a,fragmentMainIntro:c,fragmentMainOutro:h,fragmentColorTransform:u,customRewriter:f,timeUniform:d}=t;if(n=n||"",r=r||"",s=s||"",a=a||"",c=c||"",h=h||"",(o||f)&&(l=Gu(l)),(u||f)&&(e=e.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),e=Gu(e)),f){let g=f({vertexShader:l,fragmentShader:e});l=g.vertexShader,e=g.fragmentShader}if(u){let g=[];e=e.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,p=>(g.push(p),"")),h=`${u}
${g.join(`
`)}
${h}`}if(d){const g=`
uniform float ${d};
`;n=g+n,a=g+a}return o&&(l=`vec3 troika_position_${i};
vec3 troika_normal_${i};
vec2 troika_uv_${i};
${l}
`,n=`${n}
void troikaVertexTransform${i}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${o}
}
`,r=`
troika_position_${i} = vec3(position);
troika_normal_${i} = vec3(normal);
troika_uv_${i} = vec2(uv);
troikaVertexTransform${i}(troika_position_${i}, troika_normal_${i}, troika_uv_${i});
${r}
`,l=l.replace(/\b(position|normal|uv)\b/g,(g,p,m,_)=>/\battribute\s+vec[23]\s+$/.test(_.substr(0,m))?p:`troika_${p}_${i}`)),l=am(l,i,n,r,s),e=am(e,i,a,c,h),{vertexShader:l,fragmentShader:e}}function am(l,e,t,i,n){return(i||n||t)&&(l=l.replace(zg,`
${t}
void troikaOrigMain${e}() {`),l+=`
void main() {
  ${i}
  troikaOrigMain${e}();
  ${n}
}`),l}function gM(l,e){return l==="uniforms"?void 0:typeof e=="function"?e.toString():e}let _M=0;const lm=new Map;function xM(l){const e=JSON.stringify(l,gM);let t=lm.get(e);return t==null&&lm.set(e,t=++_M),t}function vM(l,e,t){const{defaultFontURL:i}=t,n=Object.create(null),r=1/0,s=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,o=/[\s\-\u007C\u00AD\u2010\u2012-\u2014\u2027\u2056\u2E17\u2E40]/;function a(_,x){function b(){const y=v=>{console.error(`Failure loading font ${_}${_===i?"":"; trying fallback"}`,v),_!==i&&(_=i,b())};try{const v=new XMLHttpRequest;v.open("get",_,!0),v.responseType="arraybuffer",v.onload=function(){if(v.status>=400)y(new Error(v.statusText));else if(v.status>0)try{const M=l(v.response);x(M)}catch(M){y(M)}},v.onerror=y,v.send()}catch(v){y(v)}}b()}function c(_,x){_||(_=i);let b=n[_];b?b.pending?b.pending.push(x):x(b):(n[_]={pending:[x]},a(_,y=>{let v=n[_].pending;n[_]=y,v.forEach(M=>M(y))}))}function h({text:_="",font:x=i,sdfGlyphSize:b=64,fontSize:y=1,letterSpacing:v=0,lineHeight:M="normal",maxWidth:S=r,direction:w,textAlign:T="left",textIndent:R=0,whiteSpace:D="normal",overflowWrap:I="normal",anchorX:U=0,anchorY:A=0,includeCaretPositions:B=!1,chunkedBoundsSize:O=8192,colorRanges:q=null},Z,k=!1){const V=g(),F={fontLoad:0,typesetting:0};_.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),_=_.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),y=+y,v=+v,S=+S,M=M||"normal",R=+R,c(x,z=>{const X=isFinite(S);let j=null,K=null,G=null,ee=null,ne=null,de=null,le=null,ge=0,W=0,se=D!=="nowrap";const{ascender:ue,descender:xe,unitsPerEm:ce}=z;F.fontLoad=g()-V;const Pe=g(),ie=y/ce;M==="normal"&&(M=(ue-xe)/ce),M=M*y;const ye=(M-(ue-xe)*ie)/2,Se=-(ue*ie+ye),oe=Math.min(M,(ue-xe)*ie),E=(ue+xe)/2*ie-oe/2;let C=R,H=new p;const Q=[H];z.forEachGlyph(_,y,v,(me,Y,Le)=>{const be=_.charAt(Le),we=me.advanceWidth*ie,N=H.count;let ae;if("isEmpty"in me||(me.isWhitespace=!!be&&/\s/.test(be),me.canBreakAfter=!!be&&o.test(be),me.isEmpty=me.xMin===me.xMax||me.yMin===me.yMax||s.test(be)),!me.isWhitespace&&!me.isEmpty&&W++,se&&X&&!me.isWhitespace&&Y+we+C>S&&N){if(H.glyphAt(N-1).glyphObj.canBreakAfter)ae=new p,C=-Y;else for(let Ee=N;Ee--;)if(Ee===0&&I==="break-word"){ae=new p,C=-Y;break}else if(H.glyphAt(Ee).glyphObj.canBreakAfter){ae=H.splitAt(Ee+1);const Me=ae.glyphAt(0).x;C-=Me;for(let Oe=ae.count;Oe--;)ae.glyphAt(Oe).x-=Me;break}ae&&(H.isSoftWrapped=!0,H=ae,Q.push(H),ge=S)}let re=H.glyphAt(H.count);re.glyphObj=me,re.x=Y+C,re.width=we,re.charIndex=Le,be===`
`&&(H=new p,Q.push(H),C=-(Y+we+v*y)+R)}),Q.forEach(me=>{for(let Y=me.count;Y--;){let{glyphObj:Le,x:be,width:we}=me.glyphAt(Y);if(!Le.isWhitespace){me.width=be+we,me.width>ge&&(ge=me.width);return}}});let fe=0,_e=0;if(U&&(typeof U=="number"?fe=-U:typeof U=="string"&&(fe=-ge*(U==="left"?0:U==="center"?.5:U==="right"?1:f(U)))),A){if(typeof A=="number")_e=-A;else if(typeof A=="string"){let me=Q.length*M;_e=A==="top"?0:A==="top-baseline"?-Se:A==="middle"?me/2:A==="bottom"?me:A==="bottom-baseline"?me-ye+xe*ie:f(A)*me}}if(!k){const me=e.getEmbeddingLevels(_,w);j=new Uint16Array(W),K=new Float32Array(W*2),G={},de=[r,r,-r,-r],le=[];let Y=Se;B&&(ne=new Float32Array(_.length*3)),q&&(ee=new Uint8Array(W*3));let Le=0,be=-1,we=-1,N,ae;if(Q.forEach((re,Ee)=>{let{count:Me,width:Oe}=re;if(Me>0){let ve=0;for(let ot=Me;ot--&&re.glyphAt(ot).glyphObj.isWhitespace;)ve++;let Ie=0,We=0;if(T==="center")Ie=(ge-Oe)/2;else if(T==="right")Ie=ge-Oe;else if(T==="justify"&&re.isSoftWrapped){let ot=0;for(let et=Me-ve;et--;)re.glyphAt(et).glyphObj.isWhitespace&&ot++;We=(ge-Oe)/ot}if(We||Ie){let ot=0;for(let et=0;et<Me;et++){let xt=re.glyphAt(et);const Qt=xt.glyphObj;xt.x+=Ie+ot,We!==0&&Qt.isWhitespace&&et<Me-ve&&(ot+=We,xt.width+=We)}}const je=e.getReorderSegments(_,me,re.glyphAt(0).charIndex,re.glyphAt(re.count-1).charIndex);for(let ot=0;ot<je.length;ot++){const[et,xt]=je[ot];let Qt=1/0,rt=-1/0;for(let It=0;It<Me;It++)if(re.glyphAt(It).charIndex>=et){let Cn=It,Rt=It;for(;Rt<Me;Rt++){let At=re.glyphAt(Rt);if(At.charIndex>xt)break;Rt<Me-ve&&(Qt=Math.min(Qt,At.x),rt=Math.max(rt,At.x+At.width))}for(let At=Cn;At<Rt;At++){const P=re.glyphAt(At);P.x=rt-(P.x+P.width-Qt)}break}}let Qe;const Ht=ot=>Qe=ot;for(let ot=0;ot<Me;ot++){let et=re.glyphAt(ot);Qe=et.glyphObj;const xt=Qe.index,Qt=me.levels[et.charIndex]&1;if(Qt){const rt=e.getMirroredCharacter(_[et.charIndex]);rt&&z.forEachGlyph(rt,0,0,Ht)}if(B){const{charIndex:rt}=et,It=et.x+fe,Cn=et.x+et.width+fe;ne[rt*3]=Qt?Cn:It,ne[rt*3+1]=Qt?It:Cn,ne[rt*3+2]=Y+E+_e;const Rt=rt-be;Rt>1&&d(ne,be,Rt),be=rt}if(q){const{charIndex:rt}=et;for(;rt>we;)we++,q.hasOwnProperty(we)&&(ae=q[we])}if(!Qe.isWhitespace&&!Qe.isEmpty){const rt=Le++;G[xt]||(G[xt]={path:Qe.path,pathBounds:[Qe.xMin,Qe.yMin,Qe.xMax,Qe.yMax]});const It=et.x+fe,Cn=Y+_e;K[rt*2]=It,K[rt*2+1]=Cn;const Rt=It+Qe.xMin*ie,At=Cn+Qe.yMin*ie,P=It+Qe.xMax*ie,J=Cn+Qe.yMax*ie;Rt<de[0]&&(de[0]=Rt),At<de[1]&&(de[1]=At),P>de[2]&&(de[2]=P),J>de[3]&&(de[3]=J),rt%O===0&&(N={start:rt,end:rt,rect:[r,r,-r,-r]},le.push(N)),N.end++;const te=N.rect;if(Rt<te[0]&&(te[0]=Rt),At<te[1]&&(te[1]=At),P>te[2]&&(te[2]=P),J>te[3]&&(te[3]=J),j[rt]=xt,q){const $=rt*3;ee[$]=ae>>16&255,ee[$+1]=ae>>8&255,ee[$+2]=ae&255}}}}Y-=M}),ne){const re=_.length-be;re>1&&d(ne,be,re)}}F.typesetting=g()-Pe,Z({glyphIds:j,glyphPositions:K,glyphData:G,caretPositions:ne,caretHeight:oe,glyphColors:ee,chunkedBounds:le,fontSize:y,unitsPerEm:ce,ascender:ue*ie,descender:xe*ie,lineHeight:M,topBaseline:Se,blockBounds:[fe,_e-Q.length*M,fe+ge,_e],visibleBounds:de,timings:F})})}function u(_,x){h(_,b=>{const[y,v,M,S]=b.blockBounds;x({width:M-y,height:S-v})},{metricsOnly:!0})}function f(_){let x=_.match(/^([\d.]+)%$/),b=x?parseFloat(x[1]):NaN;return isNaN(b)?0:b/100}function d(_,x,b){const y=_[x*3],v=_[x*3+1],M=_[x*3+2],S=(v-y)/b;for(let w=0;w<b;w++){const T=(x+w)*3;_[T]=y+S*w,_[T+1]=y+S*(w+1),_[T+2]=M}}function g(){return(self.performance||Date).now()}function p(){this.data=[]}const m=["glyphObj","x","width","charIndex"];return p.prototype={width:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/m.length)},glyphAt(_){let x=p.flyweight;return x.data=this.data,x.index=_,x},splitAt(_){let x=new p;return x.data=this.data.splice(_*m.length),x}},p.flyweight=m.reduce((_,x,b,y)=>(Object.defineProperty(_,x,{get(){return this.data[this.index*m.length+b]},set(v){this.data[this.index*m.length+b]=v}}),_),{data:null,index:0}),{typeset:h,measure:u,loadFont:c}}const jr=()=>(self.performance||Date).now(),Vc=Bg();let cm;function yM(l,e,t,i,n,r,s,o,a,c,h=!0){return h?bM(l,e,t,i,n,r,s,o,a,c).then(null,u=>(cm||(console.warn("WebGL SDF generation failed, falling back to JS",u),cm=!0),hm(l,e,t,i,n,r,s,o,a,c))):hm(l,e,t,i,n,r,s,o,a,c)}const bM=function(){const l=[];let t=0;function i(){const n=jr();for(;l.length&&jr()-n<5;)l.shift()();t=l.length?setTimeout(i,0):0}return(...n)=>{const r=Ii();return l.push(()=>{const s=jr();try{Vc.webgl.generateIntoCanvas(...n),r.resolve({timing:jr()-s})}catch(o){r.reject(o)}}),t||(t=setTimeout(i,0)),r}}(),hm=function(){const t={};let i=0;return function(n,r,s,o,a,c,h,u,f,d){const g="TroikaTextSDFGenerator_JS_"+i++%4;let p=t[g];return p||(p=t[g]={workerModule:Fo({name:g,workerId:g,dependencies:[Bg,jr],init(m,_){const x=m().javascript.generate;return function(...b){const y=_();return{textureData:x(...b),timing:_()-y}}},getTransferables(m){return[m.textureData.buffer]}}),requests:0,idleTimer:null}),p.requests++,clearTimeout(p.idleTimer),p.workerModule(n,r,s,o,a,c).then(({textureData:m,timing:_})=>{const x=jr(),b=new Uint8Array(m.length*4);for(let y=0;y<m.length;y++)b[y*4+d]=m[y];return Vc.webglUtils.renderImageData(h,b,u,f,n,r,1<<3-d),_+=jr()-x,--p.requests===0&&(p.idleTimer=setTimeout(()=>{lM(g)},2e3)),{timing:_}})}}();function wM(l){l._warm||(Vc.webgl.isSupported(l),l._warm=!0)}const MM=Vc.webglUtils.resizeWebGLCanvasWithoutClearing;/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function SM(){return typeof window=="undefined"&&(self.window=self),function(l){var e={parse:function(n){var r=e._bin,s=new Uint8Array(n);if(r.readASCII(s,0,4)=="ttcf"){var o=4;r.readUshort(s,o),o+=2,r.readUshort(s,o),o+=2;var a=r.readUint(s,o);o+=4;for(var c=[],h=0;h<a;h++){var u=r.readUint(s,o);o+=4,c.push(e._readFont(s,u))}return c}return[e._readFont(s,0)]},_readFont:function(n,r){var s=e._bin,o=r;s.readFixed(n,r),r+=4;var a=s.readUshort(n,r);r+=2,s.readUshort(n,r),r+=2,s.readUshort(n,r),r+=2,s.readUshort(n,r),r+=2;for(var c=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],h={_data:n,_offset:o},u={},f=0;f<a;f++){var d=s.readASCII(n,r,4);r+=4,s.readUint(n,r),r+=4;var g=s.readUint(n,r);r+=4;var p=s.readUint(n,r);r+=4,u[d]={offset:g,length:p}}for(f=0;f<c.length;f++){var m=c[f];u[m]&&(h[m.trim()]=e[m.trim()].parse(n,u[m].offset,u[m].length,h))}return h},_tabOffset:function(n,r,s){for(var o=e._bin,a=o.readUshort(n,s+4),c=s+12,h=0;h<a;h++){var u=o.readASCII(n,c,4);c+=4,o.readUint(n,c),c+=4;var f=o.readUint(n,c);if(c+=4,o.readUint(n,c),c+=4,u==r)return f}return 0}};e._bin={readFixed:function(n,r){return(n[r]<<8|n[r+1])+(n[r+2]<<8|n[r+3])/65540},readF2dot14:function(n,r){return e._bin.readShort(n,r)/16384},readInt:function(n,r){return e._bin._view(n).getInt32(r)},readInt8:function(n,r){return e._bin._view(n).getInt8(r)},readShort:function(n,r){return e._bin._view(n).getInt16(r)},readUshort:function(n,r){return e._bin._view(n).getUint16(r)},readUshorts:function(n,r,s){for(var o=[],a=0;a<s;a++)o.push(e._bin.readUshort(n,r+2*a));return o},readUint:function(n,r){return e._bin._view(n).getUint32(r)},readUint64:function(n,r){return 4294967296*e._bin.readUint(n,r)+e._bin.readUint(n,r+4)},readASCII:function(n,r,s){for(var o="",a=0;a<s;a++)o+=String.fromCharCode(n[r+a]);return o},readUnicode:function(n,r,s){for(var o="",a=0;a<s;a++){var c=n[r++]<<8|n[r++];o+=String.fromCharCode(c)}return o},_tdec:typeof window!="undefined"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(n,r,s){var o=e._bin._tdec;return o&&r==0&&s==n.length?o.decode(n):e._bin.readASCII(n,r,s)},readBytes:function(n,r,s){for(var o=[],a=0;a<s;a++)o.push(n[r+a]);return o},readASCIIArray:function(n,r,s){for(var o=[],a=0;a<s;a++)o.push(String.fromCharCode(n[r+a]));return o},_view:function(n){return n._dataView||(n._dataView=n.buffer?new DataView(n.buffer,n.byteOffset,n.byteLength):new DataView(new Uint8Array(n).buffer))}},e._lctf={},e._lctf.parse=function(n,r,s,o,a){var c=e._bin,h={},u=r;c.readFixed(n,r),r+=4;var f=c.readUshort(n,r);r+=2;var d=c.readUshort(n,r);r+=2;var g=c.readUshort(n,r);return r+=2,h.scriptList=e._lctf.readScriptList(n,u+f),h.featureList=e._lctf.readFeatureList(n,u+d),h.lookupList=e._lctf.readLookupList(n,u+g,a),h},e._lctf.readLookupList=function(n,r,s){var o=e._bin,a=r,c=[],h=o.readUshort(n,r);r+=2;for(var u=0;u<h;u++){var f=o.readUshort(n,r);r+=2;var d=e._lctf.readLookupTable(n,a+f,s);c.push(d)}return c},e._lctf.readLookupTable=function(n,r,s){var o=e._bin,a=r,c={tabs:[]};c.ltype=o.readUshort(n,r),r+=2,c.flag=o.readUshort(n,r),r+=2;var h=o.readUshort(n,r);r+=2;for(var u=c.ltype,f=0;f<h;f++){var d=o.readUshort(n,r);r+=2;var g=s(n,u,a+d,c);c.tabs.push(g)}return c},e._lctf.numOfOnes=function(n){for(var r=0,s=0;s<32;s++)(n>>>s&1)!=0&&r++;return r},e._lctf.readClassDef=function(n,r){var s=e._bin,o=[],a=s.readUshort(n,r);if(r+=2,a==1){var c=s.readUshort(n,r);r+=2;var h=s.readUshort(n,r);r+=2;for(var u=0;u<h;u++)o.push(c+u),o.push(c+u),o.push(s.readUshort(n,r)),r+=2}if(a==2){var f=s.readUshort(n,r);for(r+=2,u=0;u<f;u++)o.push(s.readUshort(n,r)),r+=2,o.push(s.readUshort(n,r)),r+=2,o.push(s.readUshort(n,r)),r+=2}return o},e._lctf.getInterval=function(n,r){for(var s=0;s<n.length;s+=3){var o=n[s],a=n[s+1];if(n[s+2],o<=r&&r<=a)return s}return-1},e._lctf.readCoverage=function(n,r){var s=e._bin,o={};o.fmt=s.readUshort(n,r),r+=2;var a=s.readUshort(n,r);return r+=2,o.fmt==1&&(o.tab=s.readUshorts(n,r,a)),o.fmt==2&&(o.tab=s.readUshorts(n,r,3*a)),o},e._lctf.coverageIndex=function(n,r){var s=n.tab;if(n.fmt==1)return s.indexOf(r);if(n.fmt==2){var o=e._lctf.getInterval(s,r);if(o!=-1)return s[o+2]+(r-s[o])}return-1},e._lctf.readFeatureList=function(n,r){var s=e._bin,o=r,a=[],c=s.readUshort(n,r);r+=2;for(var h=0;h<c;h++){var u=s.readASCII(n,r,4);r+=4;var f=s.readUshort(n,r);r+=2;var d=e._lctf.readFeatureTable(n,o+f);d.tag=u.trim(),a.push(d)}return a},e._lctf.readFeatureTable=function(n,r){var s=e._bin,o=r,a={},c=s.readUshort(n,r);r+=2,c>0&&(a.featureParams=o+c);var h=s.readUshort(n,r);r+=2,a.tab=[];for(var u=0;u<h;u++)a.tab.push(s.readUshort(n,r+2*u));return a},e._lctf.readScriptList=function(n,r){var s=e._bin,o=r,a={},c=s.readUshort(n,r);r+=2;for(var h=0;h<c;h++){var u=s.readASCII(n,r,4);r+=4;var f=s.readUshort(n,r);r+=2,a[u.trim()]=e._lctf.readScriptTable(n,o+f)}return a},e._lctf.readScriptTable=function(n,r){var s=e._bin,o=r,a={},c=s.readUshort(n,r);r+=2,a.default=e._lctf.readLangSysTable(n,o+c);var h=s.readUshort(n,r);r+=2;for(var u=0;u<h;u++){var f=s.readASCII(n,r,4);r+=4;var d=s.readUshort(n,r);r+=2,a[f.trim()]=e._lctf.readLangSysTable(n,o+d)}return a},e._lctf.readLangSysTable=function(n,r){var s=e._bin,o={};s.readUshort(n,r),r+=2,o.reqFeature=s.readUshort(n,r),r+=2;var a=s.readUshort(n,r);return r+=2,o.features=s.readUshorts(n,r,a),o},e.CFF={},e.CFF.parse=function(n,r,s){var o=e._bin;(n=new Uint8Array(n.buffer,r,s))[r=0],n[++r],n[++r],n[++r],r++;var a=[];r=e.CFF.readIndex(n,r,a);for(var c=[],h=0;h<a.length-1;h++)c.push(o.readASCII(n,r+a[h],a[h+1]-a[h]));r+=a[a.length-1];var u=[];r=e.CFF.readIndex(n,r,u);var f=[];for(h=0;h<u.length-1;h++)f.push(e.CFF.readDict(n,r+u[h],r+u[h+1]));r+=u[u.length-1];var d=f[0],g=[];r=e.CFF.readIndex(n,r,g);var p=[];for(h=0;h<g.length-1;h++)p.push(o.readASCII(n,r+g[h],g[h+1]-g[h]));if(r+=g[g.length-1],e.CFF.readSubrs(n,r,d),d.CharStrings){r=d.CharStrings,g=[],r=e.CFF.readIndex(n,r,g);var m=[];for(h=0;h<g.length-1;h++)m.push(o.readBytes(n,r+g[h],g[h+1]-g[h]));d.CharStrings=m}if(d.ROS){r=d.FDArray;var _=[];for(r=e.CFF.readIndex(n,r,_),d.FDArray=[],h=0;h<_.length-1;h++){var x=e.CFF.readDict(n,r+_[h],r+_[h+1]);e.CFF._readFDict(n,x,p),d.FDArray.push(x)}r+=_[_.length-1],r=d.FDSelect,d.FDSelect=[];var b=n[r];if(r++,b!=3)throw b;var y=o.readUshort(n,r);for(r+=2,h=0;h<y+1;h++)d.FDSelect.push(o.readUshort(n,r),n[r+2]),r+=3}return d.Encoding&&(d.Encoding=e.CFF.readEncoding(n,d.Encoding,d.CharStrings.length)),d.charset&&(d.charset=e.CFF.readCharset(n,d.charset,d.CharStrings.length)),e.CFF._readFDict(n,d,p),d},e.CFF._readFDict=function(n,r,s){var o;for(var a in r.Private&&(o=r.Private[1],r.Private=e.CFF.readDict(n,o,o+r.Private[0]),r.Private.Subrs&&e.CFF.readSubrs(n,o+r.Private.Subrs,r.Private)),r)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(a)!=-1&&(r[a]=s[r[a]-426+35])},e.CFF.readSubrs=function(n,r,s){var o=e._bin,a=[];r=e.CFF.readIndex(n,r,a);var c,h=a.length;c=h<1240?107:h<33900?1131:32768,s.Bias=c,s.Subrs=[];for(var u=0;u<a.length-1;u++)s.Subrs.push(o.readBytes(n,r+a[u],a[u+1]-a[u]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(n,r){for(var s=0;s<n.charset.length;s++)if(n.charset[s]==r)return s;return-1},e.CFF.glyphBySE=function(n,r){return r<0||r>255?-1:e.CFF.glyphByUnicode(n,e.CFF.tableSE[r])},e.CFF.readEncoding=function(n,r,s){e._bin;var o=[".notdef"],a=n[r];if(r++,a!=0)throw"error: unknown encoding format: "+a;var c=n[r];r++;for(var h=0;h<c;h++)o.push(n[r+h]);return o},e.CFF.readCharset=function(n,r,s){var o=e._bin,a=[".notdef"],c=n[r];if(r++,c==0)for(var h=0;h<s;h++){var u=o.readUshort(n,r);r+=2,a.push(u)}else{if(c!=1&&c!=2)throw"error: format: "+c;for(;a.length<s;){u=o.readUshort(n,r),r+=2;var f=0;for(c==1?(f=n[r],r++):(f=o.readUshort(n,r),r+=2),h=0;h<=f;h++)a.push(u),u++}}return a},e.CFF.readIndex=function(n,r,s){var o=e._bin,a=o.readUshort(n,r)+1,c=n[r+=2];if(r++,c==1)for(var h=0;h<a;h++)s.push(n[r+h]);else if(c==2)for(h=0;h<a;h++)s.push(o.readUshort(n,r+2*h));else if(c==3)for(h=0;h<a;h++)s.push(16777215&o.readUint(n,r+3*h-1));else if(a!=1)throw"unsupported offset size: "+c+", count: "+a;return(r+=a*c)-1},e.CFF.getCharString=function(n,r,s){var o=e._bin,a=n[r],c=n[r+1];n[r+2],n[r+3],n[r+4];var h=1,u=null,f=null;a<=20&&(u=a,h=1),a==12&&(u=100*a+c,h=2),21<=a&&a<=27&&(u=a,h=1),a==28&&(f=o.readShort(n,r+1),h=3),29<=a&&a<=31&&(u=a,h=1),32<=a&&a<=246&&(f=a-139,h=1),247<=a&&a<=250&&(f=256*(a-247)+c+108,h=2),251<=a&&a<=254&&(f=256*-(a-251)-c-108,h=2),a==255&&(f=o.readInt(n,r+1)/65535,h=5),s.val=f!=null?f:"o"+u,s.size=h},e.CFF.readCharString=function(n,r,s){for(var o=r+s,a=e._bin,c=[];r<o;){var h=n[r],u=n[r+1];n[r+2],n[r+3],n[r+4];var f=1,d=null,g=null;h<=20&&(d=h,f=1),h==12&&(d=100*h+u,f=2),h!=19&&h!=20||(d=h,f=2),21<=h&&h<=27&&(d=h,f=1),h==28&&(g=a.readShort(n,r+1),f=3),29<=h&&h<=31&&(d=h,f=1),32<=h&&h<=246&&(g=h-139,f=1),247<=h&&h<=250&&(g=256*(h-247)+u+108,f=2),251<=h&&h<=254&&(g=256*-(h-251)-u-108,f=2),h==255&&(g=a.readInt(n,r+1)/65535,f=5),c.push(g!=null?g:"o"+d),r+=f}return c},e.CFF.readDict=function(n,r,s){for(var o=e._bin,a={},c=[];r<s;){var h=n[r],u=n[r+1];n[r+2],n[r+3],n[r+4];var f=1,d=null,g=null;if(h==28&&(g=o.readShort(n,r+1),f=3),h==29&&(g=o.readInt(n,r+1),f=5),32<=h&&h<=246&&(g=h-139,f=1),247<=h&&h<=250&&(g=256*(h-247)+u+108,f=2),251<=h&&h<=254&&(g=256*-(h-251)-u-108,f=2),h==255)throw g=o.readInt(n,r+1)/65535,f=5,"unknown number";if(h==30){var p=[];for(f=1;;){var m=n[r+f];f++;var _=m>>4,x=15&m;if(_!=15&&p.push(_),x!=15&&p.push(x),x==15)break}for(var b="",y=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],v=0;v<p.length;v++)b+=y[p[v]];g=parseFloat(b)}h<=21&&(d=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][h],f=1,h==12&&(d=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][u],f=2)),d!=null?(a[d]=c.length==1?c[0]:c,c=[]):c.push(g),r+=f}return a},e.cmap={},e.cmap.parse=function(n,r,s){n=new Uint8Array(n.buffer,r,s),r=0;var o=e._bin,a={};o.readUshort(n,r),r+=2;var c=o.readUshort(n,r);r+=2;var h=[];a.tables=[];for(var u=0;u<c;u++){var f=o.readUshort(n,r);r+=2;var d=o.readUshort(n,r);r+=2;var g=o.readUint(n,r);r+=4;var p="p"+f+"e"+d,m=h.indexOf(g);if(m==-1){var _;m=a.tables.length,h.push(g);var x=o.readUshort(n,g);x==0?_=e.cmap.parse0(n,g):x==4?_=e.cmap.parse4(n,g):x==6?_=e.cmap.parse6(n,g):x==12?_=e.cmap.parse12(n,g):console.debug("unknown format: "+x,f,d,g),a.tables.push(_)}if(a[p]!=null)throw"multiple tables for one platform+encoding";a[p]=m}return a},e.cmap.parse0=function(n,r){var s=e._bin,o={};o.format=s.readUshort(n,r),r+=2;var a=s.readUshort(n,r);r+=2,s.readUshort(n,r),r+=2,o.map=[];for(var c=0;c<a-6;c++)o.map.push(n[r+c]);return o},e.cmap.parse4=function(n,r){var s=e._bin,o=r,a={};a.format=s.readUshort(n,r),r+=2;var c=s.readUshort(n,r);r+=2,s.readUshort(n,r),r+=2;var h=s.readUshort(n,r);r+=2;var u=h/2;a.searchRange=s.readUshort(n,r),r+=2,a.entrySelector=s.readUshort(n,r),r+=2,a.rangeShift=s.readUshort(n,r),r+=2,a.endCount=s.readUshorts(n,r,u),r+=2*u,r+=2,a.startCount=s.readUshorts(n,r,u),r+=2*u,a.idDelta=[];for(var f=0;f<u;f++)a.idDelta.push(s.readShort(n,r)),r+=2;for(a.idRangeOffset=s.readUshorts(n,r,u),r+=2*u,a.glyphIdArray=[];r<o+c;)a.glyphIdArray.push(s.readUshort(n,r)),r+=2;return a},e.cmap.parse6=function(n,r){var s=e._bin,o={};o.format=s.readUshort(n,r),r+=2,s.readUshort(n,r),r+=2,s.readUshort(n,r),r+=2,o.firstCode=s.readUshort(n,r),r+=2;var a=s.readUshort(n,r);r+=2,o.glyphIdArray=[];for(var c=0;c<a;c++)o.glyphIdArray.push(s.readUshort(n,r)),r+=2;return o},e.cmap.parse12=function(n,r){var s=e._bin,o={};o.format=s.readUshort(n,r),r+=2,r+=2,s.readUint(n,r),r+=4,s.readUint(n,r),r+=4;var a=s.readUint(n,r);r+=4,o.groups=[];for(var c=0;c<a;c++){var h=r+12*c,u=s.readUint(n,h+0),f=s.readUint(n,h+4),d=s.readUint(n,h+8);o.groups.push([u,f,d])}return o},e.glyf={},e.glyf.parse=function(n,r,s,o){for(var a=[],c=0;c<o.maxp.numGlyphs;c++)a.push(null);return a},e.glyf._parseGlyf=function(n,r){var s=e._bin,o=n._data,a=e._tabOffset(o,"glyf",n._offset)+n.loca[r];if(n.loca[r]==n.loca[r+1])return null;var c={};if(c.noc=s.readShort(o,a),a+=2,c.xMin=s.readShort(o,a),a+=2,c.yMin=s.readShort(o,a),a+=2,c.xMax=s.readShort(o,a),a+=2,c.yMax=s.readShort(o,a),a+=2,c.xMin>=c.xMax||c.yMin>=c.yMax)return null;if(c.noc>0){c.endPts=[];for(var h=0;h<c.noc;h++)c.endPts.push(s.readUshort(o,a)),a+=2;var u=s.readUshort(o,a);if(a+=2,o.length-a<u)return null;c.instructions=s.readBytes(o,a,u),a+=u;var f=c.endPts[c.noc-1]+1;for(c.flags=[],h=0;h<f;h++){var d=o[a];if(a++,c.flags.push(d),(8&d)!=0){var g=o[a];a++;for(var p=0;p<g;p++)c.flags.push(d),h++}}for(c.xs=[],h=0;h<f;h++){var m=(2&c.flags[h])!=0,_=(16&c.flags[h])!=0;m?(c.xs.push(_?o[a]:-o[a]),a++):_?c.xs.push(0):(c.xs.push(s.readShort(o,a)),a+=2)}for(c.ys=[],h=0;h<f;h++)m=(4&c.flags[h])!=0,_=(32&c.flags[h])!=0,m?(c.ys.push(_?o[a]:-o[a]),a++):_?c.ys.push(0):(c.ys.push(s.readShort(o,a)),a+=2);var x=0,b=0;for(h=0;h<f;h++)x+=c.xs[h],b+=c.ys[h],c.xs[h]=x,c.ys[h]=b}else{var y;c.parts=[];do{y=s.readUshort(o,a),a+=2;var v={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(c.parts.push(v),v.glyphIndex=s.readUshort(o,a),a+=2,1&y){var M=s.readShort(o,a);a+=2;var S=s.readShort(o,a);a+=2}else M=s.readInt8(o,a),a++,S=s.readInt8(o,a),a++;2&y?(v.m.tx=M,v.m.ty=S):(v.p1=M,v.p2=S),8&y?(v.m.a=v.m.d=s.readF2dot14(o,a),a+=2):64&y?(v.m.a=s.readF2dot14(o,a),a+=2,v.m.d=s.readF2dot14(o,a),a+=2):128&y&&(v.m.a=s.readF2dot14(o,a),a+=2,v.m.b=s.readF2dot14(o,a),a+=2,v.m.c=s.readF2dot14(o,a),a+=2,v.m.d=s.readF2dot14(o,a),a+=2)}while(32&y);if(256&y){var w=s.readUshort(o,a);for(a+=2,c.instr=[],h=0;h<w;h++)c.instr.push(o[a]),a++}}return c},e.GPOS={},e.GPOS.parse=function(n,r,s,o){return e._lctf.parse(n,r,s,o,e.GPOS.subt)},e.GPOS.subt=function(n,r,s,o){var a=e._bin,c=s,h={};if(h.fmt=a.readUshort(n,s),s+=2,r==1||r==2||r==3||r==7||r==8&&h.fmt<=2){var u=a.readUshort(n,s);s+=2,h.coverage=e._lctf.readCoverage(n,u+c)}if(r==1&&h.fmt==1){var f=a.readUshort(n,s);s+=2;var d=e._lctf.numOfOnes(f);f!=0&&(h.pos=e.GPOS.readValueRecord(n,s,f))}else if(r==2&&h.fmt>=1&&h.fmt<=2){f=a.readUshort(n,s),s+=2;var g=a.readUshort(n,s);s+=2,d=e._lctf.numOfOnes(f);var p=e._lctf.numOfOnes(g);if(h.fmt==1){h.pairsets=[];var m=a.readUshort(n,s);s+=2;for(var _=0;_<m;_++){var x=c+a.readUshort(n,s);s+=2;var b=a.readUshort(n,x);x+=2;for(var y=[],v=0;v<b;v++){var M=a.readUshort(n,x);x+=2,f!=0&&(I=e.GPOS.readValueRecord(n,x,f),x+=2*d),g!=0&&(U=e.GPOS.readValueRecord(n,x,g),x+=2*p),y.push({gid2:M,val1:I,val2:U})}h.pairsets.push(y)}}if(h.fmt==2){var S=a.readUshort(n,s);s+=2;var w=a.readUshort(n,s);s+=2;var T=a.readUshort(n,s);s+=2;var R=a.readUshort(n,s);for(s+=2,h.classDef1=e._lctf.readClassDef(n,c+S),h.classDef2=e._lctf.readClassDef(n,c+w),h.matrix=[],_=0;_<T;_++){var D=[];for(v=0;v<R;v++){var I=null,U=null;f!=0&&(I=e.GPOS.readValueRecord(n,s,f),s+=2*d),g!=0&&(U=e.GPOS.readValueRecord(n,s,g),s+=2*p),D.push({val1:I,val2:U})}h.matrix.push(D)}}}else{if(r==9&&h.fmt==1){var A=a.readUshort(n,s);s+=2;var B=a.readUint(n,s);if(s+=4,o.ltype==9)o.ltype=A;else if(o.ltype!=A)throw"invalid extension substitution";return e.GPOS.subt(n,o.ltype,c+B)}console.debug("unsupported GPOS table LookupType",r,"format",h.fmt)}return h},e.GPOS.readValueRecord=function(n,r,s){var o=e._bin,a=[];return a.push(1&s?o.readShort(n,r):0),r+=1&s?2:0,a.push(2&s?o.readShort(n,r):0),r+=2&s?2:0,a.push(4&s?o.readShort(n,r):0),r+=4&s?2:0,a.push(8&s?o.readShort(n,r):0),r+=8&s?2:0,a},e.GSUB={},e.GSUB.parse=function(n,r,s,o){return e._lctf.parse(n,r,s,o,e.GSUB.subt)},e.GSUB.subt=function(n,r,s,o){var a=e._bin,c=s,h={};if(h.fmt=a.readUshort(n,s),s+=2,r!=1&&r!=4&&r!=5&&r!=6)return null;if(r==1||r==4||r==5&&h.fmt<=2||r==6&&h.fmt<=2){var u=a.readUshort(n,s);s+=2,h.coverage=e._lctf.readCoverage(n,c+u)}if(r==1&&h.fmt>=1&&h.fmt<=2){if(h.fmt==1)h.delta=a.readShort(n,s),s+=2;else if(h.fmt==2){var f=a.readUshort(n,s);s+=2,h.newg=a.readUshorts(n,s,f),s+=2*h.newg.length}}else if(r==4){h.vals=[],f=a.readUshort(n,s),s+=2;for(var d=0;d<f;d++){var g=a.readUshort(n,s);s+=2,h.vals.push(e.GSUB.readLigatureSet(n,c+g))}}else if(r==5&&h.fmt==2){if(h.fmt==2){var p=a.readUshort(n,s);s+=2,h.cDef=e._lctf.readClassDef(n,c+p),h.scset=[];var m=a.readUshort(n,s);for(s+=2,d=0;d<m;d++){var _=a.readUshort(n,s);s+=2,h.scset.push(_==0?null:e.GSUB.readSubClassSet(n,c+_))}}}else if(r==6&&h.fmt==3){if(h.fmt==3){for(d=0;d<3;d++){f=a.readUshort(n,s),s+=2;for(var x=[],b=0;b<f;b++)x.push(e._lctf.readCoverage(n,c+a.readUshort(n,s+2*b)));s+=2*f,d==0&&(h.backCvg=x),d==1&&(h.inptCvg=x),d==2&&(h.ahedCvg=x)}f=a.readUshort(n,s),s+=2,h.lookupRec=e.GSUB.readSubstLookupRecords(n,s,f)}}else{if(r==7&&h.fmt==1){var y=a.readUshort(n,s);s+=2;var v=a.readUint(n,s);if(s+=4,o.ltype==9)o.ltype=y;else if(o.ltype!=y)throw"invalid extension substitution";return e.GSUB.subt(n,o.ltype,c+v)}console.debug("unsupported GSUB table LookupType",r,"format",h.fmt)}return h},e.GSUB.readSubClassSet=function(n,r){var s=e._bin.readUshort,o=r,a=[],c=s(n,r);r+=2;for(var h=0;h<c;h++){var u=s(n,r);r+=2,a.push(e.GSUB.readSubClassRule(n,o+u))}return a},e.GSUB.readSubClassRule=function(n,r){var s=e._bin.readUshort,o={},a=s(n,r),c=s(n,r+=2);r+=2,o.input=[];for(var h=0;h<a-1;h++)o.input.push(s(n,r)),r+=2;return o.substLookupRecords=e.GSUB.readSubstLookupRecords(n,r,c),o},e.GSUB.readSubstLookupRecords=function(n,r,s){for(var o=e._bin.readUshort,a=[],c=0;c<s;c++)a.push(o(n,r),o(n,r+2)),r+=4;return a},e.GSUB.readChainSubClassSet=function(n,r){var s=e._bin,o=r,a=[],c=s.readUshort(n,r);r+=2;for(var h=0;h<c;h++){var u=s.readUshort(n,r);r+=2,a.push(e.GSUB.readChainSubClassRule(n,o+u))}return a},e.GSUB.readChainSubClassRule=function(n,r){for(var s=e._bin,o={},a=["backtrack","input","lookahead"],c=0;c<a.length;c++){var h=s.readUshort(n,r);r+=2,c==1&&h--,o[a[c]]=s.readUshorts(n,r,h),r+=2*o[a[c]].length}return h=s.readUshort(n,r),r+=2,o.subst=s.readUshorts(n,r,2*h),r+=2*o.subst.length,o},e.GSUB.readLigatureSet=function(n,r){var s=e._bin,o=r,a=[],c=s.readUshort(n,r);r+=2;for(var h=0;h<c;h++){var u=s.readUshort(n,r);r+=2,a.push(e.GSUB.readLigature(n,o+u))}return a},e.GSUB.readLigature=function(n,r){var s=e._bin,o={chain:[]};o.nglyph=s.readUshort(n,r),r+=2;var a=s.readUshort(n,r);r+=2;for(var c=0;c<a-1;c++)o.chain.push(s.readUshort(n,r)),r+=2;return o},e.head={},e.head.parse=function(n,r,s){var o=e._bin,a={};return o.readFixed(n,r),r+=4,a.fontRevision=o.readFixed(n,r),r+=4,o.readUint(n,r),r+=4,o.readUint(n,r),r+=4,a.flags=o.readUshort(n,r),r+=2,a.unitsPerEm=o.readUshort(n,r),r+=2,a.created=o.readUint64(n,r),r+=8,a.modified=o.readUint64(n,r),r+=8,a.xMin=o.readShort(n,r),r+=2,a.yMin=o.readShort(n,r),r+=2,a.xMax=o.readShort(n,r),r+=2,a.yMax=o.readShort(n,r),r+=2,a.macStyle=o.readUshort(n,r),r+=2,a.lowestRecPPEM=o.readUshort(n,r),r+=2,a.fontDirectionHint=o.readShort(n,r),r+=2,a.indexToLocFormat=o.readShort(n,r),r+=2,a.glyphDataFormat=o.readShort(n,r),r+=2,a},e.hhea={},e.hhea.parse=function(n,r,s){var o=e._bin,a={};return o.readFixed(n,r),r+=4,a.ascender=o.readShort(n,r),r+=2,a.descender=o.readShort(n,r),r+=2,a.lineGap=o.readShort(n,r),r+=2,a.advanceWidthMax=o.readUshort(n,r),r+=2,a.minLeftSideBearing=o.readShort(n,r),r+=2,a.minRightSideBearing=o.readShort(n,r),r+=2,a.xMaxExtent=o.readShort(n,r),r+=2,a.caretSlopeRise=o.readShort(n,r),r+=2,a.caretSlopeRun=o.readShort(n,r),r+=2,a.caretOffset=o.readShort(n,r),r+=2,r+=8,a.metricDataFormat=o.readShort(n,r),r+=2,a.numberOfHMetrics=o.readUshort(n,r),r+=2,a},e.hmtx={},e.hmtx.parse=function(n,r,s,o){for(var a=e._bin,c={aWidth:[],lsBearing:[]},h=0,u=0,f=0;f<o.maxp.numGlyphs;f++)f<o.hhea.numberOfHMetrics&&(h=a.readUshort(n,r),r+=2,u=a.readShort(n,r),r+=2),c.aWidth.push(h),c.lsBearing.push(u);return c},e.kern={},e.kern.parse=function(n,r,s,o){var a=e._bin,c=a.readUshort(n,r);if(r+=2,c==1)return e.kern.parseV1(n,r-2,s,o);var h=a.readUshort(n,r);r+=2;for(var u={glyph1:[],rval:[]},f=0;f<h;f++){r+=2,s=a.readUshort(n,r),r+=2;var d=a.readUshort(n,r);r+=2;var g=d>>>8;if((g&=15)!=0)throw"unknown kern table format: "+g;r=e.kern.readFormat0(n,r,u)}return u},e.kern.parseV1=function(n,r,s,o){var a=e._bin;a.readFixed(n,r),r+=4;var c=a.readUint(n,r);r+=4;for(var h={glyph1:[],rval:[]},u=0;u<c;u++){a.readUint(n,r),r+=4;var f=a.readUshort(n,r);r+=2,a.readUshort(n,r),r+=2;var d=f>>>8;if((d&=15)!=0)throw"unknown kern table format: "+d;r=e.kern.readFormat0(n,r,h)}return h},e.kern.readFormat0=function(n,r,s){var o=e._bin,a=-1,c=o.readUshort(n,r);r+=2,o.readUshort(n,r),r+=2,o.readUshort(n,r),r+=2,o.readUshort(n,r),r+=2;for(var h=0;h<c;h++){var u=o.readUshort(n,r);r+=2;var f=o.readUshort(n,r);r+=2;var d=o.readShort(n,r);r+=2,u!=a&&(s.glyph1.push(u),s.rval.push({glyph2:[],vals:[]}));var g=s.rval[s.rval.length-1];g.glyph2.push(f),g.vals.push(d),a=u}return r},e.loca={},e.loca.parse=function(n,r,s,o){var a=e._bin,c=[],h=o.head.indexToLocFormat,u=o.maxp.numGlyphs+1;if(h==0)for(var f=0;f<u;f++)c.push(a.readUshort(n,r+(f<<1))<<1);if(h==1)for(f=0;f<u;f++)c.push(a.readUint(n,r+(f<<2)));return c},e.maxp={},e.maxp.parse=function(n,r,s){var o=e._bin,a={},c=o.readUint(n,r);return r+=4,a.numGlyphs=o.readUshort(n,r),r+=2,c==65536&&(a.maxPoints=o.readUshort(n,r),r+=2,a.maxContours=o.readUshort(n,r),r+=2,a.maxCompositePoints=o.readUshort(n,r),r+=2,a.maxCompositeContours=o.readUshort(n,r),r+=2,a.maxZones=o.readUshort(n,r),r+=2,a.maxTwilightPoints=o.readUshort(n,r),r+=2,a.maxStorage=o.readUshort(n,r),r+=2,a.maxFunctionDefs=o.readUshort(n,r),r+=2,a.maxInstructionDefs=o.readUshort(n,r),r+=2,a.maxStackElements=o.readUshort(n,r),r+=2,a.maxSizeOfInstructions=o.readUshort(n,r),r+=2,a.maxComponentElements=o.readUshort(n,r),r+=2,a.maxComponentDepth=o.readUshort(n,r),r+=2),a},e.name={},e.name.parse=function(n,r,s){var o=e._bin,a={};o.readUshort(n,r),r+=2;var c=o.readUshort(n,r);r+=2,o.readUshort(n,r);for(var h,u=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],f=r+=2,d=0;d<c;d++){var g=o.readUshort(n,r);r+=2;var p=o.readUshort(n,r);r+=2;var m=o.readUshort(n,r);r+=2;var _=o.readUshort(n,r);r+=2;var x=o.readUshort(n,r);r+=2;var b=o.readUshort(n,r);r+=2;var y,v=u[_],M=f+12*c+b;if(g==0)y=o.readUnicode(n,M,x/2);else if(g==3&&p==0)y=o.readUnicode(n,M,x/2);else if(p==0)y=o.readASCII(n,M,x);else if(p==1)y=o.readUnicode(n,M,x/2);else if(p==3)y=o.readUnicode(n,M,x/2);else{if(g!=1)throw"unknown encoding "+p+", platformID: "+g;y=o.readASCII(n,M,x),console.debug("reading unknown MAC encoding "+p+" as ASCII")}var S="p"+g+","+m.toString(16);a[S]==null&&(a[S]={}),a[S][v!==void 0?v:_]=y,a[S]._lang=m}for(var w in a)if(a[w].postScriptName!=null&&a[w]._lang==1033)return a[w];for(var w in a)if(a[w].postScriptName!=null&&a[w]._lang==0)return a[w];for(var w in a)if(a[w].postScriptName!=null&&a[w]._lang==3084)return a[w];for(var w in a)if(a[w].postScriptName!=null)return a[w];for(var w in a){h=w;break}return console.debug("returning name table with languageID "+a[h]._lang),a[h]},e["OS/2"]={},e["OS/2"].parse=function(n,r,s){var o=e._bin.readUshort(n,r);r+=2;var a={};if(o==0)e["OS/2"].version0(n,r,a);else if(o==1)e["OS/2"].version1(n,r,a);else if(o==2||o==3||o==4)e["OS/2"].version2(n,r,a);else{if(o!=5)throw"unknown OS/2 table version: "+o;e["OS/2"].version5(n,r,a)}return a},e["OS/2"].version0=function(n,r,s){var o=e._bin;return s.xAvgCharWidth=o.readShort(n,r),r+=2,s.usWeightClass=o.readUshort(n,r),r+=2,s.usWidthClass=o.readUshort(n,r),r+=2,s.fsType=o.readUshort(n,r),r+=2,s.ySubscriptXSize=o.readShort(n,r),r+=2,s.ySubscriptYSize=o.readShort(n,r),r+=2,s.ySubscriptXOffset=o.readShort(n,r),r+=2,s.ySubscriptYOffset=o.readShort(n,r),r+=2,s.ySuperscriptXSize=o.readShort(n,r),r+=2,s.ySuperscriptYSize=o.readShort(n,r),r+=2,s.ySuperscriptXOffset=o.readShort(n,r),r+=2,s.ySuperscriptYOffset=o.readShort(n,r),r+=2,s.yStrikeoutSize=o.readShort(n,r),r+=2,s.yStrikeoutPosition=o.readShort(n,r),r+=2,s.sFamilyClass=o.readShort(n,r),r+=2,s.panose=o.readBytes(n,r,10),r+=10,s.ulUnicodeRange1=o.readUint(n,r),r+=4,s.ulUnicodeRange2=o.readUint(n,r),r+=4,s.ulUnicodeRange3=o.readUint(n,r),r+=4,s.ulUnicodeRange4=o.readUint(n,r),r+=4,s.achVendID=[o.readInt8(n,r),o.readInt8(n,r+1),o.readInt8(n,r+2),o.readInt8(n,r+3)],r+=4,s.fsSelection=o.readUshort(n,r),r+=2,s.usFirstCharIndex=o.readUshort(n,r),r+=2,s.usLastCharIndex=o.readUshort(n,r),r+=2,s.sTypoAscender=o.readShort(n,r),r+=2,s.sTypoDescender=o.readShort(n,r),r+=2,s.sTypoLineGap=o.readShort(n,r),r+=2,s.usWinAscent=o.readUshort(n,r),r+=2,s.usWinDescent=o.readUshort(n,r),r+=2},e["OS/2"].version1=function(n,r,s){var o=e._bin;return r=e["OS/2"].version0(n,r,s),s.ulCodePageRange1=o.readUint(n,r),r+=4,s.ulCodePageRange2=o.readUint(n,r),r+=4},e["OS/2"].version2=function(n,r,s){var o=e._bin;return r=e["OS/2"].version1(n,r,s),s.sxHeight=o.readShort(n,r),r+=2,s.sCapHeight=o.readShort(n,r),r+=2,s.usDefault=o.readUshort(n,r),r+=2,s.usBreak=o.readUshort(n,r),r+=2,s.usMaxContext=o.readUshort(n,r),r+=2},e["OS/2"].version5=function(n,r,s){var o=e._bin;return r=e["OS/2"].version2(n,r,s),s.usLowerOpticalPointSize=o.readUshort(n,r),r+=2,s.usUpperOpticalPointSize=o.readUshort(n,r),r+=2},e.post={},e.post.parse=function(n,r,s){var o=e._bin,a={};return a.version=o.readFixed(n,r),r+=4,a.italicAngle=o.readFixed(n,r),r+=4,a.underlinePosition=o.readShort(n,r),r+=2,a.underlineThickness=o.readShort(n,r),r+=2,a},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(n,r){var s=n.cmap,o=-1;if(s.p0e4!=null?o=s.p0e4:s.p3e1!=null?o=s.p3e1:s.p1e0!=null?o=s.p1e0:s.p0e3!=null&&(o=s.p0e3),o==-1)throw"no familiar platform and encoding!";var a=s.tables[o];if(a.format==0)return r>=a.map.length?0:a.map[r];if(a.format==4){for(var c=-1,h=0;h<a.endCount.length;h++)if(r<=a.endCount[h]){c=h;break}return c==-1||a.startCount[c]>r?0:65535&(a.idRangeOffset[c]!=0?a.glyphIdArray[r-a.startCount[c]+(a.idRangeOffset[c]>>1)-(a.idRangeOffset.length-c)]:r+a.idDelta[c])}if(a.format==12){if(r>a.groups[a.groups.length-1][1])return 0;for(h=0;h<a.groups.length;h++){var u=a.groups[h];if(u[0]<=r&&r<=u[1])return u[2]+(r-u[0])}return 0}throw"unknown cmap table format "+a.format},e.U.glyphToPath=function(n,r){var s={cmds:[],crds:[]};if(n.SVG&&n.SVG.entries[r]){var o=n.SVG.entries[r];return o==null?s:(typeof o=="string"&&(o=e.SVG.toPath(o),n.SVG.entries[r]=o),o)}if(n.CFF){var a={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:n.CFF.Private?n.CFF.Private.defaultWidthX:0,open:!1},c=n.CFF,h=n.CFF.Private;if(c.ROS){for(var u=0;c.FDSelect[u+2]<=r;)u+=2;h=c.FDArray[c.FDSelect[u+1]].Private}e.U._drawCFF(n.CFF.CharStrings[r],a,c,h,s)}else n.glyf&&e.U._drawGlyf(r,n,s);return s},e.U._drawGlyf=function(n,r,s){var o=r.glyf[n];o==null&&(o=r.glyf[n]=e.glyf._parseGlyf(r,n)),o!=null&&(o.noc>-1?e.U._simpleGlyph(o,s):e.U._compoGlyph(o,r,s))},e.U._simpleGlyph=function(n,r){for(var s=0;s<n.noc;s++){for(var o=s==0?0:n.endPts[s-1]+1,a=n.endPts[s],c=o;c<=a;c++){var h=c==o?a:c-1,u=c==a?o:c+1,f=1&n.flags[c],d=1&n.flags[h],g=1&n.flags[u],p=n.xs[c],m=n.ys[c];if(c==o)if(f){if(!d){e.U.P.moveTo(r,p,m);continue}e.U.P.moveTo(r,n.xs[h],n.ys[h])}else d?e.U.P.moveTo(r,n.xs[h],n.ys[h]):e.U.P.moveTo(r,(n.xs[h]+p)/2,(n.ys[h]+m)/2);f?d&&e.U.P.lineTo(r,p,m):g?e.U.P.qcurveTo(r,p,m,n.xs[u],n.ys[u]):e.U.P.qcurveTo(r,p,m,(p+n.xs[u])/2,(m+n.ys[u])/2)}e.U.P.closePath(r)}},e.U._compoGlyph=function(n,r,s){for(var o=0;o<n.parts.length;o++){var a={cmds:[],crds:[]},c=n.parts[o];e.U._drawGlyf(c.glyphIndex,r,a);for(var h=c.m,u=0;u<a.crds.length;u+=2){var f=a.crds[u],d=a.crds[u+1];s.crds.push(f*h.a+d*h.b+h.tx),s.crds.push(f*h.c+d*h.d+h.ty)}for(u=0;u<a.cmds.length;u++)s.cmds.push(a.cmds[u])}},e.U._getGlyphClass=function(n,r){var s=e._lctf.getInterval(r,n);return s==-1?0:r[s+2]},e.U.getPairAdjustment=function(n,r,s){var o=0,a=!1;if(n.GPOS)for(var c=n.GPOS,h=c.lookupList,u=c.featureList,f=[],d=0;d<u.length;d++){var g=u[d];if(g.tag=="kern"){a=!0;for(var p=0;p<g.tab.length;p++)if(!f[g.tab[p]]){f[g.tab[p]]=!0;for(var m=h[g.tab[p]],_=0;_<m.tabs.length;_++)if(m.tabs[_]!=null){var x,b=m.tabs[_];if((!b.coverage||(x=e._lctf.coverageIndex(b.coverage,r))!=-1)&&m.ltype!=1){if(m.ltype==2){var y;if(b.fmt==1){var v=b.pairsets[x];for(d=0;d<v.length;d++)v[d].gid2==s&&(y=v[d])}else if(b.fmt==2){var M=e.U._getGlyphClass(r,b.classDef1),S=e.U._getGlyphClass(s,b.classDef2);y=b.matrix[M][S]}y&&y.val1&&y.val1[2]&&(o+=y.val1[2]),y&&y.val2&&y.val2[0]&&(o+=y.val2[0])}}}}}}if(n.kern&&!a){var w=n.kern.glyph1.indexOf(r);if(w!=-1){var T=n.kern.rval[w].glyph2.indexOf(s);T!=-1&&(o+=n.kern.rval[w].vals[T])}}return o},e.U._applySubs=function(n,r,s,o){for(var a=n.length-r-1,c=0;c<s.tabs.length;c++)if(s.tabs[c]!=null){var h,u=s.tabs[c];if(!u.coverage||(h=e._lctf.coverageIndex(u.coverage,n[r]))!=-1){if(s.ltype==1)n[r],u.fmt==1?n[r]=n[r]+u.delta:n[r]=u.newg[h];else if(s.ltype==4)for(var f=u.vals[h],d=0;d<f.length;d++){var g=f[d],p=g.chain.length;if(!(p>a)){for(var m=!0,_=0,x=0;x<p;x++){for(;n[r+_+(1+x)]==-1;)_++;g.chain[x]!=n[r+_+(1+x)]&&(m=!1)}if(m){for(n[r]=g.nglyph,x=0;x<p+_;x++)n[r+x+1]=-1;break}}}else if(s.ltype==5&&u.fmt==2)for(var b=e._lctf.getInterval(u.cDef,n[r]),y=u.cDef[b+2],v=u.scset[y],M=0;M<v.length;M++){var S=v[M],w=S.input;if(!(w.length>a)){for(m=!0,x=0;x<w.length;x++){var T=e._lctf.getInterval(u.cDef,n[r+1+x]);if(b==-1&&u.cDef[T+2]!=w[x]){m=!1;break}}if(m){var R=S.substLookupRecords;for(d=0;d<R.length;d+=2)R[d],R[d+1]}}}else if(s.ltype==6&&u.fmt==3){if(!e.U._glsCovered(n,u.backCvg,r-u.backCvg.length)||!e.U._glsCovered(n,u.inptCvg,r)||!e.U._glsCovered(n,u.ahedCvg,r+u.inptCvg.length))continue;var D=u.lookupRec;for(M=0;M<D.length;M+=2){b=D[M];var I=o[D[M+1]];e.U._applySubs(n,r+b,I,o)}}}}},e.U._glsCovered=function(n,r,s){for(var o=0;o<r.length;o++)if(e._lctf.coverageIndex(r[o],n[s+o])==-1)return!1;return!0},e.U.glyphsToPath=function(n,r,s){for(var o={cmds:[],crds:[]},a=0,c=0;c<r.length;c++){var h=r[c];if(h!=-1){for(var u=c<r.length-1&&r[c+1]!=-1?r[c+1]:0,f=e.U.glyphToPath(n,h),d=0;d<f.crds.length;d+=2)o.crds.push(f.crds[d]+a),o.crds.push(f.crds[d+1]);for(s&&o.cmds.push(s),d=0;d<f.cmds.length;d++)o.cmds.push(f.cmds[d]);s&&o.cmds.push("X"),a+=n.hmtx.aWidth[h],c<r.length-1&&(a+=e.U.getPairAdjustment(n,h,u))}}return o},e.U.P={},e.U.P.moveTo=function(n,r,s){n.cmds.push("M"),n.crds.push(r,s)},e.U.P.lineTo=function(n,r,s){n.cmds.push("L"),n.crds.push(r,s)},e.U.P.curveTo=function(n,r,s,o,a,c,h){n.cmds.push("C"),n.crds.push(r,s,o,a,c,h)},e.U.P.qcurveTo=function(n,r,s,o,a){n.cmds.push("Q"),n.crds.push(r,s,o,a)},e.U.P.closePath=function(n){n.cmds.push("Z")},e.U._drawCFF=function(n,r,s,o,a){for(var c=r.stack,h=r.nStems,u=r.haveWidth,f=r.width,d=r.open,g=0,p=r.x,m=r.y,_=0,x=0,b=0,y=0,v=0,M=0,S=0,w=0,T=0,R=0,D={val:0,size:0};g<n.length;){e.CFF.getCharString(n,g,D);var I=D.val;if(g+=D.size,I=="o1"||I=="o18")c.length%2!=0&&!u&&(f=c.shift()+o.nominalWidthX),h+=c.length>>1,c.length=0,u=!0;else if(I=="o3"||I=="o23")c.length%2!=0&&!u&&(f=c.shift()+o.nominalWidthX),h+=c.length>>1,c.length=0,u=!0;else if(I=="o4")c.length>1&&!u&&(f=c.shift()+o.nominalWidthX,u=!0),d&&e.U.P.closePath(a),m+=c.pop(),e.U.P.moveTo(a,p,m),d=!0;else if(I=="o5")for(;c.length>0;)p+=c.shift(),m+=c.shift(),e.U.P.lineTo(a,p,m);else if(I=="o6"||I=="o7")for(var U=c.length,A=I=="o6",B=0;B<U;B++){var O=c.shift();A?p+=O:m+=O,A=!A,e.U.P.lineTo(a,p,m)}else if(I=="o8"||I=="o24"){U=c.length;for(var q=0;q+6<=U;)_=p+c.shift(),x=m+c.shift(),b=_+c.shift(),y=x+c.shift(),p=b+c.shift(),m=y+c.shift(),e.U.P.curveTo(a,_,x,b,y,p,m),q+=6;I=="o24"&&(p+=c.shift(),m+=c.shift(),e.U.P.lineTo(a,p,m))}else{if(I=="o11")break;if(I=="o1234"||I=="o1235"||I=="o1236"||I=="o1237")I=="o1234"&&(x=m,b=(_=p+c.shift())+c.shift(),R=y=x+c.shift(),M=y,w=m,p=(S=(v=(T=b+c.shift())+c.shift())+c.shift())+c.shift(),e.U.P.curveTo(a,_,x,b,y,T,R),e.U.P.curveTo(a,v,M,S,w,p,m)),I=="o1235"&&(_=p+c.shift(),x=m+c.shift(),b=_+c.shift(),y=x+c.shift(),T=b+c.shift(),R=y+c.shift(),v=T+c.shift(),M=R+c.shift(),S=v+c.shift(),w=M+c.shift(),p=S+c.shift(),m=w+c.shift(),c.shift(),e.U.P.curveTo(a,_,x,b,y,T,R),e.U.P.curveTo(a,v,M,S,w,p,m)),I=="o1236"&&(_=p+c.shift(),x=m+c.shift(),b=_+c.shift(),R=y=x+c.shift(),M=y,S=(v=(T=b+c.shift())+c.shift())+c.shift(),w=M+c.shift(),p=S+c.shift(),e.U.P.curveTo(a,_,x,b,y,T,R),e.U.P.curveTo(a,v,M,S,w,p,m)),I=="o1237"&&(_=p+c.shift(),x=m+c.shift(),b=_+c.shift(),y=x+c.shift(),T=b+c.shift(),R=y+c.shift(),v=T+c.shift(),M=R+c.shift(),S=v+c.shift(),w=M+c.shift(),Math.abs(S-p)>Math.abs(w-m)?p=S+c.shift():m=w+c.shift(),e.U.P.curveTo(a,_,x,b,y,T,R),e.U.P.curveTo(a,v,M,S,w,p,m));else if(I=="o14"){if(c.length>0&&!u&&(f=c.shift()+s.nominalWidthX,u=!0),c.length==4){var Z=c.shift(),k=c.shift(),V=c.shift(),F=c.shift(),z=e.CFF.glyphBySE(s,V),X=e.CFF.glyphBySE(s,F);e.U._drawCFF(s.CharStrings[z],r,s,o,a),r.x=Z,r.y=k,e.U._drawCFF(s.CharStrings[X],r,s,o,a)}d&&(e.U.P.closePath(a),d=!1)}else if(I=="o19"||I=="o20")c.length%2!=0&&!u&&(f=c.shift()+o.nominalWidthX),h+=c.length>>1,c.length=0,u=!0,g+=h+7>>3;else if(I=="o21")c.length>2&&!u&&(f=c.shift()+o.nominalWidthX,u=!0),m+=c.pop(),p+=c.pop(),d&&e.U.P.closePath(a),e.U.P.moveTo(a,p,m),d=!0;else if(I=="o22")c.length>1&&!u&&(f=c.shift()+o.nominalWidthX,u=!0),p+=c.pop(),d&&e.U.P.closePath(a),e.U.P.moveTo(a,p,m),d=!0;else if(I=="o25"){for(;c.length>6;)p+=c.shift(),m+=c.shift(),e.U.P.lineTo(a,p,m);_=p+c.shift(),x=m+c.shift(),b=_+c.shift(),y=x+c.shift(),p=b+c.shift(),m=y+c.shift(),e.U.P.curveTo(a,_,x,b,y,p,m)}else if(I=="o26")for(c.length%2&&(p+=c.shift());c.length>0;)_=p,x=m+c.shift(),p=b=_+c.shift(),m=(y=x+c.shift())+c.shift(),e.U.P.curveTo(a,_,x,b,y,p,m);else if(I=="o27")for(c.length%2&&(m+=c.shift());c.length>0;)x=m,b=(_=p+c.shift())+c.shift(),y=x+c.shift(),p=b+c.shift(),m=y,e.U.P.curveTo(a,_,x,b,y,p,m);else if(I=="o10"||I=="o29"){var j=I=="o10"?o:s;if(c.length==0)console.debug("error: empty stack");else{var K=c.pop(),G=j.Subrs[K+j.Bias];r.x=p,r.y=m,r.nStems=h,r.haveWidth=u,r.width=f,r.open=d,e.U._drawCFF(G,r,s,o,a),p=r.x,m=r.y,h=r.nStems,u=r.haveWidth,f=r.width,d=r.open}}else if(I=="o30"||I=="o31"){var ee=c.length,ne=(q=0,I=="o31");for(q+=ee-(U=-3&ee);q<U;)ne?(x=m,b=(_=p+c.shift())+c.shift(),m=(y=x+c.shift())+c.shift(),U-q==5?(p=b+c.shift(),q++):p=b,ne=!1):(_=p,x=m+c.shift(),b=_+c.shift(),y=x+c.shift(),p=b+c.shift(),U-q==5?(m=y+c.shift(),q++):m=y,ne=!0),e.U.P.curveTo(a,_,x,b,y,p,m),q+=4}else{if((I+"").charAt(0)=="o")throw console.debug("Unknown operation: "+I,n),I;c.push(I)}}}r.x=p,r.y=m,r.nStems=h,r.haveWidth=u,r.width=f,r.open=d};var t=e,i={Typr:t};return l.Typr=t,l.default=i,Object.defineProperty(l,"__esModule",{value:!0}),l}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function TM(){return function(l){var e=Uint8Array,t=Uint16Array,i=Uint32Array,n=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),r=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),s=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o=function(I,U){for(var A=new t(31),B=0;B<31;++B)A[B]=U+=1<<I[B-1];var O=new i(A[30]);for(B=1;B<30;++B)for(var q=A[B];q<A[B+1];++q)O[q]=q-A[B]<<5|B;return[A,O]},a=o(n,2),c=a[0],h=a[1];c[28]=258,h[258]=28;for(var u=o(r,0)[0],f=new t(32768),d=0;d<32768;++d){var g=(43690&d)>>>1|(21845&d)<<1;g=(61680&(g=(52428&g)>>>2|(13107&g)<<2))>>>4|(3855&g)<<4,f[d]=((65280&g)>>>8|(255&g)<<8)>>>1}var p=function(I,U,A){for(var B=I.length,O=0,q=new t(U);O<B;++O)++q[I[O]-1];var Z,k=new t(U);for(O=0;O<U;++O)k[O]=k[O-1]+q[O-1]<<1;if(A){Z=new t(1<<U);var V=15-U;for(O=0;O<B;++O)if(I[O])for(var F=O<<4|I[O],z=U-I[O],X=k[I[O]-1]++<<z,j=X|(1<<z)-1;X<=j;++X)Z[f[X]>>>V]=F}else for(Z=new t(B),O=0;O<B;++O)I[O]&&(Z[O]=f[k[I[O]-1]++]>>>15-I[O]);return Z},m=new e(288);for(d=0;d<144;++d)m[d]=8;for(d=144;d<256;++d)m[d]=9;for(d=256;d<280;++d)m[d]=7;for(d=280;d<288;++d)m[d]=8;var _=new e(32);for(d=0;d<32;++d)_[d]=5;var x=p(m,9,1),b=p(_,5,1),y=function(I){for(var U=I[0],A=1;A<I.length;++A)I[A]>U&&(U=I[A]);return U},v=function(I,U,A){var B=U/8|0;return(I[B]|I[B+1]<<8)>>(7&U)&A},M=function(I,U){var A=U/8|0;return(I[A]|I[A+1]<<8|I[A+2]<<16)>>(7&U)},S=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],w=function(I,U,A){var B=new Error(U||S[I]);if(B.code=I,Error.captureStackTrace&&Error.captureStackTrace(B,w),!A)throw B;return B},T=function(I,U,A){var B=I.length;if(!B||A&&!A.l&&B<5)return U||new e(0);var O=!U||A,q=!A||A.i;A||(A={}),U||(U=new e(3*B));var Z,k=function(re){var Ee=U.length;if(re>Ee){var Me=new e(Math.max(2*Ee,re));Me.set(U),U=Me}},V=A.f||0,F=A.p||0,z=A.b||0,X=A.l,j=A.d,K=A.m,G=A.n,ee=8*B;do{if(!X){A.f=V=v(I,F,1);var ne=v(I,F+1,3);if(F+=3,!ne){var de=I[(Se=((Z=F)/8|0)+(7&Z&&1)+4)-4]|I[Se-3]<<8,le=Se+de;if(le>B){q&&w(0);break}O&&k(z+de),U.set(I.subarray(Se,le),z),A.b=z+=de,A.p=F=8*le;continue}if(ne==1)X=x,j=b,K=9,G=5;else if(ne==2){var ge=v(I,F,31)+257,W=v(I,F+10,15)+4,se=ge+v(I,F+5,31)+1;F+=14;for(var ue=new e(se),xe=new e(19),ce=0;ce<W;++ce)xe[s[ce]]=v(I,F+3*ce,7);F+=3*W;var Pe=y(xe),ie=(1<<Pe)-1,ye=p(xe,Pe,1);for(ce=0;ce<se;){var Se,oe=ye[v(I,F,ie)];if(F+=15&oe,(Se=oe>>>4)<16)ue[ce++]=Se;else{var E=0,C=0;for(Se==16?(C=3+v(I,F,3),F+=2,E=ue[ce-1]):Se==17?(C=3+v(I,F,7),F+=3):Se==18&&(C=11+v(I,F,127),F+=7);C--;)ue[ce++]=E}}var H=ue.subarray(0,ge),Q=ue.subarray(ge);K=y(H),G=y(Q),X=p(H,K,1),j=p(Q,G,1)}else w(1);if(F>ee){q&&w(0);break}}O&&k(z+131072);for(var fe=(1<<K)-1,_e=(1<<G)-1,me=F;;me=F){var Y=(E=X[M(I,F)&fe])>>>4;if((F+=15&E)>ee){q&&w(0);break}if(E||w(2),Y<256)U[z++]=Y;else{if(Y==256){me=F,X=null;break}var Le=Y-254;if(Y>264){var be=n[ce=Y-257];Le=v(I,F,(1<<be)-1)+c[ce],F+=be}var we=j[M(I,F)&_e],N=we>>>4;if(we||w(3),F+=15&we,Q=u[N],N>3&&(be=r[N],Q+=M(I,F)&(1<<be)-1,F+=be),F>ee){q&&w(0);break}O&&k(z+131072);for(var ae=z+Le;z<ae;z+=4)U[z]=U[z-Q],U[z+1]=U[z+1-Q],U[z+2]=U[z+2-Q],U[z+3]=U[z+3-Q];z=ae}}A.l=X,A.p=me,A.b=z,X&&(V=1,A.m=K,A.d=j,A.n=G)}while(!V);return z==U.length?U:function(re,Ee,Me){(Ee==null||Ee<0)&&(Ee=0),(Me==null||Me>re.length)&&(Me=re.length);var Oe=new(re instanceof t?t:re instanceof i?i:e)(Me-Ee);return Oe.set(re.subarray(Ee,Me)),Oe}(U,0,z)},R=new e(0),D=typeof TextDecoder!="undefined"&&new TextDecoder;try{D.decode(R,{stream:!0})}catch{}return l.convert_streams=function(I){var U=new DataView(I),A=0;function B(){var ge=U.getUint16(A);return A+=2,ge}function O(){var ge=U.getUint32(A);return A+=4,ge}function q(ge){de.setUint16(le,ge),le+=2}function Z(ge){de.setUint32(le,ge),le+=4}for(var k={signature:O(),flavor:O(),length:O(),numTables:B(),reserved:B(),totalSfntSize:O(),majorVersion:B(),minorVersion:B(),metaOffset:O(),metaLength:O(),metaOrigLength:O(),privOffset:O(),privLength:O()},V=0;Math.pow(2,V)<=k.numTables;)V++;V--;for(var F=16*Math.pow(2,V),z=16*k.numTables-F,X=12,j=[],K=0;K<k.numTables;K++)j.push({tag:O(),offset:O(),compLength:O(),origLength:O(),origChecksum:O()}),X+=16;var G,ee=new Uint8Array(12+16*j.length+j.reduce(function(ge,W){return ge+W.origLength+4},0)),ne=ee.buffer,de=new DataView(ne),le=0;return Z(k.flavor),q(k.numTables),q(F),q(V),q(z),j.forEach(function(ge){Z(ge.tag),Z(ge.origChecksum),Z(X),Z(ge.origLength),ge.outOffset=X,(X+=ge.origLength)%4!=0&&(X+=4-X%4)}),j.forEach(function(ge){var W,se=I.slice(ge.offset,ge.offset+ge.compLength);if(ge.compLength!=ge.origLength){var ue=new Uint8Array(ge.origLength);W=new Uint8Array(se,2),T(W,ue)}else ue=new Uint8Array(se);ee.set(ue,ge.outOffset);var xe=0;(X=ge.outOffset+ge.origLength)%4!=0&&(xe=4-X%4),ee.set(new Uint8Array(xe).buffer,ge.outOffset+ge.origLength),G=X+xe}),ne.slice(0,G)},Object.defineProperty(l,"__esModule",{value:!0}),l}({}).convert_streams}function CM(l,e){const t={M:2,L:2,Q:4,C:6,Z:0},i={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},n=1,r=2,s=4,o=8,a=16,c=32;let h;function u(y){if(!h){const v={R:r,L:n,D:s,C:a,U:c,T:o};h=new Map;for(let M in i){let S=0;i[M].split(",").forEach(w=>{let[T,R]=w.split("+");T=parseInt(T,36),R=R?parseInt(R,36):0,h.set(S+=T,v[M]);for(let D=R;D--;)h.set(++S,v[M])})}}return h.get(y)||c}const f=1,d=2,g=3,p=4,m=[null,"isol","init","fina","medi"];function _(y){const v=new Uint8Array(y.length);let M=c,S=f,w=-1;for(let T=0;T<y.length;T++){const R=y.codePointAt(T);let D=u(R)|0,I=f;D&o||(M&(n|s|a)?D&(r|s|a)?(I=g,(S===f||S===g)&&v[w]++):D&(n|c)&&(S===d||S===p)&&v[w]--:M&(r|c)&&(S===d||S===p)&&v[w]--,S=v[T]=I,M=D,w=T,R>65535&&T++)}return v}function x(y,v){const M=[];for(let w=0;w<v.length;w++){const T=v.codePointAt(w);T>65535&&w++,M.push(l.U.codeToGlyph(y,T))}const S=y.GSUB;if(S){const{lookupList:w,featureList:T}=S;let R;const D=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws)$/,I=[];T.forEach(U=>{if(D.test(U.tag))for(let A=0;A<U.tab.length;A++){if(I[U.tab[A]])continue;I[U.tab[A]]=!0;const B=w[U.tab[A]],O=/^(isol|init|fina|medi)$/.test(U.tag);O&&!R&&(R=_(v));for(let q=0;q<M.length;q++)(!R||!O||m[R[q]]===U.tag)&&l.U._applySubs(M,q,B,w)}})}return M}function b(y){const v=Object.create(null),M={unitsPerEm:y.head.unitsPerEm,ascender:y.hhea.ascender,descender:y.hhea.descender,forEachGlyph(S,w,T,R){let D=0;const I=1/M.unitsPerEm*w,U=x(y,S);let A=0,B=-1;return U.forEach((O,q)=>{if(O!==-1){let Z=v[O];if(!Z){const{cmds:k,crds:V}=l.U.glyphToPath(y,O);let F="",z=0;for(let ee=0,ne=k.length;ee<ne;ee++){const de=t[k[ee]];F+=k[ee];for(let le=1;le<=de;le++)F+=(le>1?",":"")+V[z++]}let X,j,K,G;if(V.length){X=j=1/0,K=G=-1/0;for(let ee=0,ne=V.length;ee<ne;ee+=2){let de=V[ee],le=V[ee+1];de<X&&(X=de),le<j&&(j=le),de>K&&(K=de),le>G&&(G=le)}}else X=K=j=G=0;Z=v[O]={index:O,advanceWidth:y.hmtx.aWidth[O],xMin:X,yMin:j,xMax:K,yMax:G,path:F,pathCommandCount:k.length}}B!==-1&&(D+=l.U.getPairAdjustment(y,B,O)*I),R.call(null,Z,D,A),Z.advanceWidth&&(D+=Z.advanceWidth*I),T&&(D+=T*w),B=O}A+=S.codePointAt(A)>65535?2:1}),D}};return M}return function(v){const M=new Uint8Array(v,0,4),S=l._bin.readASCII(M,0,4);if(S==="wOFF")v=e(v);else if(S==="wOF2")throw new Error("woff2 fonts not supported");return b(l.parse(v)[0])}}const AM=Fo({name:"Typr Font Parser",dependencies:[SM,TM,CM],init(l,e,t){const i=l(),n=e();return t(i,n)}}),Zs={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},EM=new Ae;function Vs(){return(self.performance||Date).now()}const um=Object.create(null);function Gg(l,e){l=PM({},l);const t=Vs();if(l.font=DM(l.font||Zs.defaultFontURL),l.text=""+l.text,l.sdfGlyphSize=l.sdfGlyphSize||Zs.sdfGlyphSize,l.colorRanges!=null){let u={};for(let f in l.colorRanges)if(l.colorRanges.hasOwnProperty(f)){let d=l.colorRanges[f];typeof d!="number"&&(d=EM.set(d).getHex()),u[f]=d}l.colorRanges=u}Object.freeze(l);const{textureWidth:i,sdfExponent:n}=Zs,{sdfGlyphSize:r}=l,s=i/r*4;let o=um[r];if(!o){const u=document.createElement("canvas");u.width=i,u.height=r*256/s,o=um[r]={glyphCount:0,sdfGlyphSize:r,sdfCanvas:u,sdfTexture:new wt(u,void 0,void 0,void 0,dt,dt),contextLost:!1,glyphsByFont:new Map},o.sdfTexture.generateMipmaps=!1,LM(o)}const{sdfTexture:a,sdfCanvas:c}=o;let h=o.glyphsByFont.get(l.font);h||o.glyphsByFont.set(l.font,h=new Map),FM(l).then(u=>{const{glyphIds:f,glyphPositions:d,fontSize:g,unitsPerEm:p,timings:m}=u,_=[],x=new Float32Array(f.length*4),b=g/p;let y=0,v=0;const M=Vs();f.forEach((D,I)=>{let U=h.get(D);if(!U){const{path:q,pathBounds:Z}=u.glyphData[D],k=Math.max(Z[2]-Z[0],Z[3]-Z[1])/r*(Zs.sdfMargin*r+.5),V=o.glyphCount++,F=[Z[0]-k,Z[1]-k,Z[2]+k,Z[3]+k];h.set(D,U={path:q,atlasIndex:V,sdfViewBox:F}),_.push(U)}const{sdfViewBox:A}=U,B=d[v++],O=d[v++];x[y++]=B+A[0]*b,x[y++]=O+A[1]*b,x[y++]=B+A[2]*b,x[y++]=O+A[3]*b,f[I]=U.atlasIndex}),m.quads=(m.quads||0)+(Vs()-M);const S=Vs();m.sdf={};const w=c.height,T=Math.ceil(o.glyphCount/s),R=Math.pow(2,Math.ceil(Math.log2(T*r)));R>w&&(console.info(`Increasing SDF texture size ${w}->${R}`),MM(c,i,R),a.dispose()),Ii.all(_.map(D=>Vg(D,o,l.gpuAccelerateSDF).then(({timing:I})=>{m.sdf[D.atlasIndex]=I}))).then(()=>{_.length&&!o.contextLost&&(Hg(o),a.needsUpdate=!0),m.sdfTotal=Vs()-S,m.total=Vs()-t,e(Object.freeze({parameters:l,sdfTexture:a,sdfGlyphSize:r,sdfExponent:n,glyphBounds:x,glyphAtlasIndices:f,glyphColors:u.glyphColors,caretPositions:u.caretPositions,caretHeight:u.caretHeight,chunkedBounds:u.chunkedBounds,ascender:u.ascender,descender:u.descender,lineHeight:u.lineHeight,topBaseline:u.topBaseline,blockBounds:u.blockBounds,visibleBounds:u.visibleBounds,timings:u.timings,get totalBounds(){return console.log("totalBounds deprecated, use blockBounds instead"),u.blockBounds},get totalBlockSize(){console.log("totalBlockSize deprecated, use blockBounds instead");const[D,I,U,A]=u.blockBounds;return[U-D,A-I]}}))})}),Ii.all([]).then(()=>{o.contextLost||wM(c)})}function Vg({path:l,atlasIndex:e,sdfViewBox:t},{sdfGlyphSize:i,sdfCanvas:n,contextLost:r},s){if(r)return Promise.resolve({timing:-1});const{textureWidth:o,sdfExponent:a}=Zs,c=Math.max(t[2]-t[0],t[3]-t[1]),h=Math.floor(e/4),u=h%(o/i)*i,f=Math.floor(h/(o/i))*i,d=e%4;return yM(i,i,l,t,c,a,n,u,f,d,s)}function LM(l){const e=l.sdfCanvas;e.addEventListener("webglcontextlost",t=>{console.log("Context Lost",t),t.preventDefault(),l.contextLost=!0}),e.addEventListener("webglcontextrestored",t=>{console.log("Context Restored",t),l.contextLost=!1;const i=[];l.glyphsByFont.forEach(n=>{n.forEach(r=>{i.push(Vg(r,l,!0))})}),Ii.all(i).then(()=>{Hg(l),l.sdfTexture.needsUpdate=!0})})}function RM({font:l,characters:e,sdfGlyphSize:t},i){let n=Array.isArray(e)?e.join(`
`):""+e;Gg({font:l,sdfGlyphSize:t,text:n},i)}function PM(l,e){for(let t in e)e.hasOwnProperty(t)&&(l[t]=e[t]);return l}let Kl;function DM(l){return Kl||(Kl=typeof document=="undefined"?{}:document.createElement("a")),Kl.href=l,Kl.href}function Hg(l){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:t}=l,{width:i,height:n}=e,r=l.sdfCanvas.getContext("webgl");let s=t.image.data;(!s||s.length!==i*n*4)&&(s=new Uint8Array(i*n*4),t.image={width:i,height:n,data:s},t.flipY=!1,t.isDataTexture=!0),r.readPixels(0,0,i,n,r.RGBA,r.UNSIGNED_BYTE,s)}}const IM=Fo({name:"Typesetter",dependencies:[Zs,AM,vM,uM],init(l,e,t,i){const{defaultFontURL:n}=l;return t(e,i(),{defaultFontURL:n})}}),FM=Fo({name:"Typesetter",dependencies:[IM,hM],init(l,e){return function(t){const i=new e;return l.typeset(t,i.resolve),i}},getTransferables(l){const e=[l.glyphPositions.buffer,l.glyphIds.buffer];return l.caretPositions&&e.push(l.caretPositions.buffer),l.glyphColors&&e.push(l.glyphColors.buffer),e}}),OM=(()=>{const l={};function e(a){let c=l[a];if(!c){const h=new Zn(1,1,a,a),u=h.clone(),f=h.attributes,d=u.attributes,g=new ze,p=f.uv.count;for(let m=0;m<p;m++)d.position.array[m*3]*=-1,d.normal.array[m*3+2]*=-1;["position","normal","uv"].forEach(m=>{g.setAttribute(m,new Fe([...f[m].array,...d[m].array],f[m].itemSize))}),g.setIndex([...h.index.array,...u.index.array.map(m=>m+p)]),g.translate(.5,.5,0),c=l[a]=g}return c}const t="aTroikaGlyphBounds",i="aTroikaGlyphIndex",n="aTroikaGlyphColor";class r extends Of{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new ki,this.boundingBox=new gi}computeBoundingSphere(){}computeBoundingBox(){}setSide(c){const h=this.getIndex().count;this.setDrawRange(c===tn?h/2:0,c===ui?h:h/2)}set detail(c){if(c!==this._detail){this._detail=c,(typeof c!="number"||c<1)&&(c=1);let h=e(c);["position","normal","uv"].forEach(u=>{this.attributes[u]=h.attributes[u].clone()}),this.setIndex(h.getIndex().clone())}}get detail(){return this._detail}set curveRadius(c){c!==this._curveRadius&&(this._curveRadius=c,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(c,h,u,f,d){s(this,t,c,4),s(this,i,h,1),s(this,n,d,3),this._blockBounds=u,this._chunkedBounds=f,o(this,h.length),this._updateBounds()}_updateBounds(){const c=this._blockBounds;if(c){const{curveRadius:h,boundingBox:u}=this;if(h){const{PI:f,floor:d,min:g,max:p,sin:m,cos:_}=Math,x=f/2,b=f*2,y=Math.abs(h),v=c[0]/y,M=c[2]/y,S=d((v+x)/b)!==d((M+x)/b)?-y:g(m(v)*y,m(M)*y),w=d((v-x)/b)!==d((M-x)/b)?y:p(m(v)*y,m(M)*y),T=d((v+f)/b)!==d((M+f)/b)?y*2:p(y-_(v)*y,y-_(M)*y);u.min.set(S,c[1],h<0?-T:0),u.max.set(w,c[3],h<0?0:T)}else u.min.set(c[0],c[1],0),u.max.set(c[2],c[3],0);u.getBoundingSphere(this.boundingSphere)}}applyClipRect(c){let h=this.getAttribute(i).count,u=this._chunkedBounds;if(u)for(let f=u.length;f--;){h=u[f].end;let d=u[f].rect;if(d[1]<c.w&&d[3]>c.y&&d[0]<c.z&&d[2]>c.x)break}o(this,h)}}r.prototype.setAttribute||(r.prototype.setAttribute=function(a,c){return this.attributes[a]=c,this});function s(a,c,h,u){const f=a.getAttribute(c);h?f&&f.array.length===h.length?(f.array.set(h),f.needsUpdate=!0):(a.setAttribute(c,new cs(h,u)),delete a._maxInstanceCount,a.dispose()):f&&a.deleteAttribute(c)}function o(a,c){a[a.hasOwnProperty("instanceCount")?"instanceCount":"maxInstancedCount"]=c}return r})(),UM=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,kM=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,NM=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,BM=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function zM(l){const e=Vu(l,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new pe},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new it(0,0,0,0)},uTroikaClipRect:{value:new it(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new pe},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Ae},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new yn},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:UM,vertexTransform:kM,fragmentDefs:NM,fragmentColorTransform:BM,customRewriter({vertexShader:t,fragmentShader:i}){let n=/\buniform\s+vec3\s+diffuse\b/;return n.test(i)&&(i=i.replace(n,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),n.test(t)||(t=t.replace(zg,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:t,fragmentShader:i}}});return e.transparent=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const GM=(()=>{const l=new kt({color:16777215,side:ui,transparent:!0}),e=8421504,t=new Ne,i=new L,n=new L,r=[],s=new L,o="+x+y";function a(_){return Array.isArray(_)?_[0]:_}let c=()=>{const _=new ht(new Zn(1,1),l);return c=()=>_,_},h=()=>{const _=new ht(new Zn(1,1,32,1),l);return h=()=>_,_};const u={type:"syncstart"},f={type:"synccomplete"},d=["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],g=d.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");class p extends ht{constructor(){const x=new OM;super(x,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.fontSize=.1,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=e,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=o,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(x){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(x):(this._isSyncing=!0,this.dispatchEvent(u),Gg({text:this.text,font:this.font,fontSize:this.fontSize||.1,letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF},b=>{this._isSyncing=!1,this._textRenderInfo=b,this.geometry.updateGlyphs(b.glyphBounds,b.glyphAtlasIndices,b.blockBounds,b.chunkedBounds,b.glyphColors);const y=this._queuedSyncs;y&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{y.forEach(v=>v&&v())})),this.dispatchEvent(f),x&&x()})))}onBeforeRender(x,b,y,v,M,S){this.sync(),M.isTroikaTextMaterial&&this._prepareForRender(M),M._hadOwnSide=M.hasOwnProperty("side"),this.geometry.setSide(M._actualSide=M.side),M.side=Pi}onAfterRender(x,b,y,v,M,S){M._hadOwnSide?M.side=M._actualSide:delete M.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let x=this._derivedMaterial;const b=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=l.clone());if((!x||x.baseMaterial!==b)&&(x=this._derivedMaterial=zM(b),b.addEventListener("dispose",function y(){b.removeEventListener("dispose",y),x.dispose()})),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let y=x._outlineMtl;return y||(y=x._outlineMtl=Object.create(x,{id:{value:x.id+.1}}),y.isTextOutlineMaterial=!0,y.depthWrite=!1,y.map=null,x.addEventListener("dispose",function v(){x.removeEventListener("dispose",v),y.dispose()})),[y,x]}else return x}set material(x){x&&x.isTroikaTextMaterial?(this._derivedMaterial=x,this._baseMaterial=x.baseMaterial):this._baseMaterial=x}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(x){this.geometry.detail=x}get curveRadius(){return this.geometry.curveRadius}set curveRadius(x){this.geometry.curveRadius=x}get customDepthMaterial(){return a(this.material).getDepthMaterial()}get customDistanceMaterial(){return a(this.material).getDistanceMaterial()}_prepareForRender(x){const b=x.isTextOutlineMaterial,y=x.uniforms,v=this.textRenderInfo;if(v){const{sdfTexture:w,blockBounds:T}=v;y.uTroikaSDFTexture.value=w,y.uTroikaSDFTextureSize.value.set(w.image.width,w.image.height),y.uTroikaSDFGlyphSize.value=v.sdfGlyphSize,y.uTroikaSDFExponent.value=v.sdfExponent,y.uTroikaTotalBounds.value.fromArray(T),y.uTroikaUseGlyphColors.value=!b&&!!v.glyphColors;let R=0,D=0,I=0,U,A,B,O=0,q=0;if(b){let{outlineWidth:k,outlineOffsetX:V,outlineOffsetY:F,outlineBlur:z,outlineOpacity:X}=this;R=this._parsePercent(k)||0,D=Math.max(0,this._parsePercent(z)||0),U=X,O=this._parsePercent(V)||0,q=this._parsePercent(F)||0}else I=Math.max(0,this._parsePercent(this.strokeWidth)||0),I&&(B=this.strokeColor,y.uTroikaStrokeColor.value.set(B==null?e:B),A=this.strokeOpacity,A==null&&(A=1)),U=this.fillOpacity;y.uTroikaDistanceOffset.value=R,y.uTroikaPositionOffset.value.set(O,q),y.uTroikaBlurRadius.value=D,y.uTroikaStrokeWidth.value=I,y.uTroikaStrokeOpacity.value=A,y.uTroikaFillOpacity.value=U==null?1:U,y.uTroikaCurveRadius.value=this.curveRadius||0;let Z=this.clipRect;if(Z&&Array.isArray(Z)&&Z.length===4)y.uTroikaClipRect.value.fromArray(Z);else{const k=(this.fontSize||.1)*100;y.uTroikaClipRect.value.set(T[0]-k,T[1]-k,T[2]+k,T[3]+k)}this.geometry.applyClipRect(y.uTroikaClipRect.value)}y.uTroikaSDFDebug.value=!!this.debugSDF,x.polygonOffset=!!this.depthOffset,x.polygonOffsetFactor=x.polygonOffsetUnits=this.depthOffset||0;const M=b?this.outlineColor||0:this.color;if(M==null)delete x.color;else{const w=x.hasOwnProperty("color")?x.color:x.color=new Ae;(M!==w._input||typeof M=="object")&&w.set(w._input=M)}let S=this.orientation||o;if(S!==x._orientation){let w=y.uTroikaOrient.value;S=S.replace(/[^-+xyz]/g,"");let T=S!==o&&S.match(/^([-+])([xyz])([-+])([xyz])$/);if(T){let[,R,D,I,U]=T;i.set(0,0,0)[D]=R==="-"?1:-1,n.set(0,0,0)[U]=I==="-"?-1:1,t.lookAt(s,i.cross(n),n),w.setFromMatrix4(t)}else w.identity();x._orientation=S}}_parsePercent(x){if(typeof x=="string"){let b=x.match(/^(-?[\d.]+)%$/),y=b?parseFloat(b[1]):NaN;x=(isNaN(y)?0:y/100)*this.fontSize}return x}localPositionToTextCoords(x,b=new pe){b.copy(x);const y=this.curveRadius;return y&&(b.x=Math.atan2(x.x,Math.abs(y)-Math.abs(x.z))*Math.abs(y)),b}worldPositionToTextCoords(x,b=new pe){return i.copy(x),this.localPositionToTextCoords(this.worldToLocal(i),b)}raycast(x,b){const{textRenderInfo:y,curveRadius:v}=this;if(y){const M=y.blockBounds,S=v?h():c(),w=S.geometry,{position:T,uv:R}=w.attributes;for(let D=0;D<R.count;D++){let I=M[0]+R.getX(D)*(M[2]-M[0]);const U=M[1]+R.getY(D)*(M[3]-M[1]);let A=0;v&&(A=v-Math.cos(I/v)*v,I=Math.sin(I/v)*v),T.setXYZ(D,I,U,A)}w.boundingSphere=this.geometry.boundingSphere,w.boundingBox=this.geometry.boundingBox,S.matrixWorld=this.matrixWorld,S.material.side=this.material.side,r.length=0,S.raycast(x,r);for(let D=0;D<r.length;D++)r[D].object=this,b.push(r[D])}}copy(x){const b=this.geometry;return super.copy(x),this.geometry=b,g.forEach(y=>{this[y]=x[y]}),this}clone(){return new this.constructor().copy(this)}}d.forEach(_=>{const x="_private_"+_;Object.defineProperty(p.prototype,_,{get(){return this[x]},set(b){b!==this[x]&&(this[x]=b,this._needsSync=!0)}})});let m=!1;return Object.defineProperty(p.prototype,"anchor",{get(){return this._deprecated_anchor},set(_){this._deprecated_anchor=_,m||(console.warn("TextMesh: `anchor` has been deprecated; use `anchorX` and `anchorY` instead."),m=!0),Array.isArray(_)?(this.anchorX=`${(+_[0]||0)*100}%`,this.anchorY=`${(+_[1]||0)*100}%`):this.anchorX=this.anchorY=0}}),p})();var VM="/fonts/permanentmarker.woff",HM="/fonts/rocksalt.woff",WM="/fonts/waitingforthesunrise.woff",XM="/fonts/UbuntuMono-Regular.ttf";const Ql=[VM,HM,WM];class Wg extends $e{constructor(e,t,i=!1){super();const n=new GM;n.text=e,i?n.font=XM:n.font=Ql[Math.floor(Math.random()*Ql.length)],n.fontSize=t,n.anchorX="center",n.anchorY="middle",n.depthOffset=-10,n.color=1120295,n.sync(),this.add(n)}static preloadFonts(){return new Promise((e,t)=>{let i=0;Ql.forEach(n=>{RM({font:n},()=>{i+=1,i===Ql.length&&e(i)})})})}}class Xg extends fn{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new JM(t)}),this.register(function(t){return new iS(t)}),this.register(function(t){return new rS(t)}),this.register(function(t){return new QM(t)}),this.register(function(t){return new $M(t)}),this.register(function(t){return new eS(t)}),this.register(function(t){return new tS(t)}),this.register(function(t){return new jM(t)}),this.register(function(t){return new nS(t)}),this.register(function(t){return new KM(t)}),this.register(function(t){return new YM(t)}),this.register(function(t){return new sS(t)})}load(e,t,i,n){const r=this;let s;this.resourcePath!==""?s=this.resourcePath:this.path!==""?s=this.path:s=hi.extractUrlBase(e),this.manager.itemStart(e);const o=function(c){n?n(c):console.error(c),r.manager.itemError(e),r.manager.itemEnd(e)},a=new jn(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(c){try{r.parse(c,s,function(h){t(h),r.manager.itemEnd(e)},o)}catch(h){o(h)}},i,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,n){let r;const s={},o={};if(typeof e=="string")r=e;else if(hi.decodeText(new Uint8Array(e,0,4))===qg){try{s[qe.KHR_BINARY_GLTF]=new oS(e)}catch(u){n&&n(u);return}r=s[qe.KHR_BINARY_GLTF].content}else r=hi.decodeText(new Uint8Array(e));const a=JSON.parse(r);if(a.asset===void 0||a.asset.version[0]<2){n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const c=new vS(a,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let h=0;h<this.pluginCallbacks.length;h++){const u=this.pluginCallbacks[h](c);o[u.name]=u,s[u.name]=!0}if(a.extensionsUsed)for(let h=0;h<a.extensionsUsed.length;++h){const u=a.extensionsUsed[h],f=a.extensionsRequired||[];switch(u){case qe.KHR_MATERIALS_UNLIT:s[u]=new ZM;break;case qe.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:s[u]=new cS;break;case qe.KHR_DRACO_MESH_COMPRESSION:s[u]=new aS(a,this.dracoLoader);break;case qe.KHR_TEXTURE_TRANSFORM:s[u]=new lS;break;case qe.KHR_MESH_QUANTIZATION:s[u]=new hS;break;default:f.indexOf(u)>=0&&o[u]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+u+'".')}}c.setExtensions(s),c.setPlugins(o),c.parse(i,n)}parseAsync(e,t){const i=this;return new Promise(function(n,r){i.parse(e,t,n,r)})}}function qM(){let l={};return{get:function(e){return l[e]},add:function(e,t){l[e]=t},remove:function(e){delete l[e]},removeAll:function(){l={}}}}const qe={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class YM{constructor(e){this.parser=e,this.name=qe.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,n=t.length;i<n;i++){const r=t[i];r.extensions&&r.extensions[this.name]&&r.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let n=t.cache.get(i);if(n)return n;const r=t.json,a=((r.extensions&&r.extensions[this.name]||{}).lights||[])[e];let c;const h=new Ae(16777215);a.color!==void 0&&h.fromArray(a.color);const u=a.range!==void 0?a.range:0;switch(a.type){case"directional":c=new Ff(h),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new zc(h),c.distance=u;break;case"spot":c=new If(h),c.distance=u,a.spot=a.spot||{},a.spot.innerConeAngle=a.spot.innerConeAngle!==void 0?a.spot.innerConeAngle:0,a.spot.outerConeAngle=a.spot.outerConeAngle!==void 0?a.spot.outerConeAngle:Math.PI/4,c.angle=a.spot.outerConeAngle,c.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return c.position.set(0,0,0),c.decay=2,a.intensity!==void 0&&(c.intensity=a.intensity),c.name=t.createUniqueName(a.name||"light_"+e),n=Promise.resolve(c),t.cache.add(i,n),n}createNodeAttachment(e){const t=this,i=this.parser,r=i.json.nodes[e],o=(r.extensions&&r.extensions[this.name]||{}).light;return o===void 0?null:this._loadLight(o).then(function(a){return i._getNodeRef(t.cache,o,a)})}}class ZM{constructor(){this.name=qe.KHR_MATERIALS_UNLIT}getMaterialType(){return kt}extendParams(e,t,i){const n=[];e.color=new Ae(1,1,1),e.opacity=1;const r=t.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const s=r.baseColorFactor;e.color.fromArray(s),e.opacity=s[3]}r.baseColorTexture!==void 0&&n.push(i.assignTexture(e,"map",r.baseColorTexture,nt))}return Promise.all(n)}}class jM{constructor(e){this.parser=e,this.name=qe.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name].emissiveStrength;return r!==void 0&&(t.emissiveIntensity=r),Promise.resolve()}}class JM{constructor(e){this.parser=e,this.name=qe.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ni}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=[],s=n.extensions[this.name];if(s.clearcoatFactor!==void 0&&(t.clearcoat=s.clearcoatFactor),s.clearcoatTexture!==void 0&&r.push(i.assignTexture(t,"clearcoatMap",s.clearcoatTexture)),s.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=s.clearcoatRoughnessFactor),s.clearcoatRoughnessTexture!==void 0&&r.push(i.assignTexture(t,"clearcoatRoughnessMap",s.clearcoatRoughnessTexture)),s.clearcoatNormalTexture!==void 0&&(r.push(i.assignTexture(t,"clearcoatNormalMap",s.clearcoatNormalTexture)),s.clearcoatNormalTexture.scale!==void 0)){const o=s.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new pe(o,o)}return Promise.all(r)}}class KM{constructor(e){this.parser=e,this.name=qe.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ni}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=[],s=n.extensions[this.name];return s.iridescenceFactor!==void 0&&(t.iridescence=s.iridescenceFactor),s.iridescenceTexture!==void 0&&r.push(i.assignTexture(t,"iridescenceMap",s.iridescenceTexture)),s.iridescenceIor!==void 0&&(t.iridescenceIOR=s.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),s.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=s.iridescenceThicknessMinimum),s.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=s.iridescenceThicknessMaximum),s.iridescenceThicknessTexture!==void 0&&r.push(i.assignTexture(t,"iridescenceThicknessMap",s.iridescenceThicknessTexture)),Promise.all(r)}}class QM{constructor(e){this.parser=e,this.name=qe.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ni}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=[];t.sheenColor=new Ae(0,0,0),t.sheenRoughness=0,t.sheen=1;const s=n.extensions[this.name];return s.sheenColorFactor!==void 0&&t.sheenColor.fromArray(s.sheenColorFactor),s.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=s.sheenRoughnessFactor),s.sheenColorTexture!==void 0&&r.push(i.assignTexture(t,"sheenColorMap",s.sheenColorTexture,nt)),s.sheenRoughnessTexture!==void 0&&r.push(i.assignTexture(t,"sheenRoughnessMap",s.sheenRoughnessTexture)),Promise.all(r)}}class $M{constructor(e){this.parser=e,this.name=qe.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ni}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=[],s=n.extensions[this.name];return s.transmissionFactor!==void 0&&(t.transmission=s.transmissionFactor),s.transmissionTexture!==void 0&&r.push(i.assignTexture(t,"transmissionMap",s.transmissionTexture)),Promise.all(r)}}class eS{constructor(e){this.parser=e,this.name=qe.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ni}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=[],s=n.extensions[this.name];t.thickness=s.thicknessFactor!==void 0?s.thicknessFactor:0,s.thicknessTexture!==void 0&&r.push(i.assignTexture(t,"thicknessMap",s.thicknessTexture)),t.attenuationDistance=s.attenuationDistance||0;const o=s.attenuationColor||[1,1,1];return t.attenuationColor=new Ae(o[0],o[1],o[2]),Promise.all(r)}}class tS{constructor(e){this.parser=e,this.name=qe.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ni}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name];return t.ior=r.ior!==void 0?r.ior:1.5,Promise.resolve()}}class nS{constructor(e){this.parser=e,this.name=qe.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ni}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=[],s=n.extensions[this.name];t.specularIntensity=s.specularFactor!==void 0?s.specularFactor:1,s.specularTexture!==void 0&&r.push(i.assignTexture(t,"specularIntensityMap",s.specularTexture));const o=s.specularColorFactor||[1,1,1];return t.specularColor=new Ae(o[0],o[1],o[2]),s.specularColorTexture!==void 0&&r.push(i.assignTexture(t,"specularColorMap",s.specularColorTexture,nt)),Promise.all(r)}}class iS{constructor(e){this.parser=e,this.name=qe.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,n=i.textures[e];if(!n.extensions||!n.extensions[this.name])return null;const r=n.extensions[this.name],s=t.options.ktx2Loader;if(!s){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,r.source,s)}}class rS{constructor(e){this.parser=e,this.name=qe.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,n=i.json,r=n.textures[e];if(!r.extensions||!r.extensions[t])return null;const s=r.extensions[t],o=n.images[s.source];let a=i.textureLoader;if(o.uri){const c=i.options.manager.getHandler(o.uri);c!==null&&(a=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,s.source,a);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class sS{constructor(e){this.name=qe.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const n=i.extensions[this.name],r=this.parser.getDependency("buffer",n.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([r,s.ready]).then(function(o){const a=n.byteOffset||0,c=n.byteLength||0,h=n.count,u=n.byteStride,f=new ArrayBuffer(h*u),d=new Uint8Array(o[0],a,c);return s.decodeGltfBuffer(new Uint8Array(f),h,u,d,n.mode,n.filter),f})}else return null}}const qg="glTF",ra=12,fm={JSON:1313821514,BIN:5130562};class oS{constructor(e){this.name=qe.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,ra);if(this.header={magic:hi.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==qg)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-ra,n=new DataView(e,ra);let r=0;for(;r<i;){const s=n.getUint32(r,!0);r+=4;const o=n.getUint32(r,!0);if(r+=4,o===fm.JSON){const a=new Uint8Array(e,ra+r,s);this.content=hi.decodeText(a)}else if(o===fm.BIN){const a=ra+r;this.body=e.slice(a,a+s)}r+=s}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class aS{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=qe.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,n=this.dracoLoader,r=e.extensions[this.name].bufferView,s=e.extensions[this.name].attributes,o={},a={},c={};for(const h in s){const u=Wu[h]||h.toLowerCase();o[u]=s[h]}for(const h in e.attributes){const u=Wu[h]||h.toLowerCase();if(s[h]!==void 0){const f=i.accessors[e.attributes[h]],d=Da[f.componentType];c[u]=d,a[u]=f.normalized===!0}}return t.getDependency("bufferView",r).then(function(h){return new Promise(function(u){n.decodeDracoFile(h,function(f){for(const d in f.attributes){const g=f.attributes[d],p=a[d];p!==void 0&&(g.normalized=p)}u(f)},o,c)})})}}class lS{constructor(){this.name=qe.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return t.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Hu extends ps{constructor(e){super(),this.isGLTFSpecularGlossinessMaterial=!0;const t=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),i=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),n=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),r=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),s=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join(`
`),o={specular:{value:new Ae().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=o,this.onBeforeCompile=function(a){for(const c in o)a.uniforms[c]=o[c];a.fragmentShader=a.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",i).replace("#include <roughnessmap_fragment>",n).replace("#include <metalnessmap_fragment>",r).replace("#include <lights_physical_fragment>",s)},Object.defineProperties(this,{specular:{get:function(){return o.specular.value},set:function(a){o.specular.value=a}},specularMap:{get:function(){return o.specularMap.value},set:function(a){o.specularMap.value=a,a?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return o.glossiness.value},set:function(a){o.glossiness.value=a}},glossinessMap:{get:function(){return o.glossinessMap.value},set:function(a){o.glossinessMap.value=a,a?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(e){return super.copy(e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class cS{constructor(){this.name=qe.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity"]}getMaterialType(){return Hu}extendParams(e,t,i){const n=t.extensions[this.name];e.color=new Ae(1,1,1),e.opacity=1;const r=[];if(Array.isArray(n.diffuseFactor)){const s=n.diffuseFactor;e.color.fromArray(s),e.opacity=s[3]}if(n.diffuseTexture!==void 0&&r.push(i.assignTexture(e,"map",n.diffuseTexture,nt)),e.emissive=new Ae(0,0,0),e.glossiness=n.glossinessFactor!==void 0?n.glossinessFactor:1,e.specular=new Ae(1,1,1),Array.isArray(n.specularFactor)&&e.specular.fromArray(n.specularFactor),n.specularGlossinessTexture!==void 0){const s=n.specularGlossinessTexture;r.push(i.assignTexture(e,"glossinessMap",s)),r.push(i.assignTexture(e,"specularMap",s,nt))}return Promise.all(r)}createMaterial(e){const t=new Hu(e);return t.fog=!0,t.color=e.color,t.map=e.map===void 0?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=e.aoMap===void 0?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=e.emissiveIntensity===void 0?1:e.emissiveIntensity,t.emissiveMap=e.emissiveMap===void 0?null:e.emissiveMap,t.bumpMap=e.bumpMap===void 0?null:e.bumpMap,t.bumpScale=1,t.normalMap=e.normalMap===void 0?null:e.normalMap,t.normalMapType=wr,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=e.specularMap===void 0?null:e.specularMap,t.specular=e.specular,t.glossinessMap=e.glossinessMap===void 0?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=e.envMap===void 0?null:e.envMap,t.envMapIntensity=1,t}}class hS{constructor(){this.name=qe.KHR_MESH_QUANTIZATION}}class Hf extends Do{constructor(e,t,i,n){super(e,t,i,n)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=e*n*3+n;for(let s=0;s!==n;s++)t[s]=i[r+s];return t}}Hf.prototype.interpolate_=function(l,e,t,i){const n=this.resultBuffer,r=this.sampleValues,s=this.valueSize,o=s*2,a=s*3,c=i-e,h=(t-e)/c,u=h*h,f=u*h,d=l*a,g=d-a,p=-2*f+3*u,m=f-u,_=1-p,x=m-u+h;for(let b=0;b!==s;b++){const y=r[g+b+s],v=r[g+b+o]*c,M=r[d+b+s],S=r[d+b]*c;n[b]=_*y+x*v+p*M+m*S}return n};const uS=new jt;class fS extends Hf{interpolate_(e,t,i,n){const r=super.interpolate_(e,t,i,n);return uS.fromArray(r).normalize().toArray(r),r}}const Ti={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Da={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},dm={9728:Tt,9729:dt,9984:wa,9985:Sc,9986:Ma,9987:Ui},pm={33071:Yt,33648:ro,10497:fr},mm={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Wu={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Qi={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},dS={CUBICSPLINE:void 0,LINEAR:ls,STEP:oo},Zh={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function pS(l){return l.DefaultMaterial===void 0&&(l.DefaultMaterial=new ps({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Pi})),l.DefaultMaterial}function sa(l,e,t){for(const i in t.extensions)l[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function zr(l,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(l.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function mS(l,e,t){let i=!1,n=!1,r=!1;for(let c=0,h=e.length;c<h;c++){const u=e[c];if(u.POSITION!==void 0&&(i=!0),u.NORMAL!==void 0&&(n=!0),u.COLOR_0!==void 0&&(r=!0),i&&n&&r)break}if(!i&&!n&&!r)return Promise.resolve(l);const s=[],o=[],a=[];for(let c=0,h=e.length;c<h;c++){const u=e[c];if(i){const f=u.POSITION!==void 0?t.getDependency("accessor",u.POSITION):l.attributes.position;s.push(f)}if(n){const f=u.NORMAL!==void 0?t.getDependency("accessor",u.NORMAL):l.attributes.normal;o.push(f)}if(r){const f=u.COLOR_0!==void 0?t.getDependency("accessor",u.COLOR_0):l.attributes.color;a.push(f)}}return Promise.all([Promise.all(s),Promise.all(o),Promise.all(a)]).then(function(c){const h=c[0],u=c[1],f=c[2];return i&&(l.morphAttributes.position=h),n&&(l.morphAttributes.normal=u),r&&(l.morphAttributes.color=f),l.morphTargetsRelative=!0,l})}function gS(l,e){if(l.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)l.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(l.morphTargetInfluences.length===t.length){l.morphTargetDictionary={};for(let i=0,n=t.length;i<n;i++)l.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function _S(l){const e=l.extensions&&l.extensions[qe.KHR_DRACO_MESH_COMPRESSION];let t;return e?t="draco:"+e.bufferView+":"+e.indices+":"+gm(e.attributes):t=l.indices+":"+gm(l.attributes)+":"+l.mode,t}function gm(l){let e="";const t=Object.keys(l).sort();for(let i=0,n=t.length;i<n;i++)e+=t[i]+":"+l[t[i]]+";";return e}function Xu(l){switch(l){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function xS(l){return l.search(/\.jpe?g($|\?)/i)>0||l.search(/^data\:image\/jpeg/)===0?"image/jpeg":l.search(/\.webp($|\?)/i)>0||l.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}class vS{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new qM,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};const i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,n=navigator.userAgent.indexOf("Firefox")>-1,r=n?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1;typeof createImageBitmap=="undefined"||i||n&&r<98?this.textureLoader=new yg(this.options.manager):this.textureLoader=new Ag(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new jn(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,n=this.json,r=this.extensions;this.cache.removeAll(),this._invokeAll(function(s){return s._markDefs&&s._markDefs()}),Promise.all(this._invokeAll(function(s){return s.beforeRoot&&s.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(s){const o={scene:s[0][n.scene||0],scenes:s[0],animations:s[1],cameras:s[2],asset:n.asset,parser:i,userData:{}};sa(r,o,n),zr(o,n),Promise.all(i._invokeAll(function(a){return a.afterRoot&&a.afterRoot(o)})).then(function(){e(o)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let n=0,r=t.length;n<r;n++){const s=t[n].joints;for(let o=0,a=s.length;o<a;o++)e[s[o]].isBone=!0}for(let n=0,r=e.length;n<r;n++){const s=e[n];s.mesh!==void 0&&(this._addNodeRef(this.meshCache,s.mesh),s.skin!==void 0&&(i[s.mesh].isSkinnedMesh=!0)),s.camera!==void 0&&this._addNodeRef(this.cameraCache,s.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const n=i.clone(),r=(s,o)=>{const a=this.associations.get(s);a!=null&&this.associations.set(o,a);for(const[c,h]of s.children.entries())r(h,o.children[c])};return r(i,n),n.name+="_instance_"+e.uses[t]++,n}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const n=e(t[i]);if(n)return n}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let n=0;n<t.length;n++){const r=e(t[n]);r&&i.push(r)}return i}getDependency(e,t){const i=e+":"+t;let n=this.cache.get(i);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this.loadNode(t);break;case"mesh":n=this._invokeOne(function(r){return r.loadMesh&&r.loadMesh(t)});break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne(function(r){return r.loadBufferView&&r.loadBufferView(t)});break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne(function(r){return r.loadMaterial&&r.loadMaterial(t)});break;case"texture":n=this._invokeOne(function(r){return r.loadTexture&&r.loadTexture(t)});break;case"skin":n=this.loadSkin(t);break;case"animation":n=this._invokeOne(function(r){return r.loadAnimation&&r.loadAnimation(t)});break;case"camera":n=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(i,n)}return n}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this,n=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(n.map(function(r,s){return i.getDependency(e,s)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[qe.KHR_BINARY_GLTF].body);const n=this.options;return new Promise(function(r,s){i.load(hi.resolveURL(t.uri,n.path),r,void 0,function(){s(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const n=t.byteLength||0,r=t.byteOffset||0;return i.slice(r,r+n)})}loadAccessor(e){const t=this,i=this.json,n=this.json.accessors[e];if(n.bufferView===void 0&&n.sparse===void 0)return Promise.resolve(null);const r=[];return n.bufferView!==void 0?r.push(this.getDependency("bufferView",n.bufferView)):r.push(null),n.sparse!==void 0&&(r.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(r).then(function(s){const o=s[0],a=mm[n.type],c=Da[n.componentType],h=c.BYTES_PER_ELEMENT,u=h*a,f=n.byteOffset||0,d=n.bufferView!==void 0?i.bufferViews[n.bufferView].byteStride:void 0,g=n.normalized===!0;let p,m;if(d&&d!==u){const _=Math.floor(f/d),x="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+_+":"+n.count;let b=t.cache.get(x);b||(p=new c(o,_*d,n.count*d/h),b=new Ya(p,d/h),t.cache.add(x,b)),m=new mr(b,a,f%d/h,g)}else o===null?p=new c(n.count*a):p=new c(o,f,n.count*a),m=new st(p,a,g);if(n.sparse!==void 0){const _=mm.SCALAR,x=Da[n.sparse.indices.componentType],b=n.sparse.indices.byteOffset||0,y=n.sparse.values.byteOffset||0,v=new x(s[1],b,n.sparse.count*_),M=new c(s[2],y,n.sparse.count*a);o!==null&&(m=new st(m.array.slice(),m.itemSize,m.normalized));for(let S=0,w=v.length;S<w;S++){const T=v[S];if(m.setX(T,M[S*a]),a>=2&&m.setY(T,M[S*a+1]),a>=3&&m.setZ(T,M[S*a+2]),a>=4&&m.setW(T,M[S*a+3]),a>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return m})}loadTexture(e){const t=this.json,i=this.options,r=t.textures[e].source,s=t.images[r];let o=this.textureLoader;if(s.uri){const a=i.manager.getHandler(s.uri);a!==null&&(o=a)}return this.loadTextureImage(e,r,o)}loadTextureImage(e,t,i){const n=this,r=this.json,s=r.textures[e],o=r.images[t],a=(o.uri||o.bufferView)+":"+s.sampler;if(this.textureCache[a])return this.textureCache[a];const c=this.loadImageSource(t,i).then(function(h){h.flipY=!1,s.name&&(h.name=s.name);const f=(r.samplers||{})[s.sampler]||{};return h.magFilter=dm[f.magFilter]||dt,h.minFilter=dm[f.minFilter]||Ui,h.wrapS=pm[f.wrapS]||fr,h.wrapT=pm[f.wrapT]||fr,n.associations.set(h,{textures:e}),h}).catch(function(){return null});return this.textureCache[a]=c,c}loadImageSource(e,t){const i=this,n=this.json,r=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(u=>u.clone());const s=n.images[e],o=self.URL||self.webkitURL;let a=s.uri||"",c=!1;if(s.bufferView!==void 0)a=i.getDependency("bufferView",s.bufferView).then(function(u){c=!0;const f=new Blob([u],{type:s.mimeType});return a=o.createObjectURL(f),a});else if(s.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(a).then(function(u){return new Promise(function(f,d){let g=f;t.isImageBitmapLoader===!0&&(g=function(p){const m=new wt(p);m.needsUpdate=!0,f(m)}),t.load(hi.resolveURL(u,r.path),g,void 0,d)})}).then(function(u){return c===!0&&o.revokeObjectURL(a),u.userData.mimeType=s.mimeType||xS(s.uri),u}).catch(function(u){throw console.error("THREE.GLTFLoader: Couldn't load texture",a),u});return this.sourceCache[e]=h,h}assignTexture(e,t,i,n){const r=this;return this.getDependency("texture",i.index).then(function(s){if(i.texCoord!==void 0&&i.texCoord!=0&&!(t==="aoMap"&&i.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+i.texCoord+" for texture "+t+" not yet supported."),r.extensions[qe.KHR_TEXTURE_TRANSFORM]){const o=i.extensions!==void 0?i.extensions[qe.KHR_TEXTURE_TRANSFORM]:void 0;if(o){const a=r.associations.get(s);s=r.extensions[qe.KHR_TEXTURE_TRANSFORM].extendTexture(s,o),r.associations.set(s,a)}}return n!==void 0&&(s.encoding=n),e[t]=s,s})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const n=t.attributes.tangent===void 0,r=t.attributes.color!==void 0,s=t.attributes.normal===void 0;if(e.isPoints){const o="PointsMaterial:"+i.uuid;let a=this.cache.get(o);a||(a=new Uc,bt.prototype.copy.call(a,i),a.color.copy(i.color),a.map=i.map,a.sizeAttenuation=!1,this.cache.add(o,a)),i=a}else if(e.isLine){const o="LineBasicMaterial:"+i.uuid;let a=this.cache.get(o);a||(a=new Kt,bt.prototype.copy.call(a,i),a.color.copy(i.color),this.cache.add(o,a)),i=a}if(n||r||s){let o="ClonedMaterial:"+i.uuid+":";i.isGLTFSpecularGlossinessMaterial&&(o+="specular-glossiness:"),n&&(o+="derivative-tangents:"),r&&(o+="vertex-colors:"),s&&(o+="flat-shading:");let a=this.cache.get(o);a||(a=i.clone(),r&&(a.vertexColors=!0),s&&(a.flatShading=!0),n&&(a.normalScale&&(a.normalScale.y*=-1),a.clearcoatNormalScale&&(a.clearcoatNormalScale.y*=-1)),this.cache.add(o,a),this.associations.set(a,this.associations.get(i))),i=a}i.aoMap&&t.attributes.uv2===void 0&&t.attributes.uv!==void 0&&t.setAttribute("uv2",t.attributes.uv),e.material=i}getMaterialType(){return ps}loadMaterial(e){const t=this,i=this.json,n=this.extensions,r=i.materials[e];let s;const o={},a=r.extensions||{},c=[];if(a[qe.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const u=n[qe.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];s=u.getMaterialType(),c.push(u.extendParams(o,r,t))}else if(a[qe.KHR_MATERIALS_UNLIT]){const u=n[qe.KHR_MATERIALS_UNLIT];s=u.getMaterialType(),c.push(u.extendParams(o,r,t))}else{const u=r.pbrMetallicRoughness||{};if(o.color=new Ae(1,1,1),o.opacity=1,Array.isArray(u.baseColorFactor)){const f=u.baseColorFactor;o.color.fromArray(f),o.opacity=f[3]}u.baseColorTexture!==void 0&&c.push(t.assignTexture(o,"map",u.baseColorTexture,nt)),o.metalness=u.metallicFactor!==void 0?u.metallicFactor:1,o.roughness=u.roughnessFactor!==void 0?u.roughnessFactor:1,u.metallicRoughnessTexture!==void 0&&(c.push(t.assignTexture(o,"metalnessMap",u.metallicRoughnessTexture)),c.push(t.assignTexture(o,"roughnessMap",u.metallicRoughnessTexture))),s=this._invokeOne(function(f){return f.getMaterialType&&f.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(f){return f.extendMaterialParams&&f.extendMaterialParams(e,o)})))}r.doubleSided===!0&&(o.side=ui);const h=r.alphaMode||Zh.OPAQUE;if(h===Zh.BLEND?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,h===Zh.MASK&&(o.alphaTest=r.alphaCutoff!==void 0?r.alphaCutoff:.5)),r.normalTexture!==void 0&&s!==kt&&(c.push(t.assignTexture(o,"normalMap",r.normalTexture)),o.normalScale=new pe(1,1),r.normalTexture.scale!==void 0)){const u=r.normalTexture.scale;o.normalScale.set(u,u)}return r.occlusionTexture!==void 0&&s!==kt&&(c.push(t.assignTexture(o,"aoMap",r.occlusionTexture)),r.occlusionTexture.strength!==void 0&&(o.aoMapIntensity=r.occlusionTexture.strength)),r.emissiveFactor!==void 0&&s!==kt&&(o.emissive=new Ae().fromArray(r.emissiveFactor)),r.emissiveTexture!==void 0&&s!==kt&&c.push(t.assignTexture(o,"emissiveMap",r.emissiveTexture,nt)),Promise.all(c).then(function(){let u;return s===Hu?u=n[qe.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(o):u=new s(o),r.name&&(u.name=r.name),zr(u,r),t.associations.set(u,{materials:e}),r.extensions&&sa(n,u,r),u})}createUniqueName(e){const t=Ke.sanitizeNodeName(e||"");let i=t;for(let n=1;this.nodeNamesUsed[i];++n)i=t+"_"+n;return this.nodeNamesUsed[i]=!0,i}loadGeometries(e){const t=this,i=this.extensions,n=this.primitiveCache;function r(o){return i[qe.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(o,t).then(function(a){return _m(a,o,t)})}const s=[];for(let o=0,a=e.length;o<a;o++){const c=e[o],h=_S(c),u=n[h];if(u)s.push(u.promise);else{let f;c.extensions&&c.extensions[qe.KHR_DRACO_MESH_COMPRESSION]?f=r(c):f=_m(new ze,c,t),n[h]={primitive:c,promise:f},s.push(f)}}return Promise.all(s)}loadMesh(e){const t=this,i=this.json,n=this.extensions,r=i.meshes[e],s=r.primitives,o=[];for(let a=0,c=s.length;a<c;a++){const h=s[a].material===void 0?pS(this.cache):this.getDependency("material",s[a].material);o.push(h)}return o.push(t.loadGeometries(s)),Promise.all(o).then(function(a){const c=a.slice(0,a.length-1),h=a[a.length-1],u=[];for(let d=0,g=h.length;d<g;d++){const p=h[d],m=s[d];let _;const x=c[d];if(m.mode===Ti.TRIANGLES||m.mode===Ti.TRIANGLE_STRIP||m.mode===Ti.TRIANGLE_FAN||m.mode===void 0)_=r.isSkinnedMesh===!0?new yf(p,x):new ht(p,x),_.isSkinnedMesh===!0&&!_.geometry.attributes.skinWeight.normalized&&_.normalizeSkinWeights(),m.mode===Ti.TRIANGLE_STRIP?_.geometry=xm(_.geometry,E0):m.mode===Ti.TRIANGLE_FAN&&(_.geometry=xm(_.geometry,cf));else if(m.mode===Ti.LINES)_=new Kn(p,x);else if(m.mode===Ti.LINE_STRIP)_=new Di(p,x);else if(m.mode===Ti.LINE_LOOP)_=new bf(p,x);else if(m.mode===Ti.POINTS)_=new wf(p,x);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+m.mode);Object.keys(_.geometry.morphAttributes).length>0&&gS(_,r),_.name=t.createUniqueName(r.name||"mesh_"+e),zr(_,r),m.extensions&&sa(n,_,m),t.assignFinalMaterial(_),u.push(_)}for(let d=0,g=u.length;d<g;d++)t.associations.set(u[d],{meshes:e,primitives:d});if(u.length===1)return u[0];const f=new bn;t.associations.set(f,{meshes:e});for(let d=0,g=u.length;d<g;d++)f.add(u[d]);return f})}loadCamera(e){let t;const i=this.json.cameras[e],n=i[i.type];if(!n){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new Dt(ua.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):i.type==="orthographic"&&(t=new qa(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),zr(t,i),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],i={joints:t.joints};return t.inverseBindMatrices===void 0?Promise.resolve(i):this.getDependency("accessor",t.inverseBindMatrices).then(function(n){return i.inverseBindMatrices=n,i})}loadAnimation(e){const i=this.json.animations[e],n=[],r=[],s=[],o=[],a=[];for(let c=0,h=i.channels.length;c<h;c++){const u=i.channels[c],f=i.samplers[u.sampler],d=u.target,g=d.node!==void 0?d.node:d.id,p=i.parameters!==void 0?i.parameters[f.input]:f.input,m=i.parameters!==void 0?i.parameters[f.output]:f.output;n.push(this.getDependency("node",g)),r.push(this.getDependency("accessor",p)),s.push(this.getDependency("accessor",m)),o.push(f),a.push(d)}return Promise.all([Promise.all(n),Promise.all(r),Promise.all(s),Promise.all(o),Promise.all(a)]).then(function(c){const h=c[0],u=c[1],f=c[2],d=c[3],g=c[4],p=[];for(let _=0,x=h.length;_<x;_++){const b=h[_],y=u[_],v=f[_],M=d[_],S=g[_];if(b===void 0)continue;b.updateMatrix(),b.matrixAutoUpdate=!0;let w;switch(Qi[S.path]){case Qi.weights:w=bo;break;case Qi.rotation:w=xr;break;case Qi.position:case Qi.scale:default:w=wo;break}const T=b.name?b.name:b.uuid,R=M.interpolation!==void 0?dS[M.interpolation]:ls,D=[];Qi[S.path]===Qi.weights?b.traverse(function(U){U.morphTargetInfluences&&D.push(U.name?U.name:U.uuid)}):D.push(T);let I=v.array;if(v.normalized){const U=Xu(I.constructor),A=new Float32Array(I.length);for(let B=0,O=I.length;B<O;B++)A[B]=I[B]*U;I=A}for(let U=0,A=D.length;U<A;U++){const B=new w(D[U]+"."+Qi[S.path],y.array,I,R);M.interpolation==="CUBICSPLINE"&&(B.createInterpolant=function(q){const Z=this instanceof xr?fS:Hf;return new Z(this.times,this.values,this.getValueSize()/3,q)},B.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),p.push(B)}}const m=i.name?i.name:"animation_"+e;return new Mo(m,void 0,p)})}createNodeMesh(e){const t=this.json,i=this,n=t.nodes[e];return n.mesh===void 0?null:i.getDependency("mesh",n.mesh).then(function(r){const s=i._getNodeRef(i.meshCache,n.mesh,r);return n.weights!==void 0&&s.traverse(function(o){if(!!o.isMesh)for(let a=0,c=n.weights.length;a<c;a++)o.morphTargetInfluences[a]=n.weights[a]}),s})}loadNode(e){const t=this.json,i=this.extensions,n=this,r=t.nodes[e],s=r.name?n.createUniqueName(r.name):"";return function(){const o=[],a=n._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return a&&o.push(a),r.camera!==void 0&&o.push(n.getDependency("camera",r.camera).then(function(c){return n._getNodeRef(n.cameraCache,r.camera,c)})),n._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){o.push(c)}),Promise.all(o)}().then(function(o){let a;if(r.isBone===!0?a=new Oc:o.length>1?a=new bn:o.length===1?a=o[0]:a=new $e,a!==o[0])for(let c=0,h=o.length;c<h;c++)a.add(o[c]);if(r.name&&(a.userData.name=r.name,a.name=s),zr(a,r),r.extensions&&sa(i,a,r),r.matrix!==void 0){const c=new Ne;c.fromArray(r.matrix),a.applyMatrix4(c)}else r.translation!==void 0&&a.position.fromArray(r.translation),r.rotation!==void 0&&a.quaternion.fromArray(r.rotation),r.scale!==void 0&&a.scale.fromArray(r.scale);return n.associations.has(a)||n.associations.set(a,{}),n.associations.get(a).nodes=e,a})}loadScene(e){const t=this.json,i=this.extensions,n=this.json.scenes[e],r=this,s=new bn;n.name&&(s.name=r.createUniqueName(n.name)),zr(s,n),n.extensions&&sa(i,s,n);const o=n.nodes||[],a=[];for(let c=0,h=o.length;c<h;c++)a.push(Yg(o[c],s,t,r));return Promise.all(a).then(function(){const c=h=>{const u=new Map;for(const[f,d]of r.associations)(f instanceof bt||f instanceof wt)&&u.set(f,d);return h.traverse(f=>{const d=r.associations.get(f);d!=null&&u.set(f,d)}),u};return r.associations=c(s),s})}}function Yg(l,e,t,i){const n=t.nodes[l];return i.getDependency("node",l).then(function(r){if(n.skin===void 0)return r;let s;return i.getDependency("skin",n.skin).then(function(o){s=o;const a=[];for(let c=0,h=s.joints.length;c<h;c++)a.push(i.getDependency("node",s.joints[c]));return Promise.all(a)}).then(function(o){return r.traverse(function(a){if(!a.isMesh)return;const c=[],h=[];for(let u=0,f=o.length;u<f;u++){const d=o[u];if(d){c.push(d);const g=new Ne;s.inverseBindMatrices!==void 0&&g.fromArray(s.inverseBindMatrices.array,u*16),h.push(g)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',s.joints[u])}a.bind(new Za(c,h),a.matrixWorld)}),r})}).then(function(r){e.add(r);const s=[];if(n.children){const o=n.children;for(let a=0,c=o.length;a<c;a++){const h=o[a];s.push(Yg(h,r,t,i))}}return Promise.all(s)})}function yS(l,e,t){const i=e.attributes,n=new gi;if(i.POSITION!==void 0){const o=t.json.accessors[i.POSITION],a=o.min,c=o.max;if(a!==void 0&&c!==void 0){if(n.set(new L(a[0],a[1],a[2]),new L(c[0],c[1],c[2])),o.normalized){const h=Xu(Da[o.componentType]);n.min.multiplyScalar(h),n.max.multiplyScalar(h)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const r=e.targets;if(r!==void 0){const o=new L,a=new L;for(let c=0,h=r.length;c<h;c++){const u=r[c];if(u.POSITION!==void 0){const f=t.json.accessors[u.POSITION],d=f.min,g=f.max;if(d!==void 0&&g!==void 0){if(a.setX(Math.max(Math.abs(d[0]),Math.abs(g[0]))),a.setY(Math.max(Math.abs(d[1]),Math.abs(g[1]))),a.setZ(Math.max(Math.abs(d[2]),Math.abs(g[2]))),f.normalized){const p=Xu(Da[f.componentType]);a.multiplyScalar(p)}o.max(a)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}n.expandByVector(o)}l.boundingBox=n;const s=new ki;n.getCenter(s.center),s.radius=n.min.distanceTo(n.max)/2,l.boundingSphere=s}function _m(l,e,t){const i=e.attributes,n=[];function r(s,o){return t.getDependency("accessor",s).then(function(a){l.setAttribute(o,a)})}for(const s in i){const o=Wu[s]||s.toLowerCase();o in l.attributes||n.push(r(i[s],o))}if(e.indices!==void 0&&!l.index){const s=t.getDependency("accessor",e.indices).then(function(o){l.setIndex(o)});n.push(s)}return zr(l,e),yS(l,e,t),Promise.all(n).then(function(){return e.targets!==void 0?mS(l,e.targets,t):l})}function xm(l,e){let t=l.getIndex();if(t===null){const s=[],o=l.getAttribute("position");if(o!==void 0){for(let a=0;a<o.count;a++)s.push(a);l.setIndex(s),t=l.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),l}const i=t.count-2,n=[];if(e===cf)for(let s=1;s<=i;s++)n.push(t.getX(0)),n.push(t.getX(s)),n.push(t.getX(s+1));else for(let s=0;s<i;s++)s%2===0?(n.push(t.getX(s)),n.push(t.getX(s+1)),n.push(t.getX(s+2))):(n.push(t.getX(s+2)),n.push(t.getX(s+1)),n.push(t.getX(s)));n.length/3!==i&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const r=l.clone();return r.setIndex(n),r}function bS(l){const e=new gi().setFromObject(l),t=new L;return e.getSize(t),t}var wS="/assets/vhs_vcr_crt.b15918bc.glb",no;const Xr=class extends bn{constructor(e){if(super(),Array.isArray(e)){const i=e.map(Xr.getObjectByName);return this.add(...i),this}return Xr.getObjectByName(e)}static getObjectByName(e){var i;return((i=xi(Xr,no).getObjectByName(e))==null?void 0:i.clone())||console.warn("No model with that key: ",e)}static async preloadModel(){if(!xi(Xr,no)){const t=await new Xg().loadAsync(wS);t.scene.traverse(i=>{i.userData.size=bS(i)}),sh(Xr,no,t.scene)}}};let ns=Xr;no=new WeakMap,qo(ns,no,void 0);class MS extends ns{constructor(){super(["VCR","CRT"]);Ce(this,"vcr");Ce(this,"crt");Ce(this,"createHTML",()=>{const t=document.querySelector(".crt-tv"),i=t.getBoundingClientRect();let r=this.crt.userData.size.x/i.width;r=r-r*.01;const s=new Kw(t);s.scale.set(r,r,r);const o=i.width*r;s.position.copy(this.position).setX(this.position.x-this.position.x/16).setY(this.vcr.userData.size.y+o/2),s.rotation.copy(this.rotation),this.css3dObject=s});const t=new D4;this.add(t),this.crt=this.getObjectByName("CRT"),this.vcr=this.getObjectByName("VCR"),this.rotateY(-Math.PI/2),this.position.setY(this.vcr.userData.size.y/2).setX(this.vcr.userData.size.x*2),this.vcr.userData.position=new L,this.vcr.getWorldPosition(this.vcr.userData.position),this.crt.userData.position=new L,this.crt.getWorldPosition(this.crt.userData.position),this.createHTML(),this.name="/tvset"}}function Ci(l){if(l===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return l}function Zg(l,e){l.prototype=Object.create(e.prototype),l.prototype.constructor=l,l.__proto__=e}/*!
 * GSAP 3.10.4
 * https://greensock.com
 *
 * @license Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Sn={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},So={duration:.5,overwrite:!1,delay:0},Wf,Dn=1e8,ct=1/Dn,qu=Math.PI*2,SS=qu/4,TS=0,jg=Math.sqrt,CS=Math.cos,AS=Math.sin,Bt=function(e){return typeof e=="string"},Nt=function(e){return typeof e=="function"},Fi=function(e){return typeof e=="number"},Xf=function(e){return typeof e=="undefined"},Oi=function(e){return typeof e=="object"},cn=function(e){return e!==!1},Jg=function(){return typeof window!="undefined"},$l=function(e){return Nt(e)||Bt(e)},Kg=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},Jt=Array.isArray,Yu=/(?:-?\.?\d|\.)+/gi,Qg=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,js=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,jh=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,$g=/[+-]=-?[.\d]+/,e1=/[^,'"\[\]\s]+/gi,ES=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,gt,si,Zu,qf,Tn={},pc={},t1,n1=function(e){return(pc=ds(e,Tn))&&Jn},Yf=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},mc=function(e,t){return!t&&console.warn(e)},i1=function(e,t){return e&&(Tn[e]=t)&&pc&&(pc[e]=t)||Tn},Ia=function(){return 0},Zf={},lr=[],ju={},r1,_n={},Jh={},vm=30,cc=[],jf="",Jf=function(e){var t=e[0],i,n;if(Oi(t)||Nt(t)||(e=[e]),!(i=(t._gsap||{}).harness)){for(n=cc.length;n--&&!cc[n].targetTest(t););i=cc[n]}for(n=e.length;n--;)e[n]&&(e[n]._gsap||(e[n]._gsap=new C1(e[n],i)))||e.splice(n,1);return e},is=function(e){return e._gsap||Jf(In(e))[0]._gsap},s1=function(e,t,i){return(i=e[t])&&Nt(i)?e[t]():Xf(i)&&e.getAttribute&&e.getAttribute(t)||i},hn=function(e,t){return(e=e.split(",")).forEach(t)||e},St=function(e){return Math.round(e*1e5)/1e5||0},qt=function(e){return Math.round(e*1e7)/1e7||0},$s=function(e,t){var i=t.charAt(0),n=parseFloat(t.substr(2));return e=parseFloat(e),i==="+"?e+n:i==="-"?e-n:i==="*"?e*n:e/n},LS=function(e,t){for(var i=t.length,n=0;e.indexOf(t[n])<0&&++n<i;);return n<i},gc=function(){var e=lr.length,t=lr.slice(0),i,n;for(ju={},lr.length=0,i=0;i<e;i++)n=t[i],n&&n._lazy&&(n.render(n._lazy[0],n._lazy[1],!0)._lazy=0)},o1=function(e,t,i,n){lr.length&&gc(),e.render(t,i,n),lr.length&&gc()},a1=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(e1).length<2?t:Bt(e)?e.trim():e},l1=function(e){return e},On=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},RS=function(e){return function(t,i){for(var n in i)n in t||n==="duration"&&e||n==="ease"||(t[n]=i[n])}},ds=function(e,t){for(var i in t)e[i]=t[i];return e},ym=function l(e,t){for(var i in t)i!=="__proto__"&&i!=="constructor"&&i!=="prototype"&&(e[i]=Oi(t[i])?l(e[i]||(e[i]={}),t[i]):t[i]);return e},_c=function(e,t){var i={},n;for(n in e)n in t||(i[n]=e[n]);return i},ga=function(e){var t=e.parent||gt,i=e.keyframes?RS(Jt(e.keyframes)):On;if(cn(e.inherit))for(;t;)i(e,t.vars.defaults),t=t.parent||t._dp;return e},PS=function(e,t){for(var i=e.length,n=i===t.length;n&&i--&&e[i]===t[i];);return i<0},c1=function(e,t,i,n,r){i===void 0&&(i="_first"),n===void 0&&(n="_last");var s=e[n],o;if(r)for(o=t[r];s&&s[r]>o;)s=s._prev;return s?(t._next=s._next,s._next=t):(t._next=e[i],e[i]=t),t._next?t._next._prev=t:e[n]=t,t._prev=s,t.parent=t._dp=e,t},Hc=function(e,t,i,n){i===void 0&&(i="_first"),n===void 0&&(n="_last");var r=t._prev,s=t._next;r?r._next=s:e[i]===t&&(e[i]=s),s?s._prev=r:e[n]===t&&(e[n]=r),t._next=t._prev=t.parent=null},Li=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove(e),e._act=0},rs=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var i=e;i;)i._dirty=1,i=i.parent;return e},DS=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},IS=function l(e){return!e||e._ts&&l(e.parent)},bm=function(e){return e._repeat?To(e._tTime,e=e.duration()+e._rDelay)*e:0},To=function(e,t){var i=Math.floor(e/=t);return e&&i===e?i-1:i},xc=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},Wc=function(e){return e._end=qt(e._start+(e._tDur/Math.abs(e._ts||e._rts||ct)||0))},Kf=function(e,t){var i=e._dp;return i&&i.smoothChildTiming&&e._ts&&(e._start=qt(i._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),Wc(e),i._dirty||rs(i,e)),e},h1=function(e,t){var i;if((t._time||t._initted&&!t._dur)&&(i=xc(e.rawTime(),t),(!t._dur||ja(0,t.totalDuration(),i)-t._tTime>ct)&&t.render(i,!0)),rs(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(i=e;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;e._zTime=-ct}},ai=function(e,t,i,n){return t.parent&&Li(t),t._start=qt((Fi(i)?i:i||e!==gt?Rn(e,i,t):e._time)+t._delay),t._end=qt(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),c1(e,t,"_first","_last",e._sort?"_start":0),Ju(t)||(e._recent=t),n||h1(e,t),e},u1=function(e,t){return(Tn.ScrollTrigger||Yf("scrollTrigger",t))&&Tn.ScrollTrigger.create(t,e)},f1=function(e,t,i,n){if($f(e,t),!e._initted)return 1;if(!i&&e._pt&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&r1!==xn.frame)return lr.push(e),e._lazy=[t,n],1},FS=function l(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||l(t))},Ju=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},OS=function(e,t,i,n){var r=e.ratio,s=t<0||!t&&(!e._start&&FS(e)&&!(!e._initted&&Ju(e))||(e._ts<0||e._dp._ts<0)&&!Ju(e))?0:1,o=e._rDelay,a=0,c,h,u;if(o&&e._repeat&&(a=ja(0,e._tDur,t),h=To(a,o),e._yoyo&&h&1&&(s=1-s),h!==To(e._tTime,o)&&(r=1-s,e.vars.repeatRefresh&&e._initted&&e.invalidate())),s!==r||n||e._zTime===ct||!t&&e._zTime){if(!e._initted&&f1(e,t,n,i))return;for(u=e._zTime,e._zTime=t||(i?ct:0),i||(i=t&&!u),e.ratio=s,e._from&&(s=1-s),e._time=0,e._tTime=a,c=e._pt;c;)c.r(s,c.d),c=c._next;e._startAt&&t<0&&e._startAt.render(t,!0,!0),e._onUpdate&&!i&&Fn(e,"onUpdate"),a&&e._repeat&&!i&&e.parent&&Fn(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===s&&(s&&Li(e,1),i||(Fn(e,s?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},US=function(e,t,i){var n;if(i>t)for(n=e._first;n&&n._start<=i;){if(n.data==="isPause"&&n._start>t)return n;n=n._next}else for(n=e._last;n&&n._start>=i;){if(n.data==="isPause"&&n._start<t)return n;n=n._prev}},Co=function(e,t,i,n){var r=e._repeat,s=qt(t)||0,o=e._tTime/e._tDur;return o&&!n&&(e._time*=s/e._dur),e._dur=s,e._tDur=r?r<0?1e10:qt(s*(r+1)+e._rDelay*r):s,o>0&&!n?Kf(e,e._tTime=e._tDur*o):e.parent&&Wc(e),i||rs(e.parent,e),e},wm=function(e){return e instanceof ln?rs(e):Co(e,e._dur)},kS={_start:0,endTime:Ia,totalDuration:Ia},Rn=function l(e,t,i){var n=e.labels,r=e._recent||kS,s=e.duration()>=Dn?r.endTime(!1):e._dur,o,a,c;return Bt(t)&&(isNaN(t)||t in n)?(a=t.charAt(0),c=t.substr(-1)==="%",o=t.indexOf("="),a==="<"||a===">"?(o>=0&&(t=t.replace(/=/,"")),(a==="<"?r._start:r.endTime(r._repeat>=0))+(parseFloat(t.substr(1))||0)*(c?(o<0?r:i).totalDuration()/100:1)):o<0?(t in n||(n[t]=s),n[t]):(a=parseFloat(t.charAt(o-1)+t.substr(o+1)),c&&i&&(a=a/100*(Jt(i)?i[0]:i).totalDuration()),o>1?l(e,t.substr(0,o-1),i)+a:s+a)):t==null?s:+t},_a=function(e,t,i){var n=Fi(t[1]),r=(n?2:1)+(e<2?0:1),s=t[r],o,a;if(n&&(s.duration=t[1]),s.parent=i,e){for(o=s,a=i;a&&!("immediateRender"in o);)o=a.vars.defaults||{},a=cn(a.vars.inherit)&&a.parent;s.immediateRender=cn(o.immediateRender),e<2?s.runBackwards=1:s.startAt=t[r-1]}return new Ut(t[0],s,t[r+1])},Tr=function(e,t){return e||e===0?t(e):t},ja=function(e,t,i){return i<e?e:i>t?t:i},Zt=function(e,t){return!Bt(e)||!(t=ES.exec(e))?"":t[1]},NS=function(e,t,i){return Tr(i,function(n){return ja(e,t,n)})},Ku=[].slice,d1=function(e,t){return e&&Oi(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&Oi(e[0]))&&!e.nodeType&&e!==si},BS=function(e,t,i){return i===void 0&&(i=[]),e.forEach(function(n){var r;return Bt(n)&&!t||d1(n,1)?(r=i).push.apply(r,In(n)):i.push(n)})||i},In=function(e,t,i){return Bt(e)&&!i&&(Zu||!Ao())?Ku.call((t||qf).querySelectorAll(e),0):Jt(e)?BS(e,i):d1(e)?Ku.call(e,0):e?[e]:[]},zS=function(e){return e=In(e)[0]||mc("Invalid scope")||{},function(t){var i=e.current||e.nativeElement||e;return In(t,i.querySelectorAll?i:i===e?mc("Invalid scope")||qf.createElement("div"):e)}},p1=function(e){return e.sort(function(){return .5-Math.random()})},m1=function(e){if(Nt(e))return e;var t=Oi(e)?e:{each:e},i=ss(t.ease),n=t.from||0,r=parseFloat(t.base)||0,s={},o=n>0&&n<1,a=isNaN(n)||o,c=t.axis,h=n,u=n;return Bt(n)?h=u={center:.5,edges:.5,end:1}[n]||0:!o&&a&&(h=n[0],u=n[1]),function(f,d,g){var p=(g||t).length,m=s[p],_,x,b,y,v,M,S,w,T;if(!m){if(T=t.grid==="auto"?0:(t.grid||[1,Dn])[1],!T){for(S=-Dn;S<(S=g[T++].getBoundingClientRect().left)&&T<p;);T--}for(m=s[p]=[],_=a?Math.min(T,p)*h-.5:n%T,x=T===Dn?0:a?p*u/T-.5:n/T|0,S=0,w=Dn,M=0;M<p;M++)b=M%T-_,y=x-(M/T|0),m[M]=v=c?Math.abs(c==="y"?y:b):jg(b*b+y*y),v>S&&(S=v),v<w&&(w=v);n==="random"&&p1(m),m.max=S-w,m.min=w,m.v=p=(parseFloat(t.amount)||parseFloat(t.each)*(T>p?p-1:c?c==="y"?p/T:T:Math.max(T,p/T))||0)*(n==="edges"?-1:1),m.b=p<0?r-p:r,m.u=Zt(t.amount||t.each)||0,i=i&&p<0?M1(i):i}return p=(m[f]-m.min)/m.max||0,qt(m.b+(i?i(p):p)*m.v)+m.u}},Qu=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(i){var n=Math.round(parseFloat(i)/e)*e*t;return(n-n%1)/t+(Fi(i)?0:Zt(i))}},g1=function(e,t){var i=Jt(e),n,r;return!i&&Oi(e)&&(n=i=e.radius||Dn,e.values?(e=In(e.values),(r=!Fi(e[0]))&&(n*=n)):e=Qu(e.increment)),Tr(t,i?Nt(e)?function(s){return r=e(s),Math.abs(r-s)<=n?r:s}:function(s){for(var o=parseFloat(r?s.x:s),a=parseFloat(r?s.y:0),c=Dn,h=0,u=e.length,f,d;u--;)r?(f=e[u].x-o,d=e[u].y-a,f=f*f+d*d):f=Math.abs(e[u]-o),f<c&&(c=f,h=u);return h=!n||c<=n?e[h]:s,r||h===s||Fi(s)?h:h+Zt(s)}:Qu(e))},_1=function(e,t,i,n){return Tr(Jt(e)?!t:i===!0?!!(i=0):!n,function(){return Jt(e)?e[~~(Math.random()*e.length)]:(i=i||1e-5)&&(n=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((e-i/2+Math.random()*(t-e+i*.99))/i)*i*n)/n})},GS=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(n){return t.reduce(function(r,s){return s(r)},n)}},VS=function(e,t){return function(i){return e(parseFloat(i))+(t||Zt(i))}},HS=function(e,t,i){return v1(e,t,0,1,i)},x1=function(e,t,i){return Tr(i,function(n){return e[~~t(n)]})},WS=function l(e,t,i){var n=t-e;return Jt(e)?x1(e,l(0,e.length),t):Tr(i,function(r){return(n+(r-e)%n)%n+e})},XS=function l(e,t,i){var n=t-e,r=n*2;return Jt(e)?x1(e,l(0,e.length-1),t):Tr(i,function(s){return s=(r+(s-e)%r)%r||0,e+(s>n?r-s:s)})},Fa=function(e){for(var t=0,i="",n,r,s,o;~(n=e.indexOf("random(",t));)s=e.indexOf(")",n),o=e.charAt(n+7)==="[",r=e.substr(n+7,s-n-7).match(o?e1:Yu),i+=e.substr(t,n-t)+_1(o?r:+r[0],o?0:+r[1],+r[2]||1e-5),t=s+1;return i+e.substr(t,e.length-t)},v1=function(e,t,i,n,r){var s=t-e,o=n-i;return Tr(r,function(a){return i+((a-e)/s*o||0)})},qS=function l(e,t,i,n){var r=isNaN(e+t)?0:function(d){return(1-d)*e+d*t};if(!r){var s=Bt(e),o={},a,c,h,u,f;if(i===!0&&(n=1)&&(i=null),s)e={p:e},t={p:t};else if(Jt(e)&&!Jt(t)){for(h=[],u=e.length,f=u-2,c=1;c<u;c++)h.push(l(e[c-1],e[c]));u--,r=function(g){g*=u;var p=Math.min(f,~~g);return h[p](g-p)},i=t}else n||(e=ds(Jt(e)?[]:{},e));if(!h){for(a in t)Qf.call(o,e,a,"get",t[a]);r=function(g){return nd(g,o)||(s?e.p:e)}}}return Tr(i,r)},Mm=function(e,t,i){var n=e.labels,r=Dn,s,o,a;for(s in n)o=n[s]-t,o<0==!!i&&o&&r>(o=Math.abs(o))&&(a=s,r=o);return a},Fn=function(e,t,i){var n=e.vars,r=n[t],s,o;if(!!r)return s=n[t+"Params"],o=n.callbackScope||e,i&&lr.length&&gc(),s?r.apply(o,s):r.call(o)},la=function(e){return Li(e),e.scrollTrigger&&e.scrollTrigger.kill(!1),e.progress()<1&&Fn(e,"onInterrupt"),e},Js,YS=function(e){e=!e.name&&e.default||e;var t=e.name,i=Nt(e),n=t&&!i&&e.init?function(){this._props=[]}:e,r={init:Ia,render:nd,add:Qf,kill:c4,modifier:l4,rawVars:0},s={targetTest:0,get:0,getSetter:td,aliases:{},register:0};if(Ao(),e!==n){if(_n[t])return;On(n,On(_c(e,r),s)),ds(n.prototype,ds(r,_c(e,s))),_n[n.prop=t]=n,e.targetTest&&(cc.push(n),Zf[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}i1(t,n),e.register&&e.register(Jn,n,un)},lt=255,ca={aqua:[0,lt,lt],lime:[0,lt,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,lt],navy:[0,0,128],white:[lt,lt,lt],olive:[128,128,0],yellow:[lt,lt,0],orange:[lt,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[lt,0,0],pink:[lt,192,203],cyan:[0,lt,lt],transparent:[lt,lt,lt,0]},Kh=function(e,t,i){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(i-t)*e*6:e<.5?i:e*3<2?t+(i-t)*(2/3-e)*6:t)*lt+.5|0},y1=function(e,t,i){var n=e?Fi(e)?[e>>16,e>>8&lt,e&lt]:0:ca.black,r,s,o,a,c,h,u,f,d,g;if(!n){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),ca[e])n=ca[e];else if(e.charAt(0)==="#"){if(e.length<6&&(r=e.charAt(1),s=e.charAt(2),o=e.charAt(3),e="#"+r+r+s+s+o+o+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return n=parseInt(e.substr(1,6),16),[n>>16,n>>8&lt,n&lt,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),n=[e>>16,e>>8&lt,e&lt]}else if(e.substr(0,3)==="hsl"){if(n=g=e.match(Yu),!t)a=+n[0]%360/360,c=+n[1]/100,h=+n[2]/100,s=h<=.5?h*(c+1):h+c-h*c,r=h*2-s,n.length>3&&(n[3]*=1),n[0]=Kh(a+1/3,r,s),n[1]=Kh(a,r,s),n[2]=Kh(a-1/3,r,s);else if(~e.indexOf("="))return n=e.match(Qg),i&&n.length<4&&(n[3]=1),n}else n=e.match(Yu)||ca.transparent;n=n.map(Number)}return t&&!g&&(r=n[0]/lt,s=n[1]/lt,o=n[2]/lt,u=Math.max(r,s,o),f=Math.min(r,s,o),h=(u+f)/2,u===f?a=c=0:(d=u-f,c=h>.5?d/(2-u-f):d/(u+f),a=u===r?(s-o)/d+(s<o?6:0):u===s?(o-r)/d+2:(r-s)/d+4,a*=60),n[0]=~~(a+.5),n[1]=~~(c*100+.5),n[2]=~~(h*100+.5)),i&&n.length<4&&(n[3]=1),n},b1=function(e){var t=[],i=[],n=-1;return e.split(cr).forEach(function(r){var s=r.match(js)||[];t.push.apply(t,s),i.push(n+=s.length+1)}),t.c=i,t},Sm=function(e,t,i){var n="",r=(e+n).match(cr),s=t?"hsla(":"rgba(",o=0,a,c,h,u;if(!r)return e;if(r=r.map(function(f){return(f=y1(f,t,1))&&s+(t?f[0]+","+f[1]+"%,"+f[2]+"%,"+f[3]:f.join(","))+")"}),i&&(h=b1(e),a=i.c,a.join(n)!==h.c.join(n)))for(c=e.replace(cr,"1").split(js),u=c.length-1;o<u;o++)n+=c[o]+(~a.indexOf(o)?r.shift()||s+"0,0,0,0)":(h.length?h:r.length?r:i).shift());if(!c)for(c=e.split(cr),u=c.length-1;o<u;o++)n+=c[o]+r[o];return n+c[u]},cr=function(){var l="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in ca)l+="|"+e+"\\b";return new RegExp(l+")","gi")}(),ZS=/hsl[a]?\(/,w1=function(e){var t=e.join(" "),i;if(cr.lastIndex=0,cr.test(t))return i=ZS.test(t),e[1]=Sm(e[1],i),e[0]=Sm(e[0],i,b1(e[1])),!0},Oa,xn=function(){var l=Date.now,e=500,t=33,i=l(),n=i,r=1e3/240,s=r,o=[],a,c,h,u,f,d,g=function p(m){var _=l()-n,x=m===!0,b,y,v,M;if(_>e&&(i+=_-t),n+=_,v=n-i,b=v-s,(b>0||x)&&(M=++u.frame,f=v-u.time*1e3,u.time=v=v/1e3,s+=b+(b>=r?4:r-b),y=1),x||(a=c(p)),y)for(d=0;d<o.length;d++)o[d](v,f,M,m)};return u={time:0,frame:0,tick:function(){g(!0)},deltaRatio:function(m){return f/(1e3/(m||60))},wake:function(){t1&&(!Zu&&Jg()&&(si=Zu=window,qf=si.document||{},Tn.gsap=Jn,(si.gsapVersions||(si.gsapVersions=[])).push(Jn.version),n1(pc||si.GreenSockGlobals||!si.gsap&&si||{}),h=si.requestAnimationFrame),a&&u.sleep(),c=h||function(m){return setTimeout(m,s-u.time*1e3+1|0)},Oa=1,g(2))},sleep:function(){(h?si.cancelAnimationFrame:clearTimeout)(a),Oa=0,c=Ia},lagSmoothing:function(m,_){e=m||1/ct,t=Math.min(_,e,0)},fps:function(m){r=1e3/(m||240),s=u.time*1e3+r},add:function(m,_,x){var b=_?function(y,v,M,S){m(y,v,M,S),u.remove(b)}:m;return u.remove(m),o[x?"unshift":"push"](b),Ao(),b},remove:function(m,_){~(_=o.indexOf(m))&&o.splice(_,1)&&d>=_&&d--},_listeners:o},u}(),Ao=function(){return!Oa&&xn.wake()},Je={},jS=/^[\d.\-M][\d.\-,\s]/,JS=/["']/g,KS=function(e){for(var t={},i=e.substr(1,e.length-3).split(":"),n=i[0],r=1,s=i.length,o,a,c;r<s;r++)a=i[r],o=r!==s-1?a.lastIndexOf(","):a.length,c=a.substr(0,o),t[n]=isNaN(c)?c.replace(JS,"").trim():+c,n=a.substr(o+1).trim();return t},QS=function(e){var t=e.indexOf("(")+1,i=e.indexOf(")"),n=e.indexOf("(",t);return e.substring(t,~n&&n<i?e.indexOf(")",i+1):i)},$S=function(e){var t=(e+"").split("("),i=Je[t[0]];return i&&t.length>1&&i.config?i.config.apply(null,~e.indexOf("{")?[KS(t[1])]:QS(e).split(",").map(a1)):Je._CE&&jS.test(e)?Je._CE("",e):i},M1=function(e){return function(t){return 1-e(1-t)}},S1=function l(e,t){for(var i=e._first,n;i;)i instanceof ln?l(i,t):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==t&&(i.timeline?l(i.timeline,t):(n=i._ease,i._ease=i._yEase,i._yEase=n,i._yoyo=t)),i=i._next},ss=function(e,t){return e&&(Nt(e)?e:Je[e]||$S(e))||t},_s=function(e,t,i,n){i===void 0&&(i=function(a){return 1-t(1-a)}),n===void 0&&(n=function(a){return a<.5?t(a*2)/2:1-t((1-a)*2)/2});var r={easeIn:t,easeOut:i,easeInOut:n},s;return hn(e,function(o){Je[o]=Tn[o]=r,Je[s=o.toLowerCase()]=i;for(var a in r)Je[s+(a==="easeIn"?".in":a==="easeOut"?".out":".inOut")]=Je[o+"."+a]=r[a]}),r},T1=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},Qh=function l(e,t,i){var n=t>=1?t:1,r=(i||(e?.3:.45))/(t<1?t:1),s=r/qu*(Math.asin(1/n)||0),o=function(h){return h===1?1:n*Math.pow(2,-10*h)*AS((h-s)*r)+1},a=e==="out"?o:e==="in"?function(c){return 1-o(1-c)}:T1(o);return r=qu/r,a.config=function(c,h){return l(e,c,h)},a},$h=function l(e,t){t===void 0&&(t=1.70158);var i=function(s){return s?--s*s*((t+1)*s+t)+1:0},n=e==="out"?i:e==="in"?function(r){return 1-i(1-r)}:T1(i);return n.config=function(r){return l(e,r)},n};hn("Linear,Quad,Cubic,Quart,Quint,Strong",function(l,e){var t=e<5?e+1:e;_s(l+",Power"+(t-1),e?function(i){return Math.pow(i,t)}:function(i){return i},function(i){return 1-Math.pow(1-i,t)},function(i){return i<.5?Math.pow(i*2,t)/2:1-Math.pow((1-i)*2,t)/2})});Je.Linear.easeNone=Je.none=Je.Linear.easeIn;_s("Elastic",Qh("in"),Qh("out"),Qh());(function(l,e){var t=1/e,i=2*t,n=2.5*t,r=function(o){return o<t?l*o*o:o<i?l*Math.pow(o-1.5/e,2)+.75:o<n?l*(o-=2.25/e)*o+.9375:l*Math.pow(o-2.625/e,2)+.984375};_s("Bounce",function(s){return 1-r(1-s)},r)})(7.5625,2.75);_s("Expo",function(l){return l?Math.pow(2,10*(l-1)):0});_s("Circ",function(l){return-(jg(1-l*l)-1)});_s("Sine",function(l){return l===1?1:-CS(l*SS)+1});_s("Back",$h("in"),$h("out"),$h());Je.SteppedEase=Je.steps=Tn.SteppedEase={config:function(e,t){e===void 0&&(e=1);var i=1/e,n=e+(t?0:1),r=t?1:0,s=1-ct;return function(o){return((n*ja(0,s,o)|0)+r)*i}}};So.ease=Je["quad.out"];hn("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(l){return jf+=l+","+l+"Params,"});var C1=function(e,t){this.id=TS++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:s1,this.set=t?t.getSetter:td},Ua=function(){function l(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Co(this,+t.duration,1,1),this.data=t.data,Oa||xn.wake()}var e=l.prototype;return e.delay=function(i){return i||i===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},e.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},e.totalDuration=function(i){return arguments.length?(this._dirty=0,Co(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(i,n){if(Ao(),!arguments.length)return this._tTime;var r=this._dp;if(r&&r.smoothChildTiming&&this._ts){for(Kf(this,i),!r._dp||r.parent||h1(r,this);r&&r.parent;)r.parent._time!==r._start+(r._ts>=0?r._tTime/r._ts:(r.totalDuration()-r._tTime)/-r._ts)&&r.totalTime(r._tTime,!0),r=r.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&ai(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!n||this._initted&&Math.abs(this._zTime)===ct||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),o1(this,i,n)),this},e.time=function(i,n){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+bm(this))%(this._dur+this._rDelay)||(i?this._dur:0),n):this._time},e.totalProgress=function(i,n){return arguments.length?this.totalTime(this.totalDuration()*i,n):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(i,n){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-i:i)+bm(this),n):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(i,n){var r=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*r,n):this._repeat?To(this._tTime,r)+1:1},e.timeScale=function(i){if(!arguments.length)return this._rts===-ct?0:this._rts;if(this._rts===i)return this;var n=this.parent&&this._ts?xc(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-ct?0:this._rts,this.totalTime(ja(-this._delay,this._tDur,n),!0),Wc(this),DS(this)},e.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Ao(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==ct&&(this._tTime-=ct)))),this):this._ps},e.startTime=function(i){if(arguments.length){this._start=i;var n=this.parent||this._dp;return n&&(n._sort||!this.parent)&&ai(n,this,i-this._delay),this}return this._start},e.endTime=function(i){return this._start+(cn(i)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(i){var n=this.parent||this._dp;return n?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?xc(n.rawTime(i),this):this._tTime:this._tTime},e.globalTime=function(i){for(var n=this,r=arguments.length?i:n.rawTime();n;)r=n._start+r/(n._ts||1),n=n._dp;return r},e.repeat=function(i){return arguments.length?(this._repeat=i===1/0?-2:i,wm(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(i){if(arguments.length){var n=this._time;return this._rDelay=i,wm(this),n?this.time(n):this}return this._rDelay},e.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},e.seek=function(i,n){return this.totalTime(Rn(this,i),cn(n))},e.restart=function(i,n){return this.play().totalTime(i?-this._delay:0,cn(n))},e.play=function(i,n){return i!=null&&this.seek(i,n),this.reversed(!1).paused(!1)},e.reverse=function(i,n){return i!=null&&this.seek(i||this.totalDuration(),n),this.reversed(!0).paused(!1)},e.pause=function(i,n){return i!=null&&this.seek(i,n),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-ct:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-ct,this},e.isActive=function(){var i=this.parent||this._dp,n=this._start,r;return!!(!i||this._ts&&this._initted&&i.isActive()&&(r=i.rawTime(!0))>=n&&r<this.endTime(!0)-ct)},e.eventCallback=function(i,n,r){var s=this.vars;return arguments.length>1?(n?(s[i]=n,r&&(s[i+"Params"]=r),i==="onUpdate"&&(this._onUpdate=n)):delete s[i],this):s[i]},e.then=function(i){var n=this;return new Promise(function(r){var s=Nt(i)?i:l1,o=function(){var c=n.then;n.then=null,Nt(s)&&(s=s(n))&&(s.then||s===n)&&(n.then=c),r(s),n.then=c};n._initted&&n.totalProgress()===1&&n._ts>=0||!n._tTime&&n._ts<0?o():n._prom=o})},e.kill=function(){la(this)},l}();On(Ua.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-ct,_prom:0,_ps:!1,_rts:1});var ln=function(l){Zg(e,l);function e(i,n){var r;return i===void 0&&(i={}),r=l.call(this,i)||this,r.labels={},r.smoothChildTiming=!!i.smoothChildTiming,r.autoRemoveChildren=!!i.autoRemoveChildren,r._sort=cn(i.sortChildren),gt&&ai(i.parent||gt,Ci(r),n),i.reversed&&r.reverse(),i.paused&&r.paused(!0),i.scrollTrigger&&u1(Ci(r),i.scrollTrigger),r}var t=e.prototype;return t.to=function(n,r,s){return _a(0,arguments,this),this},t.from=function(n,r,s){return _a(1,arguments,this),this},t.fromTo=function(n,r,s,o){return _a(2,arguments,this),this},t.set=function(n,r,s){return r.duration=0,r.parent=this,ga(r).repeatDelay||(r.repeat=0),r.immediateRender=!!r.immediateRender,new Ut(n,r,Rn(this,s),1),this},t.call=function(n,r,s){return ai(this,Ut.delayedCall(0,n,r),s)},t.staggerTo=function(n,r,s,o,a,c,h){return s.duration=r,s.stagger=s.stagger||o,s.onComplete=c,s.onCompleteParams=h,s.parent=this,new Ut(n,s,Rn(this,a)),this},t.staggerFrom=function(n,r,s,o,a,c,h){return s.runBackwards=1,ga(s).immediateRender=cn(s.immediateRender),this.staggerTo(n,r,s,o,a,c,h)},t.staggerFromTo=function(n,r,s,o,a,c,h,u){return o.startAt=s,ga(o).immediateRender=cn(o.immediateRender),this.staggerTo(n,r,o,a,c,h,u)},t.render=function(n,r,s){var o=this._time,a=this._dirty?this.totalDuration():this._tDur,c=this._dur,h=n<=0?0:qt(n),u=this._zTime<0!=n<0&&(this._initted||!c),f,d,g,p,m,_,x,b,y,v,M,S;if(this!==gt&&h>a&&n>=0&&(h=a),h!==this._tTime||s||u){if(o!==this._time&&c&&(h+=this._time-o,n+=this._time-o),f=h,y=this._start,b=this._ts,_=!b,u&&(c||(o=this._zTime),(n||!r)&&(this._zTime=n)),this._repeat){if(M=this._yoyo,m=c+this._rDelay,this._repeat<-1&&n<0)return this.totalTime(m*100+n,r,s);if(f=qt(h%m),h===a?(p=this._repeat,f=c):(p=~~(h/m),p&&p===h/m&&(f=c,p--),f>c&&(f=c)),v=To(this._tTime,m),!o&&this._tTime&&v!==p&&(v=p),M&&p&1&&(f=c-f,S=1),p!==v&&!this._lock){var w=M&&v&1,T=w===(M&&p&1);if(p<v&&(w=!w),o=w?0:c,this._lock=1,this.render(o||(S?0:qt(p*m)),r,!c)._lock=0,this._tTime=h,!r&&this.parent&&Fn(this,"onRepeat"),this.vars.repeatRefresh&&!S&&(this.invalidate()._lock=1),o&&o!==this._time||_!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(c=this._dur,a=this._tDur,T&&(this._lock=2,o=w?c:-1e-4,this.render(o,!0),this.vars.repeatRefresh&&!S&&this.invalidate()),this._lock=0,!this._ts&&!_)return this;S1(this,S)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(x=US(this,qt(o),qt(f)),x&&(h-=f-(f=x._start))),this._tTime=h,this._time=f,this._act=!b,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=n,o=0),!o&&f&&!r&&(Fn(this,"onStart"),this._tTime!==h))return this;if(f>=o&&n>=0)for(d=this._first;d;){if(g=d._next,(d._act||f>=d._start)&&d._ts&&x!==d){if(d.parent!==this)return this.render(n,r,s);if(d.render(d._ts>0?(f-d._start)*d._ts:(d._dirty?d.totalDuration():d._tDur)+(f-d._start)*d._ts,r,s),f!==this._time||!this._ts&&!_){x=0,g&&(h+=this._zTime=-ct);break}}d=g}else{d=this._last;for(var R=n<0?n:f;d;){if(g=d._prev,(d._act||R<=d._end)&&d._ts&&x!==d){if(d.parent!==this)return this.render(n,r,s);if(d.render(d._ts>0?(R-d._start)*d._ts:(d._dirty?d.totalDuration():d._tDur)+(R-d._start)*d._ts,r,s),f!==this._time||!this._ts&&!_){x=0,g&&(h+=this._zTime=R?-ct:ct);break}}d=g}}if(x&&!r&&(this.pause(),x.render(f>=o?0:-ct)._zTime=f>=o?1:-1,this._ts))return this._start=y,Wc(this),this.render(n,r,s);this._onUpdate&&!r&&Fn(this,"onUpdate",!0),(h===a&&this._tTime>=this.totalDuration()||!h&&o)&&(y===this._start||Math.abs(b)!==Math.abs(this._ts))&&(this._lock||((n||!c)&&(h===a&&this._ts>0||!h&&this._ts<0)&&Li(this,1),!r&&!(n<0&&!o)&&(h||o||!a)&&(Fn(this,h===a&&n>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(h<a&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(n,r){var s=this;if(Fi(r)||(r=Rn(this,r,n)),!(n instanceof Ua)){if(Jt(n))return n.forEach(function(o){return s.add(o,r)}),this;if(Bt(n))return this.addLabel(n,r);if(Nt(n))n=Ut.delayedCall(0,n);else return this}return this!==n?ai(this,n,r):this},t.getChildren=function(n,r,s,o){n===void 0&&(n=!0),r===void 0&&(r=!0),s===void 0&&(s=!0),o===void 0&&(o=-Dn);for(var a=[],c=this._first;c;)c._start>=o&&(c instanceof Ut?r&&a.push(c):(s&&a.push(c),n&&a.push.apply(a,c.getChildren(!0,r,s)))),c=c._next;return a},t.getById=function(n){for(var r=this.getChildren(1,1,1),s=r.length;s--;)if(r[s].vars.id===n)return r[s]},t.remove=function(n){return Bt(n)?this.removeLabel(n):Nt(n)?this.killTweensOf(n):(Hc(this,n),n===this._recent&&(this._recent=this._last),rs(this))},t.totalTime=function(n,r){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=qt(xn.time-(this._ts>0?n/this._ts:(this.totalDuration()-n)/-this._ts))),l.prototype.totalTime.call(this,n,r),this._forcing=0,this):this._tTime},t.addLabel=function(n,r){return this.labels[n]=Rn(this,r),this},t.removeLabel=function(n){return delete this.labels[n],this},t.addPause=function(n,r,s){var o=Ut.delayedCall(0,r||Ia,s);return o.data="isPause",this._hasPause=1,ai(this,o,Rn(this,n))},t.removePause=function(n){var r=this._first;for(n=Rn(this,n);r;)r._start===n&&r.data==="isPause"&&Li(r),r=r._next},t.killTweensOf=function(n,r,s){for(var o=this.getTweensOf(n,s),a=o.length;a--;)ir!==o[a]&&o[a].kill(n,r);return this},t.getTweensOf=function(n,r){for(var s=[],o=In(n),a=this._first,c=Fi(r),h;a;)a instanceof Ut?LS(a._targets,o)&&(c?(!ir||a._initted&&a._ts)&&a.globalTime(0)<=r&&a.globalTime(a.totalDuration())>r:!r||a.isActive())&&s.push(a):(h=a.getTweensOf(o,r)).length&&s.push.apply(s,h),a=a._next;return s},t.tweenTo=function(n,r){r=r||{};var s=this,o=Rn(s,n),a=r,c=a.startAt,h=a.onStart,u=a.onStartParams,f=a.immediateRender,d,g=Ut.to(s,On({ease:r.ease||"none",lazy:!1,immediateRender:!1,time:o,overwrite:"auto",duration:r.duration||Math.abs((o-(c&&"time"in c?c.time:s._time))/s.timeScale())||ct,onStart:function(){if(s.pause(),!d){var m=r.duration||Math.abs((o-(c&&"time"in c?c.time:s._time))/s.timeScale());g._dur!==m&&Co(g,m,0,1).render(g._time,!0,!0),d=1}h&&h.apply(g,u||[])}},r));return f?g.render(0):g},t.tweenFromTo=function(n,r,s){return this.tweenTo(r,On({startAt:{time:Rn(this,n)}},s))},t.recent=function(){return this._recent},t.nextLabel=function(n){return n===void 0&&(n=this._time),Mm(this,Rn(this,n))},t.previousLabel=function(n){return n===void 0&&(n=this._time),Mm(this,Rn(this,n),1)},t.currentLabel=function(n){return arguments.length?this.seek(n,!0):this.previousLabel(this._time+ct)},t.shiftChildren=function(n,r,s){s===void 0&&(s=0);for(var o=this._first,a=this.labels,c;o;)o._start>=s&&(o._start+=n,o._end+=n),o=o._next;if(r)for(c in a)a[c]>=s&&(a[c]+=n);return rs(this)},t.invalidate=function(){var n=this._first;for(this._lock=0;n;)n.invalidate(),n=n._next;return l.prototype.invalidate.call(this)},t.clear=function(n){n===void 0&&(n=!0);for(var r=this._first,s;r;)s=r._next,this.remove(r),r=s;return this._dp&&(this._time=this._tTime=this._pTime=0),n&&(this.labels={}),rs(this)},t.totalDuration=function(n){var r=0,s=this,o=s._last,a=Dn,c,h,u;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-n:n));if(s._dirty){for(u=s.parent;o;)c=o._prev,o._dirty&&o.totalDuration(),h=o._start,h>a&&s._sort&&o._ts&&!s._lock?(s._lock=1,ai(s,o,h-o._delay,1)._lock=0):a=h,h<0&&o._ts&&(r-=h,(!u&&!s._dp||u&&u.smoothChildTiming)&&(s._start+=h/s._ts,s._time-=h,s._tTime-=h),s.shiftChildren(-h,!1,-1/0),a=0),o._end>r&&o._ts&&(r=o._end),o=c;Co(s,s===gt&&s._time>r?s._time:r,1,1),s._dirty=0}return s._tDur},e.updateRoot=function(n){if(gt._ts&&(o1(gt,xc(n,gt)),r1=xn.frame),xn.frame>=vm){vm+=Sn.autoSleep||120;var r=gt._first;if((!r||!r._ts)&&Sn.autoSleep&&xn._listeners.length<2){for(;r&&!r._ts;)r=r._next;r||xn.sleep()}}},e}(Ua);On(ln.prototype,{_lock:0,_hasPause:0,_forcing:0});var e4=function(e,t,i,n,r,s,o){var a=new un(this._pt,e,t,0,1,D1,null,r),c=0,h=0,u,f,d,g,p,m,_,x;for(a.b=i,a.e=n,i+="",n+="",(_=~n.indexOf("random("))&&(n=Fa(n)),s&&(x=[i,n],s(x,e,t),i=x[0],n=x[1]),f=i.match(jh)||[];u=jh.exec(n);)g=u[0],p=n.substring(c,u.index),d?d=(d+1)%5:p.substr(-5)==="rgba("&&(d=1),g!==f[h++]&&(m=parseFloat(f[h-1])||0,a._pt={_next:a._pt,p:p||h===1?p:",",s:m,c:g.charAt(1)==="="?$s(m,g)-m:parseFloat(g)-m,m:d&&d<4?Math.round:0},c=jh.lastIndex);return a.c=c<n.length?n.substring(c,n.length):"",a.fp=o,($g.test(n)||_)&&(a.e=0),this._pt=a,a},Qf=function(e,t,i,n,r,s,o,a,c){Nt(n)&&(n=n(r||0,e,s));var h=e[t],u=i!=="get"?i:Nt(h)?c?e[t.indexOf("set")||!Nt(e["get"+t.substr(3)])?t:"get"+t.substr(3)](c):e[t]():h,f=Nt(h)?c?s4:R1:ed,d;if(Bt(n)&&(~n.indexOf("random(")&&(n=Fa(n)),n.charAt(1)==="="&&(d=$s(u,n)+(Zt(u)||0),(d||d===0)&&(n=d))),u!==n||$u)return!isNaN(u*n)&&n!==""?(d=new un(this._pt,e,t,+u||0,n-(u||0),typeof h=="boolean"?a4:P1,0,f),c&&(d.fp=c),o&&d.modifier(o,this,e),this._pt=d):(!h&&!(t in e)&&Yf(t,n),e4.call(this,e,t,u,n,f,a||Sn.stringFilter,c))},t4=function(e,t,i,n,r){if(Nt(e)&&(e=xa(e,r,t,i,n)),!Oi(e)||e.style&&e.nodeType||Jt(e)||Kg(e))return Bt(e)?xa(e,r,t,i,n):e;var s={},o;for(o in e)s[o]=xa(e[o],r,t,i,n);return s},A1=function(e,t,i,n,r,s){var o,a,c,h;if(_n[e]&&(o=new _n[e]).init(r,o.rawVars?t[e]:t4(t[e],n,r,s,i),i,n,s)!==!1&&(i._pt=a=new un(i._pt,r,e,0,1,o.render,o,0,o.priority),i!==Js))for(c=i._ptLookup[i._targets.indexOf(r)],h=o._props.length;h--;)c[o._props[h]]=a;return o},ir,$u,$f=function l(e,t){var i=e.vars,n=i.ease,r=i.startAt,s=i.immediateRender,o=i.lazy,a=i.onUpdate,c=i.onUpdateParams,h=i.callbackScope,u=i.runBackwards,f=i.yoyoEase,d=i.keyframes,g=i.autoRevert,p=e._dur,m=e._startAt,_=e._targets,x=e.parent,b=x&&x.data==="nested"?x.parent._targets:_,y=e._overwrite==="auto"&&!Wf,v=e.timeline,M,S,w,T,R,D,I,U,A,B,O,q,Z;if(v&&(!d||!n)&&(n="none"),e._ease=ss(n,So.ease),e._yEase=f?M1(ss(f===!0?n:f,So.ease)):0,f&&e._yoyo&&!e._repeat&&(f=e._yEase,e._yEase=e._ease,e._ease=f),e._from=!v&&!!i.runBackwards,!v||d&&!i.stagger){if(U=_[0]?is(_[0]).harness:0,q=U&&i[U.prop],M=_c(i,Zf),m&&(Li(m.render(-1,!0)),m._lazy=0),r)if(Li(e._startAt=Ut.set(_,On({data:"isStart",overwrite:!1,parent:x,immediateRender:!0,lazy:cn(o),startAt:null,delay:0,onUpdate:a,onUpdateParams:c,callbackScope:h,stagger:0},r))),t<0&&!s&&!g&&e._startAt.render(-1,!0),s){if(t>0&&!g&&(e._startAt=0),p&&t<=0){t&&(e._zTime=t);return}}else g===!1&&(e._startAt=0);else if(u&&p){if(m)!g&&(e._startAt=0);else if(t&&(s=!1),w=On({overwrite:!1,data:"isFromStart",lazy:s&&cn(o),immediateRender:s,stagger:0,parent:x},M),q&&(w[U.prop]=q),Li(e._startAt=Ut.set(_,w)),t<0&&e._startAt.render(-1,!0),e._zTime=t,!s)l(e._startAt,ct);else if(!t)return}for(e._pt=e._ptCache=0,o=p&&cn(o)||o&&!p,S=0;S<_.length;S++){if(R=_[S],I=R._gsap||Jf(_)[S]._gsap,e._ptLookup[S]=B={},ju[I.id]&&lr.length&&gc(),O=b===_?S:b.indexOf(R),U&&(A=new U).init(R,q||M,e,O,b)!==!1&&(e._pt=T=new un(e._pt,R,A.name,0,1,A.render,A,0,A.priority),A._props.forEach(function(k){B[k]=T}),A.priority&&(D=1)),!U||q)for(w in M)_n[w]&&(A=A1(w,M,e,O,R,b))?A.priority&&(D=1):B[w]=T=Qf.call(e,R,w,"get",M[w],O,b,0,i.stringFilter);e._op&&e._op[S]&&e.kill(R,e._op[S]),y&&e._pt&&(ir=e,gt.killTweensOf(R,B,e.globalTime(t)),Z=!e.parent,ir=0),e._pt&&o&&(ju[I.id]=1)}D&&I1(e),e._onInit&&e._onInit(e)}e._onUpdate=a,e._initted=(!e._op||e._pt)&&!Z,d&&t<=0&&v.render(Dn,!0,!0)},n4=function(e,t,i,n,r,s,o){var a=(e._pt&&e._ptCache||(e._ptCache={}))[t],c,h,u;if(!a)for(a=e._ptCache[t]=[],h=e._ptLookup,u=e._targets.length;u--;){if(c=h[u][t],c&&c.d&&c.d._pt)for(c=c.d._pt;c&&c.p!==t;)c=c._next;if(!c)return $u=1,e.vars[t]="+=0",$f(e,o),$u=0,1;a.push(c)}for(u=a.length;u--;)c=a[u],c.s=(n||n===0)&&!r?n:c.s+(n||0)+s*c.c,c.c=i-c.s,c.e&&(c.e=St(i)+Zt(c.e)),c.b&&(c.b=c.s+Zt(c.b))},i4=function(e,t){var i=e[0]?is(e[0]).harness:0,n=i&&i.aliases,r,s,o,a;if(!n)return t;r=ds({},t);for(s in n)if(s in r)for(a=n[s].split(","),o=a.length;o--;)r[a[o]]=r[s];return r},r4=function(e,t,i,n){var r=t.ease||n||"power1.inOut",s,o;if(Jt(t))o=i[e]||(i[e]=[]),t.forEach(function(a,c){return o.push({t:c/(t.length-1)*100,v:a,e:r})});else for(s in t)o=i[s]||(i[s]=[]),s==="ease"||o.push({t:parseFloat(e),v:t[s],e:r})},xa=function(e,t,i,n,r){return Nt(e)?e.call(t,i,n,r):Bt(e)&&~e.indexOf("random(")?Fa(e):e},E1=jf+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",L1={};hn(E1+",id,stagger,delay,duration,paused,scrollTrigger",function(l){return L1[l]=1});var Ut=function(l){Zg(e,l);function e(i,n,r,s){var o;typeof n=="number"&&(r.duration=n,n=r,r=null),o=l.call(this,s?n:ga(n))||this;var a=o.vars,c=a.duration,h=a.delay,u=a.immediateRender,f=a.stagger,d=a.overwrite,g=a.keyframes,p=a.defaults,m=a.scrollTrigger,_=a.yoyoEase,x=n.parent||gt,b=(Jt(i)||Kg(i)?Fi(i[0]):"length"in n)?[i]:In(i),y,v,M,S,w,T,R,D;if(o._targets=b.length?Jf(b):mc("GSAP target "+i+" not found. https://greensock.com",!Sn.nullTargetWarn)||[],o._ptLookup=[],o._overwrite=d,g||f||$l(c)||$l(h)){if(n=o.vars,y=o.timeline=new ln({data:"nested",defaults:p||{}}),y.kill(),y.parent=y._dp=Ci(o),y._start=0,f||$l(c)||$l(h)){if(S=b.length,R=f&&m1(f),Oi(f))for(w in f)~E1.indexOf(w)&&(D||(D={}),D[w]=f[w]);for(v=0;v<S;v++)M=_c(n,L1),M.stagger=0,_&&(M.yoyoEase=_),D&&ds(M,D),T=b[v],M.duration=+xa(c,Ci(o),v,T,b),M.delay=(+xa(h,Ci(o),v,T,b)||0)-o._delay,!f&&S===1&&M.delay&&(o._delay=h=M.delay,o._start+=h,M.delay=0),y.to(T,M,R?R(v,T,b):0),y._ease=Je.none;y.duration()?c=h=0:o.timeline=0}else if(g){ga(On(y.vars.defaults,{ease:"none"})),y._ease=ss(g.ease||n.ease||"none");var I=0,U,A,B;if(Jt(g))g.forEach(function(O){return y.to(b,O,">")});else{M={};for(w in g)w==="ease"||w==="easeEach"||r4(w,g[w],M,g.easeEach);for(w in M)for(U=M[w].sort(function(O,q){return O.t-q.t}),I=0,v=0;v<U.length;v++)A=U[v],B={ease:A.e,duration:(A.t-(v?U[v-1].t:0))/100*c},B[w]=A.v,y.to(b,B,I),I+=B.duration;y.duration()<c&&y.to({},{duration:c-y.duration()})}}c||o.duration(c=y.duration())}else o.timeline=0;return d===!0&&!Wf&&(ir=Ci(o),gt.killTweensOf(b),ir=0),ai(x,Ci(o),r),n.reversed&&o.reverse(),n.paused&&o.paused(!0),(u||!c&&!g&&o._start===qt(x._time)&&cn(u)&&IS(Ci(o))&&x.data!=="nested")&&(o._tTime=-ct,o.render(Math.max(0,-h))),m&&u1(Ci(o),m),o}var t=e.prototype;return t.render=function(n,r,s){var o=this._time,a=this._tDur,c=this._dur,h=n>a-ct&&n>=0?a:n<ct?0:n,u,f,d,g,p,m,_,x,b;if(!c)OS(this,n,r,s);else if(h!==this._tTime||!n||s||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=n<0){if(u=h,x=this.timeline,this._repeat){if(g=c+this._rDelay,this._repeat<-1&&n<0)return this.totalTime(g*100+n,r,s);if(u=qt(h%g),h===a?(d=this._repeat,u=c):(d=~~(h/g),d&&d===h/g&&(u=c,d--),u>c&&(u=c)),m=this._yoyo&&d&1,m&&(b=this._yEase,u=c-u),p=To(this._tTime,g),u===o&&!s&&this._initted)return this._tTime=h,this;d!==p&&(x&&this._yEase&&S1(x,m),this.vars.repeatRefresh&&!m&&!this._lock&&(this._lock=s=1,this.render(qt(g*d),!0).invalidate()._lock=0))}if(!this._initted){if(f1(this,n<0?n:u,s,r))return this._tTime=0,this;if(o!==this._time)return this;if(c!==this._dur)return this.render(n,r,s)}if(this._tTime=h,this._time=u,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=_=(b||this._ease)(u/c),this._from&&(this.ratio=_=1-_),u&&!o&&!r&&(Fn(this,"onStart"),this._tTime!==h))return this;for(f=this._pt;f;)f.r(_,f.d),f=f._next;x&&x.render(n<0?n:!u&&m?-ct:x._dur*x._ease(u/this._dur),r,s)||this._startAt&&(this._zTime=n),this._onUpdate&&!r&&(n<0&&this._startAt&&this._startAt.render(n,!0,s),Fn(this,"onUpdate")),this._repeat&&d!==p&&this.vars.onRepeat&&!r&&this.parent&&Fn(this,"onRepeat"),(h===this._tDur||!h)&&this._tTime===h&&(n<0&&this._startAt&&!this._onUpdate&&this._startAt.render(n,!0,!0),(n||!c)&&(h===this._tDur&&this._ts>0||!h&&this._ts<0)&&Li(this,1),!r&&!(n<0&&!o)&&(h||o)&&(Fn(this,h===a?"onComplete":"onReverseComplete",!0),this._prom&&!(h<a&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),l.prototype.invalidate.call(this)},t.resetTo=function(n,r,s,o){Oa||xn.wake(),this._ts||this.play();var a=Math.min(this._dur,(this._dp._time-this._start)*this._ts),c;return this._initted||$f(this,a),c=this._ease(a/this._dur),n4(this,n,r,s,o,c,a)?this.resetTo(n,r,s,o):(Kf(this,0),this.parent||c1(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(n,r){if(r===void 0&&(r="all"),!n&&(!r||r==="all"))return this._lazy=this._pt=0,this.parent?la(this):this;if(this.timeline){var s=this.timeline.totalDuration();return this.timeline.killTweensOf(n,r,ir&&ir.vars.overwrite!==!0)._first||la(this),this.parent&&s!==this.timeline.totalDuration()&&Co(this,this._dur*this.timeline._tDur/s,0,1),this}var o=this._targets,a=n?In(n):o,c=this._ptLookup,h=this._pt,u,f,d,g,p,m,_;if((!r||r==="all")&&PS(o,a))return r==="all"&&(this._pt=0),la(this);for(u=this._op=this._op||[],r!=="all"&&(Bt(r)&&(p={},hn(r,function(x){return p[x]=1}),r=p),r=i4(o,r)),_=o.length;_--;)if(~a.indexOf(o[_])){f=c[_],r==="all"?(u[_]=r,g=f,d={}):(d=u[_]=u[_]||{},g=r);for(p in g)m=f&&f[p],m&&((!("kill"in m.d)||m.d.kill(p)===!0)&&Hc(this,m,"_pt"),delete f[p]),d!=="all"&&(d[p]=1)}return this._initted&&!this._pt&&h&&la(this),this},e.to=function(n,r){return new e(n,r,arguments[2])},e.from=function(n,r){return _a(1,arguments)},e.delayedCall=function(n,r,s,o){return new e(r,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:n,onComplete:r,onReverseComplete:r,onCompleteParams:s,onReverseCompleteParams:s,callbackScope:o})},e.fromTo=function(n,r,s){return _a(2,arguments)},e.set=function(n,r){return r.duration=0,r.repeatDelay||(r.repeat=0),new e(n,r)},e.killTweensOf=function(n,r,s){return gt.killTweensOf(n,r,s)},e}(Ua);On(Ut.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});hn("staggerTo,staggerFrom,staggerFromTo",function(l){Ut[l]=function(){var e=new ln,t=Ku.call(arguments,0);return t.splice(l==="staggerFromTo"?5:4,0,0),e[l].apply(e,t)}});var ed=function(e,t,i){return e[t]=i},R1=function(e,t,i){return e[t](i)},s4=function(e,t,i,n){return e[t](n.fp,i)},o4=function(e,t,i){return e.setAttribute(t,i)},td=function(e,t){return Nt(e[t])?R1:Xf(e[t])&&e.setAttribute?o4:ed},P1=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},a4=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},D1=function(e,t){var i=t._pt,n="";if(!e&&t.b)n=t.b;else if(e===1&&t.e)n=t.e;else{for(;i;)n=i.p+(i.m?i.m(i.s+i.c*e):Math.round((i.s+i.c*e)*1e4)/1e4)+n,i=i._next;n+=t.c}t.set(t.t,t.p,n,t)},nd=function(e,t){for(var i=t._pt;i;)i.r(e,i.d),i=i._next},l4=function(e,t,i,n){for(var r=this._pt,s;r;)s=r._next,r.p===n&&r.modifier(e,t,i),r=s},c4=function(e){for(var t=this._pt,i,n;t;)n=t._next,t.p===e&&!t.op||t.op===e?Hc(this,t,"_pt"):t.dep||(i=1),t=n;return!i},h4=function(e,t,i,n){n.mSet(e,t,n.m.call(n.tween,i,n.mt),n)},I1=function(e){for(var t=e._pt,i,n,r,s;t;){for(i=t._next,n=r;n&&n.pr>t.pr;)n=n._next;(t._prev=n?n._prev:s)?t._prev._next=t:r=t,(t._next=n)?n._prev=t:s=t,t=i}e._pt=r},un=function(){function l(t,i,n,r,s,o,a,c,h){this.t=i,this.s=r,this.c=s,this.p=n,this.r=o||P1,this.d=a||this,this.set=c||ed,this.pr=h||0,this._next=t,t&&(t._prev=this)}var e=l.prototype;return e.modifier=function(i,n,r){this.mSet=this.mSet||this.set,this.set=h4,this.m=i,this.mt=r,this.tween=n},l}();hn(jf+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(l){return Zf[l]=1});Tn.TweenMax=Tn.TweenLite=Ut;Tn.TimelineLite=Tn.TimelineMax=ln;gt=new ln({sortChildren:!1,defaults:So,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Sn.stringFilter=w1;var vc={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(function(n){return YS(n)})},timeline:function(e){return new ln(e)},getTweensOf:function(e,t){return gt.getTweensOf(e,t)},getProperty:function(e,t,i,n){Bt(e)&&(e=In(e)[0]);var r=is(e||{}).get,s=i?l1:a1;return i==="native"&&(i=""),e&&(t?s((_n[t]&&_n[t].get||r)(e,t,i,n)):function(o,a,c){return s((_n[o]&&_n[o].get||r)(e,o,a,c))})},quickSetter:function(e,t,i){if(e=In(e),e.length>1){var n=e.map(function(h){return Jn.quickSetter(h,t,i)}),r=n.length;return function(h){for(var u=r;u--;)n[u](h)}}e=e[0]||{};var s=_n[t],o=is(e),a=o.harness&&(o.harness.aliases||{})[t]||t,c=s?function(h){var u=new s;Js._pt=0,u.init(e,i?h+i:h,Js,0,[e]),u.render(1,u),Js._pt&&nd(1,Js)}:o.set(e,a);return s?c:function(h){return c(e,a,i?h+i:h,o,1)}},quickTo:function(e,t,i){var n,r=Jn.to(e,ds((n={},n[t]="+=0.1",n.paused=!0,n),i||{})),s=function(a,c,h){return r.resetTo(t,a,c,h)};return s.tween=r,s},isTweening:function(e){return gt.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=ss(e.ease,So.ease)),ym(So,e||{})},config:function(e){return ym(Sn,e||{})},registerEffect:function(e){var t=e.name,i=e.effect,n=e.plugins,r=e.defaults,s=e.extendTimeline;(n||"").split(",").forEach(function(o){return o&&!_n[o]&&!Tn[o]&&mc(t+" effect requires "+o+" plugin.")}),Jh[t]=function(o,a,c){return i(In(o),On(a||{},r),c)},s&&(ln.prototype[t]=function(o,a,c){return this.add(Jh[t](o,Oi(a)?a:(c=a)&&{},this),c)})},registerEase:function(e,t){Je[e]=ss(t)},parseEase:function(e,t){return arguments.length?ss(e,t):Je},getById:function(e){return gt.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var i=new ln(e),n,r;for(i.smoothChildTiming=cn(e.smoothChildTiming),gt.remove(i),i._dp=0,i._time=i._tTime=gt._time,n=gt._first;n;)r=n._next,(t||!(!n._dur&&n instanceof Ut&&n.vars.onComplete===n._targets[0]))&&ai(i,n,n._start-n._delay),n=r;return ai(gt,i,0),i},utils:{wrap:WS,wrapYoyo:XS,distribute:m1,random:_1,snap:g1,normalize:HS,getUnit:Zt,clamp:NS,splitColor:y1,toArray:In,selector:zS,mapRange:v1,pipe:GS,unitize:VS,interpolate:qS,shuffle:p1},install:n1,effects:Jh,ticker:xn,updateRoot:ln.updateRoot,plugins:_n,globalTimeline:gt,core:{PropTween:un,globals:i1,Tween:Ut,Timeline:ln,Animation:Ua,getCache:is,_removeLinkedListItem:Hc,suppressOverwrites:function(e){return Wf=e}}};hn("to,from,fromTo,delayedCall,set,killTweensOf",function(l){return vc[l]=Ut[l]});xn.add(ln.updateRoot);Js=vc.to({},{duration:0});var u4=function(e,t){for(var i=e._pt;i&&i.p!==t&&i.op!==t&&i.fp!==t;)i=i._next;return i},f4=function(e,t){var i=e._targets,n,r,s;for(n in t)for(r=i.length;r--;)s=e._ptLookup[r][n],s&&(s=s.d)&&(s._pt&&(s=u4(s,n)),s&&s.modifier&&s.modifier(t[n],e,i[r],n))},eu=function(e,t){return{name:e,rawVars:1,init:function(n,r,s){s._onInit=function(o){var a,c;if(Bt(r)&&(a={},hn(r,function(h){return a[h]=1}),r=a),t){a={};for(c in r)a[c]=t(r[c]);r=a}f4(o,r)}}}},Jn=vc.registerPlugin({name:"attr",init:function(e,t,i,n,r){var s,o;for(s in t)o=this.add(e,"setAttribute",(e.getAttribute(s)||0)+"",t[s],n,r,0,0,s),o&&(o.op=s),this._props.push(s)}},{name:"endArray",init:function(e,t){for(var i=t.length;i--;)this.add(e,i,e[i]||0,t[i])}},eu("roundProps",Qu),eu("modifiers"),eu("snap",g1))||vc;Ut.version=ln.version=Jn.version="3.10.4";t1=1;Jg()&&Ao();Je.Power0;Je.Power1;Je.Power2;Je.Power3;Je.Power4;Je.Linear;Je.Quad;Je.Cubic;Je.Quart;Je.Quint;Je.Strong;Je.Elastic;Je.Back;Je.SteppedEase;Je.Bounce;Je.Sine;Je.Expo;Je.Circ;/*!
 * CSSPlugin 3.10.4
 * https://greensock.com
 *
 * Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Tm,rr,eo,id,Jr,Cm,d4=function(){return typeof window!="undefined"},vr={},Gr=180/Math.PI,to=Math.PI/180,Hs=Math.atan2,Am=1e8,F1=/([A-Z])/g,p4=/(left|right|width|margin|padding|x)/i,m4=/[\s,\(]\S/,sr={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},O1=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},g4=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},_4=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},x4=function(e,t){var i=t.s+t.c*e;t.set(t.t,t.p,~~(i+(i<0?-.5:.5))+t.u,t)},U1=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},k1=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},v4=function(e,t,i){return e.style[t]=i},y4=function(e,t,i){return e.style.setProperty(t,i)},b4=function(e,t,i){return e._gsap[t]=i},w4=function(e,t,i){return e._gsap.scaleX=e._gsap.scaleY=i},M4=function(e,t,i,n,r){var s=e._gsap;s.scaleX=s.scaleY=i,s.renderTransform(r,s)},S4=function(e,t,i,n,r){var s=e._gsap;s[t]=i,s.renderTransform(r,s)},Vt="transform",yr=Vt+"Origin",N1,ef=function(e,t){var i=rr.createElementNS?rr.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):rr.createElement(e);return i.style?i:rr.createElement(e)},Ri=function l(e,t,i){var n=getComputedStyle(e);return n[t]||n.getPropertyValue(t.replace(F1,"-$1").toLowerCase())||n.getPropertyValue(t)||!i&&l(e,Eo(t)||t,1)||""},Em="O,Moz,ms,Ms,Webkit".split(","),Eo=function(e,t,i){var n=t||Jr,r=n.style,s=5;if(e in r&&!i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);s--&&!(Em[s]+e in r););return s<0?null:(s===3?"ms":s>=0?Em[s]:"")+e},tf=function(){d4()&&window.document&&(Tm=window,rr=Tm.document,eo=rr.documentElement,Jr=ef("div")||{style:{}},ef("div"),Vt=Eo(Vt),yr=Vt+"Origin",Jr.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",N1=!!Eo("perspective"),id=1)},tu=function l(e){var t=ef("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,n=this.nextSibling,r=this.style.cssText,s;if(eo.appendChild(t),t.appendChild(this),this.style.display="block",e)try{s=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=l}catch{}else this._gsapBBox&&(s=this._gsapBBox());return i&&(n?i.insertBefore(this,n):i.appendChild(this)),eo.removeChild(t),this.style.cssText=r,s},Lm=function(e,t){for(var i=t.length;i--;)if(e.hasAttribute(t[i]))return e.getAttribute(t[i])},B1=function(e){var t;try{t=e.getBBox()}catch{t=tu.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===tu||(t=tu.call(e,!0)),t&&!t.width&&!t.x&&!t.y?{x:+Lm(e,["x","cx","x1"])||0,y:+Lm(e,["y","cy","y1"])||0,width:0,height:0}:t},z1=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&B1(e))},ka=function(e,t){if(t){var i=e.style;t in vr&&t!==yr&&(t=Vt),i.removeProperty?((t.substr(0,2)==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),i.removeProperty(t.replace(F1,"-$1").toLowerCase())):i.removeAttribute(t)}},or=function(e,t,i,n,r,s){var o=new un(e._pt,t,i,0,1,s?k1:U1);return e._pt=o,o.b=n,o.e=r,e._props.push(i),o},Rm={deg:1,rad:1,turn:1},br=function l(e,t,i,n){var r=parseFloat(i)||0,s=(i+"").trim().substr((r+"").length)||"px",o=Jr.style,a=p4.test(t),c=e.tagName.toLowerCase()==="svg",h=(c?"client":"offset")+(a?"Width":"Height"),u=100,f=n==="px",d=n==="%",g,p,m,_;return n===s||!r||Rm[n]||Rm[s]?r:(s!=="px"&&!f&&(r=l(e,t,i,"px")),_=e.getCTM&&z1(e),(d||s==="%")&&(vr[t]||~t.indexOf("adius"))?(g=_?e.getBBox()[a?"width":"height"]:e[h],St(d?r/g*u:r/100*g)):(o[a?"width":"height"]=u+(f?s:n),p=~t.indexOf("adius")||n==="em"&&e.appendChild&&!c?e:e.parentNode,_&&(p=(e.ownerSVGElement||{}).parentNode),(!p||p===rr||!p.appendChild)&&(p=rr.body),m=p._gsap,m&&d&&m.width&&a&&m.time===xn.time?St(r/m.width*u):((d||s==="%")&&(o.position=Ri(e,"position")),p===e&&(o.position="static"),p.appendChild(Jr),g=Jr[h],p.removeChild(Jr),o.position="absolute",a&&d&&(m=is(p),m.time=xn.time,m.width=p[h]),St(f?g*r/u:g&&r?u/g*r:0))))},Vr=function(e,t,i,n){var r;return id||tf(),t in sr&&t!=="transform"&&(t=sr[t],~t.indexOf(",")&&(t=t.split(",")[0])),vr[t]&&t!=="transform"?(r=Ba(e,n),r=t!=="transformOrigin"?r[t]:r.svg?r.origin:bc(Ri(e,yr))+" "+r.zOrigin+"px"):(r=e.style[t],(!r||r==="auto"||n||~(r+"").indexOf("calc("))&&(r=yc[t]&&yc[t](e,t,i)||Ri(e,t)||s1(e,t)||(t==="opacity"?1:0))),i&&!~(r+"").trim().indexOf(" ")?br(e,t,r,i)+i:r},T4=function(e,t,i,n){if(!i||i==="none"){var r=Eo(t,e,1),s=r&&Ri(e,r,1);s&&s!==i?(t=r,i=s):t==="borderColor"&&(i=Ri(e,"borderTopColor"))}var o=new un(this._pt,e.style,t,0,1,D1),a=0,c=0,h,u,f,d,g,p,m,_,x,b,y,v;if(o.b=i,o.e=n,i+="",n+="",n==="auto"&&(e.style[t]=n,n=Ri(e,t)||n,e.style[t]=i),h=[i,n],w1(h),i=h[0],n=h[1],f=i.match(js)||[],v=n.match(js)||[],v.length){for(;u=js.exec(n);)m=u[0],x=n.substring(a,u.index),g?g=(g+1)%5:(x.substr(-5)==="rgba("||x.substr(-5)==="hsla(")&&(g=1),m!==(p=f[c++]||"")&&(d=parseFloat(p)||0,y=p.substr((d+"").length),m.charAt(1)==="="&&(m=$s(d,m)+y),_=parseFloat(m),b=m.substr((_+"").length),a=js.lastIndex-b.length,b||(b=b||Sn.units[t]||y,a===n.length&&(n+=b,o.e+=b)),y!==b&&(d=br(e,t,p,b)||0),o._pt={_next:o._pt,p:x||c===1?x:",",s:d,c:_-d,m:g&&g<4||t==="zIndex"?Math.round:0});o.c=a<n.length?n.substring(a,n.length):""}else o.r=t==="display"&&n==="none"?k1:U1;return $g.test(n)&&(o.e=0),this._pt=o,o},Pm={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},C4=function(e){var t=e.split(" "),i=t[0],n=t[1]||"50%";return(i==="top"||i==="bottom"||n==="left"||n==="right")&&(e=i,i=n,n=e),t[0]=Pm[i]||i,t[1]=Pm[n]||n,t.join(" ")},A4=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var i=t.t,n=i.style,r=t.u,s=i._gsap,o,a,c;if(r==="all"||r===!0)n.cssText="",a=1;else for(r=r.split(","),c=r.length;--c>-1;)o=r[c],vr[o]&&(a=1,o=o==="transformOrigin"?yr:Vt),ka(i,o);a&&(ka(i,Vt),s&&(s.svg&&i.removeAttribute("transform"),Ba(i,1),s.uncache=1))}},yc={clearProps:function(e,t,i,n,r){if(r.data!=="isFromStart"){var s=e._pt=new un(e._pt,t,i,0,0,A4);return s.u=n,s.pr=-10,s.tween=r,e._props.push(i),1}}},Na=[1,0,0,1,0,0],G1={},V1=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},Dm=function(e){var t=Ri(e,Vt);return V1(t)?Na:t.substr(7).match(Qg).map(St)},rd=function(e,t){var i=e._gsap||is(e),n=e.style,r=Dm(e),s,o,a,c;return i.svg&&e.getAttribute("transform")?(a=e.transform.baseVal.consolidate().matrix,r=[a.a,a.b,a.c,a.d,a.e,a.f],r.join(",")==="1,0,0,1,0,0"?Na:r):(r===Na&&!e.offsetParent&&e!==eo&&!i.svg&&(a=n.display,n.display="block",s=e.parentNode,(!s||!e.offsetParent)&&(c=1,o=e.nextSibling,eo.appendChild(e)),r=Dm(e),a?n.display=a:ka(e,"display"),c&&(o?s.insertBefore(e,o):s?s.appendChild(e):eo.removeChild(e))),t&&r.length>6?[r[0],r[1],r[4],r[5],r[12],r[13]]:r)},nf=function(e,t,i,n,r,s){var o=e._gsap,a=r||rd(e,!0),c=o.xOrigin||0,h=o.yOrigin||0,u=o.xOffset||0,f=o.yOffset||0,d=a[0],g=a[1],p=a[2],m=a[3],_=a[4],x=a[5],b=t.split(" "),y=parseFloat(b[0])||0,v=parseFloat(b[1])||0,M,S,w,T;i?a!==Na&&(S=d*m-g*p)&&(w=y*(m/S)+v*(-p/S)+(p*x-m*_)/S,T=y*(-g/S)+v*(d/S)-(d*x-g*_)/S,y=w,v=T):(M=B1(e),y=M.x+(~b[0].indexOf("%")?y/100*M.width:y),v=M.y+(~(b[1]||b[0]).indexOf("%")?v/100*M.height:v)),n||n!==!1&&o.smooth?(_=y-c,x=v-h,o.xOffset=u+(_*d+x*p)-_,o.yOffset=f+(_*g+x*m)-x):o.xOffset=o.yOffset=0,o.xOrigin=y,o.yOrigin=v,o.smooth=!!n,o.origin=t,o.originIsAbsolute=!!i,e.style[yr]="0px 0px",s&&(or(s,o,"xOrigin",c,y),or(s,o,"yOrigin",h,v),or(s,o,"xOffset",u,o.xOffset),or(s,o,"yOffset",f,o.yOffset)),e.setAttribute("data-svg-origin",y+" "+v)},Ba=function(e,t){var i=e._gsap||new C1(e);if("x"in i&&!t&&!i.uncache)return i;var n=e.style,r=i.scaleX<0,s="px",o="deg",a=Ri(e,yr)||"0",c,h,u,f,d,g,p,m,_,x,b,y,v,M,S,w,T,R,D,I,U,A,B,O,q,Z,k,V,F,z,X,j;return c=h=u=g=p=m=_=x=b=0,f=d=1,i.svg=!!(e.getCTM&&z1(e)),M=rd(e,i.svg),i.svg&&(O=(!i.uncache||a==="0px 0px")&&!t&&e.getAttribute("data-svg-origin"),nf(e,O||a,!!O||i.originIsAbsolute,i.smooth!==!1,M)),y=i.xOrigin||0,v=i.yOrigin||0,M!==Na&&(R=M[0],D=M[1],I=M[2],U=M[3],c=A=M[4],h=B=M[5],M.length===6?(f=Math.sqrt(R*R+D*D),d=Math.sqrt(U*U+I*I),g=R||D?Hs(D,R)*Gr:0,_=I||U?Hs(I,U)*Gr+g:0,_&&(d*=Math.abs(Math.cos(_*to))),i.svg&&(c-=y-(y*R+v*I),h-=v-(y*D+v*U))):(j=M[6],z=M[7],k=M[8],V=M[9],F=M[10],X=M[11],c=M[12],h=M[13],u=M[14],S=Hs(j,F),p=S*Gr,S&&(w=Math.cos(-S),T=Math.sin(-S),O=A*w+k*T,q=B*w+V*T,Z=j*w+F*T,k=A*-T+k*w,V=B*-T+V*w,F=j*-T+F*w,X=z*-T+X*w,A=O,B=q,j=Z),S=Hs(-I,F),m=S*Gr,S&&(w=Math.cos(-S),T=Math.sin(-S),O=R*w-k*T,q=D*w-V*T,Z=I*w-F*T,X=U*T+X*w,R=O,D=q,I=Z),S=Hs(D,R),g=S*Gr,S&&(w=Math.cos(S),T=Math.sin(S),O=R*w+D*T,q=A*w+B*T,D=D*w-R*T,B=B*w-A*T,R=O,A=q),p&&Math.abs(p)+Math.abs(g)>359.9&&(p=g=0,m=180-m),f=St(Math.sqrt(R*R+D*D+I*I)),d=St(Math.sqrt(B*B+j*j)),S=Hs(A,B),_=Math.abs(S)>2e-4?S*Gr:0,b=X?1/(X<0?-X:X):0),i.svg&&(O=e.getAttribute("transform"),i.forceCSS=e.setAttribute("transform","")||!V1(Ri(e,Vt)),O&&e.setAttribute("transform",O))),Math.abs(_)>90&&Math.abs(_)<270&&(r?(f*=-1,_+=g<=0?180:-180,g+=g<=0?180:-180):(d*=-1,_+=_<=0?180:-180)),t=t||i.uncache,i.x=c-((i.xPercent=c&&(!t&&i.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-c)?-50:0)))?e.offsetWidth*i.xPercent/100:0)+s,i.y=h-((i.yPercent=h&&(!t&&i.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-h)?-50:0)))?e.offsetHeight*i.yPercent/100:0)+s,i.z=u+s,i.scaleX=St(f),i.scaleY=St(d),i.rotation=St(g)+o,i.rotationX=St(p)+o,i.rotationY=St(m)+o,i.skewX=_+o,i.skewY=x+o,i.transformPerspective=b+s,(i.zOrigin=parseFloat(a.split(" ")[2])||0)&&(n[yr]=bc(a)),i.xOffset=i.yOffset=0,i.force3D=Sn.force3D,i.renderTransform=i.svg?L4:N1?H1:E4,i.uncache=0,i},bc=function(e){return(e=e.split(" "))[0]+" "+e[1]},nu=function(e,t,i){var n=Zt(t);return St(parseFloat(t)+parseFloat(br(e,"x",i+"px",n)))+n},E4=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,H1(e,t)},kr="0deg",oa="0px",Nr=") ",H1=function(e,t){var i=t||this,n=i.xPercent,r=i.yPercent,s=i.x,o=i.y,a=i.z,c=i.rotation,h=i.rotationY,u=i.rotationX,f=i.skewX,d=i.skewY,g=i.scaleX,p=i.scaleY,m=i.transformPerspective,_=i.force3D,x=i.target,b=i.zOrigin,y="",v=_==="auto"&&e&&e!==1||_===!0;if(b&&(u!==kr||h!==kr)){var M=parseFloat(h)*to,S=Math.sin(M),w=Math.cos(M),T;M=parseFloat(u)*to,T=Math.cos(M),s=nu(x,s,S*T*-b),o=nu(x,o,-Math.sin(M)*-b),a=nu(x,a,w*T*-b+b)}m!==oa&&(y+="perspective("+m+Nr),(n||r)&&(y+="translate("+n+"%, "+r+"%) "),(v||s!==oa||o!==oa||a!==oa)&&(y+=a!==oa||v?"translate3d("+s+", "+o+", "+a+") ":"translate("+s+", "+o+Nr),c!==kr&&(y+="rotate("+c+Nr),h!==kr&&(y+="rotateY("+h+Nr),u!==kr&&(y+="rotateX("+u+Nr),(f!==kr||d!==kr)&&(y+="skew("+f+", "+d+Nr),(g!==1||p!==1)&&(y+="scale("+g+", "+p+Nr),x.style[Vt]=y||"translate(0, 0)"},L4=function(e,t){var i=t||this,n=i.xPercent,r=i.yPercent,s=i.x,o=i.y,a=i.rotation,c=i.skewX,h=i.skewY,u=i.scaleX,f=i.scaleY,d=i.target,g=i.xOrigin,p=i.yOrigin,m=i.xOffset,_=i.yOffset,x=i.forceCSS,b=parseFloat(s),y=parseFloat(o),v,M,S,w,T;a=parseFloat(a),c=parseFloat(c),h=parseFloat(h),h&&(h=parseFloat(h),c+=h,a+=h),a||c?(a*=to,c*=to,v=Math.cos(a)*u,M=Math.sin(a)*u,S=Math.sin(a-c)*-f,w=Math.cos(a-c)*f,c&&(h*=to,T=Math.tan(c-h),T=Math.sqrt(1+T*T),S*=T,w*=T,h&&(T=Math.tan(h),T=Math.sqrt(1+T*T),v*=T,M*=T)),v=St(v),M=St(M),S=St(S),w=St(w)):(v=u,w=f,M=S=0),(b&&!~(s+"").indexOf("px")||y&&!~(o+"").indexOf("px"))&&(b=br(d,"x",s,"px"),y=br(d,"y",o,"px")),(g||p||m||_)&&(b=St(b+g-(g*v+p*S)+m),y=St(y+p-(g*M+p*w)+_)),(n||r)&&(T=d.getBBox(),b=St(b+n/100*T.width),y=St(y+r/100*T.height)),T="matrix("+v+","+M+","+S+","+w+","+b+","+y+")",d.setAttribute("transform",T),x&&(d.style[Vt]=T)},R4=function(e,t,i,n,r){var s=360,o=Bt(r),a=parseFloat(r)*(o&&~r.indexOf("rad")?Gr:1),c=a-n,h=n+c+"deg",u,f;return o&&(u=r.split("_")[1],u==="short"&&(c%=s,c!==c%(s/2)&&(c+=c<0?s:-s)),u==="cw"&&c<0?c=(c+s*Am)%s-~~(c/s)*s:u==="ccw"&&c>0&&(c=(c-s*Am)%s-~~(c/s)*s)),e._pt=f=new un(e._pt,t,i,n,c,g4),f.e=h,f.u="deg",e._props.push(i),f},Im=function(e,t){for(var i in t)e[i]=t[i];return e},P4=function(e,t,i){var n=Im({},i._gsap),r="perspective,force3D,transformOrigin,svgOrigin",s=i.style,o,a,c,h,u,f,d,g;n.svg?(c=i.getAttribute("transform"),i.setAttribute("transform",""),s[Vt]=t,o=Ba(i,1),ka(i,Vt),i.setAttribute("transform",c)):(c=getComputedStyle(i)[Vt],s[Vt]=t,o=Ba(i,1),s[Vt]=c);for(a in vr)c=n[a],h=o[a],c!==h&&r.indexOf(a)<0&&(d=Zt(c),g=Zt(h),u=d!==g?br(i,a,c,g):parseFloat(c),f=parseFloat(h),e._pt=new un(e._pt,o,a,u,f-u,O1),e._pt.u=g||0,e._props.push(a));Im(o,n)};hn("padding,margin,Width,Radius",function(l,e){var t="Top",i="Right",n="Bottom",r="Left",s=(e<3?[t,i,n,r]:[t+r,t+i,n+i,n+r]).map(function(o){return e<2?l+o:"border"+o+l});yc[e>1?"border"+l:l]=function(o,a,c,h,u){var f,d;if(arguments.length<4)return f=s.map(function(g){return Vr(o,g,c)}),d=f.join(" "),d.split(f[0]).length===5?f[0]:d;f=(h+"").split(" "),d={},s.forEach(function(g,p){return d[g]=f[p]=f[p]||f[(p-1)/2|0]}),o.init(a,d,u)}});var W1={name:"css",register:tf,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,i,n,r){var s=this._props,o=e.style,a=i.vars.startAt,c,h,u,f,d,g,p,m,_,x,b,y,v,M,S;id||tf();for(p in t)if(p!=="autoRound"&&(h=t[p],!(_n[p]&&A1(p,t,i,n,e,r)))){if(d=typeof h,g=yc[p],d==="function"&&(h=h.call(i,n,e,r),d=typeof h),d==="string"&&~h.indexOf("random(")&&(h=Fa(h)),g)g(this,e,p,h,i)&&(S=1);else if(p.substr(0,2)==="--")c=(getComputedStyle(e).getPropertyValue(p)+"").trim(),h+="",cr.lastIndex=0,cr.test(c)||(m=Zt(c),_=Zt(h)),_?m!==_&&(c=br(e,p,c,_)+_):m&&(h+=m),this.add(o,"setProperty",c,h,n,r,0,0,p),s.push(p);else if(d!=="undefined"){if(a&&p in a?(c=typeof a[p]=="function"?a[p].call(i,n,e,r):a[p],Bt(c)&&~c.indexOf("random(")&&(c=Fa(c)),Zt(c+"")||(c+=Sn.units[p]||Zt(Vr(e,p))||""),(c+"").charAt(1)==="="&&(c=Vr(e,p))):c=Vr(e,p),f=parseFloat(c),x=d==="string"&&h.charAt(1)==="="&&h.substr(0,2),x&&(h=h.substr(2)),u=parseFloat(h),p in sr&&(p==="autoAlpha"&&(f===1&&Vr(e,"visibility")==="hidden"&&u&&(f=0),or(this,o,"visibility",f?"inherit":"hidden",u?"inherit":"hidden",!u)),p!=="scale"&&p!=="transform"&&(p=sr[p],~p.indexOf(",")&&(p=p.split(",")[0]))),b=p in vr,b){if(y||(v=e._gsap,v.renderTransform&&!t.parseTransform||Ba(e,t.parseTransform),M=t.smoothOrigin!==!1&&v.smooth,y=this._pt=new un(this._pt,o,Vt,0,1,v.renderTransform,v,0,-1),y.dep=1),p==="scale")this._pt=new un(this._pt,v,"scaleY",v.scaleY,(x?$s(v.scaleY,x+u):u)-v.scaleY||0),s.push("scaleY",p),p+="X";else if(p==="transformOrigin"){h=C4(h),v.svg?nf(e,h,0,M,0,this):(_=parseFloat(h.split(" ")[2])||0,_!==v.zOrigin&&or(this,v,"zOrigin",v.zOrigin,_),or(this,o,p,bc(c),bc(h)));continue}else if(p==="svgOrigin"){nf(e,h,1,M,0,this);continue}else if(p in G1){R4(this,v,p,f,x?$s(f,x+h):h);continue}else if(p==="smoothOrigin"){or(this,v,"smooth",v.smooth,h);continue}else if(p==="force3D"){v[p]=h;continue}else if(p==="transform"){P4(this,h,e);continue}}else p in o||(p=Eo(p)||p);if(b||(u||u===0)&&(f||f===0)&&!m4.test(h)&&p in o)m=(c+"").substr((f+"").length),u||(u=0),_=Zt(h)||(p in Sn.units?Sn.units[p]:m),m!==_&&(f=br(e,p,c,_)),this._pt=new un(this._pt,b?v:o,p,f,(x?$s(f,x+u):u)-f,!b&&(_==="px"||p==="zIndex")&&t.autoRound!==!1?x4:O1),this._pt.u=_||0,m!==_&&_!=="%"&&(this._pt.b=c,this._pt.r=_4);else if(p in o)T4.call(this,e,p,c,x?x+h:h);else if(p in e)this.add(e,p,c||e[p],x?x+h:h,n,r);else{Yf(p,h);continue}s.push(p)}}S&&I1(this)},get:Vr,aliases:sr,getSetter:function(e,t,i){var n=sr[t];return n&&n.indexOf(",")<0&&(t=n),t in vr&&t!==yr&&(e._gsap.x||Vr(e,"x"))?i&&Cm===i?t==="scale"?w4:b4:(Cm=i||{})&&(t==="scale"?M4:S4):e.style&&!Xf(e.style[t])?v4:~t.indexOf("-")?y4:td(e,t)},core:{_removeProperty:ka,_getMatrix:rd}};Jn.utils.checkPrefix=Eo;(function(l,e,t,i){var n=hn(l+","+e+","+t,function(r){vr[r]=1});hn(e,function(r){Sn.units[r]="deg",G1[r]=1}),sr[n[13]]=l+","+e,hn(i,function(r){var s=r.split(":");sr[s[1]]=n[s[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");hn("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(l){Sn.units[l]="px"});Jn.registerPlugin(W1);var Ja=Jn.registerPlugin(W1)||Jn;Ja.core.Tween;class D4 extends ns{constructor(){var r;super(["BACK","EJECT"]);const e=(r=this.getObjectByName("BACK"))==null?void 0:r.userData.size,t=Ja.to(this.position,{z:-e.z/2,paused:!0,duration:.1});function i(s){s.stopPropagation(),s.type==="mouseover"?t.play():t.reverse()}const n=new os;this.addEventListener("click",()=>n.router.goTo()),this.addEventListener("mouseover",i),this.addEventListener("mouseout",i),n.interactionManager.add(this)}}var I4=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},X1={exports:{}};(function(l,e){(function(t,i,n){l.exports=n(),l.exports.default=n()})("slugify",I4,function(){var t=JSON.parse(`{"$":"dollar","%":"percent","&":"and","<":"less",">":"greater","|":"or","\xA2":"cent","\xA3":"pound","\xA4":"currency","\xA5":"yen","\xA9":"(c)","\xAA":"a","\xAE":"(r)","\xBA":"o","\xC0":"A","\xC1":"A","\xC2":"A","\xC3":"A","\xC4":"A","\xC5":"A","\xC6":"AE","\xC7":"C","\xC8":"E","\xC9":"E","\xCA":"E","\xCB":"E","\xCC":"I","\xCD":"I","\xCE":"I","\xCF":"I","\xD0":"D","\xD1":"N","\xD2":"O","\xD3":"O","\xD4":"O","\xD5":"O","\xD6":"O","\xD8":"O","\xD9":"U","\xDA":"U","\xDB":"U","\xDC":"U","\xDD":"Y","\xDE":"TH","\xDF":"ss","\xE0":"a","\xE1":"a","\xE2":"a","\xE3":"a","\xE4":"a","\xE5":"a","\xE6":"ae","\xE7":"c","\xE8":"e","\xE9":"e","\xEA":"e","\xEB":"e","\xEC":"i","\xED":"i","\xEE":"i","\xEF":"i","\xF0":"d","\xF1":"n","\xF2":"o","\xF3":"o","\xF4":"o","\xF5":"o","\xF6":"o","\xF8":"o","\xF9":"u","\xFA":"u","\xFB":"u","\xFC":"u","\xFD":"y","\xFE":"th","\xFF":"y","\u0100":"A","\u0101":"a","\u0102":"A","\u0103":"a","\u0104":"A","\u0105":"a","\u0106":"C","\u0107":"c","\u010C":"C","\u010D":"c","\u010E":"D","\u010F":"d","\u0110":"DJ","\u0111":"dj","\u0112":"E","\u0113":"e","\u0116":"E","\u0117":"e","\u0118":"e","\u0119":"e","\u011A":"E","\u011B":"e","\u011E":"G","\u011F":"g","\u0122":"G","\u0123":"g","\u0128":"I","\u0129":"i","\u012A":"i","\u012B":"i","\u012E":"I","\u012F":"i","\u0130":"I","\u0131":"i","\u0136":"k","\u0137":"k","\u013B":"L","\u013C":"l","\u013D":"L","\u013E":"l","\u0141":"L","\u0142":"l","\u0143":"N","\u0144":"n","\u0145":"N","\u0146":"n","\u0147":"N","\u0148":"n","\u014C":"O","\u014D":"o","\u0150":"O","\u0151":"o","\u0152":"OE","\u0153":"oe","\u0154":"R","\u0155":"r","\u0158":"R","\u0159":"r","\u015A":"S","\u015B":"s","\u015E":"S","\u015F":"s","\u0160":"S","\u0161":"s","\u0162":"T","\u0163":"t","\u0164":"T","\u0165":"t","\u0168":"U","\u0169":"u","\u016A":"u","\u016B":"u","\u016E":"U","\u016F":"u","\u0170":"U","\u0171":"u","\u0172":"U","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017A":"z","\u017B":"Z","\u017C":"z","\u017D":"Z","\u017E":"z","\u018F":"E","\u0192":"f","\u01A0":"O","\u01A1":"o","\u01AF":"U","\u01B0":"u","\u01C8":"LJ","\u01C9":"lj","\u01CB":"NJ","\u01CC":"nj","\u0218":"S","\u0219":"s","\u021A":"T","\u021B":"t","\u0259":"e","\u02DA":"o","\u0386":"A","\u0388":"E","\u0389":"H","\u038A":"I","\u038C":"O","\u038E":"Y","\u038F":"W","\u0390":"i","\u0391":"A","\u0392":"B","\u0393":"G","\u0394":"D","\u0395":"E","\u0396":"Z","\u0397":"H","\u0398":"8","\u0399":"I","\u039A":"K","\u039B":"L","\u039C":"M","\u039D":"N","\u039E":"3","\u039F":"O","\u03A0":"P","\u03A1":"R","\u03A3":"S","\u03A4":"T","\u03A5":"Y","\u03A6":"F","\u03A7":"X","\u03A8":"PS","\u03A9":"W","\u03AA":"I","\u03AB":"Y","\u03AC":"a","\u03AD":"e","\u03AE":"h","\u03AF":"i","\u03B0":"y","\u03B1":"a","\u03B2":"b","\u03B3":"g","\u03B4":"d","\u03B5":"e","\u03B6":"z","\u03B7":"h","\u03B8":"8","\u03B9":"i","\u03BA":"k","\u03BB":"l","\u03BC":"m","\u03BD":"n","\u03BE":"3","\u03BF":"o","\u03C0":"p","\u03C1":"r","\u03C2":"s","\u03C3":"s","\u03C4":"t","\u03C5":"y","\u03C6":"f","\u03C7":"x","\u03C8":"ps","\u03C9":"w","\u03CA":"i","\u03CB":"y","\u03CC":"o","\u03CD":"y","\u03CE":"w","\u0401":"Yo","\u0402":"DJ","\u0404":"Ye","\u0406":"I","\u0407":"Yi","\u0408":"J","\u0409":"LJ","\u040A":"NJ","\u040B":"C","\u040F":"DZ","\u0410":"A","\u0411":"B","\u0412":"V","\u0413":"G","\u0414":"D","\u0415":"E","\u0416":"Zh","\u0417":"Z","\u0418":"I","\u0419":"J","\u041A":"K","\u041B":"L","\u041C":"M","\u041D":"N","\u041E":"O","\u041F":"P","\u0420":"R","\u0421":"S","\u0422":"T","\u0423":"U","\u0424":"F","\u0425":"H","\u0426":"C","\u0427":"Ch","\u0428":"Sh","\u0429":"Sh","\u042A":"U","\u042B":"Y","\u042C":"","\u042D":"E","\u042E":"Yu","\u042F":"Ya","\u0430":"a","\u0431":"b","\u0432":"v","\u0433":"g","\u0434":"d","\u0435":"e","\u0436":"zh","\u0437":"z","\u0438":"i","\u0439":"j","\u043A":"k","\u043B":"l","\u043C":"m","\u043D":"n","\u043E":"o","\u043F":"p","\u0440":"r","\u0441":"s","\u0442":"t","\u0443":"u","\u0444":"f","\u0445":"h","\u0446":"c","\u0447":"ch","\u0448":"sh","\u0449":"sh","\u044A":"u","\u044B":"y","\u044C":"","\u044D":"e","\u044E":"yu","\u044F":"ya","\u0451":"yo","\u0452":"dj","\u0454":"ye","\u0456":"i","\u0457":"yi","\u0458":"j","\u0459":"lj","\u045A":"nj","\u045B":"c","\u045D":"u","\u045F":"dz","\u0490":"G","\u0491":"g","\u0492":"GH","\u0493":"gh","\u049A":"KH","\u049B":"kh","\u04A2":"NG","\u04A3":"ng","\u04AE":"UE","\u04AF":"ue","\u04B0":"U","\u04B1":"u","\u04BA":"H","\u04BB":"h","\u04D8":"AE","\u04D9":"ae","\u04E8":"OE","\u04E9":"oe","\u0531":"A","\u0532":"B","\u0533":"G","\u0534":"D","\u0535":"E","\u0536":"Z","\u0537":"E'","\u0538":"Y'","\u0539":"T'","\u053A":"JH","\u053B":"I","\u053C":"L","\u053D":"X","\u053E":"C'","\u053F":"K","\u0540":"H","\u0541":"D'","\u0542":"GH","\u0543":"TW","\u0544":"M","\u0545":"Y","\u0546":"N","\u0547":"SH","\u0549":"CH","\u054A":"P","\u054B":"J","\u054C":"R'","\u054D":"S","\u054E":"V","\u054F":"T","\u0550":"R","\u0551":"C","\u0553":"P'","\u0554":"Q'","\u0555":"O''","\u0556":"F","\u0587":"EV","\u0621":"a","\u0622":"aa","\u0623":"a","\u0624":"u","\u0625":"i","\u0626":"e","\u0627":"a","\u0628":"b","\u0629":"h","\u062A":"t","\u062B":"th","\u062C":"j","\u062D":"h","\u062E":"kh","\u062F":"d","\u0630":"th","\u0631":"r","\u0632":"z","\u0633":"s","\u0634":"sh","\u0635":"s","\u0636":"dh","\u0637":"t","\u0638":"z","\u0639":"a","\u063A":"gh","\u0641":"f","\u0642":"q","\u0643":"k","\u0644":"l","\u0645":"m","\u0646":"n","\u0647":"h","\u0648":"w","\u0649":"a","\u064A":"y","\u064B":"an","\u064C":"on","\u064D":"en","\u064E":"a","\u064F":"u","\u0650":"e","\u0652":"","\u0660":"0","\u0661":"1","\u0662":"2","\u0663":"3","\u0664":"4","\u0665":"5","\u0666":"6","\u0667":"7","\u0668":"8","\u0669":"9","\u067E":"p","\u0686":"ch","\u0698":"zh","\u06A9":"k","\u06AF":"g","\u06CC":"y","\u06F0":"0","\u06F1":"1","\u06F2":"2","\u06F3":"3","\u06F4":"4","\u06F5":"5","\u06F6":"6","\u06F7":"7","\u06F8":"8","\u06F9":"9","\u0E3F":"baht","\u10D0":"a","\u10D1":"b","\u10D2":"g","\u10D3":"d","\u10D4":"e","\u10D5":"v","\u10D6":"z","\u10D7":"t","\u10D8":"i","\u10D9":"k","\u10DA":"l","\u10DB":"m","\u10DC":"n","\u10DD":"o","\u10DE":"p","\u10DF":"zh","\u10E0":"r","\u10E1":"s","\u10E2":"t","\u10E3":"u","\u10E4":"f","\u10E5":"k","\u10E6":"gh","\u10E7":"q","\u10E8":"sh","\u10E9":"ch","\u10EA":"ts","\u10EB":"dz","\u10EC":"ts","\u10ED":"ch","\u10EE":"kh","\u10EF":"j","\u10F0":"h","\u1E62":"S","\u1E63":"s","\u1E80":"W","\u1E81":"w","\u1E82":"W","\u1E83":"w","\u1E84":"W","\u1E85":"w","\u1E9E":"SS","\u1EA0":"A","\u1EA1":"a","\u1EA2":"A","\u1EA3":"a","\u1EA4":"A","\u1EA5":"a","\u1EA6":"A","\u1EA7":"a","\u1EA8":"A","\u1EA9":"a","\u1EAA":"A","\u1EAB":"a","\u1EAC":"A","\u1EAD":"a","\u1EAE":"A","\u1EAF":"a","\u1EB0":"A","\u1EB1":"a","\u1EB2":"A","\u1EB3":"a","\u1EB4":"A","\u1EB5":"a","\u1EB6":"A","\u1EB7":"a","\u1EB8":"E","\u1EB9":"e","\u1EBA":"E","\u1EBB":"e","\u1EBC":"E","\u1EBD":"e","\u1EBE":"E","\u1EBF":"e","\u1EC0":"E","\u1EC1":"e","\u1EC2":"E","\u1EC3":"e","\u1EC4":"E","\u1EC5":"e","\u1EC6":"E","\u1EC7":"e","\u1EC8":"I","\u1EC9":"i","\u1ECA":"I","\u1ECB":"i","\u1ECC":"O","\u1ECD":"o","\u1ECE":"O","\u1ECF":"o","\u1ED0":"O","\u1ED1":"o","\u1ED2":"O","\u1ED3":"o","\u1ED4":"O","\u1ED5":"o","\u1ED6":"O","\u1ED7":"o","\u1ED8":"O","\u1ED9":"o","\u1EDA":"O","\u1EDB":"o","\u1EDC":"O","\u1EDD":"o","\u1EDE":"O","\u1EDF":"o","\u1EE0":"O","\u1EE1":"o","\u1EE2":"O","\u1EE3":"o","\u1EE4":"U","\u1EE5":"u","\u1EE6":"U","\u1EE7":"u","\u1EE8":"U","\u1EE9":"u","\u1EEA":"U","\u1EEB":"u","\u1EEC":"U","\u1EED":"u","\u1EEE":"U","\u1EEF":"u","\u1EF0":"U","\u1EF1":"u","\u1EF2":"Y","\u1EF3":"y","\u1EF4":"Y","\u1EF5":"y","\u1EF6":"Y","\u1EF7":"y","\u1EF8":"Y","\u1EF9":"y","\u2013":"-","\u2018":"'","\u2019":"'","\u201C":"\\"","\u201D":"\\"","\u201E":"\\"","\u2020":"+","\u2022":"*","\u2026":"...","\u20A0":"ecu","\u20A2":"cruzeiro","\u20A3":"french franc","\u20A4":"lira","\u20A5":"mill","\u20A6":"naira","\u20A7":"peseta","\u20A8":"rupee","\u20A9":"won","\u20AA":"new shequel","\u20AB":"dong","\u20AC":"euro","\u20AD":"kip","\u20AE":"tugrik","\u20AF":"drachma","\u20B0":"penny","\u20B1":"peso","\u20B2":"guarani","\u20B3":"austral","\u20B4":"hryvnia","\u20B5":"cedi","\u20B8":"kazakhstani tenge","\u20B9":"indian rupee","\u20BA":"turkish lira","\u20BD":"russian ruble","\u20BF":"bitcoin","\u2120":"sm","\u2122":"tm","\u2202":"d","\u2206":"delta","\u2211":"sum","\u221E":"infinity","\u2665":"love","\u5143":"yuan","\u5186":"yen","\uFDFC":"rial","\uFEF5":"laa","\uFEF7":"laa","\uFEF9":"lai","\uFEFB":"la"}`),i=JSON.parse('{"bg":{"\u0419":"Y","\u0426":"Ts","\u0429":"Sht","\u042A":"A","\u042C":"Y","\u0439":"y","\u0446":"ts","\u0449":"sht","\u044A":"a","\u044C":"y"},"de":{"\xC4":"AE","\xE4":"ae","\xD6":"OE","\xF6":"oe","\xDC":"UE","\xFC":"ue","\xDF":"ss","%":"prozent","&":"und","|":"oder","\u2211":"summe","\u221E":"unendlich","\u2665":"liebe"},"es":{"%":"por ciento","&":"y","<":"menor que",">":"mayor que","|":"o","\xA2":"centavos","\xA3":"libras","\xA4":"moneda","\u20A3":"francos","\u2211":"suma","\u221E":"infinito","\u2665":"amor"},"fr":{"%":"pourcent","&":"et","<":"plus petit",">":"plus grand","|":"ou","\xA2":"centime","\xA3":"livre","\xA4":"devise","\u20A3":"franc","\u2211":"somme","\u221E":"infini","\u2665":"amour"},"pt":{"%":"porcento","&":"e","<":"menor",">":"maior","|":"ou","\xA2":"centavo","\u2211":"soma","\xA3":"libra","\u221E":"infinito","\u2665":"amor"},"uk":{"\u0418":"Y","\u0438":"y","\u0419":"Y","\u0439":"y","\u0426":"Ts","\u0446":"ts","\u0425":"Kh","\u0445":"kh","\u0429":"Shch","\u0449":"shch","\u0413":"H","\u0433":"h"},"vi":{"\u0110":"D","\u0111":"d"},"da":{"\xD8":"OE","\xF8":"oe","\xC5":"AA","\xE5":"aa","%":"procent","&":"og","|":"eller","$":"dollar","<":"mindre end",">":"st\xF8rre end"},"nb":{"&":"og","\xC5":"AA","\xC6":"AE","\xD8":"OE","\xE5":"aa","\xE6":"ae","\xF8":"oe"},"it":{"&":"e"},"nl":{"&":"en"},"sv":{"&":"och","\xC5":"AA","\xC4":"AE","\xD6":"OE","\xE5":"aa","\xE4":"ae","\xF6":"oe"}}');function n(r,s){if(typeof r!="string")throw new Error("slugify: string argument expected");s=typeof s=="string"?{replacement:s}:s||{};var o=i[s.locale]||{},a=s.replacement===void 0?"-":s.replacement,c=s.trim===void 0?!0:s.trim,h=r.normalize().split("").reduce(function(u,f){var d=o[f]||t[f]||f;return d===a&&(d=" "),u+d.replace(s.remove||/[^\w\s$*_+~.()'"!\-:@]+/g,"")},"");return s.strict&&(h=h.replace(/[^A-Za-z0-9\s]/g,"")),c&&(h=h.trim()),h=h.replace(/\s+/g,a),s.lower&&(h=h.toLowerCase()),h}return n.extend=function(r){Object.assign(t,r)},n})})(X1);var F4=X1.exports;class O4 extends ns{constructor(t,i){const{name:n="",label:r}=t.dataset;super("VHS");Ce(this,"world");Ce(this,"rotationOffset");Ce(this,"hoverAnimation");Ce(this,"onClick",t=>{t.stopPropagation(),this.world.router.goTo(this.name)});Ce(this,"onHover",t=>{t.stopPropagation(),!this.userData.active&&(t.type==="mouseover"?this.hoverAnimation.play():this.hoverAnimation.reverse())});this.world=new os,this.world.interactionManager.add(this),this.name=F4(n,{strict:!0}),this.userData={...this.userData,...t.dataset,active:!1};const s=document.querySelector("div.screen"),o=new Vw(t);this.userData.print={on:()=>{t.classList.add("active"),s.classList.add("active"),o.start()},off:()=>{o.stop(),s.classList.remove("active"),t.classList.remove("active")}},this.position.setY(i*this.userData.size.y),this.rotationOffset=ua.randFloat(ua.degToRad(-30),ua.degToRad(30)),this.rotateY(this.rotationOffset);const a=new iM({title:n,label:r},this.userData.size);this.add(a),this.hoverAnimation=Ja.to(this.position,{z:this.userData.size.z/4,paused:!0,duration:.1}),this.addEventListener("click",this.onClick),this.addEventListener("mouseover",this.onHover),this.addEventListener("mouseout",this.onHover)}}class U4 extends bn{constructor(e,t){super();const i=new L().setY(t.vcr.userData.position.y),n=t.vcr.userData.position.clone();Array.from(document.querySelectorAll("#app article")).reverse().forEach((s,o)=>{const a=new O4(s,o);this.attach(a);const c=Ja.timeline({paused:!0,defaults:{ease:"sine.inOut",duration:1},onStart:()=>{e.attach(a),a.userData.active=!0},onReverseComplete:()=>{this.attach(a),a.userData.active=!1}}).to(a.position,{...i}).to(a.rotation,{y:a.rotationOffset>0?Math.PI:0}).to(a.position,n,"<");a.userData.animation=c,a.userData.viewTarget=t}),this.position.setY(this.children[0].userData.size.y/2),this.position.setZ(-10),this.name="index"}}class k4 extends bn{constructor(){super();const e=16777215,t=new zc(e,2,1e5),i=new _r(.5,16,8),n=new kt({color:e,transparent:!0}),r=new ht(i,n),s=new pi(.2,.2,.6,32),o=new kt({color:4210752}),a=new ht(s,o);a.position.setY(.6),r.add(a);const c=15,h=new pi(.05,.05,c),u=new kt({color:4210752}),f=new ht(h,u);f.position.setY(c/2),r.add(f),r.position.setY(-c),this.add(t,r),Ja.fromTo(this.rotation,{z:-.1},{z:.1,duration:2,yoyo:!0,repeat:-1,ease:"sine.inOut"}),this.position.setY(25)}}var N4="/assets/digitalbin.0bf35fa0.glb";const B4=new Xg;class z4 extends bn{constructor(){super(),B4.load(N4,t=>{const{scene:i}=t;this.add(i)}),this.name="404";const e=new os;this.addEventListener("click",t=>{t.stopPropagation(),e.router.goTo(this.name)}),e.interactionManager.add(this),this.scale.set(4,4,4),this.position.set(0,12,-25)}}var io;const va=class{constructor(){Ce(this,"router");Ce(this,"interactionManager");Ce(this,"onReady");Ce(this,"isReady",!1);Ce(this,"renderer",new jw);Ce(this,"css3Drenderer",new tM);Ce(this,"scene",new im);Ce(this,"cssScene",new im);Ce(this,"camera",new Hw);Ce(this,"cameraControls",new Yw(this.camera,this.renderer));Ce(this,"clock",new kf);Ce(this,"render",()=>{this.renderer.render(this.scene,this.camera),this.css3Drenderer.render(this.cssScene,this.camera)});Ce(this,"tick",()=>{const e=this.clock.getDelta(),t=this.cameraControls.update(e);this.interactionManager.update(),(this.router.isMoving||t)&&this.render(),!this.isReady&&this.scene.children.length>0&&this.setIsReady(),requestAnimationFrame(this.tick)});Ce(this,"setIsReady",()=>{var e;this.isReady=!0,this.css3Drenderer.domElement.style.visibility="visible",(e=this.onReady)==null||e.call(this)});Ce(this,"generateItems",()=>{const e=new nM,t=new k4,i=new z4,n=new MS,r=new U4(this.scene,n);this.scene.add(e,t,i,n,r),this.cssScene.add(n.css3dObject)});Ce(this,"onWindowResize",()=>{this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight),this.css3Drenderer.setSize(window.innerWidth,window.innerHeight),this.render()});Ce(this,"start",()=>{this.router.handleCurrentPath()});Ce(this,"initialize",async()=>{await Promise.all([Wg.preloadFonts(),ns.preloadModel()]),this.generateItems(),this.tick()});if(xi(va,io))return xi(va,io);sh(va,io,this),this.router=new Bw(this.scene,this.cameraControls),this.interactionManager=new Gw(this.renderer,this.camera),window.addEventListener("mousemove",this.render),window.addEventListener("resize",this.onWindowResize,!1)}};let os=va;io=new WeakMap,qo(os,io,void 0);const sd=new os,q1=document.querySelector("loading-screen");sd.initialize();sd.onReady=()=>{q1.setAttribute("ready","")};q1.addEventListener("onstart",()=>{sd.start()});const G4=["data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgdmlld0JveD0iMCAwIDUxMiA1MTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgICA8c3R5bGU+CiAgICAgICAgcGF0aCB7CiAgICAgICAgICAgIGZpbGw6ICMxMTE4Mjc7CiAgICAgICAgfQoKICAgICAgICBAbWVkaWEgKHByZWZlcnMtY29sb3Itc2NoZW1lOiBkYXJrKSB7CiAgICAgICAgICAgIHBhdGggewogICAgICAgICAgICAgICAgZmlsbDogI2Y5ZmFmYjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIDwvc3R5bGU+CiAgICA8cGF0aCBkPSJNMjgzIDI5MC4wODNMNDguMzg0MiAzODlMMjcgMzIzLjA1NUwxOTguNjg1IDI1Ni41TDI3IDE4OS45NDVMNDguMzg0MiAxMjRMMjgzIDIyMi4zMDZWMjkwLjA4M1oiCiAgICAgICAgZmlsbD0iIzExMTgyNyIgLz4KICAgIDxwYXRoIGQ9Ik0zMjcgMTI0SDQ3OVYzODlIMzI3VjEyNFoiIGZpbGw9IiMxMTE4MjciIC8+Cjwvc3ZnPg==","data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgdmlld0JveD0iMCAwIDUxMiA1MTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgICA8c3R5bGU+CiAgICAgICAgcGF0aCB7CiAgICAgICAgICAgIGZpbGw6ICMxMTE4Mjc7CiAgICAgICAgfQoKICAgICAgICBAbWVkaWEgKHByZWZlcnMtY29sb3Itc2NoZW1lOiBkYXJrKSB7CiAgICAgICAgICAgIHBhdGggewogICAgICAgICAgICAgICAgZmlsbDogI2Y5ZmFmYjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIDwvc3R5bGU+CiAgICA8cGF0aCBkPSJNMjgzIDI5MC4wODNMNDguMzg0MiAzODlMMjcgMzIzLjA1NUwxOTguNjg1IDI1Ni41TDI3IDE4OS45NDVMNDguMzg0MiAxMjRMMjgzIDIyMi4zMDZWMjkwLjA4M1oiCiAgICAgICAgZmlsbD0iIzExMTgyNyIgLz4KPC9zdmc+"],iu=document.querySelector('link[rel="icon"]');let ru=0;setInterval(()=>{iu==null||iu.setAttribute("href",G4[ru]),ru+=ru?-1:1},1e3);
